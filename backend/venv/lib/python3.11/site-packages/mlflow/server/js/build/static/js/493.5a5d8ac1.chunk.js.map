{"version":3,"file":"static/js/493.5a5d8ac1.chunk.js","mappings":"0JAAIA,EAAOC,EAAOC,EAAQC,EAAQC,E,WAClC,SAASC,IAAa,OAAOA,EAAWC,OAAOC,OAASD,OAAOC,OAAOC,OAAS,SAAUC,GAAK,IAAK,IAAIC,EAAI,EAAGA,EAAIC,UAAUC,OAAQF,IAAK,CAAE,IAAIG,EAAIF,UAAUD,GAAI,IAAK,IAAII,KAAKD,GAAG,CAAG,GAAEE,eAAeC,KAAKH,EAAGC,KAAOL,EAAEK,GAAKD,EAAEC,GAAK,CAAE,OAAOL,CAAG,EAAGJ,EAASY,MAAM,KAAMN,UAAY,CAEnR,SAASO,EAAYC,EAAMC,GACzB,IAAI,MACFC,EAAK,QACLC,KACGC,GACDJ,EACJ,OAAoB,gBAAoB,MAAOd,EAAS,CACtDmB,MAAO,GACPC,OAAQ,GACRC,QAAS,YACTC,KAAM,OACNC,MAAO,6BACPC,IAAKT,EACL,kBAAmBE,GAClBC,GAAQF,EAAqB,gBAAoB,QAAS,CAC3DS,GAAIR,GACHD,GAAS,KAAMrB,IAAUA,EAAqB,gBAAoB,OAAQ,CAC3E+B,EAAG,yBACHC,OAAQ,UACRC,cAAe,WACZhC,IAAUA,EAAqB,gBAAoB,OAAQ,CAC9DiC,EAAG,QACHC,EAAG,QACHX,MAAO,QACPC,OAAQ,QACRE,KAAM,aACHzB,IAAWA,EAAsB,gBAAoB,OAAQ,CAChEgC,EAAG,QACHC,EAAG,QACHX,MAAO,QACPC,OAAQ,QACRE,KAAM,aACHxB,IAAWA,EAAsB,gBAAoB,OAAQ,CAChE+B,EAAG,QACHC,EAAG,QACHX,MAAO,QACPC,OAAQ,QACRE,KAAM,aACHvB,IAAWA,EAAsB,gBAAoB,OAAQ,CAChE8B,EAAG,QACHC,EAAG,QACHX,MAAO,QACPC,OAAQ,QACRE,KAAM,aAEV,CACA,MAAMS,EAA0B,aAAiBlB,GAClC,G,wEClDXlB,EAAOqC,EAAQC,E,WACnB,SAASjC,IAAa,OAAOA,EAAWC,OAAOC,OAASD,OAAOC,OAAOC,OAAS,SAAUC,GAAK,IAAK,IAAIC,EAAI,EAAGA,EAAIC,UAAUC,OAAQF,IAAK,CAAE,IAAIG,EAAIF,UAAUD,GAAI,IAAK,IAAII,KAAKD,GAAG,CAAG,GAAEE,eAAeC,KAAKH,EAAGC,KAAOL,EAAEK,GAAKD,EAAEC,GAAK,CAAE,OAAOL,CAAG,EAAGJ,EAASY,MAAM,KAAMN,UAAY,CAEnR,SAAS4B,EAAgBpB,EAAMC,GAC7B,IAAI,MACFC,EAAK,QACLC,KACGC,GACDJ,EACJ,OAAoB,gBAAoB,MAAOd,EAAS,CACtDmB,MAAO,GACPC,OAAQ,GACRC,QAAS,YACTC,KAAM,OACNC,MAAO,6BACPC,IAAKT,EACL,kBAAmBE,GAClBC,GAAQF,EAAqB,gBAAoB,QAAS,CAC3DS,GAAIR,GACHD,GAAS,KAAMrB,IAAUA,EAAqB,gBAAoB,OAAQ,CAC3E+B,EAAG,aACHC,OAAQ,UACRC,cAAe,WACZI,IAAWA,EAAsB,gBAAoB,OAAQ,CAChEN,EAAG,6wBACHC,OAAQ,UACRC,cAAe,WACZK,IAAWA,EAAsB,gBAAoB,OAAQ,CAChEP,EAAG,2eACHC,OAAQ,UACRC,cAAe,WAEnB,CACA,MAAMG,EAA0B,aAAiBG,GAClC,G,yEClCXtC,EAAOC,EAAQC,EAAQC,EAAQoC,EAAQC,EAAQC,EAAQC,EAAQC,EAAQC,EAASC,EAASC,EAASC,EAASC,EAASC,EAASC,EAASC,EAASC,E,WACnJ,SAAShD,IAAa,OAAOA,EAAWC,OAAOC,OAASD,OAAOC,OAAOC,OAAS,SAAUC,GAAK,IAAK,IAAIC,EAAI,EAAGA,EAAIC,UAAUC,OAAQF,IAAK,CAAE,IAAIG,EAAIF,UAAUD,GAAI,IAAK,IAAII,KAAKD,GAAG,CAAG,GAAEE,eAAeC,KAAKH,EAAGC,KAAOL,EAAEK,GAAKD,EAAEC,GAAK,CAAE,OAAOL,CAAG,EAAGJ,EAASY,MAAM,KAAMN,UAAY,CAEnR,SAAS2C,EAAmBnC,EAAMC,GAChC,IAAI,MACFC,EAAK,QACLC,KACGC,GACDJ,EACJ,OAAoB,gBAAoB,MAAOd,EAAS,CACtDmB,MAAO,GACPC,OAAQ,GACRC,QAAS,YACTC,KAAM,OACNC,MAAO,6BACPC,IAAKT,EACL,kBAAmBE,GAClBC,GAAQF,EAAqB,gBAAoB,QAAS,CAC3DS,GAAIR,GACHD,GAAS,KAAMpB,IAAUA,EAAqB,gBAAoB,OAAQ,CAC3EkC,EAAG,EACHX,MAAO,EACPC,OAAQ,EACRE,KAAM,aACHzB,IAAWA,EAAsB,gBAAoB,OAAQ,CAChEgC,EAAG,EACHC,EAAG,EACHX,MAAO,EACPC,OAAQ,EACRE,KAAM,aACHxB,IAAWA,EAAsB,gBAAoB,OAAQ,CAChE+B,EAAG,GACHC,EAAG,EACHX,MAAO,EACPC,OAAQ,EACRE,KAAM,aACHvB,IAAWA,EAAsB,gBAAoB,OAAQ,CAChE+B,EAAG,EACHX,MAAO,EACPC,OAAQ,EACRE,KAAM,aACHa,IAAWA,EAAsB,gBAAoB,OAAQ,CAChEN,EAAG,EACHC,EAAG,EACHX,MAAO,EACPC,OAAQ,EACRE,KAAM,aACHc,IAAWA,EAAsB,gBAAoB,OAAQ,CAChEP,EAAG,GACHC,EAAG,EACHX,MAAO,EACPC,OAAQ,EACRE,KAAM,aACHe,IAAWA,EAAsB,gBAAoB,OAAQ,CAChEP,EAAG,EACHX,MAAO,EACPC,OAAQ,EACRE,KAAM,aACHgB,IAAWA,EAAsB,gBAAoB,OAAQ,CAChET,EAAG,EACHC,EAAG,EACHX,MAAO,EACPC,OAAQ,EACRE,KAAM,aACHiB,IAAWA,EAAsB,gBAAoB,OAAQ,CAChEV,EAAG,GACHC,EAAG,EACHX,MAAO,EACPC,OAAQ,EACRE,KAAM,aACHkB,IAAYA,EAAuB,gBAAoB,OAAQ,CAClEV,EAAG,EACHX,MAAO,EACPC,OAAQ,EACRE,KAAM,aACHmB,IAAYA,EAAuB,gBAAoB,OAAQ,CAClEZ,EAAG,EACHC,EAAG,EACHX,MAAO,EACPC,OAAQ,EACRE,KAAM,aACHoB,IAAYA,EAAuB,gBAAoB,OAAQ,CAClEb,EAAG,GACHC,EAAG,EACHX,MAAO,EACPC,OAAQ,EACRE,KAAM,aACHqB,IAAYA,EAAuB,gBAAoB,OAAQ,CAClEb,EAAG,GACHX,MAAO,EACPC,OAAQ,EACRE,KAAM,aACHsB,IAAYA,EAAuB,gBAAoB,OAAQ,CAClEf,EAAG,EACHC,EAAG,GACHX,MAAO,EACPC,OAAQ,EACRE,KAAM,aACHuB,IAAYA,EAAuB,gBAAoB,OAAQ,CAClEhB,EAAG,GACHC,EAAG,GACHX,MAAO,EACPC,OAAQ,EACRE,KAAM,aACHwB,IAAYA,EAAuB,gBAAoB,OAAQ,CAClEhB,EAAG,GACHX,MAAO,EACPC,OAAQ,EACRE,KAAM,aACHyB,IAAYA,EAAuB,gBAAoB,OAAQ,CAClElB,EAAG,EACHC,EAAG,GACHX,MAAO,EACPC,OAAQ,EACRE,KAAM,aACH0B,IAAYA,EAAuB,gBAAoB,OAAQ,CAClEnB,EAAG,GACHC,EAAG,GACHX,MAAO,EACPC,OAAQ,EACRE,KAAM,aAEV,CACA,MAAMS,EAA0B,aAAiBkB,GAClC,G,yEC5HXrD,EAAOsD,EAAOC,EAAQC,E,WAC1B,SAASpD,IAAa,OAAOA,EAAWC,OAAOC,OAASD,OAAOC,OAAOC,OAAS,SAAUC,GAAK,IAAK,IAAIC,EAAI,EAAGA,EAAIC,UAAUC,OAAQF,IAAK,CAAE,IAAIG,EAAIF,UAAUD,GAAI,IAAK,IAAII,KAAKD,GAAG,CAAG,GAAEE,eAAeC,KAAKH,EAAGC,KAAOL,EAAEK,GAAKD,EAAEC,GAAK,CAAE,OAAOL,CAAG,EAAGJ,EAASY,MAAM,KAAMN,UAAY,CAEnR,SAAS+C,EAAcvC,EAAMC,GAC3B,IAAI,MACFC,EAAK,QACLC,KACGC,GACDJ,EACJ,OAAoB,gBAAoB,MAAOd,EAAS,CACtDmB,MAAO,GACPC,OAAQ,GACRC,QAAS,YACTC,KAAM,OACNC,MAAO,6BACPC,IAAKT,EACL,kBAAmBE,GAClBC,GAAQF,EAAqB,gBAAoB,QAAS,CAC3DS,GAAIR,GACHD,GAAS,KAAMpB,IAAUA,EAAqB,gBAAoB,OAAQ,CAC3EiC,EAAG,GACHC,EAAG,GACHX,MAAO,GACPC,OAAQ,GACRO,OAAQ,aACLuB,IAAUA,EAAqB,gBAAoB,OAAQ,CAC9DI,GAAI,IACJC,GAAI,QACJC,GAAI,IACJC,GAAI,GACJ9B,OAAQ,aACLwB,IAAWA,EAAsB,gBAAoB,OAAQ,CAChEG,GAAI,GACJC,GAAI,QACJC,IAAK,WACLC,GAAI,QACJ9B,OAAQ,aACLyB,IAAWA,EAAsB,gBAAoB,OAAQ,CAChEE,GAAI,GACJC,GAAI,KACJC,IAAK,WACLC,GAAI,KACJ9B,OAAQ,aAEZ,CACA,MAAMI,EAA0B,aAAiBsB,GAClC,G,yEC9CX1D,EAAOqC,E,WACX,SAAShC,IAAa,OAAOA,EAAWC,OAAOC,OAASD,OAAOC,OAAOC,OAAS,SAAUC,GAAK,IAAK,IAAIC,EAAI,EAAGA,EAAIC,UAAUC,OAAQF,IAAK,CAAE,IAAIG,EAAIF,UAAUD,GAAI,IAAK,IAAII,KAAKD,GAAG,CAAG,GAAEE,eAAeC,KAAKH,EAAGC,KAAOL,EAAEK,GAAKD,EAAEC,GAAK,CAAE,OAAOL,CAAG,EAAGJ,EAASY,MAAM,KAAMN,UAAY,CAEnR,SAASoD,EAAa5C,EAAMC,GAC1B,IAAI,MACFC,EAAK,QACLC,KACGC,GACDJ,EACJ,OAAoB,gBAAoB,MAAOd,EAAS,CACtDmB,MAAO,GACPC,OAAQ,GACRC,QAAS,YACTC,KAAM,OACNC,MAAO,6BACPC,IAAKT,EACL,kBAAmBE,GAClBC,GAAQF,EAAqB,gBAAoB,QAAS,CAC3DS,GAAIR,GACHD,GAAS,KAAMrB,IAAUA,EAAqB,gBAAoB,OAAQ,CAC3E+B,EAAG,iEACHC,OAAQ,UACRgC,YAAa,EACb/B,cAAe,QACfgC,eAAgB,WACb5B,IAAWA,EAAsB,gBAAoB,OAAQ,CAChEN,EAAG,aACHC,OAAQ,UACRC,cAAe,WAEnB,CACA,MAAMG,EAA0B,aAAiB2B,GAClC,G,yEChCX/D,EAAOqC,EAAQC,EAAQ4B,EAAQC,E,WACnC,SAAS9D,IAAa,OAAOA,EAAWC,OAAOC,OAASD,OAAOC,OAAOC,OAAS,SAAUC,GAAK,IAAK,IAAIC,EAAI,EAAGA,EAAIC,UAAUC,OAAQF,IAAK,CAAE,IAAIG,EAAIF,UAAUD,GAAI,IAAK,IAAII,KAAKD,GAAG,CAAG,GAAEE,eAAeC,KAAKH,EAAGC,KAAOL,EAAEK,GAAKD,EAAEC,GAAK,CAAE,OAAOL,CAAG,EAAGJ,EAASY,MAAM,KAAMN,UAAY,CAEnR,SAASyD,EAAiBjD,EAAMC,GAC9B,IAAI,MACFC,EAAK,QACLC,KACGC,GACDJ,EACJ,OAAoB,gBAAoB,MAAOd,EAAS,CACtDmB,MAAO,GACPC,OAAQ,GACRC,QAAS,YACTC,KAAM,OACNC,MAAO,6BACPC,IAAKT,EACL,kBAAmBE,GAClBC,GAAQF,EAAqB,gBAAoB,QAAS,CAC3DS,GAAIR,GACHD,GAAS,KAAMrB,IAAUA,EAAqB,gBAAoB,OAAQ,CAC3E+B,EAAG,aACHC,OAAQ,UACRC,cAAe,WACZI,IAAWA,EAAsB,gBAAoB,OAAQ,CAChEN,EAAG,6nBACHC,OAAQ,UACRC,cAAe,WACZK,IAAWA,EAAsB,gBAAoB,OAAQ,CAChEP,EAAG,sqBACHC,OAAQ,UACRC,cAAe,WACZiC,IAAWA,EAAsB,gBAAoB,OAAQ,CAChEnC,EAAG,2BACHC,OAAQ,UACRC,cAAe,WACZkC,IAAWA,EAAsB,gBAAoB,OAAQ,CAChEpC,EAAG,0BACHC,OAAQ,UACRC,cAAe,WAEnB,CACA,MAAMG,EAA0B,aAAiBgC,GAClC,G,yEC1CXpE,EAAOqE,EAASC,EAAUC,EAAUC,EAAUC,EAAWC,E,WAC7D,SAASrE,IAAa,OAAOA,EAAWC,OAAOC,OAASD,OAAOC,OAAOC,OAAS,SAAUC,GAAK,IAAK,IAAIC,EAAI,EAAGA,EAAIC,UAAUC,OAAQF,IAAK,CAAE,IAAIG,EAAIF,UAAUD,GAAI,IAAK,IAAII,KAAKD,GAAG,CAAG,GAAEE,eAAeC,KAAKH,EAAGC,KAAOL,EAAEK,GAAKD,EAAEC,GAAK,CAAE,OAAOL,CAAG,EAAGJ,EAASY,MAAM,KAAMN,UAAY,CAEnR,SAASgE,EAAgBxD,EAAMC,GAC7B,IAAI,MACFC,EAAK,QACLC,KACGC,GACDJ,EACJ,OAAoB,gBAAoB,MAAOd,EAAS,CACtDmB,MAAO,GACPC,OAAQ,GACRC,QAAS,YACTC,KAAM,OACNC,MAAO,6BACPC,IAAKT,EACL,kBAAmBE,GAClBC,GAAQF,EAAqB,gBAAoB,QAAS,CAC3DS,GAAIR,GACHD,GAAS,KAAMrB,IAAUA,EAAqB,gBAAoB,OAAQ,CAC3E+B,EAAG,yBACHC,OAAQ,UACRC,cAAe,WACZoC,IAAYA,EAAuB,gBAAoB,SAAU,CACpEO,GAAI,QACJC,GAAI,QACJ/D,EAAG,QACHa,KAAM,aACH2C,IAAaA,EAAwB,gBAAoB,UAAW,CACvEM,GAAI,QACJC,GAAI,QACJC,GAAI,QACJC,GAAI,QACJpD,KAAM,aACH4C,IAAaA,EAAwB,gBAAoB,SAAU,CACtEK,GAAI,OACJC,GAAI,OACJ/D,EAAG,QACHa,KAAM,UACNqD,YAAa,OACVR,IAAaA,EAAwB,gBAAoB,SAAU,CACtEI,GAAI,QACJC,GAAI,QACJ/D,EAAG,QACHa,KAAM,aACH8C,IAAcA,EAAyB,gBAAoB,UAAW,CACzEG,GAAI,QACJC,GAAI,QACJC,GAAI,QACJC,GAAI,QACJpD,KAAM,UACNqD,YAAa,OACVN,IAAcA,EAAyB,gBAAoB,UAAW,CACzEE,GAAI,QACJC,GAAI,QACJC,GAAI,QACJC,GAAI,QACJpD,KAAM,aAEV,CACA,MAAMS,EAA0B,aAAiBuC,GAClC,G,yEC7DX3E,EAAOiF,EAAI5C,EAAQC,EAAQ4C,E,WAC/B,SAAS7E,IAAa,OAAOA,EAAWC,OAAOC,OAASD,OAAOC,OAAOC,OAAS,SAAUC,GAAK,IAAK,IAAIC,EAAI,EAAGA,EAAIC,UAAUC,OAAQF,IAAK,CAAE,IAAIG,EAAIF,UAAUD,GAAI,IAAK,IAAII,KAAKD,GAAG,CAAG,GAAEE,eAAeC,KAAKH,EAAGC,KAAOL,EAAEK,GAAKD,EAAEC,GAAK,CAAE,OAAOL,CAAG,EAAGJ,EAASY,MAAM,KAAMN,UAAY,CAEnR,SAASwE,EAAyBhE,EAAMC,GACtC,IAAI,MACFC,EAAK,QACLC,KACGC,GACDJ,EACJ,OAAoB,gBAAoB,MAAOd,EAAS,CACtDmB,MAAO,GACPC,OAAQ,GACRC,QAAS,YACTC,KAAM,OACNC,MAAO,6BACPC,IAAKT,EACL,kBAAmBE,GAClBC,GAAQF,EAAqB,gBAAoB,QAAS,CAC3DS,GAAIR,GACHD,GAAS,KAAmB,gBAAoB,IAAK,CACtD+D,SAAU,mBACI,gBAAoB,OAAQ,CAC1CtD,GAAI,YACJuD,MAAO,CACLC,SAAU,aAEZC,UAAW,iBACXrD,EAAG,EACHC,EAAG,EACHX,MAAO,GACPC,OAAQ,IACPzB,IAAUA,EAAqB,gBAAoB,OAAQ,CAC5D+B,EAAG,mBACHJ,KAAM,YACFsD,IAAOA,EAAkB,gBAAoB,IAAK,CACtDO,KAAM,mBACQ,gBAAoB,OAAQ,CAC1CC,SAAU,UACVC,SAAU,UACV3D,EAAG,uuDACHJ,KAAM,mBACFU,IAAWA,EAAsB,gBAAoB,OAAQ,CACjEN,EAAG,uHACHJ,KAAM,WACHW,IAAWA,EAAsB,gBAAoB,OAAQ,CAChEmD,SAAU,UACVC,SAAU,UACV3D,EAAG,0dACHJ,KAAM,cACFuD,IAAUA,EAAqB,gBAAoB,OAAQ,KAAmB,gBAAoB,WAAY,CAClHpD,GAAI,aACU,gBAAoB,OAAQ,CAC1CN,MAAO,GACPC,OAAQ,GACRE,KAAM,aAEV,CACA,MAAMS,EAA0B,aAAiB+C,GAClC,G,wJC/CR,MAAMQ,EAA0CxE,IAA6D,IAA5D,KAAEyE,EAAI,aAAEC,EAAY,aAAEC,EAAY,iBAAEC,GAAkB5E,EAC5G,MAAM,cAAE6E,EAAa,cAAEC,GAAkBC,EAAiBN,GAsB1D,OACEO,EAAAA,EAAAA,GAAA,OAAKd,MAAO,CApBZe,SAAU,WACVC,UAAW,kBACXC,SAAU,YAkB+BT,GAAeU,SACrDN,GACCO,EAAAA,EAAAA,IAAAC,EAAAA,GAAA,CAAAF,SAAA,EACEJ,EAAAA,EAAAA,GAACO,EAAAA,GAAW,CAACC,SAAS,OAAOtB,MAAO,CAR1CuB,QAAS,MACTC,UAAW,YAOgEd,GAAmBQ,SACrFP,KAEHG,EAAAA,EAAAA,GAAA,OAAKW,KAAGC,EAAAA,EAAAA,IAAE,CApBhBX,SAAU,WACVY,OAAQ,EACRC,MAAO,EACPC,KAAM,EACNzF,OAAQ,MACR0F,WAAY,yCAeiCrB,GAAc,UAGvDK,EAAAA,EAAAA,GAAAM,EAAAA,GAAA,CAAAF,SAAGX,KAED,EAIH,SAASM,EAAiBN,GAC/B,OAAOwB,EAAAA,SAAc,KACnB,IACE,MAAMC,EAASC,KAAKC,MAAM3B,GACpB4B,GAASC,EAAAA,EAAAA,UAASJ,IAA6B,oBAAXA,KAA2BA,aAAkBK,MACvF,MAAO,CACL1B,cAAewB,EAASF,KAAKK,UAAUN,EAAQ,KAAM,GAAKzB,EAC1DK,cAAeuB,EAEnB,CAAE,MAAO9G,GACP,MAAO,CACLsF,cAAeJ,EACfK,eAAe,EAEnB,IACC,CAACL,GACN,CAAC,IAAAgC,EAAA,CAAAC,KAAA,UAAAC,OAAA,wBAEM,MAAMC,EAAmDC,IAAe,IAAd,KAAEpC,GAAMoC,EACvE,MAAM,cAAEhC,EAAa,cAAEC,GAAkBC,EAAiBN,GAE1D,OACEO,EAAAA,EAAAA,GAAA,OAAKW,IAAGc,EAA6BrB,SAClCN,GACCE,EAAAA,EAAAA,GAACO,EAAAA,GAAW,CAACC,SAAS,OAAOsB,eAAa,EAAA1B,SACvCP,KAGHG,EAAAA,EAAAA,GAAA,QAAAI,SAAOX,KAEL,C,qHC1DV,MAAMsC,EAAmBd,EAAAA,YACvB,CAAC7F,EAA8BM,KAC7B,MAAM,QACJsG,EAAO,QACPC,EAAO,KACPC,EAAI,OACJC,EAAM,QACNC,EAAO,aACPC,EAAY,aACZC,EAAY,YACZC,EAAW,gBACXC,EAAe,KACfC,KACGC,GACDtH,GACE,MAAEuH,IAAUC,EAAAA,EAAAA,KAEZC,GAAeC,EAAAA,EAAAA,GAAuC,CAC1DC,cAAeC,EAAAA,EAAwCC,OACvDV,cACAC,gBAAgC,OAAfA,QAAe,IAAfA,EAAAA,EAAmB,CAACU,EAAAA,EAA6CC,WAGpF,OACEnD,EAAAA,EAAAA,GAAA,UACEiC,QAAUmB,IACRP,EAAaZ,QAAQmB,GACd,OAAPnB,QAAO,IAAPA,GAAAA,EAAUmB,EAAM,EAElBzC,KAAGC,EAAAA,EAAAA,IAAE,CACHyC,OAAQ,UACRhI,MAAOsH,EAAMW,QAAQC,SACrBjI,OAAQqH,EAAMW,QAAQC,SACtBC,aAAcb,EAAMc,cAAcC,eAClCC,WAAYhB,EAAMiB,WAAWC,eAC7BpD,QAAS,EACTqD,OAAQ,EACRC,QAAS,OACTC,WAAY,SACZC,eAAgB,SAChBjD,WAAYgB,EAAUW,EAAMuB,OAAOC,6BAA+B,cAClEC,MAAOpC,EAAUW,EAAMuB,OAAOG,uBAAyB1B,EAAMuB,OAAOI,cACpE,UAAW,CACTtD,WAAY2B,EAAMuB,OAAOK,6BACzBH,MAAOzB,EAAMuB,OAAOM,yBAEvB,IACD9I,IAAKA,EACLyG,OAAQA,EACRC,QAASA,EACTC,aAAcA,EACdC,aAAcA,KACVI,EAActC,SAEjB8B,GACM,G,0KC1CR,MAAMuC,EAAwBzJ,IAKF,IALG,aACpC0J,EAAY,QACZC,EAAO,OACPC,EAAM,SACNC,GAAW,GACgB7J,EAC3B,MAAM8J,GAAeC,EAAAA,EAAAA,QAAOH,GAE5BE,EAAaE,QAAUJ,EAEvB,OAAO,OAAEK,EAAM,YAAEC,GAAeC,IAAiBC,EAAAA,EAAAA,GAK/C,CACEC,QAASA,KAAOR,EAChBS,OAAQ,OAAOZ,IACfa,KAAMA,CAAA1D,EAAsC2D,KAAa,IAAhDC,IAAKC,GAA4B7D,EACpC6D,IAAcf,GAAWa,EAAQG,WAGrCb,EAAaE,QAAQU,EAAWf,EAAQ,EAE1CiB,QAAUJ,IAAO,CAAQP,OAAQO,EAAQP,OAAO,CAAEY,SAAS,IAASX,YAAaM,EAAQM,aAE3F,CAACjB,EAAUH,EAAcC,MAGpB,WAAEoB,GAAcC,EAAeC,IAAkBC,EAAAA,EAAAA,GACtD,CACEC,QAASA,KAAOtB,EAChBpC,KAAM,OAAOiC,IACb0B,KAAM,CAAEX,IAAKd,EAAS0B,SAAU3B,GAChCkB,QAAUJ,IAAO,CACfO,WAAYP,EAAQO,gBAGxB,CAAClB,EAAUH,EAAcC,IAK3B,MAAO,CAAEQ,gBAAea,gBAAeC,iBAAgBF,aAAYd,SAAQqB,qBAF9CC,QAAQrB,GAAeA,EAAYmB,WAAa3B,GAEoB,EAGnG,IAAA8B,EAAA,CAAA9E,KAAA,SAAAC,OAAA,oBAKO,MAAM8E,EAAgChF,IAAmB,IAAlB,SAAErB,GAAUqB,EACxD,MAAMiF,GAAiB3B,EAAAA,EAAAA,QAAuB,OACvC4B,EAASC,IAAcC,EAAAA,EAAAA,UAAiC,MAW/D,OATAC,EAAAA,EAAAA,kBAAgB,KACd,MAAMC,EAAcL,EAAe1B,QAC7BgC,GAAkBC,EAAAA,EAAAA,GAAsBC,EAAAA,QAAcC,EAAW,CAAEJ,gBAEzE,OADAH,EAAWI,GACJ,KACLA,EAAgBI,aAAaC,UAAU,CACxC,GACA,KAGDrH,EAAAA,EAAAA,GAAA,OAAKW,IAAG6F,EAA2B9K,IAAKgL,EAAetG,SACpDuG,IAAW3G,EAAAA,EAAAA,GAACsH,EAAAA,EAAW,CAACX,QAASA,EAAQvG,SAAEA,KACxC,C,mFChGH,MAAMmH,EAAiBA,KAC5B,MAAOC,EAAaC,IAAkBZ,EAAAA,EAAAA,UAAsC,YAA7Ba,SAASC,iBAMxD,OALAC,EAAAA,EAAAA,YAAU,KACRF,SAASG,iBAAiB,oBAAqB9L,IAC7C0L,EAA4C,YAA7BC,SAASC,gBAA8B,GACtD,GACD,IACIH,CAAW,C,mECbpB,MAAMM,EAAsB,EACtBC,EAAsB,EACtBC,EAA2B,IAC3BC,EAAc,GAMPC,EAAqBlN,IAAA,IAAC,WACjCmN,EAAaL,EAAmB,WAChCM,EAAaL,EAAmB,eAChCM,EAAiBL,EAAwB,IACzCM,EAAML,EAAW,sBACjBM,EAAwB,IAuBzBvN,EAAA,MAAM,CACL+I,QAAS,OACTyE,oBAAqB,4FAKJL,OAAgBG,kDAGrBD,+BACUD,OAAgBE,6DAMtCA,SACGC,EAAsBE,QACvB,CAACC,EAAG7G,KAAA,IAAE,gBAAE8G,EAAe,4BAAEC,GAA6B/G,EAAA,MAAM,IACvD6G,EACH,CAAC,sBAAsBC,QAAuB,CAC5CH,oBAAqB,0DAGjBI,2CAKP,GACD,CAAC,GAEJ,C,qEC5Dc,MAAMC,EAanB,2BAAOC,CAAqBC,EAAoBpN,GAC9C,OAAO,IAAIqN,EAAkB,CAACD,EAAepN,GAAIsN,KAAK,KAAM,eAC9D,CAEA,wCAAOC,CAAkCH,EAAoBpN,GAC3D,OAAO,IAAIqN,EAAkB,CAACD,EAAepN,GAAIsN,KAAK,KAAM,iBAC9D,EAnBmBJ,EAMZM,QAAU,MAoBnB,MAAMH,EACJI,WAAAA,CAAYC,EAAY5G,GAAY,KAUpC4G,WAAK,OACLC,gBAAU,EAVRC,KAAKF,MAAQA,EAEXE,KAAKD,WADM,iBAAT7G,EACgB+G,OAAOC,aAEPD,OAAOE,cAE7B,CASAC,kBAAAA,GACE,MAAMC,EAAYL,KAAKzD,QAAQkD,EAAkBa,wBACjD,OAAID,EACKzI,KAAKC,MAAMwI,GAEb,CAAC,CACV,CAMAE,kBAAAA,CAAmBC,GACjB,MAAMC,EAA4C,oBAAvBD,EAAYE,OAAwBF,EAAYE,SAAWF,EACtFR,KAAKW,QAAQlB,EAAkBa,uBAAwB1I,KAAKK,UAAUwI,GACxE,CAMAG,eAAAA,CAAgB1E,GACd,MAAO,CAAC,qBAAsBoD,EAAkBM,QAASI,KAAKF,MAAO5D,GAAKwD,KAAK,IACjF,CAGAiB,OAAAA,CAAQzE,EAAU2E,GAChBb,KAAKD,WAAWY,QAAQX,KAAKY,gBAAgB1E,GAAM2E,EACrD,CAGAtE,OAAAA,CAAQL,GACN,OAAO8D,KAAKD,WAAWxD,QAAQyD,KAAKY,gBAAgB1E,GACtD,EAlDIuD,EASGa,uBAAyB,qB,kFCnC3B,MAAMQ,EAAoBC,IAC/B,MAAOC,EAA2BC,IAAgC3D,EAAAA,EAAAA,UAA6B,OAExF4D,EAAeC,IAAoB7D,EAAAA,EAAAA,eAA6BM,GAgBvE,OAdAS,EAAAA,EAAAA,YAAU,KACR,IAAK2C,IAA8Bf,OAAOmB,eACxC,OAEF,MAAMC,EAAiB,IAAID,gBAAe3P,IAAc,IAAZ6P,GAAM7P,EAClC,OAAdsP,QAAc,IAAdA,GAAAA,EAAiBO,GACbA,EAAMC,OAAOC,cACfL,EAAiBG,EAAMC,OAAOC,aAChC,IAGF,OADAH,EAAeI,QAAQT,GAChB,IAAMK,EAAeK,YAAY,GACvC,CAACV,EAA2BD,IAExB,CAAEG,gBAAeS,cAAeV,EAA8B,C,yGCvBhE,MAAMW,EAA2BnQ,IAMjC,IANkC,WACvCoQ,EAAU,UACVC,GAIDrQ,EACC,OAAIoQ,IAAeE,EAAAA,GAAWC,UACrBvL,EAAAA,EAAAA,GAACwL,EAAAA,IAAY,CAACH,UAAWA,IACvBD,IAAeE,EAAAA,GAAWG,OAC5BzL,EAAAA,EAAAA,GAAC0L,EAAAA,IAAQ,CAACL,UAAWA,IACnBD,IAAeE,EAAAA,GAAWK,SAC5B3L,EAAAA,EAAAA,GAAC4L,EAAAA,IAAgB,CAACP,UAAWA,IAC3BD,IAAeE,EAAAA,GAAWO,KAC5B7L,EAAAA,EAAAA,GAAC8L,EAAAA,IAAa,CAACT,UAAWA,IAE5B,IAAI,C,gICpBb,MAAMU,EAAYA,KAChB,MAAM,MAAEpJ,IAAUC,EAAAA,EAAAA,KAClB,OAAO5C,EAAAA,EAAAA,GAACgM,EAAAA,IAAW,CAACrL,KAAGC,EAAAA,EAAAA,IAAE,CAAEwD,MAAOzB,EAAMuB,OAAO+H,sBAAsB,KAAI,EAGrEC,EAAeA,KACnB,MAAM,MAAEvJ,IAAUC,EAAAA,EAAAA,KAClB,OAAO5C,EAAAA,EAAAA,GAACmM,EAAAA,IAAe,CAACxL,KAAGC,EAAAA,EAAAA,IAAE,CAAEwD,MAAOzB,EAAMuB,OAAOkI,uBAAuB,KAAI,EAGnEC,EAAgBrR,IAAqC,IAApC,OAAEsR,GAA4BtR,EAC1D,OAAQsR,GACN,IAAK,SACL,IAAK,SACH,OAAOtM,EAAAA,EAAAA,GAAC+L,EAAS,IACnB,IAAK,WACH,OAAO/L,EAAAA,EAAAA,GAACkM,EAAY,IACtB,IAAK,YACL,IAAK,UACH,OAAOlM,EAAAA,EAAAA,GAACuM,EAAAA,EAAS,IACnB,QACE,OAAO,KACX,C,0IChBF,MAAMC,EAA8B,uEAqBpC,IAAAhG,EAAA,CAAA9E,KAAA,UAAAC,OAAA,oGAGO,MAAM8K,EAAezR,IASrB,IAAD6G,EAAA,IATuB,MAC3BuC,EAAK,OACLsI,EAAM,cACNC,KACGvR,GAKJJ,EACC,MAAO4R,EAAYC,IAAiBhG,EAAAA,EAAAA,eAA6BM,GAE3D2F,GAAyBC,EAAAA,EAAAA,UAAQ,IAIjCJ,GACKK,EAAAA,EAAAA,UAASL,EAAe,KAE1B,QACN,CAACA,IAEJ,OACEtM,EAAAA,EAAAA,IAAA,SACEM,KAAGC,EAAAA,EAAAA,IAAE,CACHvF,MAAO,GACPC,OAAQ,GACRkI,aAAc,EACdyJ,WAAY,EAEZnJ,OAAQ,cAAa4I,EAAS,cAAgB,mBAE9C,CAACF,GAA8B,CAC7BU,aAAc,GAEhBlM,WAAY0L,EAzDiB,kSAyDuBvF,EACpD9D,OAAQsJ,EAAgB,UAAY,UACpC1M,SAAU,WACV,UAAW,CACTkN,QAASR,EAAgB,GAAM,IAElC,IACDzN,MAAO,CAAEkO,gBAAoC,QAArBvL,EAAY,OAAV+K,QAAU,IAAVA,EAAAA,EAAcxI,SAAK,IAAAvC,EAAAA,EAAI,kBAC7CzG,EAAKgF,SAAA,EAETJ,EAAAA,EAAAA,GAAA,QACEW,IAAG,CACD0M,EAAAA,EAAe,qBAIfjN,SAEDgE,IAEFuI,IACC3M,EAAAA,EAAAA,GAAA,SACE6E,SAAU6H,EACVjK,KAAK,QACL2H,MAAiB,OAAVwC,QAAU,IAAVA,EAAAA,EAAcxI,EACrBkJ,SAAU7L,IAAiB,IAAhB,OAAEqJ,GAAQrJ,EACnBoL,EAAc/B,EAAOV,OACrB0C,EAAuBhC,EAAOV,MAAM,EAEtCmD,KAAMC,EAAAA,EACN7M,IAAG6F,MAYD,C,4KC5GkC,IAAA3E,EAAA,CAAAH,KAAA,UAAAC,OAAA,cAOvC,MAAM8L,EAAmCzS,IAGW,IAHV,OAC/C0S,EAAM,OACNC,GACsC3S,EACtC,MAQM4S,EAAiBF,EAAOC,QAAO,CAACE,EAAqCC,KACzEC,OATiBrM,EASPmM,EAAInM,KATkBe,EASZoL,EAAIpL,KAPX,KAAXkL,IACI,OAAJjM,QAAI,IAAJA,OAAI,EAAJA,EAAMsM,cAAcC,SAASN,EAAOK,kBAChC,OAAJvL,QAAI,IAAJA,OAAI,EAAJA,EAAMuL,cAAcC,SAASN,EAAOK,gBAJtBD,IAACrM,EAAee,CAUlC,IAeA,OACEpC,EAAAA,EAAAA,IAAC6N,EAAAA,IAAK,CAACC,YAAU,EAACxN,IAAGkB,EAAoBzB,SAAA,EACvCC,EAAAA,EAAAA,IAAC+N,EAAAA,IAAQ,CAACC,UAAQ,EAAAjO,SAAA,EAChBJ,EAAAA,EAAAA,GAACsO,EAAAA,IAAW,CAAC/L,YAAY,gIAA+HnC,UAd1JJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,YAgBfxO,EAAAA,EAAAA,GAACsO,EAAAA,IAAW,CAAC/L,YAAY,gIAA+HnC,UATrJJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SAAC6S,eAAe,eAatCxO,EAAAA,EAAAA,GAAA,OAAKyO,QAAUlU,GAAMA,EAAEmU,kBAAkBtO,SACZ,IAA1BwN,EAAenT,QACduF,EAAAA,EAAAA,GAACoO,EAAAA,IAAQ,CAAAhO,UACPJ,EAAAA,EAAAA,GAAC2O,EAAAA,IAAS,CAAAvO,UACRJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,sCAMrBZ,EAAegB,KAAI,CAACf,EAAqCgB,KACvDxO,EAAAA,EAAAA,IAAC+N,EAAAA,IAAQ,CAAAhO,SAAA,EACPJ,EAAAA,EAAAA,GAAC2O,EAAAA,IAAS,CAAAvO,SAAEyN,EAAInM,QAChB1B,EAAAA,EAAAA,GAAC2O,EAAAA,IAAS,CAAAvO,SAAEyN,EAAIpL,SAFH,kBAAkBoM,WAOjC,EClDkC,IAAAhN,EAAA,CAAAH,KAAA,SAAAC,OAAA,mDAAAF,EAAA,CAAAC,KAAA,UAAAC,OAAA,kGAAA6E,EAAA,CAAA9E,KAAA,SAAAC,OAAA,mEAAAmN,EAAA,CAAApN,KAAA,UAAAC,OAAA,cAAAoN,EAAA,CAAArN,KAAA,SAAAC,OAAA,gBAAAqN,EAAA,CAAAtN,KAAA,SAAAC,OAAA,4FAAAsN,EAAA,CAAAvN,KAAA,SAAAC,OAAA,qBAAAuN,EAAA,CAAAxN,KAAA,UAAAC,OAAA,iEAAAwN,EAAA,CAAAzN,KAAA,UAAAC,OAAA,iEAMvC,MAAMyN,EAA8BpU,IAAkE,IAAjE,gBAAEqU,GAA4CrU,EACxF,MAAM,MAAE2H,IAAUC,EAAAA,EAAAA,MACZ,QAAE0M,GAAYD,GACb1B,EAAQ4B,IAAa1I,EAAAA,EAAAA,UAAS,IAErC,GAAuB,OAAnByI,EAAQ5B,QAAsC,KAAnB4B,EAAQ5B,OACrC,OACE1N,EAAAA,EAAAA,GAAA,OACEW,IAAGkB,EAIDzB,UAEFJ,EAAAA,EAAAA,GAAA,OACEW,IAAGc,EAMDrB,UAEFJ,EAAAA,EAAAA,GAACwP,EAAAA,IAAM,CAACtU,OAAO8E,EAAAA,EAAAA,GAAA,OAAKW,KAAGC,EAAAA,EAAAA,IAAE,CAAEwD,MAAOzB,EAAMuB,OAAOuL,SAAS,IAACrP,SAAC,8BAKlE,IACE,MAAMsN,EAASvM,KAAKC,MAAMkO,EAAQ5B,QAClC,MAAI,mBAAoBA,GAGpBrN,EAAAA,EAAAA,IAAA,OACEM,IAAG6F,EAKDpG,SAAA,EAEFJ,EAAAA,EAAAA,GAAA,OACEW,KAAGC,EAAAA,EAAAA,IAAE,CACH8O,UAAW/M,EAAMgN,QAAQC,GACzBC,KAAM,CAAExU,MAAO,SAChB,IAAC+E,UAEFJ,EAAAA,EAAAA,GAAC8P,EAAAA,IAAgB,CACfvN,YAAY,2HACZ6H,MAAOuD,EACPoC,YAAY,gBACZzC,SAAW/S,GAAMgV,EAAUhV,EAAEuQ,OAAOV,OACpC4F,QAASA,KACPT,EAAU,GAAG,EAEf5O,IAAGmO,EACHmB,eAAgB,CAAE/Q,MAAO,CAAE7D,MAAO,cAGtC2E,EAAAA,EAAAA,GAAA,OACEW,KAAGC,EAAAA,EAAAA,IAAE,CACH8O,UAAW/M,EAAMgN,QAAQC,GACzBzP,SAAU,UACX,IAACC,UAEFJ,EAAAA,EAAAA,GAACyN,EAAgC,CAACC,OAAQA,EAAOwC,eAAgBvC,OAAQA,SAItE,sBAAuBD,GAG9B1N,EAAAA,EAAAA,GAAA,OAAKW,IAAGoO,EAAsB3O,UAC5BC,EAAAA,EAAAA,IAAA,OACEM,IAAGqO,EAMD5O,SAAA,EAEFJ,EAAAA,EAAAA,GAACmQ,EAAAA,IAAS,CAACxP,KAAGC,EAAAA,EAAAA,IAAE,CAAEwP,SAAU,OAAQhM,MAAOzB,EAAMuB,OAAOuL,SAAS,OACjEzP,EAAAA,EAAAA,GAACwP,EAAAA,IAAM,CAACtU,OAAO8E,EAAAA,EAAAA,GAAA,OAAKW,KAAGC,EAAAA,EAAAA,IAAE,CAAEwD,MAAOzB,EAAMuB,OAAOuL,SAAS,IAACrP,SAAC,wBAC1DJ,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWC,KAAI,CAAClM,MAAOzB,EAAMuB,OAAOuL,QAAS9O,IAAGsO,EAA0B7O,UACzEJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,iHAUvBxO,EAAAA,EAAAA,GAAA,OAAKW,KAAGC,EAAAA,EAAAA,IAAE,CAAE2P,WAAY5N,EAAMgN,QAAQa,GAAId,UAAW/M,EAAMgN,QAAQc,GAAIpV,MAAO,QAAQ,IAAC+E,UACrFC,EAAAA,EAAAA,IAAA,OAAKM,IAAGuO,EAA6E9O,SAAA,EACnFJ,EAAAA,EAAAA,GAACwP,EAAAA,IAAM,CAACtU,OAAO8E,EAAAA,EAAAA,GAAA,OAAKW,KAAGC,EAAAA,EAAAA,IAAE,CAAEwD,MAAOzB,EAAMuB,OAAOuL,SAAS,IAACrP,SAAC,kCAC1DC,EAAAA,EAAAA,IAACgQ,EAAAA,EAAWC,KAAI,CAAClM,MAAOzB,EAAMuB,OAAOuL,QAAQrP,SAAA,EAC3CJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,sBAGhBrN,KAAKK,UAAUkM,UAM5B,CAAE,MACA,OACE1N,EAAAA,EAAAA,GAAA,OAAKW,KAAGC,EAAAA,EAAAA,IAAE,CAAE2P,WAAY5N,EAAMgN,QAAQa,GAAId,UAAW/M,EAAMgN,QAAQc,GAAIpV,MAAO,QAAQ,IAAC+E,UACrFJ,EAAAA,EAAAA,GAAA,OAAKW,IAAGwO,EAA6E/O,UACnFJ,EAAAA,EAAAA,GAACwP,EAAAA,IAAM,CAACtU,OAAO8E,EAAAA,EAAAA,GAAA,OAAKW,KAAGC,EAAAA,EAAAA,IAAE,CAAEwD,MAAOzB,EAAMuB,OAAOuL,SAAS,IAACrP,SAAC,6BAIlE,G,qCChIK,MAAMsQ,EAA4B1V,IAAqD,IAApD,gBAAEqU,EAAe,QAAEsB,GAA2B3V,EACtF,MAAM,QAAEsU,GAAYD,EACpB,GAAIC,EAAQlE,aAAewF,EAAAA,GAAmBC,MAAQvB,EAAQlE,aAAewF,EAAAA,GAAmBE,aAAc,CAC5G,MAAMC,GAAMC,EAAAA,EAAAA,GAAoB3B,GAChC,GAAI0B,EACF,OACE/Q,EAAAA,EAAAA,GAACiD,EAAAA,EAAM,CACLR,KAAK,UACLF,YAAY,2HACZL,MAAMlC,EAAAA,EAAAA,GAACiR,EAAAA,GAAa,IACpBC,KAAMH,EACNjG,OAAO,SAAQ1K,UAEfJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,kBAMzB,CACA,GAAIc,EAAQlE,aAAewF,EAAAA,GAAmBO,GAAI,CAChD,MAAMJ,GAAMC,EAAAA,EAAAA,GAAoB3B,GAChC,GAAI0B,EACF,OACE/Q,EAAAA,EAAAA,GAACoR,EAAAA,EAAU,CACT7O,YAAY,2HACZL,MAAMlC,EAAAA,EAAAA,GAACqR,EAAAA,IAAQ,IACfC,SAAUP,EAAI3Q,UAEdJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,8BAMzB,CACA,OAAIc,EAAQlE,aAAewF,EAAAA,GAAmBW,UAE1CvR,EAAAA,EAAAA,GAACiD,EAAAA,EAAM,CACLV,YAAY,2HACZL,MAAMlC,EAAAA,EAAAA,GAACiR,EAAAA,GAAa,IAAI7Q,UAExBJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,8BAMhB,IAAI,E,gDCtDN,MAAMgD,EAAkCxW,IAAgE,IAA/D,gBAAEqU,GAAuDrU,EACvG,MAAM,QAAEsU,GAAYD,EAEdjE,EAAakE,EAAQlE,WA8BrBqG,EA3BArG,IAAewF,EAAAA,GAAmBC,MAAQzF,IAAewF,EAAAA,GAAmBW,UAE5EvR,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,SAKjBpD,IAAewF,EAAAA,GAAmBO,IAElCnR,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,OAKjBpD,IAAewF,EAAAA,GAAmBE,cAElC9Q,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,iBAKd,KAKT,OAAIiD,GAEAzR,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWqB,KAAI,CAAAtR,UACdJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,2BAEfmD,OAAQ,CAAEF,iBAMX,IAAI,ECtDwD,IAAA5P,EAAA,CAAAH,KAAA,SAAAC,OAAA,gCAAAF,EAAA,CAAAC,KAAA,UAAAC,OAAA,0CAAA6E,EAAA,CAAA9E,KAAA,SAAAC,OAAA,6DAM9D,MAAMiQ,EAAiC5W,IAA4D,IAA3D,gBAAEqU,GAAmDrU,EAClG,MAAM,QAAEsU,GAAYD,GACd,MAAE1M,IAAUC,EAAAA,EAAAA,KAEZwI,EAAakE,EAAQlE,WAE3B,GACEA,IAAewF,EAAAA,GAAmBC,MAClCzF,IAAewF,EAAAA,GAAmBW,UAClCnG,IAAewF,EAAAA,GAAmBE,aAClC,CACA,MAAMC,GAAMC,EAAAA,EAAAA,GAAoB3B,GAChC,GAAI0B,EACF,OACE1Q,EAAAA,EAAAA,IAAA,OACEM,KAAGC,EAAAA,EAAAA,IAAE,CACHiR,WAAY,SACZ9N,QAAS,OACTqM,SAAUzN,EAAMiB,WAAWkO,WAC3B1N,MAAOzB,EAAMuB,OAAOI,cACpByN,UAAWpP,EAAMgN,QAAQqC,IAC1B,IACD9W,MAAO6V,EAAI3Q,SAAA,CACZ,OACM,KACLJ,EAAAA,EAAAA,GAACqQ,EAAAA,EAAW4B,KAAI,CACd1P,YAAY,8HACZ2P,cAAY,EACZhB,KAAMH,EACNpQ,IAAGkB,EAA0CzB,UAE7CJ,EAAAA,EAAAA,GAAA,QAAMW,IAAGc,EAAmDrB,SAAE2Q,QAKxE,CACA,GAAI3F,IAAewF,EAAAA,GAAmBO,GACpC,IACE,MAAM,IAAEgB,GAAQhR,KAAKC,MAAMkO,EAAQ8C,QACnC,GAAID,EACF,OACE9R,EAAAA,EAAAA,IAACgQ,EAAAA,EAAWqB,KAAI,CACdxW,MAAOiX,EACPxR,IAAG6F,EAIDpG,SAAA,CACH,WACU+R,IAIjB,CAAE,MACA,OAAO,IACT,CAEF,OAAO,IAAI,EC9DAE,EAA8BrX,IAAmE,IAAlE,gBAAEqU,GAA0DrU,EACtG,MAAM,QAAEsU,GAAYD,EACpB,OACErP,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWqB,KAAI,CAAAtR,UACdJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,mBAEfmD,OAAQ,CAAEW,QAAQtS,EAAAA,EAAAA,GAAA,QAAAI,SAAOkP,EAAQgD,aAEnB,E,eCoCQ,IAAAzQ,EAAA,CAAAH,KAAA,UAAAC,OAAA,+CAAAF,EAAA,CAAAC,KAAA,SAAAC,OAAA,gEAAA6E,EAAA,CAAA9E,KAAA,UAAAC,OAAA,qDAAAmN,EAAA,CAAApN,KAAA,SAAAC,OAAA,UAAAoN,EAAA,CAAArN,KAAA,SAAAC,OAAA,sDAAAqN,EAAA,CAAAtN,KAAA,UAAAC,OAAA,mCAEvB,MAAM4Q,EAAkCvX,IAKA,IAADwX,EAAA,IALE,OAC9CC,EAAM,UACNC,EAAS,uBACTC,EAAsB,0BACtBC,GAC0B5X,EAC1B,MAAM,MAAE2H,IAAUC,EAAAA,EAAAA,MACZ,gBAAEyM,EAAe,QAAEwD,GAAYF,EAC/BG,EAAaH,EACA,OAAftD,QAAe,IAAfA,GAAqB,QAANmD,EAAfnD,EAAiB0D,YAAI,IAAAP,OAAN,EAAfA,EAAuBQ,MAAMC,GAAQA,EAAIxN,MAAQyN,EAAAA,UACjD/L,EACEgM,EACJ9D,EAAgBC,QAAQ8D,SAA+C,SAApC/D,EAAgBC,QAAQ8D,QACvD/D,EAAgBC,QAAQ8D,aACxBjM,EAEAkM,GAAcC,EAAAA,EAAAA,OACd,aAAEC,EAAe,GAAE,KAAER,EAAO,CAAC,GAAMF,EAEzC,OACE7S,EAAAA,EAAAA,GAACwT,EAAAA,GAAOC,KAAI,CACVC,KAAMjB,EACNkB,aAAeD,IACRA,GACHhB,GAAU,EACZ,EACAtS,UAEFJ,EAAAA,EAAAA,GAACwT,EAAAA,GAAOI,QAAO,CACbrR,YAAY,2HACZrH,OACEmF,EAAAA,EAAAA,IAAA,OAAKM,IAAGkB,EAA4DzB,SAAA,EAClEJ,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWwD,MAAK,CAACC,MAAO,EAAGnT,KAAGC,EAAAA,EAAAA,IAAE,CAAEmT,YAAapR,EAAMgN,QAAQC,GAAI1C,aAAc,GAAG,IAAC9M,UAClFJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,yBAInBnO,EAAAA,EAAAA,IAAC4R,EAAAA,GAAI,CAAC+B,GAAIC,EAAAA,EAAOC,gBAAgBX,EAAcV,EAAQsB,SAAUxT,IAAKgB,EAAOyS,QAAQhU,SAAA,EACnFJ,EAAAA,EAAAA,GAACyM,EAAAA,EAAY,CAACrI,MAAOiP,EAAYR,EAAQsB,YACzCnU,EAAAA,EAAAA,GAAA,QAAMW,IAAKgB,EAAO0S,QAAQjU,SAAEyS,EAAQwB,gBAI1ChZ,MA/Ca,QAgDbiZ,QAAQtU,EAAAA,EAAAA,GAACuU,EAAAA,EAAM,CAACC,KAAK,OAAQpU,UAE7BC,EAAAA,EAAAA,IAAA,OACEM,KAAGC,EAAAA,EAAAA,IAAE,CACHmD,QAAS,OACT0Q,UAAW,aAAa9R,EAAMuB,OAAOJ,SACrCxI,OAAQ,OACRiV,YAAa5N,EAAMgN,QAAQC,IAC5B,IAACxP,SAAA,EAGFC,EAAAA,EAAAA,IAAA,OACEM,KAAGC,EAAAA,EAAAA,IAAE,CACHmD,QAAS,OACT2Q,cAAe,SACfrZ,MAAO,QACPsZ,YAAa,aAAahS,EAAMuB,OAAOJ,SACvCxI,OAAQ,QACT,IAAC8E,SAAA,EAEFC,EAAAA,EAAAA,IAACgQ,EAAAA,EAAWC,KAAI,CACdlM,MAAM,YACNzD,KAAGC,EAAAA,EAAAA,IAAE,CACHsM,aAAcvK,EAAMgN,QAAQC,GAC5BF,UAAW/M,EAAMgN,QAAQC,GACzBgF,YAAajS,EAAMgN,QAAQC,IAC5B,IAACxP,SAAA,CAEDyS,EAAQgC,SAASpa,OAAQ,KAC1BuF,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,sBAInBxO,EAAAA,EAAAA,GAAA,OACEW,IAAGc,EAMHgN,QAAUlU,GAAMA,EAAEmU,kBAAkBtO,SAEnCyS,EAAQgC,SAASjG,KAAKU,IACrBtP,EAAAA,EAAAA,GAAA,OAEEW,KAAGC,EAAAA,EAAAA,IAAE,CACHmD,QAAS,OACT2Q,cAAe,SACfzQ,eAAgB,SAChBmJ,gBACEkC,EAAQA,QAAQ5N,OAAS2N,EAAgBC,QAAQ5N,MACjD4N,EAAQA,QAAQgD,SAAWjD,EAAgBC,QAAQgD,OAC/C3P,EAAMuB,OAAO4Q,oBACb,cACNL,UAAW,aAAa9R,EAAMuB,OAAOJ,SACrCiR,cAAepS,EAAMgN,QAAQC,GAC7BoF,WAAYrS,EAAMgN,QAAQC,GAC1BgF,YAAajS,EAAMgN,QAAQC,IAC5B,IAACxP,UAEFJ,EAAAA,EAAAA,GAACiD,EAAAA,EAAM,CACLV,YAAY,4HACZE,KAAK,OACL9B,IAAG6F,EAKHvE,QAASA,KACP2Q,EAA0B,CAAEvD,gBAAiBC,EAASuD,QAASA,IAC/DH,GAAU,EAAK,EACftS,UAEFJ,EAAAA,EAAAA,GAACiV,EAAAA,EAAgC,CAAC5F,gBAAiBC,EAAS4F,mBAAmB,OA7B5E,GAAG5F,EAAQA,QAAQ5N,QAAQ4N,EAAQA,QAAQgD,kBAoCxDjS,EAAAA,EAAAA,IAAA,OACEM,KAAGC,EAAAA,EAAAA,IAAE,CACHT,SAAU,SACVyU,YAAajS,EAAMgN,QAAQc,GAC3BuE,WAAYrS,EAAMgN,QAAQc,GAC1B1M,QAAS,OACT2Q,cAAe,SACfrZ,MAAO,QACR,IAAC+E,SAAA,EAGFC,EAAAA,EAAAA,IAAA,OACEM,KAAGC,EAAAA,EAAAA,IAAE,CACHmD,QAAS,OACTuE,IAAK3F,EAAMgN,QAAQC,IACpB,IAACxP,SAAA,EAEFC,EAAAA,EAAAA,IAAA,OAAKM,IAAGmO,EAAgB1O,SAAA,EACtBJ,EAAAA,EAAAA,GAACwP,EAAAA,IAAM,CACLtU,OACEmF,EAAAA,EAAAA,IAAA,OAAKM,IAAGoO,EAAkE3O,SAAA,EACxEJ,EAAAA,EAAAA,GAACmQ,EAAAA,IAAS,CAACxP,KAAGC,EAAAA,EAAAA,IAAE,CAAEmT,YAAapR,EAAMgN,QAAQqC,IAAI,OACjDhS,EAAAA,EAAAA,GAACmV,EAAAA,IAAa,CAACja,MAAOmU,EAAgBC,QAAQ5N,KAAKtB,UACjDJ,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWwD,MAAK,CAACuB,UAAQ,EAACtB,MAAO,EAAGnT,IAAGqO,EAAqC5O,SAC1EiP,EAAgBC,QAAQ5N,SAG5BoR,IACC9S,EAAAA,EAAAA,GAACqV,EAAAA,IAAG,CACF9S,YAAY,4HACZ5B,KAAGC,EAAAA,EAAAA,IAAE,CACH0U,cAAe,aACf/E,WAAY5N,EAAMgN,QAAQqC,GAC1B+B,YAAapR,EAAMgN,QAAQqC,IAC5B,IAAC5R,SAED0S,EAAW1I,cAMtBpK,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWwD,MAAK,CACfC,MAAO,EACP1P,MAAM,YACNzD,KAAGC,EAAAA,EAAAA,IAAE,CAAEsM,aAAcvK,EAAMgN,QAAQqC,GAAItC,UAAW/M,EAAMgN,QAAQqC,IAAI,IACpE9W,MAAOiY,EAAY/S,SAElBiP,EAAgBC,QAAQ8D,SAA+C,SAApC/D,EAAgBC,QAAQ8D,QAC1D/D,EAAgBC,QAAQ8D,QAAQ3Y,OAjLzB,GAkLL,GAAG4U,EAAgBC,QAAQ8D,QAAQmC,UAAU,EAlLxC,UAoLLlG,EAAgBC,QAAQ8D,SAG1BpT,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,+BAMvBxO,EAAAA,EAAAA,GAAC0Q,EAAyB,CAACrB,gBAAiBA,EAAiBsB,QAASoC,QAExE1S,EAAAA,EAAAA,IAAA,OAAKM,KAAGC,EAAAA,EAAAA,IAAE,CAAEqM,WAAY,EAAGlJ,QAAS,OAAQ2Q,cAAe,SAAUpM,IAAK3F,EAAMgN,QAAQqC,IAAI,IAAC5R,SAAA,EAC3FJ,EAAAA,EAAAA,GAACqS,EAA2B,CAAChD,gBAAiBA,KAC9CrP,EAAAA,EAAAA,GAACwR,EAA+B,CAACnC,gBAAiBA,KAClDrP,EAAAA,EAAAA,GAAC4R,EAA8B,CAACvC,gBAAiBA,QAGnDrP,EAAAA,EAAAA,GAACwV,EAAAA,EAAO,CAAC7U,KAAGC,EAAAA,EAAAA,IAAE,CAAE8O,UAAW/M,EAAMgN,QAAQC,GAAI1C,aAAcvK,EAAMgN,QAAQqC,IAAI,OAC7EhS,EAAAA,EAAAA,GAACoP,EAA2B,CAACC,gBAAiBA,aAIxC,EAMLoG,EAA8BxU,EAAAA,KAAWsR,GAEhD5Q,EAAS,CACbyS,QAAS,CACPjU,SAAU,SACV4D,QAAS,OACTuE,IAAK,EACLtE,WAAY,UAEdqQ,QAAS,CACPlU,SAAU,SACVuV,aAAc,WACdtF,SAAU,Q,2IC3QyD,IAAAvO,EAAA,CAAAH,KAAA,UAAAC,OAAA,mBAQhE,MAAMsT,EAAmCja,IAIhB,IAAD2a,EAAA,IAJkB,gBAC/CtG,EAAe,kBACf6F,EAAiB,UACjB7J,GACwBrQ,EACxB,MAAM,QAAEsU,EAAO,KAAEyD,GAAS1D,GACpB,MAAE1M,IAAUC,EAAAA,EAAAA,KAElB,OACEvC,EAAAA,EAAAA,IAAA,OACEM,KAAGC,EAAAA,EAAAA,IAAE,CACHmD,QAAS,OACT2Q,cAAe,MACf1Q,WAAY,SACZ0L,UAAW/M,EAAMgN,QAAQqC,GACzB9E,aAAcvK,EAAMgN,QAAQqC,IAC7B,IACD3G,UAAWA,EAAUjL,SAAA,EAErBJ,EAAAA,EAAAA,GAACmQ,EAAAA,IAAS,CAACxP,KAAGC,EAAAA,EAAAA,IAAE,CAAEmT,YAAapR,EAAMgN,QAAQqC,GAAI5N,MAAOzB,EAAMuB,OAAOI,eAAe,MACnF4Q,GACC7U,EAAAA,EAAAA,IAAA,OAAAD,SAAA,CACGkP,EAAQ5N,KAAK,KAAG4N,EAAQgD,OAAO,QAGlCjS,EAAAA,EAAAA,IAACgQ,EAAAA,EAAWC,KAAI,CAACkE,KAAK,KAAK7T,IAAGkB,EAAsBzB,SAAA,CACjDkP,EAAQ5N,KAAK,KAAG4N,EAAQgD,OAAO,QAGpCtS,EAAAA,EAAAA,GAACqV,EAAAA,IAAG,CACF9S,YAAY,gIACZ5B,KAAGC,EAAAA,EAAAA,IAAE,CACH0U,cAAe,aACf/E,WAAY5N,EAAMgN,QAAQqC,GAC1B+B,YAAapR,EAAMgN,QAAQqC,IAC5B,IAAC5R,SAED2S,IAAsE,QAAlE4C,EAAI5C,EAAKC,MAAKvR,IAAA,IAAC,IAAEgE,GAAKhE,EAAA,OAAKgE,IAAQyN,EAAAA,EAA8B,WAAC,IAAAyC,OAAA,EAA9DA,EAAgEvL,WAEvE,C,0IC9CsE,IAAAvI,EAAA,CAAAH,KAAA,UAAAC,OAAA,0CAEzE,MAAMiU,EAAqB3U,EAAAA,MAAWjG,IAAqD,IAAD6a,EAAA,IAAjDzL,MAAO2I,GAAqC/X,EAC1F,MAAM,MAAE2H,IAAUC,EAAAA,EAAAA,KAClB,IAAKmQ,EACH,OAAO/S,EAAAA,EAAAA,GAAAM,EAAAA,GAAA,CAAAF,SAAE,MAEX,MAAMgL,GAAsC,QAAzByK,EAAA9C,EAAK+C,EAAAA,EAAMC,sBAAc,IAAAF,OAAA,EAAzBA,EAA2BzL,QAAS,GAEjD4L,EAAaF,EAAAA,EAAMG,aAAalD,GAAQ,CAAC,OAAG5L,OAAWA,GAC7D,OAAO6O,GACL3V,EAAAA,EAAAA,IAAA,OAAKM,KAAGC,EAAAA,EAAAA,IAAE,CAAEmD,QAAS,OAAQuE,IAAK3F,EAAMgN,QAAQqC,GAAIhO,WAAY,UAAU,IAAC5D,SAAA,EACzEJ,EAAAA,EAAAA,GAACmL,EAAAA,EAAwB,CAACC,WAAYA,EAAYzK,KAAGC,EAAAA,EAAAA,IAAE,CAAEwD,MAAOzB,EAAMuB,OAAOI,eAAe,OAC5FtE,EAAAA,EAAAA,GAAA,QAAMW,IAAGkB,EAAmDzB,SAAE4V,QAGhEhW,EAAAA,EAAAA,GAAAM,EAAAA,GAAA,CAAAF,SAAE,KACH,G,sHClBH,MAAM8V,EAAkCjV,EAAAA,eAErCkV,GAAUA,IAGAC,EAAuCpb,IAAA,IAAC,SACnDoF,EAAQ,WACRiW,GAIDrb,EAAA,OACCgF,EAAAA,EAAAA,GAACkW,EAAgCI,SAAQ,CAAClM,MAAOiM,EAAWjW,SAAEA,GAAoD,EAGvGmW,EAAiCA,IAAMtV,EAAAA,WAAiBiV,E,8HCH9D,MAAMM,EAAmBA,KAC9B,MAAMC,GAASC,EAAAA,EAAAA,KACTC,GAAWC,EAAAA,EAAAA,MAEXC,GAA2B9J,EAAAA,EAAAA,UAAQ,IAAM+J,mBAAmBH,EAASI,SAAS,CAACJ,EAASI,SAKxFC,GAAiCjK,EAAAA,EAAAA,UAAQ,KAC7C,MAAMkK,EAAcC,IAAAA,MAASL,EAAyBtB,UAAU,IAChE,GAAI0B,EAAyB,YAAG,CAC9B,MAAME,EAAmBF,EAAyB,YAClD,OAAuB,OAAhBE,QAAgB,IAAhBA,OAAgB,EAAhBA,EAAkBC,aAAc,EACzC,CAEA,MAAO,EAAE,GACR,CAACP,IAEJ,OAAO9J,EAAAA,EAAAA,UAAQ,KAEb,GAAU,OAAN0J,QAAM,IAANA,GAAAA,EAAQlD,aACV,MAAO,CAAO,OAANkD,QAAM,IAANA,OAAM,EAANA,EAAQlD,cAIlB,GAAIyD,EACF,IACE,OAAO7V,KAAKC,MAAM4V,EACpB,CAAE,MAGA,OADAlB,EAAAA,EAAMuB,sBAAsB,8CAA8CL,KACnE,EACT,CAGF,MAAO,EAAE,GACR,CAACA,EAAsC,OAANP,QAAM,IAANA,OAAM,EAANA,EAAQlD,cAAc,C,gIC5CrD,MAAM+D,EAA6Btc,IAUnC,IAVoC,SACzCuc,EAAQ,iBACRC,EAAgB,mBAChBC,EAAkB,QAClBC,GAMD1c,EAGC,MAAM2c,GAAWC,EAAAA,EAAAA,MASXC,EAAqBN,EAASO,MAAM,EAAGC,EAAAA,IAAmC9O,KAAK,MACrFrB,EAAAA,EAAAA,YAAU,KAEH8P,IAAWD,GAGhBI,EAAmBG,MAAM,KAAKC,SAAS9D,IACjCA,GACFwD,GAASO,EAAAA,EAAAA,IAAc/D,GACzB,GACA,GACD,CAAC0D,EAAoBF,EAAUF,EAAoBC,IAEtD,MAAMS,GAAoBpT,EAAAA,EAAAA,aAA2BoC,GAC/CiR,GAAwBrT,EAAAA,EAAAA,QAAO0S,GAAsBC,GAC3DU,EAAsBpT,QAAUyS,EAEhC,MAAMY,EAA6Bb,EAAiBM,MAAM,EAAGC,EAAAA,IAAmC9O,KAAK,MAErGrB,EAAAA,EAAAA,YAAU,KACR,IAAI0Q,GAAgB,EAEpB,IAAKZ,IAAYD,EACf,OAGF,MAAMc,EAAgBC,UACpB,MAAMjB,EAAWM,EAAmBG,MAAM,KAEpCS,EAAiBJ,EAA2BL,MAAM,MAE/BU,EAAcnB,EAAS5J,QAAO,CAACG,EAAG6K,IAAoC,SAA1BF,EAAeE,KAAqBpB,GAExFU,SAAS9D,IACpBA,GACFwD,GAASO,EAAAA,EAAAA,IAAc/D,EAASuE,GAClC,GACA,EAGEE,EAAkBJ,UAEtB,GAAKJ,EAAsBpT,UAAWsT,EAAtC,CAGA,UACQC,GAAc,EACtB,CAAE,MAAOhe,GAEPub,EAAAA,EAAMuB,sBAAsB9c,EAC9B,CACAse,aAAaV,EAAkBnT,SAG1BoT,EAAsBpT,UAAWsT,IAItCH,EAAkBnT,QAAUwE,OAAOsP,WAAWF,EAAiBG,EAAAA,IAd/D,CAc2G,EAK7G,OAFAR,GAAc,GAAOS,KAAKJ,GAEnB,KACLL,GAAc,GAEdD,GAAgB,EAEhBO,aAAaV,EAAkBnT,QAAQ,CACxC,GACA,CAAC2S,EAAUE,EAAoBQ,EAA4BZ,EAAoBC,GAAS,C,0GC/EtF,MAAMuB,UAAqBC,EAAAA,UAChC9P,WAAAA,CAAYhO,GACV+d,MAAM/d,GAAO,KAKf+a,MAAQ,CACNiD,cAAc,GALd7P,KAAK8P,sBAAwB9P,KAAK8P,sBAAsBhf,KAAKkP,MAC7DA,KAAK+P,oBAAsB/P,KAAK+P,oBAAoBjf,KAAKkP,KAC3D,CAMA8P,qBAAAA,GACO9P,KAAK4M,MAAMiD,cACd7P,KAAKnO,MAAMme,SAEf,CAEAD,mBAAAA,GAEE,OADA/P,KAAKiQ,SAAS,CAAEJ,cAAc,IACvB7P,KAAKnO,MAAMqe,eAAeC,SAAQ,KACvCnQ,KAAKnO,MAAMme,UACXhQ,KAAKiQ,SAAS,CAAEJ,cAAc,GAAQ,GAE1C,CAEAO,MAAAA,GACE,OACE3Z,EAAAA,EAAAA,GAAC4Z,EAAAA,EAAK,CACJ,cAAY,gBACZ1e,MAAOqO,KAAKnO,MAAMF,MAClB2e,QAAStQ,KAAKnO,MAAMqX,OACpBqH,KAAMvQ,KAAK+P,oBACXS,OAAQxQ,KAAKnO,MAAM4e,kBACnBC,eAAgB1Q,KAAK4M,MAAMiD,aAC3Bc,SAAU3Q,KAAK8P,sBAEfc,UAAQ,EAAA/Z,UAERJ,EAAAA,EAAAA,GAAA,OAAKqL,UAAU,yBAAwBjL,SAAEmJ,KAAKnO,MAAMgf,YAG1D,E,sHCtCK,MAAMC,UAA2BnB,EAAAA,UACtC9P,WAAAA,CAAYhO,GACV+d,MAAM/d,GACNmO,KAAKkQ,aAAelQ,KAAKkQ,aAAapf,KAAKkP,KAC7C,CAEAkQ,YAAAA,GACE,MAAMa,EAAsB,GAI5B,OAHA/Q,KAAKnO,MAAMmf,eAAetC,SAASuC,IACjCF,EAAeG,KAAKlR,KAAKnO,MAAMsf,aAAaF,GAAO,IAE9CG,QAAQC,IAAIN,GAChBO,OAAM,KACL,MAAMC,EAAoB,GAAGvR,KAAKnO,MAAM2f,KAAKC,cAAc,CAAArf,GAAA,SACzD6S,eAAe,2DAGjBjF,KAAKnO,MAAM6f,eAAeH,EAAkB,IAE7C9B,MAAK,KAAO,IAADkC,EAAAC,EACU,QAApBD,GAAAC,EAAA5R,KAAKnO,OAAMggB,iBAAS,IAAAF,GAApBA,EAAArgB,KAAAsgB,EAAwB,GAE9B,CAEAxB,MAAAA,GACE,MAAM0B,EAAS9R,KAAKnO,MAAMmf,eAAe9f,OACzC,OACEuF,EAAAA,EAAAA,GAACiZ,EAAAA,EAAY,CACXxG,OAAQlJ,KAAKnO,MAAMqX,OACnB8G,QAAShQ,KAAKnO,MAAMme,QACpBE,aAAclQ,KAAKkQ,aACnBve,MAAO,qBAAqB4a,EAAAA,EAAMwF,UAAU,MAAOD,KACnDjB,UACE/Z,EAAAA,EAAAA,IAAA,OAAAD,SAAA,EACEJ,EAAAA,EAAAA,GAAA,KAAAI,UACEC,EAAAA,EAAAA,IAAA,KAAAD,SAAA,CACGib,EAAO,eAAavF,EAAAA,EAAMwF,UAAU,MAAOD,GAAQ,yBAUtD,MAINrB,kBAAkB,UAGxB,EAGF,MAAMuB,EAAqB,CACzBb,aAAY,KACZO,eACF,MAEA,KAAeO,EAAAA,EAAAA,IAAQ,KAAMD,EAA7B,EAAiDE,EAAAA,EAAAA,IAAWpB,G,qHCvDrD,MAAMqB,UAA0BxC,EAAAA,UAAwB9P,WAAAA,GAAA,SAAA5O,WAAA,KAC7D2b,MAAQ,CACNiD,cAAc,GACd,KAEFuC,QAAU1a,EAAAA,YAAkB,KAE5B2a,SAAWpD,UACTjP,KAAKiQ,SAAS,CAAEJ,cAAc,IAC9B,IACE,MAAMzH,QAAgBpI,KAAaoS,QAAQ3W,QAAQ6W,iBAInD,aAAatS,KAAKnO,MACfqe,aAAa9H,GACbqH,KAAKzP,KAAKuS,wBACVjB,MAAMtR,KAAKwS,qBACXrC,QAAQnQ,KAAK8P,sBAClB,CAAE,MAAO9e,GAEP,OADAgP,KAAKiQ,SAAS,CAAEJ,cAAc,IACvBuB,QAAQqB,OAAOzhB,EACxB,GACA,KAEFuhB,uBAAyB,KACvBvS,KAAKiQ,SAAS,CAAEJ,cAAc,IAC7B7P,KAAaoS,QAAQ3W,QAAQiX,aAAa,EAC3C,KAEFF,oBAAuBxhB,IACrBgP,KAAKiQ,SAAS,CAAEJ,cAAc,IAC9BtD,EAAAA,EAAMuB,sBAAsB9c,EAAE,EAC9B,KAEF8e,sBAAwB,KACjB9P,KAAK4M,MAAMiD,eACd7P,KAAKuS,yBACLvS,KAAKnO,MAAMme,UACb,EACA,KAEF2C,aAAe,KACb3S,KAAK8P,6BAEuBlS,IAAxBoC,KAAKnO,MAAM8e,UACb3Q,KAAKnO,MAAM8e,UACb,CACA,CAEFP,MAAAA,GACE,MAAM,aAAEP,GAAiB7P,KAAK4M,OACxB,OAAE4D,EAAM,WAAEoC,EAAU,OAAE1J,EAAM,OAAE6B,EAAM,SAAElU,GAAamJ,KAAKnO,MAGxDghB,EAAcnb,EAAAA,SAAe2N,IAAIxO,GAAWic,GAG5Cpb,EAAAA,eAAqBob,GAEhBpb,EAAAA,aAAmBob,EAAO,CAAEC,SAAU/S,KAAKoS,UAE7CU,IAGT,OACErc,EAAAA,EAAAA,GAAC4Z,EAAAA,EAAK,CACJ,cAAY,qBACZvO,UAAW9B,KAAKnO,MAAMiQ,UACtBnQ,MAAOqO,KAAKnO,MAAMF,MAElBG,MAAO,IACPwe,QAASpH,EACTqH,KAAMvQ,KAAKqS,SACX7B,OAAQA,EACRoC,WAAYA,EACZlC,eAAgBb,EAChBc,SAAU3Q,KAAK2S,aACf5H,OAAQA,EACR6F,UAAQ,EAAA/Z,SAEPgc,GAGP,E,4ICvGK,MAAMG,EAAiB,UAa9B,MAAMC,UAA4BtD,EAAAA,UAAiB9P,WAAAA,GAAA,SAAA5O,WAAA,KACjDiiB,sBAAgB,OAOhBC,kBAAqBD,IACnBlT,KAAKkT,iBAAmBA,EACxBA,GAAoBA,EAAiBE,QACrCF,GAAoBA,EAAiBG,QAAQ,EAC7C,KAEFC,UAAaC,KACe,IAAtBA,EAAUjD,UAA4C,IAAvBtQ,KAAKnO,MAAMye,UAE5CtQ,KAAKkT,kBAAoBlT,KAAKkT,iBAAiBE,QAE/CpT,KAAKkT,kBAAoBlT,KAAKkT,iBAAiBG,SACjD,EACA,KAEFX,YAAea,IACb,MAAMnB,EAAUpS,KAAKnO,MAAMkhB,SACvBQ,EAAUpb,OAAS6H,KAAKnO,MAAMsG,MAEhCia,EAAQ3W,QAAQiX,YAAY,CAACM,GAC/B,CACA,CA1BFQ,kBAAAA,CAAmBD,GACjBvT,KAAKsT,UAAUC,GACfvT,KAAK0S,YAAYa,EACnB,CAyBAnD,MAAAA,GACE,OAEE3Z,EAAAA,EAAAA,GAACgd,EAAAA,IAAU,CAACthB,IAAK6N,KAAKnO,MAAMkhB,SAAUW,OAAO,WAAU7c,UACrDJ,EAAAA,EAAAA,GAACgd,EAAAA,IAAWE,KAAI,CACdxb,KAAM6a,EACNY,aAAc5T,KAAKnO,MAAMsG,KACzB0b,MAAO,CACL,CAAEC,UAAU,EAAMC,QAAS,mCAAmC/T,KAAKnO,MAAMqH,SACzE,CAAE8a,UAAWhU,KAAKnO,MAAMmiB,YAE1BC,MAAO,OAAOjU,KAAKnO,MAAMqH,YAAYrC,UAErCJ,EAAAA,EAAAA,GAACyd,EAAAA,EAAK,CACJlb,YAAY,iFACZwN,YAAa,WAAWxG,KAAKnO,MAAMqH,YACnC/G,IAAK6N,KAAKmT,kBACV,cAAY,0BAKtB,EAGK,MAAMgB,EAAalB,C,iKCrDnB,MAAMmB,UAA2BzE,EAAAA,UAAiB9P,WAAAA,GAAA,SAAA5O,WAAA,KACvDojB,gBAAmBjM,IAEjB,MAAMkM,EAAalM,EAAO4K,EAAAA,GAEpBuB,GAAqBC,EAAAA,EAAAA,MAE3B,OAAOxU,KAAKnO,MACT4iB,aAAazU,KAAKnO,MAAM+Y,QAAS0J,EAAYC,GAC7C9E,MAAK,SAAAkC,EAAAC,EAAA,OAA0B,QAA1BD,GAAMC,EAAA5R,KAAKnO,OAAMggB,iBAAS,IAAAF,OAAA,EAApBA,EAAArgB,KAAAsgB,EAAwB,GAAC,CACvC,CAEFxB,MAAAA,GACE,MAAM,OAAElH,EAAM,QAAE4B,GAAY9K,KAAKnO,MACjC,OACE4E,EAAAA,EAAAA,GAAC0b,EAAAA,EAAiB,CAChBxgB,MAAOqO,KAAKnO,MAAM2f,KAAKC,cAAc,CAAArf,GAAA,SACnC6S,eAAe,eAGjBuL,OAAQxQ,KAAKnO,MAAM2f,KAAKC,cAAc,CAAArf,GAAA,SACpC6S,eAAe,SAGjBiE,OAAQA,EACRgH,aAAclQ,KAAKqU,gBACnBrE,QAAShQ,KAAKnO,MAAMme,QAAQnZ,UAE5BJ,EAAAA,EAAAA,GAAC0d,EAAAA,EAAU,CACTjb,KAAK,MACLf,KAAM2S,EAENwF,QAASpH,EACT8K,UAAW/E,MAAO1K,EAAG1D,KACnB,GAAqB,kBAAVA,GAAsBA,EAAM3P,SAAW2P,EAAM6T,OACtD,MAAM,IAAIC,MACR3U,KAAKnO,MAAM2f,KAAKC,cAAc,CAAArf,GAAA,SAC5B6S,eAAe,iDAKrB,OAAO,CAAI,KAKrB,EAGF,MAAM+M,EAAqB,CACzByC,aACF,MAEaG,GAAyB1C,EAAAA,EAAAA,IAAWkC,GACpCS,GAAiB5C,EAAAA,EAAAA,SAAQrU,EAAWoU,EAAnBC,CAAuC2C,E,+QCxE9D,MAAME,EAA2BrjB,IAOhC,IAPiC,MACvCE,EAAK,QACLojB,GAAU,EAAK,SACfle,GAIApF,EACA,MAAM,MAAE2H,IAAUC,EAAAA,EAAAA,KAClB,OACEvC,EAAAA,EAAAA,IAAA,OACEM,KAAGC,EAAAA,EAAAA,IAAE,CAAEsM,aAAcoR,EAAU3b,EAAMgN,QAAQC,GAAwB,EAAnBjN,EAAMgN,QAAQc,IAAQ,IACxE,cAAY,4CAA2CrQ,SAAA,EAEvDJ,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWwD,MAAK,CAACC,MAAO,EAAE1T,SAAElF,IAC5BkF,IACG,EAOGme,EAA8B1c,IAUpC,IAVqC,MAC1CuI,EAAK,SACLkD,EAAQ,cACRkR,EAAa,aACbC,GAMD5c,EACC,MAAM,cAAEmZ,IAAkB0D,EAAAA,EAAAA,KAEpBC,IAAuB,OAAZF,QAAY,IAAZA,GAAAA,EAAchkB,WAAwB,OAAb+jB,QAAa,IAAbA,GAAAA,EAAe/jB,QAEzD,OACE4F,EAAAA,EAAAA,IAACue,EAAAA,IAAY,CACXje,IAAKgB,EAAOkd,WACZzU,MACEuU,EACI3D,EAAc,CAAArf,GAAA,SAGZ6S,eAAe,uCAEjBpE,EAENvF,SAAU8Z,EACVrR,SAAUA,EACVwR,wBAAyB,CAAEC,YAAY,GAAO3e,SAAA,CAEhC,OAAboe,QAAa,IAAbA,GAAAA,EAAe/jB,QACduF,EAAAA,EAAAA,GAAC4e,EAAAA,IAAaI,SAAQ,CACpBxB,MAAOxC,EAAc,CAAArf,GAAA,SACnB6S,eAAe,YAEdpO,SAEFoe,EAAc5P,KAAKqQ,IAClBjf,EAAAA,EAAAA,GAAC4e,EAAAA,IAAaM,OAAM,CAElB9U,OAAO+U,EAAAA,EAAAA,IAAqB,SAAUF,GAAQ7e,SAE7C6e,IAHIE,EAAAA,EAAAA,IAAqB,SAAUF,QAOxC,KACS,OAAZR,QAAY,IAAZA,GAAAA,EAAchkB,QACbuF,EAAAA,EAAAA,GAAC4e,EAAAA,IAAaI,SAAQ,CACpBxB,MAAOxC,EAAc,CAAArf,GAAA,SACnB6S,eAAe,WAEdpO,SAEFqe,EAAa7P,KAAKwQ,IACjBpf,EAAAA,EAAAA,GAAC4e,EAAAA,IAAaM,OAAM,CAElB9U,OAAO+U,EAAAA,EAAAA,IAAqB,QAASC,GAAOhf,SAE3Cgf,IAHID,EAAAA,EAAAA,IAAqB,QAASC,QAOvC,OACS,EAINC,EAA4B5d,IAQlC,IARmC,SACxC6L,EAAQ,MACRlD,EAAK,QACLkV,GAKD7d,EACC,MAAM,cAAEuZ,IAAkB0D,EAAAA,EAAAA,KAG1B,OAAIa,EAAAA,EAAAA,MACK,MAGPvf,EAAAA,EAAAA,GAACqe,EAAwB,CACvBnjB,MAAO8f,EAAc,CAAArf,GAAA,SACnB6S,eAAe,0BAEdpO,UAEHJ,EAAAA,EAAAA,GAAC4e,EAAAA,IAAY,CAASje,IAAKgB,EAAOkd,WAAYzU,MAAOA,EAAOkD,SAAUA,EAASlN,SAC5Ekf,EAAQ1Q,KAAK4Q,IACZ,MAAMC,EAAqC,kBAAhBD,EAA2BA,EAAcA,EAAYpV,MAC1EoT,EAA+B,kBAAhBgC,EAA2BA,EAAcA,EAAYhC,MAC1E,OACExd,EAAAA,EAAAA,GAAC4e,EAAAA,IAAaM,OAAM,CAAmB9U,MAAOqV,EAAYrf,SACvDod,GADuBiC,EAEJ,OAIH,EAIlBC,EAAgF,CAE3F,CACEtV,MAAO,EACPoT,OACExd,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,OAKrB,CACEpE,MAAO,GACPoT,OACExd,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,QAKrB,CACEpE,MAAO,GACPoT,OACExd,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,SAOjB7M,EAAS,CAAEkd,WAAY,CAAExjB,MAAO,SC9JzBskB,EAA8B3kB,IAQpC,IARqC,MAC1Cmb,EAAK,cACLyJ,EAAa,cACbpB,GAKDxjB,EAIC,MAAM6kB,GAAeC,EAAAA,EAAAA,cAClBC,IACCH,GAAe5a,IAAO,IAAYA,EAAqC+a,eAAa,GAEtF,CAACH,IAMGI,GAAwBF,EAAAA,EAAAA,cAC3BG,IACCL,GAAe5a,IAAO,IAChBA,EACJib,wBACC,GAEL,CAACL,KAOHhY,EAAAA,EAAAA,YAAU,MACHuO,EAAM4J,WAA0B,OAAbvB,QAAa,IAAbA,GAAAA,EAAgB,IACtCqB,EAAarB,EAAc,GAC7B,GACC,CAACrI,EAAM4J,UAAWF,EAAcrB,IAEnC,MAAM0B,EAA4C,IAAzB1B,EAAc/jB,OAEvC,OACE4F,EAAAA,EAAAA,IAAAC,EAAAA,GAAA,CAAAF,SAAA,EACEJ,EAAAA,EAAAA,GAACqe,EAAwB,CAACnjB,MAAM,SAAQkF,UACtCJ,EAAAA,EAAAA,GAAC4e,EAAAA,IAAY,CACXje,IAAKgB,EAAOkd,WACZzU,MAAO8V,EAAmB,uBAAyB/J,EAAM4J,UACzDzS,SAAUuS,EACVhb,SAAUqb,EACVpB,wBAAyB,CAAEC,YAAY,GAAO3e,SAE7Coe,EAAc5P,KAAKqQ,IAClBjf,EAAAA,EAAAA,GAAC4e,EAAAA,IAAaM,OAAM,CAAc9U,MAAO6U,EAAQ,cAAa,UAAUA,IAAS7e,SAC9E6e,GADuBA,UAMhCjf,EAAAA,EAAAA,GAACqf,EAAyB,CACxBjV,MAAO+L,EAAM8J,mBACb3S,SAAU0S,EACVV,QAASI,MAEV,EAID/d,EAAS,CAAEkd,WAAY,CAAExjB,MAAO,SC1EzB8kB,EAAmCnlB,IAUzC,IAV0C,MAC/Cmb,EAAK,cACLyJ,EAAa,cACbpB,EAAa,aACbC,GAMDzjB,EAKC,MAAMolB,GAAuBN,EAAAA,EAAAA,cAC1BO,IACCT,GAAe5a,IAAO,IAChBA,EACJqb,oBACC,GAEL,CAACT,IAGGU,GAAwBR,EAAAA,EAAAA,cAC3BS,IACCX,GAAe5a,IAAO,IAChBA,EACJub,qBACC,GAEL,CAACX,IAGGM,EAA4C,IAAzB1B,EAAc/jB,OACjC+lB,EAA0C,IAAxB/B,EAAahkB,OAErC,OACE4F,EAAAA,EAAAA,IAAAC,EAAAA,GAAA,CAAAF,SAAA,EACEJ,EAAAA,EAAAA,GAACqe,EAAwB,CAACnjB,MAAM,SAAQkF,UACtCJ,EAAAA,EAAAA,GAAC4e,EAAAA,IAAY,CACX6B,KAAMD,OAAkBrZ,EAAY,WACpCmG,SAAU8S,EACVlhB,MAAO,CACL7D,MAAO,KAET+O,MAAOoW,EAAmB,0BAAoCrK,EAAMkK,eACpExb,SAAU2b,EAAgBpgB,SAEzBqe,EAAa7P,KAAKwQ,IACjBpf,EAAAA,EAAAA,GAAC4e,EAAAA,IAAaM,OAAM,CAAC9U,MAAOgV,EAAMhf,SAC/Bgf,GADqCA,UAM9Cpf,EAAAA,EAAAA,GAACqe,EAAwB,CAACnjB,MAAM,UAASkF,UACvCJ,EAAAA,EAAAA,GAAC4e,EAAAA,IAAY,CACX6B,KAAMP,OAAmB/Y,EAAY,WACrCmG,SAAUgT,EACVphB,MAAO,CACL7D,MAAO,KAET+O,MAAO8V,EAAoB,uBAAiC/J,EAAMoK,gBAClE1b,SAAUqb,EAAiB9f,SAE1Boe,EAAc5P,KAAKqQ,IAClBjf,EAAAA,EAAAA,GAAC4e,EAAAA,IAAaM,OAAM,CAAC9U,MAAO6U,EAAO7e,SAChC6e,GADsCA,WAM9C,E,0DClCL,IAAAzY,EAAA,CAAA9E,KAAA,UAAAC,OAAA,cAEF,MAAM+e,EAAyBjf,IAQxB,IARyB,cAC9B+c,EAAa,mBACbmC,EAAkB,sBAClBL,GAKD7e,EACC,MAAMye,EAA4C,IAAzB1B,EAAc/jB,OAEvC,OACEuF,EAAAA,EAAAA,GAAC4e,EAAAA,IAAY,CACX6B,KAAK,WACL1Q,YACEmQ,GACElgB,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,0BAIjBxO,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,mBAKrB7N,IAAG6F,EACH4D,MAAO8V,EAAmB,GAAKS,EAC/BrT,SAAUgT,EACVzb,SAAUqb,EACVpB,wBAAyB,CAAEC,YAAY,GAAO3e,SAE7Coe,EAAc5P,KAAKqQ,IAClBjf,EAAAA,EAAAA,GAAC4e,EAAAA,IAAaM,OAAM,CAAc9U,MAAO6U,EAAQ,cAAa,UAAUA,IAAS7e,SAC9E6e,GADuBA,MAIf,EAIb2B,EAAkB9R,IAYjB,IAZkB,gBACvB+R,EAAe,MACflI,EAAK,sBACLmI,EAAqB,sBACrBC,EAAqB,cACrBvC,GAOD1P,EACC,MAAM,MAAEnM,IAAUC,EAAAA,EAAAA,MACZ,kBAAEoe,IAAsBC,EAAAA,EAAAA,MACvBC,EAAmBC,IAAwBta,EAAAA,EAAAA,WAAS,GAY3D,OACExG,EAAAA,EAAAA,IAAA,QAAMM,KAAGC,EAAAA,EAAAA,IAAE,CAAEmD,QAAS,OAAQ1I,MAAO,OAAQiN,IAAK3F,EAAMgN,QAAQC,IAAI,IAACxP,SAAA,EACnEJ,EAAAA,EAAAA,GAACyd,EAAAA,EAAK,CACJlb,YAAY,kIACZ6H,MAAOyW,EAAgBO,WACvB9T,SAAW/S,GAhBU6mB,KACzB,MAAMC,EAAqBL,EAAkBI,EAAY5C,QAC9BrX,IAAvBka,GACFF,GAAqB,GACrBL,EAAsB,CAAEQ,IAAK,GAAIC,UAAW,GAAIH,cAAczI,KAE9DwI,GAAqB,GACrBL,EAAsBO,EAAoB1I,GAC5C,EAQqB6I,CAAkBjnB,EAAEuQ,OAAOV,OAC5CqX,gBAAiBP,OAAoB/Z,EAAY,WAEnDnH,EAAAA,EAAAA,GAACiD,EAAAA,EAAM,CACLV,YAAY,8CACZL,MAAMlC,EAAAA,EAAAA,GAAC0hB,EAAAA,EAAS,IAChBzf,QAASA,IAAM8e,EAAsBpI,OAElC,EAIEgJ,EAA6C5S,IAUnD,IAVoD,MACzDoH,EAAK,cACLyJ,EAAa,cACbpB,EAAa,sBACb8B,GAMDvR,EACC,MAAM,MAAEpM,IAAUC,EAAAA,EAAAA,KACZgf,GACJC,EAAAA,EAAAA,OAAkC1L,EAAM2L,WAAaC,EAAAA,GAA6BC,QAI7EC,EAA2BC,IAAgCrb,EAAAA,EAAAA,UAChEsP,EAAMgM,kBAAoB,IAGtBC,EAAiCA,CAAChB,EAA2CzI,KACjFuJ,GAA8Bld,IAC5B,MAAMqd,EAAiB,IAAIrd,GAE3B,OADAqd,EAAe1J,GAASyI,EACjBiB,CAAc,GACrB,EASEC,EAAkC3J,IACtCuJ,GAA8Bld,IAC5B,MAAMqd,EAAiB,IAAIrd,GAE3B,OADAqd,EAAeE,OAAO5J,EAAO,GACtB0J,CAAc,GACrB,GAGJza,EAAAA,EAAAA,YAAU,KACR,MASM4a,EAAU1J,YAAW,KATIqJ,QAUPF,EATtBrC,GAAe5a,IAEN,IADQA,EAGbmd,sBAK4C,GAvC7B,KA0CrB,MAAO,KACLtJ,aAAa2J,EAAQ,CACtB,GACA,CAACP,EAA2BrC,IAE/B,MAAM6C,GAAiB3C,EAAAA,EAAAA,cACpB4C,IACC9C,GAAe5a,IACb,MAAM2d,EAAS3d,EACf,MAAO,IACF2d,EACHD,WACAE,MAAO,IACFD,EAAOC,MACVC,UAAM1b,EACN2b,UAAM3b,GAET,GACD,GAEJ,CAACyY,IAGH,OACEvf,EAAAA,EAAAA,IAAAC,EAAAA,GAAA,CAAAF,SAAA,CACGwhB,IACC5hB,EAAAA,EAAAA,GAACqe,EAAwB,CAACnjB,MAAM,cAAcojB,SAAO,EAAAle,UACnDC,EAAAA,EAAAA,IAAC0iB,EAAAA,IAAMC,MAAK,CACVzgB,YAAY,kIACZb,KAAK,6CACL0I,MAAO+L,EAAMuM,UAAYO,EAAAA,GAA6BjB,OACtD1U,SAAU0B,IAAA,IAAGlE,QAAQ,MAAEV,IAAS4E,EAAA,OAAKyT,EAAerY,EAAM,EAAChK,SAAA,EAE3DJ,EAAAA,EAAAA,GAAC+iB,EAAAA,IAAK,CAAC3Y,MAAO6Y,EAAAA,GAA6BjB,OAAO5hB,UAChDJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,oBAFqCyU,EAAAA,GAA6BjB,SAMrFhiB,EAAAA,EAAAA,GAAC+iB,EAAAA,IAAK,CAAC3Y,MAAO6Y,EAAAA,GAA6BC,WAAW9iB,UACpDJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,uBAFyCyU,EAAAA,GAA6BC,iBAS9FtB,GAAyBzL,EAAMuM,WAAaO,EAAAA,GAA6BC,YACxEljB,EAAAA,EAAAA,GAACqe,EAAwB,CAACnjB,MAAM,aAAaojB,SAAO,EAAAle,UAClDC,EAAAA,EAAAA,IAAA,OAAKM,KAAGC,EAAAA,EAAAA,IAAE,CAAEmD,QAAS,OAAQ2Q,cAAe,SAAU1Q,WAAY,aAAcsE,IAAK3F,EAAMgN,QAAQC,IAAI,IAACxP,SAAA,CACrG6hB,EAA0BrT,KAAI,CAACiS,EAAiBlI,KAE7C3Y,EAAAA,EAAAA,GAAC4gB,EAAe,CAEdC,gBAAiBA,EACjBlI,MAAOA,EACPmI,sBAAuBsB,EACvBrB,sBAAuBuB,EACvB9D,cAAeA,GALV7F,MASX3Y,EAAAA,EAAAA,GAACiD,EAAAA,EAAM,CACLV,YAAY,+CACZL,MAAMlC,EAAAA,EAAAA,GAACmjB,EAAAA,IAAQ,IACflhB,QA9F2BmhB,KACrClB,GAA8Bld,GACrB,IAAIA,EAAS,CAAEsc,IAAK,GAAIC,UAAW,GAAIH,WAAY,MAC1D,EA2FgDhhB,SACzC,kBAMLJ,EAAAA,EAAAA,GAACqe,EAAwB,CAACnjB,MAAM,SAASojB,SAAO,EAAAle,SAC7CsgB,EAAuB,CACtBlC,gBACAmC,mBAAoBxK,EAAMwK,mBAC1BL,8BAIL,ECrOP,MAAM+C,EAAyB,UAEzBC,EAA4BtoB,IAY3B,IAZ4B,MACjC2H,EAAK,cACL6b,EAAa,uBACb+E,EAAsB,6BACtBC,EAA4B,SAC5B3e,GAAW,GAOZ7J,EACC,MAAMklB,EAA4C,IAAzB1B,EAAc/jB,OAEvC,OACE4F,EAAAA,EAAAA,IAAC0iB,EAAAA,IAAK,CAAC3Y,MAAO2X,EAAAA,GAA6BC,OAAQnd,SAAUA,EAASzE,SAAA,EACpEJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,YAGjBxO,EAAAA,EAAAA,GAAC4e,EAAAA,IAAY,CACXje,KAAGC,EAAAA,EAAAA,IAAE,CACH8O,UAAW/M,EAAMgN,QAAQqC,GACzB3W,MAAO,QACR,IACD+O,MAAOmZ,QAA0Bpc,EACjC4I,YACEmQ,GACElgB,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,0BAIjBxO,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,kBAKrBvM,QAAU1H,IAGRA,EAAEkpB,iBACFlpB,EAAEmU,iBAAiB,EAErBpB,SAAUkW,EACV3e,SAAUqb,GAAoBrb,EAC9Bia,wBAAyB,CAAEC,YAAY,GAAO3e,SAE7Coe,EAAc5P,KAAKqQ,IAClBjf,EAAAA,EAAAA,GAAC4e,EAAAA,IAAaM,OAAM,CAAc9U,MAAO6U,EAAQ,cAAa,UAAUA,IAAS7e,SAC9E6e,GADuBA,SAKxB,EAINyE,EAAW3nB,IACX4nB,EAAAA,EAAAA,aAAY5nB,GACPA,EAELA,GAAK,OAAT,EAGO6nB,KAAKC,MAAM9nB,GAGd+nB,EAAW/nB,IACX4nB,EAAAA,EAAAA,aAAY5nB,GACPA,EAEF6nB,KAAKG,IAAI,GAAIhoB,GAGtB,IAAA+S,EAAA,CAAApN,KAAA,SAAAC,OAAA,iEAGO,MAAMqiB,EAA+BniB,IAQrC,IAADoiB,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,IARuC,MAC3CrO,EAAK,cACLyJ,EAAa,cACbpB,GAKD3c,EACC,MAAM+f,GAAwBC,EAAAA,EAAAA,MACxB4C,GAA6BC,EAAAA,EAAAA,MAC7BC,GAA2BC,EAAAA,EAAAA,OAC3B,MAAEjiB,IAAUC,EAAAA,EAAAA,KACZmY,GAAO2D,EAAAA,EAAAA,MAGNmG,EAAgBC,IAAqBje,EAAAA,EAAAA,UAAqB,CAC/Dke,KAA+B,QAAzB5O,EAAM6O,eAA2BlB,EAAmB,QAAZG,EAAC9N,EAAMyM,aAAK,IAAAqB,OAAA,EAAXA,EAAac,MAAmB,QAAdb,EAAG/N,EAAMyM,aAAK,IAAAsB,OAAA,EAAXA,EAAaa,KACjFE,KAA+B,QAAzB9O,EAAM6O,eAA2BlB,EAAmB,QAAZK,EAAChO,EAAMyM,aAAK,IAAAuB,OAAA,EAAXA,EAAac,MAAmB,QAAdb,EAAGjO,EAAMyM,aAAK,IAAAwB,OAAA,EAAXA,EAAaa,KACjFpC,KAA0B,QAApB1M,EAAM+O,UAAsBpB,EAAmB,QAAZO,EAAClO,EAAMyM,aAAK,IAAAyB,OAAA,EAAXA,EAAaxB,MAAmB,QAAdyB,EAAGnO,EAAMyM,aAAK,IAAA0B,OAAA,EAAXA,EAAazB,KAC5EC,KAA0B,QAApB3M,EAAM+O,UAAsBpB,EAAmB,QAAZS,EAACpO,EAAMyM,aAAK,IAAA2B,OAAA,EAAXA,EAAazB,MAAmB,QAAd0B,EAAGrO,EAAMyM,aAAK,IAAA4B,OAAA,EAAXA,EAAa1B,OAMxEjD,GAAeC,EAAAA,EAAAA,cAClBC,IACCH,GAAe5a,IAAO,IAAYA,EAAsC+a,eAAa,GAEvF,CAACH,IAGGU,GAAwBR,EAAAA,EAAAA,cAC3BqF,IACCvF,GAAe5a,IAAO,IAChBA,EACJ+a,UAAWoF,EAAW,GACtBxE,mBAAoBwE,KACnB,GAEL,CAACvF,IAGGwF,GAAiBtF,EAAAA,EAAAA,cACrB,SAACgC,GAAuE,IAAvBuD,EAAS7qB,UAAAC,OAAA,QAAA0M,IAAA3M,UAAA,IAAAA,UAAA,GACxDolB,GAAe5a,IACb,MAAM2d,EAAS3d,EACf,MAAO,IACF2d,EACHb,WACAyB,uBAAwB,GACxBX,MAAO,IACFD,EAAOC,MACVmC,UAAM5d,EACN8d,UAAM9d,GAERme,kBAA4B,OAATD,QAAS,IAATA,EAAAA,EAAa1C,EAAO2C,kBACvCC,uBAAwBtC,EAAAA,GAA6BjB,OACtD,GAEL,GACA,CAACpC,IAGG4F,EAAqBpb,KAA+BuZ,EAAAA,EAAAA,aAAYvZ,IAAUA,GAAS,EAEnFqb,GAAuB3F,EAAAA,EAAAA,cAC1B4F,IAEG9F,EADE+E,EACa3f,IACb,MAAM2d,EAAS3d,EAEf,IAAI2gB,EAAUD,EAAYhC,EAAQmB,EAAeE,MAAQF,EAAeE,KACpEa,EAAUF,EAAYhC,EAAQmB,EAAeI,MAAQJ,EAAeI,KAiBxE,OAhBIS,GAAaF,EAAkBX,EAAeE,OAASF,EAAeI,MAAQJ,EAAeI,KAAO,GAEtGH,GAAmBe,IAAI,IAClBA,EACHd,KAAM,MAERY,EAAU,GACDD,IAAcF,EAAkBX,EAAeE,OAASS,EAAkBX,EAAeI,SAClGH,GAAmBe,IAAI,IAClBA,EACHd,UAAM5d,EACN8d,UAAM9d,MAERwe,OAAUxe,EACVye,OAAUze,GAEL,IACFwb,EACHqC,eAAgBU,EAAY,MAAQ,SACpC9C,MAAO,IACFD,EAAOC,MACVmC,KAAMY,EACNV,KAAMW,GAET,EAGY5gB,IAAO,IAChBA,EACJggB,eAAgBU,EAAY,MAAQ,WAExC,GAEF,CAAC9F,EAAeiF,EAAeE,KAAMF,EAAeI,KAAMN,IAGtDnB,GAA+B1D,EAAAA,EAAAA,cAClCyD,IACC3D,GAAe5a,IAAO,IAChBA,EACJue,yBACAzB,SAAUC,EAAAA,GAA6BC,UACtC,GAEL,CAACpC,IAGGkG,GAAkBhG,EAAAA,EAAAA,cACrB4F,IAEG9F,EADE+E,EACa3f,IACb,MAAM2d,EAAS3d,EAEf,IAAI+gB,EAAUL,EAAYhC,EAAQmB,EAAehC,MAAQgC,EAAehC,KACpEmD,EAAUN,EAAYhC,EAAQmB,EAAe/B,MAAQ+B,EAAe/B,KAiBxE,OAhBI4C,GAAaF,EAAkBX,EAAehC,OAASgC,EAAe/B,MAAQ+B,EAAe/B,KAAO,GAEtGgC,GAAmBe,IAAI,IAClBA,EACHhD,KAAM,MAERkD,EAAU,GACDL,IAAcF,EAAkBX,EAAehC,OAAS2C,EAAkBX,EAAe/B,SAClGgC,GAAmBe,IAAI,IAClBA,EACHhD,UAAM1b,EACN2b,UAAM3b,MAER4e,OAAU5e,EACV6e,OAAU7e,GAEL,IACFwb,EACHuC,UAAWQ,EAAY,MAAQ,SAC/B9C,MAAO,IACFD,EAAOC,MACVC,KAAMkD,EACNjD,KAAMkD,GAET,EAGYhhB,IAAO,IAChBA,EACJkgB,UAAWQ,EAAY,MAAQ,WAEnC,GAEF,CAAC9F,EAAeiF,EAAehC,KAAMgC,EAAe/B,KAAM6B,IAGtDsB,GAAuBnG,EAAAA,EAAAA,cAC1BoG,IACCtG,GAAe5a,IAAO,IAChBA,EACJkhB,oBACC,GAEL,CAACtG,IAGGuG,GAAkBrG,EAAAA,EAAAA,cACrBsG,IACCxG,GAAe5a,IAAO,IAChBA,EACJohB,eAAgBA,KACf,GAEL,CAACxG,IAMGI,GAAwBF,EAAAA,EAAAA,cAC3BG,IACCL,GAAe5a,IAAO,IAChBA,EACJib,wBACC,GAEL,CAACL,KAOHhY,EAAAA,EAAAA,YAAU,MACHuO,EAAM4J,WAA0B,OAAbvB,QAAa,IAAbA,GAAAA,EAAgB,IACtCqB,EAAarB,EAAc,GAC7B,GACC,CAACrI,EAAM4J,UAAWF,EAAcrB,KAInC5W,EAAAA,EAAAA,YAAU,MACJ+b,EAAAA,EAAAA,aAAYxN,EAAMwK,uBAAwBgD,EAAAA,EAAAA,aAAYxN,EAAM4J,YAAkC,KAApB5J,EAAM4J,WAClFO,EAAsB,CAACnK,EAAM4J,WAC/B,GACC,CAAC5J,EAAMwK,mBAAoBxK,EAAM4J,UAAWO,IAE/C,MAAM+F,EAA2BA,CAACtB,EAA0BE,KACtDqB,GAAkBvB,EAAME,IAG5BrF,GAAe5a,IACb,MAAM2d,EAAS3d,EACf,MAAO,IACF2d,EACHC,MAAO,IACFD,EAAOC,MACVmC,KAAgC,QAA1BpC,EAAOqC,eAA2BtB,EAAQqB,GAAQA,EACxDE,KAAgC,QAA1BtC,EAAOqC,eAA2BtB,EAAQuB,GAAQA,GAE3D,GACD,EAGEsB,EAA2BA,CAAC1D,EAA0BC,KACtDwD,GAAkBzD,EAAMC,IAG5BlD,GAAe5a,IACb,MAAM2d,EAAS3d,EACf,MAAO,IACF2d,EACHC,MAAO,IACFD,EAAOC,MACVC,KAA2B,QAArBF,EAAOuC,UAAsBxB,EAAQb,GAAQA,EACnDC,KAA2B,QAArBH,EAAOuC,UAAsBxB,EAAQZ,GAAQA,GAEtD,GACD,EAwBEwD,GAAoBA,CAACE,EAAuBC,OAC5C9C,EAAAA,EAAAA,aAAY6C,MAAM7C,EAAAA,EAAAA,aAAY8C,SAEtB9C,EAAAA,EAAAA,aAAY6C,MAAO7C,EAAAA,EAAAA,aAAY8C,IAOvCC,GAAiBA,CAACxB,EAAyC9a,IAC7C,QAAd8a,GAAuBM,EAAkBpb,IAEzCpK,EAAAA,EAAAA,GAAC2mB,EAAAA,IAAOC,QAAO,CACbtJ,SACEtd,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,sBAInB/L,KAAK,YAIJ,KAGHokB,GAAqB,UAC3B,OACExmB,EAAAA,EAAAA,IAAAC,EAAAA,GAAA,CAAAF,SAAA,EACEJ,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWwD,MAAK,CAACC,MAAO,EAAG1P,MAAM,YAAWhE,SAAC,YAG9CJ,EAAAA,EAAAA,GAACqe,EAAwB,CAACnjB,MAAM,OAAOojB,SAAO,EAAAle,SAC3CwhB,GACCvhB,EAAAA,EAAAA,IAACymB,EAAAA,IAAY,CACXvkB,YAAY,2HACZ5G,GAAG,cACHN,MAAM,OACN+O,MAAO+L,EAAMmP,kBAAoBjC,EAAyBlN,EAAM2L,SAChEiF,aAAc,CAAEC,mBAAmB,EAAMC,iBAAkB,YAC3D3Z,SAAU7L,IAA4B,IAAzBqJ,QAAQ,MAAEV,IAAS3I,EAC1B2I,EAAM8c,WAAWL,IACnBrD,EAA6BpZ,EAAM0N,MAAM+O,IAChCzc,IAAU2X,EAAAA,GAA6BoF,KAChD/B,EAAerD,EAAAA,GAA6BoF,MACnC/c,IAAU2X,EAAAA,GAA6BqF,KAChDhC,EAAerD,EAAAA,GAA6BqF,MACnChd,IAAU2X,EAAAA,GAA6BsF,cAChDjC,EAAerD,EAAAA,GAA6BsF,eACnCjd,IAAUiZ,GACnB+B,EAAerD,EAAAA,GAA6BoF,MAAM,EACpD,EACA/mB,SAAA,EAEDknB,EAAAA,EAAAA,QACCtnB,EAAAA,EAAAA,GAACunB,EAAAA,IAAkB,CAACnd,MAAOiZ,EAAuBjjB,UAChDJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,8BAKrBxO,EAAAA,EAAAA,GAACunB,EAAAA,IAAkB,CAACnd,MAAO2X,EAAAA,GAA6BoF,KAAK/mB,UAC3DJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,YAInBnO,EAAAA,EAAAA,IAACknB,EAAAA,IAAkB,CAACnd,MAAO2X,EAAAA,GAA6BqF,KAAKhnB,SAAA,EAC3DJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,iBAGjBxO,EAAAA,EAAAA,GAACwnB,EAAAA,EAAO,CACNjlB,YAAY,2HACZklB,SACEznB,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,2BAInBkZ,KAAK,QAAOtnB,UAEZC,EAAAA,EAAAA,IAAA,QAAAD,SAAA,CACG,KACDJ,EAAAA,EAAAA,GAAC2nB,EAAAA,IAAgB,CAAChnB,IAAKgB,EAAOimB,oCAIpCvnB,EAAAA,EAAAA,IAACknB,EAAAA,IAAkB,CAACnd,MAAO2X,EAAAA,GAA6BsF,cAAcjnB,SAAA,EACpEJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,qBAGjBxO,EAAAA,EAAAA,GAACwnB,EAAAA,EAAO,CACNjlB,YAAY,2HACZklB,SACEznB,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,2EAInBkZ,KAAK,QAAOtnB,UAEZC,EAAAA,EAAAA,IAAA,QAAAD,SAAA,CACG,KACDJ,EAAAA,EAAAA,GAAC2nB,EAAAA,IAAgB,CAAChnB,IAAKgB,EAAOimB,mCAInCnD,GAA8BjG,EAAc/jB,OAAS,IACpDuF,EAAAA,EAAAA,GAAC6nB,EAAAA,IAAuB,CAACrK,MAAM,UAASpd,SACrCoe,EAAc5P,KAAKqQ,IAClBjf,EAAAA,EAAAA,GAACunB,EAAAA,IAAkB,CAEjBnd,MAAO,GAAGyc,KAAqB5H,IAC/B,cAAa,GAAG4H,KAAqB5H,IAAS7e,SAE7C6e,GAJIA,WAWf5e,EAAAA,EAAAA,IAAC0iB,EAAAA,IAAMC,MAAK,CACVzgB,YAAY,2HACZb,KAAK,iCACL0I,MAAO+L,EAAMmP,kBAAoBjC,EAAyBlN,EAAM2L,SAChExU,SAAU9G,IAA4B,IAAzBsE,QAAQ,MAAEV,IAAS5D,EAC1B4D,IAAUiZ,EACZ+B,EAAerD,EAAAA,GAA6BoF,MAAM,GAElD/B,EAAehb,EACjB,EACAhK,SAAA,EAEDknB,EAAAA,EAAAA,QACCtnB,EAAAA,EAAAA,GAAC+iB,EAAAA,IAAK,CAAC3Y,MAAOiZ,EAAuBjjB,UACnCJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,8BAKrBxO,EAAAA,EAAAA,GAAC+iB,EAAAA,IAAK,CAAC3Y,MAAO2X,EAAAA,GAA6BoF,KAAK/mB,UAC9CJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,YAInBnO,EAAAA,EAAAA,IAAC0iB,EAAAA,IAAK,CAAC3Y,MAAO2X,EAAAA,GAA6BqF,KAAKhnB,SAAA,EAC9CJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,iBAGjBnO,EAAAA,EAAAA,IAAC8U,EAAAA,IAAa,CACZja,OACE8E,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,2BAInBsZ,UAAU,QAAO1nB,SAAA,CAEhB,KACDJ,EAAAA,EAAAA,GAAC2nB,EAAAA,IAAgB,CAAChnB,IAAKgB,EAAOimB,kCAGlCvnB,EAAAA,EAAAA,IAAC0iB,EAAAA,IAAK,CAAC3Y,MAAO2X,EAAAA,GAA6BsF,cAAcjnB,SAAA,EACvDJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,qBAGjBnO,EAAAA,EAAAA,IAAC8U,EAAAA,IAAa,CACZja,OACE8E,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,2EAInBsZ,UAAU,QAAO1nB,SAAA,CAEhB,KACDJ,EAAAA,EAAAA,GAAC2nB,EAAAA,IAAgB,CAAChnB,IAAKgB,EAAOimB,iCAGjCnD,GACCnB,EAA0B,CACxB3gB,QACA6b,gBACA+E,uBAAwBpN,EAAMoN,uBAC9BC,sCAKTrN,EAAM2L,WAAaC,EAAAA,GAA6BoF,OAC/CnnB,EAAAA,EAAAA,GAAAM,EAAAA,GAAA,CAAAF,SACGukB,IACCtkB,EAAAA,EAAAA,IAACge,EAAwB,CAACnjB,MAAM,eAAeojB,SAAO,EAAAle,SAAA,EACpDC,EAAAA,EAAAA,IAAA,OAAKM,KAAGC,EAAAA,EAAAA,IAAE,CAAEmD,QAAS,OAAQuE,IAAK3F,EAAMgN,QAAQC,IAAI,IAACxP,SAAA,EACnDC,EAAAA,EAAAA,IAAA,OAAAD,SAAA,EACEJ,EAAAA,EAAAA,GAACyd,EAAAA,EAAK,CACJlb,YAAY,gDACZ,aAAW,aACXb,KAAK,MACLe,KAAK,SACL2H,MAAOya,EAAeE,KACtBzX,SAAW/S,GAvOAwqB,KAC3B,MAAMY,EAAUZ,EAAOgD,OAAOhD,QAAQ5d,EACtC2d,GAAmBe,IAAI,IAAWA,EAAMd,KAAMY,MAC9CU,EAAyBV,EAASd,EAAeI,KAAK,EAoOrB+C,CAAoBztB,EAAEuQ,OAAOV,OAC9C6d,IAAKpD,EAAeI,KACpBlV,YAAY,QAEb2W,GAAevQ,EAAM6O,eAAgBH,EAAeE,UAEvD1kB,EAAAA,EAAAA,IAAA,OAAAD,SAAA,EACEJ,EAAAA,EAAAA,GAACyd,EAAAA,EAAK,CACJlb,YAAY,gDACZ,aAAW,aACXb,KAAK,MACLe,KAAK,SACL2H,MAAOya,EAAeI,KACtB3X,SAAW/S,GA/OA0qB,KAC3B,MAAMW,EAAUX,EAAO8C,OAAO9C,QAAQ9d,EACtC2d,GAAmBe,IAAI,IAAWA,EAAMZ,KAAMW,MAC9CS,EAAyBxB,EAAeE,KAAMa,EAAQ,EA4OrBsC,CAAoB3tB,EAAEuQ,OAAOV,OAC9C+d,IAAKtD,EAAeE,KACpBhV,YAAY,QAEb2W,GAAevQ,EAAM6O,eAAgBH,EAAeI,aAGzDjlB,EAAAA,EAAAA,GAAA,OAAKd,MAAO,CAAEuB,QAASkC,EAAMgN,QAAQqC,OACrChS,EAAAA,EAAAA,GAACooB,EAAAA,IAAM,CACL7lB,YAAY,2HACZ,aAAW,aACX8lB,QAAkC,QAAzBlS,EAAM6O,eACf1X,SAAUmY,EACVjI,MAAM,YACN8K,YAAY,KACZC,cAAc,MACdC,cAAc,mBAMxBxoB,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWwD,MAAK,CAACC,MAAO,EAAG1P,MAAM,YAAYzD,KAAGC,EAAAA,EAAAA,IAAE,CAAEoU,WAAYrS,EAAMgN,QAAQa,IAAI,IAACpQ,SAAC,YAGrFJ,EAAAA,EAAAA,GAAC2hB,EAA0C,CACzCxL,MAAOA,EACPyJ,cAAeA,EACfpB,cAAeA,EACf8B,sBAAuBA,KAEzBjgB,EAAAA,EAAAA,IAACge,EAAwB,CAACnjB,MAAM,eAAeojB,SAAO,EAAAle,SAAA,CACnDukB,IACCtkB,EAAAA,EAAAA,IAAA,OAAKM,KAAGC,EAAAA,EAAAA,IAAE,CAAEmD,QAAS,OAAQuE,IAAK3F,EAAMgN,QAAQC,IAAI,IAACxP,SAAA,EACnDC,EAAAA,EAAAA,IAAA,OAAAD,SAAA,EACEJ,EAAAA,EAAAA,GAACyd,EAAAA,EAAK,CACJlb,YAAY,gDACZ,aAAW,aACXb,KAAK,MACLe,KAAK,SACL2H,MAAOya,EAAehC,KACtBvV,SAAW/S,GAnRIsoB,KAC3B,MAAMkD,EAAUlD,EAAOkF,OAAOlF,QAAQ1b,EACtC2d,GAAmBe,IAAI,IAAWA,EAAMhD,KAAMkD,MAC9CQ,EAAyBR,EAASlB,EAAe/B,KAAK,EAgRzB2F,CAAoBluB,EAAEuQ,OAAOV,OAC9C6d,IAAKpD,EAAe/B,KACpB/S,YAAY,QAEb2W,GAAevQ,EAAM+O,UAAWL,EAAehC,UAElDxiB,EAAAA,EAAAA,IAAA,OAAAD,SAAA,EACEJ,EAAAA,EAAAA,GAACyd,EAAAA,EAAK,CACJlb,YAAY,gDACZ,aAAW,aACXb,KAAK,MACLe,KAAK,SACL2H,MAAOya,EAAe/B,KACtBxV,SAAW/S,GA3RIuoB,KAC3B,MAAMkD,EAAUlD,EAAOiF,OAAOjF,QAAQ3b,EACtC2d,GAAmBe,IAAI,IAAWA,EAAM/C,KAAMkD,MAC9CO,EAAyB1B,EAAehC,KAAMmD,EAAQ,EAwRzB0C,CAAoBnuB,EAAEuQ,OAAOV,OAC9C+d,IAAKtD,EAAehC,KACpB9S,YAAY,QAEb2W,GAAevQ,EAAM+O,UAAWL,EAAe/B,aAItD9iB,EAAAA,EAAAA,GAACuU,EAAAA,EAAM,CAACC,KAAK,QACbxU,EAAAA,EAAAA,GAACooB,EAAAA,IAAM,CACL7lB,YAAY,2HACZ,aAAW,aACX8lB,QAA6B,QAApBlS,EAAM+O,UACf5X,SAAUwY,EACVtI,MAAM,YACN8K,YAAY,KACZC,cAAc,MACdC,cAAc,cAEhBxoB,EAAAA,EAAAA,GAACuU,EAAAA,EAAM,CAACC,KAAK,QACbnU,EAAAA,EAAAA,IAAA,OAAKM,IAAGmO,EAA6E1O,SAAA,EACnFC,EAAAA,EAAAA,IAAA,OAAAD,SAAA,EACEJ,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWC,KAAI,CAACqY,MAAI,EAAAvoB,UACnBJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,uBAInBxO,EAAAA,EAAAA,GAACwnB,EAAAA,EAAO,CACNjlB,YAAY,2HACZqmB,cAAe,EACfnB,SACEznB,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,oKAInBkZ,KAAK,QAAOtnB,UAEZC,EAAAA,EAAAA,IAAA,QAAAD,SAAA,CACG,KACDJ,EAAAA,EAAAA,GAAC2nB,EAAAA,IAAgB,CAAChnB,IAAKgB,EAAOimB,oCAIpC5nB,EAAAA,EAAAA,GAACooB,EAAAA,IAAM,CACL7lB,YAAY,2HACZ,aAAW,yBACX8lB,QAASlS,EAAM+P,eACf5Y,SAAU2Y,EAEVzI,MAAM,IACN8K,YAAavN,EAAKC,cAAc,CAAArf,GAAA,SAC9B6S,eAAe,OAGjB+Z,cAAexN,EAAKC,cAAc,CAAArf,GAAA,SAChC6S,eAAe,QAGjBga,cAAezN,EAAKC,cAAc,CAAArf,GAAA,SAChC6S,eAAe,sBAMvBxO,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWwD,MAAK,CAACC,MAAO,EAAG1P,MAAM,YAAYzD,KAAGC,EAAAA,EAAAA,IAAE,CAAEoU,WAAYrS,EAAMgN,QAAQa,IAAI,IAACpQ,SAAC,cAGrFJ,EAAAA,EAAAA,GAACqe,EAAwB,CACvBnjB,MAAO6f,EAAKC,cAAc,CAAArf,GAAA,SACxB6S,eAAe,mBAGjB8P,SAAO,EAAAle,UAEPC,EAAAA,EAAAA,IAACwoB,EAAAA,IAAqB,CACpBtmB,YAAY,2HACZb,KAAMqZ,EAAKC,cAAc,CAAArf,GAAA,SACvB6S,eAAe,mBAGjBpE,MAAO+L,EAAM2S,cACbxb,SAAUyB,IAAiB,IAAhB,OAAEjE,GAAQiE,EACnB6Q,GAAe5a,IAAO,IAChBA,EACJ8jB,cAAehe,EAAOV,SACrB,EACHhK,SAAA,EAEFC,EAAAA,EAAAA,IAAC0oB,EAAAA,IAAsB,CACrB3e,WAAOjD,EACP,aAAY,CACV4T,EAAKC,cAAc,CAAArf,GAAA,SACjB6S,eAAe,mBAGjBuM,EAAKC,cAAc,CAAArf,GAAA,SACjB6S,eAAe,UAGjBvF,KAAK,MAAM7I,SAAA,EAEbJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,SAEd,KACHxO,EAAAA,EAAAA,GAACmV,EAAAA,IAAa,CACZja,OACE8E,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,gFAGlBpO,UAEDJ,EAAAA,EAAAA,GAACgpB,EAAAA,EAAQ,UAGbhpB,EAAAA,EAAAA,GAAC+oB,EAAAA,IAAsB,CACrB3e,OAAK,EACL,aAAY,CACV2Q,EAAKC,cAAc,CAAArf,GAAA,SACjB6S,eAAe,mBAGjBuM,EAAKC,cAAc,CAAArf,GAAA,SACjB6S,eAAe,QAGjBvF,KAAK,MAAM7I,UAEbJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,UAInBxO,EAAAA,EAAAA,GAAC+oB,EAAAA,IAAsB,CACrB3e,OAAO,EACP,aAAY,CACV2Q,EAAKC,cAAc,CAAArf,GAAA,SACjB6S,eAAe,mBAGjBuM,EAAKC,cAAc,CAAArf,GAAA,SACjB6S,eAAe,SAGjBvF,KAAK,MAAM7I,UAEbJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,gBAMvBnO,EAAAA,EAAAA,IAACge,EAAwB,CACvBnjB,OACE8E,EAAAA,EAAAA,GAAAM,EAAAA,GAAA,CAAAF,UACEJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,qBAKrB8P,SAAO,EAAAle,SAAA,EAENknB,EAAAA,EAAAA,QACCjnB,EAAAA,EAAAA,IAAC0iB,EAAAA,IAAMC,MAAK,CACVzgB,YAAY,2HACZb,KAAK,6BACL0I,MAAO7D,QAAQ4P,EAAM8S,wBACrB3b,SAAU0B,IAAiB,IAAhB,OAAElE,GAAQkE,EACnB4Q,GAAe5a,IAAO,IAChBA,EACJikB,wBAAyC,IAAjBne,EAAOV,SAC9B,EACHhK,SAAA,EAEFJ,EAAAA,EAAAA,GAAC+iB,EAAAA,IAAK,CAAC3Y,OAAK,EAAAhK,SAAC,4BACbJ,EAAAA,EAAAA,GAAC+iB,EAAAA,IAAK,CAAC3Y,OAAO,EAAMhK,SAAC,eAIzBJ,EAAAA,EAAAA,GAACkpB,EAAAA,EAAgB,CACf,cAAY,oBACZf,IAAK,EACLF,IAAK,IACL3a,SAAU6Y,EACVgD,aAAchT,EAAMiQ,eAAiBjQ,EAAMiQ,eAAiB,EAC5DvhB,UAAUyiB,EAAAA,EAAAA,OAAuCnR,EAAM8S,6BAG3DjpB,EAAAA,EAAAA,GAACqf,EAAyB,CACxBjV,MAAO+L,EAAM8J,mBACb3S,SAAU0S,EACVV,QA5tBmB,CAAC,EAAG,GAAI,GAAI,GAAI,SA8tBpC,EAID3d,EAAS,CACbkd,WAAY,CAAExjB,MAAO,QACrBusB,yBAA0BA,KAAA,CACxBwB,IAAK,CAAE/tB,MAAO,GAAIC,OAAQ,O,qECz1BvB,MAkJM+tB,GAAsC7N,EAAAA,EAAAA,KAP3B3Z,IAAA,IAAGynB,UAAU,iBAAEC,IAAgC1nB,EAAA,MAAM,CAC3E0nB,mBACD,QAK2EpiB,OAAWA,EAAW,CAChGqiB,eAAgBA,CAACC,EAAWC,IAAcD,EAAUH,SAASC,mBAAqBG,EAAUJ,SAASC,kBADpD/N,EAlJIxgB,IAchD,IAAD2uB,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,IAdkD,YACtDC,EAAW,WACXC,EAAU,iBACVV,EAAgB,QAChBW,EAAO,sBACPC,GASDnvB,EACC,MAAMovB,GAAgC1F,EAAAA,EAAAA,MAChCC,GAA2BC,EAAAA,EAAAA,OAE3B,eAAEwB,EAAc,uBAAE7C,EAAsB,SAAEzB,IAAauI,EAAAA,EAAAA,GAC3DJ,EACAE,GAGIG,GAAYvd,EAAAA,EAAAA,UAAQ,IAAMid,EAAYO,MAAM5vB,GAAMA,EAAE6vB,mBAAkB,CAACR,KAEvE,kBAAES,GAAsBP,GAAW,CAAC,EAEpCQ,GAAkB3d,EAAAA,EAAAA,UAAQ,KAC9B,GAAIud,EAAW,CAKb,MAAO,KAJchM,EAAAA,EAAAA,SAAQ0L,EAAYpb,KAAKjU,GAAMA,EAAE6vB,mBAAkBG,SAASC,GAAMA,EAAErT,eACnE+G,EAAAA,EAAAA,SACpB0L,EAAYrc,QAAQhT,IAAOA,EAAE6vB,kBAAoB7vB,EAAEkwB,iBAAgBjc,KAAKjU,IAAC,IAAAmwB,EAAAC,EAAA,OAAuB,QAAvBD,EAAc,QAAdC,EAAKpwB,EAAEqwB,eAAO,IAAAD,OAAA,EAATA,EAAW5W,eAAO,IAAA2W,EAAAA,OAAI3jB,CAAS,KAGjH,CACA,OAAOmX,EAAAA,EAAAA,SAAQ0L,EAAYpb,KAAKjU,GAAMA,EAAEqwB,WAAUpc,KAAKgc,IAAC,IAAAK,EAAA,OAAc,QAAdA,EAAKL,EAAEzW,eAAO,IAAA8W,EAAAA,EAAI,EAAE,GAAC,GAC5E,CAACjB,EAAaM,IAEXY,GAAoBne,EAAAA,EAAAA,UAAQ,KAChC,MAWMoe,EAXgBlB,KAA0C,IAADmB,EAC7D,MAAMC,EAAW,CAACpB,EAAWlK,WAC4E,IAADuL,EAAxG,KAAKzJ,EAAAA,EAAAA,OAAkCoI,EAAWvH,WAAaO,EAAAA,GAA6BC,WAC1F,OAAoC,QAApCoI,EAAOrB,EAAWtJ,0BAAkB,IAAA2K,EAAAA,EAAID,EAE1C,MAAMF,EAAuC,QAA9BC,EAAGnB,EAAW9H,wBAAgB,IAAAiJ,OAAA,EAA3BA,EAA6B3iB,QAAO,CAACC,EAAK6iB,KAC1DA,EAAIhK,UAAUtJ,SAASuT,GAAa9iB,EAAI+iB,IAAID,KACrC9iB,IACN,IAAIgjB,KACP,YAAqBvkB,IAAdgkB,EAA0BE,EAAWM,MAAMC,KAAKT,EAAU,EAEjDU,CAAa5B,GACzB6B,EAAavI,EAA8B,CAACA,GAAN,GAC5C,OAAO4H,EAAUY,OAAOD,EAAU,GACjC,CAAC7B,EAAY1G,KAEV,iBAAEyI,EAAgB,UAAEC,IAAcC,EAAAA,EAAAA,GAAwB,CAC9D3U,SAAUmT,EACVvF,WAAY+F,EACZxT,SAAS,EACTyU,WAAY,IACZ1U,oBAAoB,IAGhB2U,GAAcrf,EAAAA,EAAAA,UAClB,IACEid,EAAYpb,KAAKyd,IACf,MAAMC,EAAiBpB,EAAkBziB,QAAO,CAACC,EAA0BjD,KAAS,IAAD8mB,EAAAC,EACjF,MAAMC,EAAoC,QAA7BF,EAAGP,EAAiBK,EAAIK,aAAK,IAAAH,GAAO,QAAPC,EAA1BD,EAA6B9mB,UAAI,IAAA+mB,OAAP,EAA1BA,EAAmCF,eAInD,OAHIG,IACF/jB,EAAIjD,GAAOwkB,EAAW/D,gBAAiByG,EAAAA,EAAAA,IAAgCF,GAAWA,GAE7E/jB,CAAG,GACT,CAAC,GAEJ,MAAO,IACF2jB,EACHC,iBACD,KAEL,CAACpB,EAAmBc,EAAkBhC,EAAaC,EAAW/D,iBAG1D0G,GAAmBC,EAAAA,EAAAA,GAAuB,CAC9CnV,QAAS4S,EACTwC,kBAAmBV,EACnBjH,WAAY+F,EACZ6B,4BAA6Bf,EAC7BvB,oBACAlH,uBAAwBzB,IAAaC,EAAAA,GAA6BC,OAASuB,OAAyBpc,EACpG+e,eAAyC,QAA3ByD,EAAEM,EAAW/D,sBAAc,IAAAyD,GAAAA,IAIrCqD,EAAY1C,EAAYsC,EAAmBR,GAE3C,WAAEa,EAAU,aAAEC,IAAiBC,EAAAA,EAAAA,IACnClD,EACAG,EAAgCgD,EAAAA,GAAsBC,2BAA6BD,EAAAA,GAAsBE,QAG3G,GAAIrB,EACF,OAAOjsB,EAAAA,EAAAA,GAACutB,EAAAA,IAAc,IAGxB,MAAMC,EAAkBA,CACtBC,EACAC,KAEA,KAAI/J,EAAAA,EAAAA,aAAY8J,MAAa9J,EAAAA,EAAAA,aAAY+J,GAGzC,MAAO,CAACD,EAAUC,EAAS,EAGvBC,EAASH,EAAgC,QAAjB5D,EAACK,EAAWrH,aAAK,IAAAgH,OAAA,EAAhBA,EAAkB7E,KAAsB,QAAlB8E,EAAEI,EAAWrH,aAAK,IAAAiH,OAAA,EAAhBA,EAAkB5E,MACnE2I,EAASJ,EAAgC,QAAjB1D,EAACG,EAAWrH,aAAK,IAAAkH,OAAA,EAAhBA,EAAkBjH,KAAsB,QAAlBkH,EAAEE,EAAWrH,aAAK,IAAAmH,OAAA,EAAhBA,EAAkBjH,MAEzE,OACE9iB,EAAAA,EAAAA,GAAC6tB,EAAAA,EAAmB,CAClBC,SAAUd,EACVjN,UAAWkK,EAAWlK,UACtBY,mBAAoBsJ,EAAWtJ,mBAC/BuE,UAAW+E,EAAW/E,UACtBF,eAAgBiF,EAAWjF,eAC3BoB,eAAgBA,EAChBtE,SAAUA,EACVyB,uBAAwBA,EACxBuF,cAAemB,EAAWnB,cAC1B3G,iBAAkB8H,EAAW9H,iBAC7BO,SAAUuH,EAAWvH,SACrBqL,oBAAoB,EACpBC,QAASf,EACTgB,UAAWf,EACXS,OAAQhJ,EAA2BgJ,OAASxmB,EAC5CymB,OAAQjJ,EAA2BiJ,OAASzmB,GAC5C,I,sFCxJoD,IAAAtF,GAAA,CAAAH,KAAA,SAAAC,OAAA,4EAAAF,GAAA,CAAAC,KAAA,UAAAC,OAAA,0DAEnD,MCSMusB,GAAkClzB,IAUxC,IAVyC,MAC9Cmb,EAAK,cACLyJ,EAAa,cACbpB,EAAa,aACbC,GAMDzjB,EACC,MAAM,cAAEggB,IAAkB0D,EAAAA,EAAAA,KAMpByP,GAAarO,EAAAA,EAAAA,cACjB,CAACsO,EAAsBC,KACrB,MAAM5rB,GAAO6rB,EAAAA,EAAAA,IAAyBF,EAAc,UAAY,SAAW,QACrE3oB,GAAM8oB,EAAAA,EAAAA,IAAwBH,EAAc3rB,GAClDmd,GAAe5a,IAAO,IAChBA,EACJ,CAACqpB,GAAO,CAAE5oB,MAAKhD,WACd,GAEL,CAACmd,IAMGI,GAAwBF,EAAAA,EAAAA,cAC3BG,IACCL,GAAe5a,IAAO,IAChBA,EACJib,wBACC,GAEL,CAACL,IAiCH,OA1BAhY,EAAAA,EAAAA,YAAU,KAAO,IAAD4mB,EAAAC,EAAAC,EACd,MAAMC,EAA2B,OAAbnQ,QAAa,IAAbA,OAAa,EAAbA,EAAgB,GAC9BoQ,EAAyB,OAAZnQ,QAAY,IAAZA,OAAY,EAAZA,EAAe,GAClB,QAAZ+P,EAACrY,EAAM0Y,aAAK,IAAAL,GAAXA,EAAa/oB,MACZkpB,EACFR,GAAWhP,EAAAA,EAAAA,IAAqB,SAAUwP,GAAc,SAC/CC,GACTT,GAAWhP,EAAAA,EAAAA,IAAqB,QAASyP,GAAa,UAG1C,QAAZH,EAACtY,EAAM2Y,aAAK,IAAAL,GAAXA,EAAahpB,MACZkpB,EACFR,GAAWhP,EAAAA,EAAAA,IAAqB,SAAUwP,GAAc,SAC/CC,GACTT,GAAWhP,EAAAA,EAAAA,IAAqB,QAASyP,GAAa,UAG1C,QAAZF,EAACvY,EAAM4Y,aAAK,IAAAL,GAAXA,EAAajpB,MACZkpB,EACFR,GAAWhP,EAAAA,EAAAA,IAAqB,SAAUwP,GAAc,SAC/CC,GACTT,GAAWhP,EAAAA,EAAAA,IAAqB,QAASyP,GAAa,SAE1D,GACC,CAACzY,EAAM0Y,MAAO1Y,EAAM2Y,MAAO3Y,EAAM4Y,MAAOZ,EAAY3P,EAAeC,KAGpEpe,EAAAA,EAAAA,IAAAC,EAAAA,GAAA,CAAAF,SAAA,EACEJ,EAAAA,EAAAA,GAACqe,EAAwB,CACvBnjB,MAAO8f,EAAc,CAAArf,GAAA,SACnB6S,eAAe,WAEdpO,UAEHJ,EAAAA,EAAAA,GAACue,EAA2B,CAC1BnU,MAAO+L,EAAM0Y,MAAMppB,KAAM0Z,EAAAA,EAAAA,IAAqBhJ,EAAM0Y,MAAMpsB,KAAM0T,EAAM0Y,MAAMppB,KAAO,GACnF6H,SAAWlD,IACT+jB,EAAW/jB,EAAO,QAAQ,EAE5BqU,aAAcA,EACdD,cAAeA,OAGnBxe,EAAAA,EAAAA,GAACqe,EAAwB,CACvBnjB,MAAO8f,EAAc,CAAArf,GAAA,SACnB6S,eAAe,WAEdpO,UAEHJ,EAAAA,EAAAA,GAACue,EAA2B,CAC1BnU,MAAO+L,EAAM2Y,MAAMrpB,KAAM0Z,EAAAA,EAAAA,IAAqBhJ,EAAM2Y,MAAMrsB,KAAM0T,EAAM2Y,MAAMrpB,KAAO,GACnF6H,SAAWlD,IACT+jB,EAAW/jB,EAAO,QAAQ,EAE5BqU,aAAcA,EACdD,cAAeA,OAGnBxe,EAAAA,EAAAA,GAACqe,EAAwB,CACvBnjB,MAAO8f,EAAc,CAAArf,GAAA,SACnB6S,eAAe,WAEdpO,UAEHJ,EAAAA,EAAAA,GAACue,EAA2B,CAC1BnU,MAAO+L,EAAM4Y,MAAMtpB,KAAM0Z,EAAAA,EAAAA,IAAqBhJ,EAAM4Y,MAAMtsB,KAAM0T,EAAM4Y,MAAMtpB,KAAO,GACnF6H,SAAWlD,IACT+jB,EAAW/jB,EAAO,QAAQ,EAE5BqU,aAAcA,EACdD,cAAeA,OAGnBxe,EAAAA,EAAAA,GAACqf,EAAyB,CACxBjV,MAAO+L,EAAM8J,mBACb3S,SAAU0S,EACVV,QA9GmB,CAAC,EAAG,GAAI,GAAI,GAAI,SAgHpC,EC9HD0P,GAA4BtP,EAClCsP,GAA0BvU,KACxB,CACErQ,MAAO,IACPoT,OACExd,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,SAKrB,CACEpE,MAAO,IACPoT,OACExd,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,SAKrB,CACEpE,MAAO,IACPoT,OACExd,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,UAUhB,MAAMygB,GAAkCj0B,IAUxC,IAVyC,MAC9Cmb,EAAK,cACLyJ,EAAa,cACbpB,EAAa,aACbC,GAMDzjB,EACC,MAAM,cAAEggB,IAAkB0D,EAAAA,EAAAA,KAKpByP,GAAarO,EAAAA,EAAAA,cACjB,CAACsO,EAAsBC,KACrB,MAAM5rB,GAAO6rB,EAAAA,EAAAA,IAAyBF,EAAc,UAAY,SAAW,QACrE3oB,GAAM8oB,EAAAA,EAAAA,IAAwBH,EAAc3rB,GAClDmd,GAAe5a,IAAO,IAChBA,EACJ,CAACqpB,GAAO,CAAE5oB,MAAKhD,WACd,GAEL,CAACmd,IAMGI,GAAwBF,EAAAA,EAAAA,cAC3BG,IACCL,GAAe5a,IAAO,IAChBA,EACJib,wBACC,GAEL,CAACL,IA0BH,OAnBAhY,EAAAA,EAAAA,YAAU,KAAO,IAAD4mB,EAAAC,EACd,MAAME,EAA2B,OAAbnQ,QAAa,IAAbA,OAAa,EAAbA,EAAgB,GAC9BoQ,EAAyB,OAAZnQ,QAAY,IAAZA,OAAY,EAAZA,EAAe,GAClB,QAAZ+P,EAACrY,EAAM0Y,aAAK,IAAAL,GAAXA,EAAa/oB,MACZkpB,EACFR,GAAWhP,EAAAA,EAAAA,IAAqB,SAAUwP,GAAc,SAC/CC,GACTT,GAAWhP,EAAAA,EAAAA,IAAqB,QAASyP,GAAa,UAG1C,QAAZH,EAACtY,EAAM2Y,aAAK,IAAAL,GAAXA,EAAahpB,MACZkpB,EACFR,GAAWhP,EAAAA,EAAAA,IAAqB,SAAUwP,GAAc,SAC/CC,GACTT,GAAWhP,EAAAA,EAAAA,IAAqB,QAASyP,GAAa,SAE1D,GACC,CAACzY,EAAM0Y,MAAO1Y,EAAM2Y,MAAOX,EAAY3P,EAAeC,KAGvDpe,EAAAA,EAAAA,IAAAC,EAAAA,GAAA,CAAAF,SAAA,EACEJ,EAAAA,EAAAA,GAACqe,EAAwB,CACvBnjB,MAAO8f,EAAc,CAAArf,GAAA,SACnB6S,eAAe,WAEdpO,UAEHJ,EAAAA,EAAAA,GAACue,EAA2B,CAC1BnU,MAAO+L,EAAM0Y,MAAMppB,KAAM0Z,EAAAA,EAAAA,IAAqBhJ,EAAM0Y,MAAMpsB,KAAM0T,EAAM0Y,MAAMppB,KAAO,GACnF6H,SAAWlD,IACT+jB,EAAW/jB,EAAO,QAAQ,EAE5BqU,aAAcA,EACdD,cAAeA,OAGnBxe,EAAAA,EAAAA,GAACqe,EAAwB,CACvBnjB,MAAO8f,EAAc,CAAArf,GAAA,SACnB6S,eAAe,WAEdpO,UAEHJ,EAAAA,EAAAA,GAACue,EAA2B,CAC1BnU,MAAO+L,EAAM2Y,MAAMrpB,KAAM0Z,EAAAA,EAAAA,IAAqBhJ,EAAM2Y,MAAMrsB,KAAM0T,EAAM2Y,MAAMrpB,KAAO,GACnF6H,SAAWlD,IACT+jB,EAAW/jB,EAAO,QAAQ,EAE5BqU,aAAcA,EACdD,cAAeA,OAGnBxe,EAAAA,EAAAA,GAACqf,EAAyB,CACxBjV,MAAO+L,EAAM8J,mBACb3S,SAAU0S,EACVV,QAAS0P,OAEV,E,wCCvIgD,IAAAntB,GAAA,CAAAH,KAAA,SAAAC,OAAA,0CAMhD,MAAMutB,GAAqCl0B,IAY3C,IAZ4C,MACjDmb,EAAK,cACLyJ,EAAa,cACbpB,EAAa,aACbC,EAAY,QACZyL,GAODlvB,EAIC,MAAMm0B,GAAsBrP,EAAAA,EAAAA,cACzBsP,IACCxP,GAAe5a,IACb,MACMqqB,EADgBrqB,EACcqqB,cACpC,OAAIA,EAAcphB,SAASmhB,GAClB,IACDpqB,EACJqqB,cAAeA,EAAc1hB,QAAQ2hB,GAAUA,IAAUF,KAGpD,IAAMpqB,EAA4CqqB,cAAe,IAAIA,EAAeD,GAC7F,GACA,GAEJ,CAACxP,IAGG2P,GAAkBzP,EAAAA,EAAAA,cACrBvlB,GAAMqlB,GAAe5a,IAAO,IAAYA,EAA4CwqB,UAAWj1B,EAAEuQ,OAAOV,WACzG,CAACwV,IAGG6P,GAA+B3P,EAAAA,EAAAA,cAClC4P,GACC9P,GAAe5a,IAAO,IAChBA,EACJ0qB,8BAEJ,CAAC9P,IAGG+P,GAA4B7P,EAAAA,EAAAA,cAC/B8P,GACChQ,GAAe5a,IAAO,IAChBA,EACJ4qB,2BAEJ,CAAChQ,KAGG,MAAEjd,IAAUC,EAAAA,EAAAA,MACZ,cAAEoY,IAAkB0D,EAAAA,EAAAA,KAE1B,OACEre,EAAAA,EAAAA,IAAAC,EAAAA,GAAA,CAAAF,SAAA,EACEC,EAAAA,EAAAA,IAACge,EAAwB,CACvBnjB,MAAO8f,EAAc,CAAArf,GAAA,SACnB6S,eAAe,YAGdpO,SAAA,EAEHJ,EAAAA,EAAAA,GAAC6vB,EAAAA,IAAS7M,MAAK,CAACrnB,GAAG,iBAAiBwtB,aAAchT,EAAMkZ,cAAcjvB,SACnEjG,OAAOwX,OAAOme,EAAAA,IAAkClhB,KAAK0gB,IAAW,IAADS,EAC9D,MAAMC,IAAmB9F,GAAU+F,EAAAA,GAA4BhiB,SAASqhB,GACxE,OACEjvB,EAAAA,EAAAA,IAAA,OAAKM,IAAGkB,GAAmDzB,SAAA,EACzDJ,EAAAA,EAAAA,GAAC6vB,EAAAA,IAAQ,CACPttB,YAAY,gIAEZ6H,MAAOklB,EACPY,UAA8B,QAArBH,EAAE5Z,EAAMkZ,qBAAa,IAAAU,OAAA,EAAnBA,EAAqB9hB,SAASqhB,GACzChiB,SAAUA,IAAM6hB,EAAoBG,GACpCzqB,SAAUmrB,EAAiB5vB,SAE1BkvB,GANIA,GAQNU,IACChwB,EAAAA,EAAAA,GAACmwB,EAAAA,IAAiB,CAChBj1B,OACE8E,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,wCAfwC8gB,EAqB3D,OAIZjvB,EAAAA,EAAAA,IAAA,OACEM,KAAGC,EAAAA,EAAAA,IAAE,CACHmD,QAAS,OACT2Q,cAAe,SACfjU,QAAS,GAAGkC,EAAMgN,QAAQc,WAC1BnI,IAAK3F,EAAMgN,QAAQC,IACpB,IAACxP,SAAA,EAEFJ,EAAAA,EAAAA,GAACooB,EAAAA,IAAM,CACL7lB,YAAY,iIACZ8lB,QAASlS,EAAMuZ,uBACfpiB,SAAUmiB,EACVjS,MAAOxC,EAAc,CAAArf,GAAA,SACnB6S,eAAe,iCAKnBxO,EAAAA,EAAAA,GAACooB,EAAAA,IAAM,CACL7lB,YAAY,iIACZ8lB,QAASlS,EAAMyZ,oBACftiB,SAAUqiB,EACVnS,MAAOxC,EAAc,CAAArf,GAAA,SACnB6S,eAAe,mCAQvBxO,EAAAA,EAAAA,GAACqe,EAAwB,CACvBnjB,MAAO8f,EAAc,CAAArf,GAAA,SACnB6S,eAAe,eAGdpO,UAEHJ,EAAAA,EAAAA,GAACyd,EAAAA,EAAK,CACJlb,YAAY,iIACZ6H,MAAO+L,EAAMqZ,UACbliB,SAAUiiB,QAGb,E,gBCrJA,MAAMa,GAAgCp1B,IAUtC,IAVuC,YAC5CgvB,EAAW,MACX7T,EAAK,cACLyJ,EAAa,aACbyQ,GAMDr1B,EACC,MAEM,UAAEs1B,EAAS,QAAEC,EAAO,QAAEC,IAAYC,EAAAA,GAAAA,GAAwB,CAC9DC,KAAM1G,EACN2G,kBAAmBxa,EAAMya,WAAa,KAYlCC,IATkB/Q,EAAAA,EAAAA,cACrB8Q,IACChR,GAAe5a,IACN,IAAMA,EAAuC4rB,eACpD,GAEJ,CAAChR,KAGgBE,EAAAA,EAAAA,cAChBgR,IACClR,GAAe5a,IACN,IAAMA,EAAuC8rB,UACpD,GAEJ,CAAClR,MAGG,cAAE5E,IAAkB0D,EAAAA,EAAAA,KAEpBqS,EAAgBC,IACpBpR,GAAe5a,IAAa,IAADisB,EACzB,MAAMC,EAAgBlsB,EAC4B,IAADmsB,EAAjD,OAA2B,QAA3BF,EAAIC,EAAcN,iBAAS,IAAAK,GAAvBA,EAAyBhjB,SAAS+iB,GAC7B,IACFE,EACHN,UAAkC,QAAzBO,EAAED,EAAcN,iBAAS,IAAAO,OAAA,EAAvBA,EAAyBxjB,QAAQlI,GAAQA,IAAQurB,KAGvD,IAAKE,EAAeN,UAAW,IAAKM,EAAcN,WAAa,GAAKI,GAC7E,GACA,EASJ,OACE3wB,EAAAA,EAAAA,IAAAC,EAAAA,GAAA,CAAAF,SAAA,EACEJ,EAAAA,EAAAA,GAACqe,EAAwB,CACvBnjB,MAAO8f,EAAc,CAAArf,GAAA,SACnB6S,eAAe,WAEdpO,UAEHC,EAAAA,EAAAA,IAAC+wB,EAAAA,IAAc,CACb7uB,YAAY,2HACZ6H,MAAO+L,EAAMya,UACbpT,MAAM,SACN6T,aAAW,EAAAjxB,SAAA,EAEXJ,EAAAA,EAAAA,GAACsxB,EAAAA,IAAqB,CAACthB,QApBXuhB,KAClB3R,GAAe5a,IACN,IAAMA,EAAuC4rB,UAAW,MAC/D,EAiBiDY,SA7D1B,OA8DnBxxB,EAAAA,EAAAA,GAACyxB,EAAAA,IAAqB,CAACzK,mBAAiB,EAAA5mB,UACtCJ,EAAAA,EAAAA,GAAC0xB,EAAAA,IAAwB,CAAAtxB,SACtBiwB,EAAazhB,KAAKoiB,IAAc,IAADW,EAC9B,OACE3xB,EAAAA,EAAAA,GAAC4xB,EAAAA,IAAoC,CAEnCxnB,MAAO4mB,EACP1jB,SAAUyjB,EACV1I,QAAwB,QAAjBsJ,EAAExb,EAAMya,iBAAS,IAAAe,OAAA,EAAfA,EAAiB1jB,SAAS+iB,IAH9BA,EAIL,cAOdhxB,EAAAA,EAAAA,GAACqe,EAAwB,CAACnjB,MAAM,OAAMkF,UACpCJ,EAAAA,EAAAA,GAACkpB,EAAAA,EAAgB,CACfjB,IAAKsI,EACLpI,IAAKqI,EACLqB,MAAOvB,EACPnH,aAAchT,EAAM2a,KACpBjsB,SAAU1K,OAAO23B,KAAKxB,GAAW71B,QAAU,EAC3C6S,SAAUujB,EACVC,KAAM,WAGT,E,gBCjHiD,IAAAjvB,GAAA,CAAAH,KAAA,UAAAC,OAAA,mCCiDxD,MAAMowB,GAaF,CACF,CAACC,EAAAA,GAAcC,KC5DiCj3B,IAM3C,IAN4C,YACjDgvB,EAAW,WACXC,GAIDjvB,EACC,MAAM,aAAEkyB,EAAY,WAAED,IAAeE,EAAAA,EAAAA,IAAqBlD,GAE1D,OACEjqB,EAAAA,EAAAA,GAACkyB,EAAAA,EAAkB,CACjBnE,oBAAoB,EACpBoE,iBAAiB,EACjBC,kBAAkB,EAClBrS,UAAWkK,EAAWlK,UACtB+N,SAAU9D,EACVqI,OAAQC,EAAAA,EACRtE,QAASf,EACTgB,UAAWf,GACX,ED0CJ,CAAC8E,EAAAA,GAAcO,SE7DqCv3B,IAM/C,IANgD,YACrDgvB,EAAW,WACXC,GAIDjvB,EACC,MAAM,aAAEkyB,EAAY,WAAED,IAAeE,EAAAA,EAAAA,IAAqBlD,GAMpDxkB,GAAMsH,EAAAA,EAAAA,UAAQ,KAClB,MAAM,MAAE8hB,EAAK,MAAEC,EAAK,MAAEC,GAAU9E,EAChC,OAAO9oB,KAAKK,UAAU,CAAEqtB,QAAOC,QAAOC,SAAQ,GAC7C,CAAC9E,IAEJ,OACEjqB,EAAAA,EAAAA,GAACwyB,GAAAA,EAAe,CACdC,MAAOxI,EAAW4E,MAClB6D,MAAOzI,EAAW6E,MAClB6D,MAAO1I,EAAW8E,MAClBjB,SAAU9D,EACVgE,QAASf,EACTgB,UAAWf,EACXa,oBAAoB,GACftoB,EACL,EFkCJ,CAACusB,EAAAA,GAAcY,MAAOvJ,EACtB,CAAC2I,EAAAA,GAAca,UN3DsC73B,IAQhD,IARiD,YACtDgvB,EAAW,WACXC,EAAU,QACVC,GAKDlvB,EACC,MAAM83B,GAAeC,EAAAA,GAAAA,IAA0B9I,IAEzC,WAAEgD,EAAU,aAAEC,IAAiBC,EAAAA,EAAAA,IAAqBlD,GAW1D,IAT6Bld,EAAAA,EAAAA,UAC3B,SAAAimB,EAAA,OAC2B,QAD3BA,EACE/I,EAAW5J,sBAAc,IAAA2S,OAAA,EAAzBA,EAA2BzI,MACxB0I,GAAwB,OAAXjJ,QAAW,IAAXA,OAAW,EAAXA,EAAaO,MAAM2I,IAAS,IAAAC,EAAA,OAAKC,MAAMrL,OAAiC,QAA3BoL,EAACD,EAAUzc,OAAOwc,UAAS,IAAAE,OAAA,EAA1BA,EAA4B/oB,OAAO,KAC/F,CAAC6f,EAAW5J,eAAgB2J,GAC7B,GACH,CAACC,EAAW5J,eAAgB2J,KAGFE,EAC1B,OACElqB,EAAAA,EAAAA,GAAA,OAAKW,IAAGkB,GAA2FzB,UACjGJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,sIAOvB,MAAM6kB,EAAeP,GACjBQ,EAAAA,GAAAA,IAA8BtJ,EAAaC,EAAW5J,eAAgB4J,EAAW1J,iBACjF,GAEJ,OAAKuS,EAQEO,EAAa54B,QAElBuF,EAAAA,EAAAA,GAACuzB,GAAAA,EAA2B,CAC1BhT,gBAAiB0J,EAAW1J,gBAC5BF,eAAgB4J,EAAW5J,eAC3BqQ,KAAM2C,EACNG,oBAAqB,EACrBxF,QAASf,EACTgB,UAAWf,KAGbltB,EAAAA,EAAAA,GAACyzB,EAAAA,IAAK,CACJC,aACE1zB,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,mDAInBmlB,OAAO3zB,EAAAA,EAAAA,GAAC4zB,EAAAA,IAAM,OAxBd5zB,EAAAA,EAAAA,GAAA,OAAKW,IAAGc,GAAsErB,SAAC,gDA0BlF,EMLD,CAAC4xB,EAAAA,GAAc6B,SGhEqC74B,IAM/C,IANgD,YACrDgvB,EAAW,WACXC,GAIDjvB,EACC,MAAM,aAAEkyB,EAAY,WAAED,IAAeE,EAAAA,EAAAA,IAAqBlD,GAMpDxkB,GAAMsH,EAAAA,EAAAA,UAAQ,KAClB,MAAM,MAAE8hB,EAAK,MAAEC,GAAU7E,EACzB,OAAO9oB,KAAKK,UAAU,CAAEqtB,QAAOC,SAAQ,GACtC,CAAC7E,IAEJ,OACEjqB,EAAAA,EAAAA,GAAC8zB,GAAAA,EAAe,CACdrB,MAAOxI,EAAW4E,MAClB6D,MAAOzI,EAAW6E,MAClBhB,SAAU9D,EACVgE,QAASf,EACTgB,UAAWf,EACXa,oBAAoB,GACftoB,EACL,EHsCJ,CAACusB,EAAAA,GAAc+B,YI1DwC/4B,IAUlD,IAVmD,YACxDgvB,EAAW,QACXE,EAAO,WACPD,EAAU,cACV+J,GAMDh5B,EACC,OAAIi5B,EAAAA,EAAAA,OAEAj0B,EAAAA,EAAAA,GAACk0B,GAAAA,EAAoB,CACnBlK,YAAaA,EACbE,QAASA,EACTD,WAAYA,EACZ+J,cAAeA,KAKnBh0B,EAAAA,EAAAA,GAACm0B,GAAAA,EAAkB,CACjBnK,YAAaA,EACbE,QAASA,EACTD,WAAYA,EACZ+J,cAAeA,GACf,EJgCJ,CAAChC,EAAAA,GAAcoC,ODnEmCp5B,IAU7C,IAV8C,YACnDgvB,EAAW,WACXC,EAAU,cACV+J,EAAa,QACb9J,GAMDlvB,EACC,OACEgF,EAAAA,EAAAA,GAAA,OAAKW,IAAGkB,GAA6CzB,UACnDJ,EAAAA,EAAAA,GAACq0B,GAAAA,EAAa,CACZrK,YAAaA,EACbC,WAAYA,EACZ+J,cAAeA,EACfM,eAAgB,IAChBpK,QAASA,KAEP,GCgDR,IAAAzoB,GAAA,CAAAC,KAAA,SAAAC,OAAA,gBAAA6E,GAAA,CAAA9E,KAAA,UAAAC,OAAA,cAAAoN,GAAA,CAAArN,KAAA,UAAAC,OAAA,6BAAAqN,GAAA,CAAAtN,KAAA,SAAAC,OAAA,6DAEK,MAAM4yB,GAA2Bv5B,IAoBjC,IApBkC,SACvCkf,EAAQ,SACR0B,EAAQ,OACR+G,EAAM,aACN6R,EAAY,cACZhW,EAAa,aACbC,EAAY,QACZyL,EAAO,oBACPuK,EAAmB,sBACnBtK,GAWDnvB,EACC,MAAM05B,EAAwBjyB,IAAyBgyB,GAAuBA,EAAoBxmB,SAASxL,IACrG,MAAEE,IAAUC,EAAAA,EAAAA,KACZ+xB,EAAc,aAAahyB,EAAMuB,OAAO0wB,8BACvCC,EAAkBC,IAAuBjuB,EAAAA,EAAAA,UAA+B8b,GAEzEoS,EAAYxuB,QAAQsuB,EAAiBnI,MAErCsI,GAAkBlV,EAAAA,EAAAA,cAAard,IACnC,IAAKA,EACH,OAEF,MAAMwyB,EAAiBC,EAAAA,GAAqBC,wBAAwB1yB,GAAM,GACtEwyB,GACFH,EAAoBG,EACtB,GACC,IAEGjL,GAAcjd,EAAAA,EAAAA,UAAQ,KACtBwS,EAAAA,EAAAA,MACKiV,EAAa7mB,QAAO9L,IAAA,IAAC,OAAE6K,GAAQ7K,EAAA,OAAM6K,CAAM,IAAE0oB,UAE/CZ,EAAa1c,MAAM,EAAG+c,EAAiB5U,oBAAoBmV,WACjE,CAACZ,EAAcK,EAAiB5U,qBAE7BoQ,GAAetjB,EAAAA,EAAAA,UAAQ,KAC3B,MAAM6jB,EAAY,IAAIlF,IAMtB,OALA1B,EAAY/R,SAASoU,IACnBlyB,OAAO23B,KAAKzF,EAAIgJ,QAAQpd,SAAS+Y,IAC/BJ,EAAUnF,IAAIuF,EAAS,GACvB,IAEGrF,MAAMC,KAAKgF,GAAW0E,MAAM,GAClC,CAACtL,KA8FE,cAAEhP,IAAkB0D,EAAAA,EAAAA,KAE1B,IAAI6W,GAAoB,EACxB,GAAIV,EAAiBpyB,OAASuvB,EAAAA,GAAcY,KAAM,CAAC,IAAD4C,EAEhDD,EAAyE,KAAnB,QAAlCC,EADGX,EACalU,0BAAkB,IAAA6U,EAAAA,EAAI,IAAI/6B,MAChE,CAEA,OACEuF,EAAAA,EAAAA,GAAC4Z,EAAAA,EAAK,CACJrX,YAAY,gHACZsX,SAAO,EACPK,SAAUA,EACVJ,KAAMA,IAAM8B,EAASiZ,GACrB35B,MAEM8f,EADJ+Z,EACkB,CAAAp5B,GAAA,SACZ6S,eAAe,cAGH,CAAA7S,GAAA,SACZ6S,eAAe,kBAIvBinB,cAAe,CACb,cAAe,mDACf5wB,SAAU0wB,GAEZpZ,WAAYnB,EAAc,CAAArf,GAAA,SACxB6S,eAAe,WAGjBuL,OAEMiB,EADJ+Z,EACkB,CAAAp5B,GAAA,SACZ6S,eAAe,gBAGH,CAAA7S,GAAA,SACZ6S,eAAe,cAIvBgG,KAAK,OACL7T,IAAGc,GACHqd,wBAAyB,CACvB4W,UAAW,CACTC,UAAW,SACX5xB,QAAS,SAEX3D,UAEFC,EAAAA,EAAAA,IAAA,OACEM,KAAGC,EAAAA,EAAAA,IAAE,CAEHmD,QAAS,OACT1I,MAAO,OACPmN,oBAAqB,YACrBF,IAAK3F,EAAMgN,QAAQc,GACnBgE,UAAWkgB,EACXiB,aAAcjB,GACf,IAACv0B,SAAA,EAEFC,EAAAA,EAAAA,IAAA,OACEM,KAAGC,EAAAA,EAAAA,IAAE,CACH+0B,UAAW,OACXhhB,YAAaggB,EACbl0B,QAAS,GAAGkC,EAAMgN,QAAQc,QAAQ9N,EAAMgN,QAAQc,QAAQ9N,EAAMgN,QAAQc,WACtEpV,MAAO,SACR,IAAC+E,SAAA,EAEA20B,IACA/0B,EAAAA,EAAAA,GAACqe,EAAwB,CAACnjB,MAAM,aAAYkF,UAC1CC,EAAAA,EAAAA,IAACymB,EAAAA,IAAY,CACXvkB,YAAY,gHACZ5G,GAAG,oBACHgF,IAAG6F,GACH4D,MAAOyqB,EAAiBpyB,KACxB6K,SAAUwB,IAAiB,IAAhB,OAAEhE,GAAQgE,EACnB,MAAM+mB,EAAY/qB,EAAOV,MACzBjQ,OAAOwX,OAAOqgB,EAAAA,IAAe/jB,SAAS4nB,IAAcb,EAAgBa,EAAU,EAC9Ez1B,SAAA,CAEDs0B,EAAqB1C,EAAAA,GAAcC,OAClCjyB,EAAAA,EAAAA,GAACunB,EAAAA,IAAkB,CAACnd,MAAO4nB,EAAAA,GAAcC,IAAI7xB,UAC3CC,EAAAA,EAAAA,IAAA,OAAKM,IAAKgB,GAAOm0B,gBAAgBnzB,GAAOvC,SAAA,EACtCJ,EAAAA,EAAAA,GAAC+1B,EAAAA,EAAY,KACb/1B,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,mBAMtBkmB,EAAqB1C,EAAAA,GAAc6B,WAClC7zB,EAAAA,EAAAA,GAACunB,EAAAA,IAAkB,CAACnd,MAAO4nB,EAAAA,GAAc6B,QAAQzzB,UAC/CC,EAAAA,EAAAA,IAAA,OAAKM,IAAKgB,GAAOm0B,gBAAgBnzB,GAAOvC,SAAA,EACtCJ,EAAAA,EAAAA,GAACg2B,EAAAA,EAAgB,KACjBh2B,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,uBAMtBkmB,EAAqB1C,EAAAA,GAAcY,QAClC5yB,EAAAA,EAAAA,GAACunB,EAAAA,IAAkB,CAACnd,MAAO4nB,EAAAA,GAAcY,KAAKxyB,UAC5CC,EAAAA,EAAAA,IAAA,OAAKM,IAAKgB,GAAOm0B,gBAAgBnzB,GAAOvC,SAAA,EACtCJ,EAAAA,EAAAA,GAACi2B,EAAAA,EAAa,KACdj2B,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,oBAMtBkmB,EAAqB1C,EAAAA,GAAca,YAClC7yB,EAAAA,EAAAA,GAACunB,EAAAA,IAAkB,CAACnd,MAAO4nB,EAAAA,GAAca,SAASzyB,UAChDC,EAAAA,EAAAA,IAAA,OAAKM,IAAKgB,GAAOm0B,gBAAgBnzB,GAAOvC,SAAA,EACtCJ,EAAAA,EAAAA,GAACk2B,EAAAA,EAAiB,KAClBl2B,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,8BAMtBkmB,EAAqB1C,EAAAA,GAAcO,WAClCvyB,EAAAA,EAAAA,GAACunB,EAAAA,IAAkB,CAACnd,MAAO4nB,EAAAA,GAAcO,QAAQnyB,UAC/CC,EAAAA,EAAAA,IAAA,OAAKM,IAAKgB,GAAOm0B,gBAAgBnzB,GAAOvC,SAAA,EACtCJ,EAAAA,EAAAA,GAACm2B,EAAAA,EAAgB,KACjBn2B,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,wBAMtB4nB,EAAAA,EAAAA,OAAsC1B,EAAqB1C,EAAAA,GAAc+B,cACxE/zB,EAAAA,EAAAA,GAACunB,EAAAA,IAAkB,CAACnd,MAAO4nB,EAAAA,GAAc+B,WAAW3zB,UAClDC,EAAAA,EAAAA,IAAA,OAAKM,IAAKgB,GAAOm0B,gBAAgBnzB,GAAOvC,SAAA,EACtCJ,EAAAA,EAAAA,GAACq2B,EAAAA,EAAmB,KACpBr2B,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,0BAMtB8nB,EAAAA,EAAAA,OAAiC5B,EAAqB1C,EAAAA,GAAcoC,SACnEp0B,EAAAA,EAAAA,GAACunB,EAAAA,IAAkB,CAACnd,MAAO4nB,EAAAA,GAAcoC,MAAMh0B,UAC7CC,EAAAA,EAAAA,IAAA,OAAKM,IAAKgB,GAAOm0B,gBAAgBnzB,GAAOvC,SAAA,EACtCJ,EAAAA,EAAAA,GAACu2B,EAAAA,EAAc,KACfv2B,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,0BAvPI/L,EAgQAoyB,EAAiBpyB,KA/PpDA,IAASuvB,EAAAA,GAAcC,KAEvBjyB,EAAAA,EAAAA,GAAC2f,EAA2B,CAC1BnB,cAAeA,EACfrI,MAAO0e,EACPjV,cAAekV,IAIjBryB,IAASuvB,EAAAA,GAAcO,SAEvBvyB,EAAAA,EAAAA,GAACkuB,GAA+B,CAC9B1P,cAAeA,EACfC,aAAcA,EACdtI,MAAO0e,EACPjV,cAAekV,IAIjBryB,IAASuvB,EAAAA,GAAcY,MAEvB5yB,EAAAA,EAAAA,GAACgkB,EAA4B,CAC3BxF,cAAeA,EACfrI,MAAO0e,EACPjV,cAAekV,IAIjBryB,IAASuvB,EAAAA,GAAca,UAEvB7yB,EAAAA,EAAAA,GAACmgB,EAAgC,CAC/B3B,cAAeA,EACfC,aAAcA,EACdtI,MAAO0e,EACPjV,cAAekV,IAIjBryB,IAASuvB,EAAAA,GAAc6B,SAEvB7zB,EAAAA,EAAAA,GAACivB,GAA+B,CAC9BzQ,cAAeA,EACfC,aAAcA,EACdtI,MAAO0e,EACPjV,cAAekV,KAIjBsB,EAAAA,EAAAA,OAAsC3zB,IAASuvB,EAAAA,GAAc+B,YAE7D/zB,EAAAA,EAAAA,GAACkvB,GAAkC,CACjC1Q,cAAeA,EACfC,aAAcA,EACdtI,MAAO0e,EACPjV,cAAekV,EACf5K,QAASA,KAIXoM,EAAAA,EAAAA,OAAiC7zB,IAASuvB,EAAAA,GAAcoC,OAExDp0B,EAAAA,EAAAA,GAACowB,GAA6B,CAC5BpG,YAAaA,EACbqG,aAAcA,EACdla,MAAO0e,EACPjV,cAAekV,IAId,UA4LH90B,EAAAA,EAAAA,GAAA,OAAKW,IAAGoO,GAAoC3O,UAC1CJ,EAAAA,EAAAA,GAACw2B,EAAAA,EAAwB,CAACC,YAAa,CAAEC,KAAMlC,GAAgBmC,UAAWC,GAAAA,EAAuBC,WAAS,EAAAz2B,UACxGJ,EAAAA,EAAAA,GAAA,OACEW,IAAGqO,GAKD5O,SAjMkBqC,KAC9B,IAAKA,EACH,OAAO,KAET,MAAMq0B,EAAmB/E,GAAqBtvB,GAC9C,OAAKq0B,GAIH92B,EAAAA,EAAAA,GAAC82B,EAAgB,CACf9M,YAAaA,EACbC,WAAY4K,EACZ3K,QAASA,EACT8J,cAAec,EACf3K,sBAAuBA,IARlB,IASL,EAoLO4M,CAAuBlC,EAAiBpyB,iBA5QZA,KAiR/B,EAINd,GAAS,CACbm0B,gBAAkBnzB,IAAY,CAE1BoB,QAAS,OACTyE,oBAAqB,GAAG7F,EAAMW,QAAQ0zB,SAAWr0B,EAAMgN,QAAQqC,WAC/D1J,IAAK3F,EAAMgN,QAAQqC,GACnBhO,WAAY,WAEhBizB,MAAO,CAELlzB,QAAS,OACTyE,oBAAqB,WACrB0E,aAAc,I,2LK3ZlB,MAAMgqB,GAAsCC,EAAAA,EAAAA,eAIzC,CACDC,gBAAiB,GACjBC,cAAe,GACftxB,WAAYA,KAAM,IAGduxB,GAAwCH,EAAAA,EAAAA,eAM3C,CACDI,mBAAoBA,OACpBC,iBAAkBA,OAClBC,kBAAmBA,OACnBC,gBAAiBA,OACjBC,YAAaA,SAGFC,EAAyCA,KAAMC,EAAAA,EAAAA,YAAWX,GAC1DY,EAA2CA,KAAMD,EAAAA,EAAAA,YAAWP,GAE5DS,EAA8C/8B,IAMpD,IANqD,SAC1DoF,EAAQ,kBACR43B,EAAoB,IAIrBh9B,EAEC,KAAKi9B,EAAAA,EAAAA,MACH,OAAOj4B,EAAAA,EAAAA,GAACyG,EAAAA,EAAmB,CAAArG,SAAEA,IAI/B,MAAOg3B,EAAiBG,IAAsB1wB,EAAAA,EAAAA,UAAwB,OAC/DqxB,EAAmBC,IAAwBtxB,EAAAA,EAAAA,UAAwB,MAGpEuxB,GAA2BrzB,EAAAA,EAAAA,QAAsB,MACjDszB,GAA2BtzB,EAAAA,EAAAA,QAAsB,MACvDqzB,EAAyBpzB,QAAUoyB,EACnCiB,EAAyBrzB,QAAUkzB,EAGnC,MAAMI,GAAsBvzB,EAAAA,EAAAA,QAAsB,MAE5C0yB,GAAoB3X,EAAAA,EAAAA,cAAayY,IACrCD,EAAoBtzB,QAAUuzB,CAAG,GAChC,IAEGxyB,GAAa+Z,EAAAA,EAAAA,cAAY,IAA2C,OAArCsY,EAAyBpzB,SAAkB,IAE1EwzB,GAAsBC,EAAAA,EAAAA,MAGtBd,GAAc7X,EAAAA,EAAAA,cAClB,CAAC4Y,EAAyBC,KACxBH,GAAqBxzB,IAAa,IAAD4zB,EAC/B,MAAMC,EAAyC,QAA3BD,EAAG5zB,EAAQ8zB,wBAAgB,IAAAF,OAAA,EAAxBA,EAA0B9gB,QAEjD,IAAK+gB,EACH,OAAO7zB,EAGT,MAAM+zB,EAAcF,EAAeG,WAAWC,GAAMA,EAAEvM,OAASgM,IACzDQ,EAAcL,EAAeG,WAAWC,GAAMA,EAAEvM,OAASiM,IAG/D,GAAII,EAAc,GAAKG,EAAc,EACnC,OAAOl0B,EAGT,MAAMm0B,EAAcN,EAAeE,GAMnC,OAHAF,EAAetW,OAAOwW,EAAa,GACnCF,EAAetW,OAAO2W,EAAa,EAAGC,GAE/B,IAAKn0B,EAAS8zB,iBAAkBD,EAAgB,GACvD,GAEJ,CAACL,IAIGd,GAAkB5X,EAAAA,EAAAA,cAAY,KAClC,MAAMsZ,EAAmBhB,EAAyBpzB,QAC5Cq0B,EAAkBhB,EAAyBrzB,QAC3Cs0B,EAAiBhB,EAAoBtzB,QAElB,OAArBo0B,GAAiD,OAApBC,GAA+C,OAAnBC,IAI7D/B,EAAmB,MAEnBiB,GAAqBxzB,IAAa,IAADu0B,EAAAC,EAAAC,EAAAC,EAE/B,MAAMC,EAAqC,QAA3BJ,EAAGv0B,EAAQ8zB,wBAAgB,IAAAS,OAAA,EAAxBA,EAA0BvmB,MAAM4mB,GAAUA,EAAMlN,OAAS0M,IAC5E,IAAKO,EACH,OAAO30B,EAGT,MAAM60B,EAA0C,QAA7BL,EAAGx0B,EAAQ80B,0BAAkB,IAAAN,OAAA,EAA1BA,EAA4BxmB,MAAM+mB,GAAYA,EAAQrN,QAAmB,OAAViN,QAAU,IAAVA,OAAU,EAAVA,EAAYK,mBAG3F3C,EAA0C,QAA7BoC,EAAGz0B,EAAQ80B,0BAAkB,IAAAL,OAAA,EAA1BA,EAA4BzmB,MAAM+mB,GAAYA,EAAQrN,OAAS2M,IAG/EY,EAA6C,QAA3BP,EAAG10B,EAAQ8zB,wBAAgB,IAAAY,OAAA,EAAxBA,EAA0B/rB,QAClDusB,GAAcA,EAAUF,mBAAiC,OAAbH,QAAa,IAAbA,OAAa,EAAbA,EAAenN,QAI9D,GAAImN,IAAkBxC,EAAe,CAAC,IAAD8C,EAEnC,MAAMC,EAA2C,QAA3BD,EAAGn1B,EAAQ8zB,wBAAgB,IAAAqB,OAAA,EAAxBA,EAA0BriB,QAG7CuiB,EAAwC,OAAlBJ,QAAkB,IAAlBA,OAAkB,EAAlBA,EAAoBtsB,QAAQusB,GAAclC,EAAkB/pB,SAASisB,KAEjG,IAAKE,IAAqBC,EACxB,OAAOr1B,EAIT,MAAMs1B,EAAgBF,EAAiBpB,WAAWkB,GAAcA,EAAUxN,OAAS0M,IAG7EmB,EAAuB3W,KAAKuE,IAAImR,EAAgBe,EAAoB5/B,OAAS,GAG7E+/B,GAAcC,EAAAA,EAAAA,SAAQL,EAAqC,OAAnBC,QAAmB,IAAnBA,OAAmB,EAAnBA,EAAsBE,IAUpE,OAPIH,IAAuC,IAAnBE,IAAyC,IAAjBE,IAE9CJ,EAAiB7X,OAAO+X,EAAe,GAEvCF,EAAiB7X,OAAOiY,EAAa,EAAGb,IAGnC,IACF30B,EACH8zB,iBAAkBsB,EAEtB,CAAO,CAAC,IAADM,EAEL,MAAMC,EAA6C,QAA3BD,EAAG11B,EAAQ8zB,wBAAgB,IAAA4B,OAAA,EAAxBA,EAA0B/sB,QAClDisB,GAAUA,EAAMI,kBAAoBX,IAAoBO,EAAMgB,UAQjE,OAJID,GACFA,EAAmBpY,OAAO+W,EAAgB,EAAGK,GAGxC,IACF30B,EAEH8zB,kBAAkB+B,EAAAA,EAAAA,QAAO71B,EAAQ8zB,kBAAmBtS,IAAC,IAAAsU,EAAA,OAAmC,QAAnCA,EAAuB,OAAlBH,QAAkB,IAAlBA,OAAkB,EAAlBA,EAAoBF,QAAQjU,UAAE,IAAAsU,EAAAA,GAAK,CAAC,IAAElsB,KAC7FgrB,GAEKA,EAAMlN,OAASiN,EAAWjN,KACrB,IACFkN,EACHI,gBAAiBX,GAGdO,IAIf,KACA,GACD,CAACpB,EAAqBR,IAInB+C,GAAoBhuB,EAAAA,EAAAA,UACxB,MACEqqB,kBACAC,cAAea,EACfnyB,gBAEF,CAACqxB,EAAiBc,EAAmBnyB,IAGjCi1B,GAAsBjuB,EAAAA,EAAAA,UAC1B,MACEwqB,qBACAC,iBAAkBW,EAClBV,oBACAC,kBACAC,iBAEF,CAACD,EAAiBC,EAAaF,IAGjC,OACEz3B,EAAAA,EAAAA,GAACyG,EAAAA,EAAmB,CAAArG,UAClBJ,EAAAA,EAAAA,GAACk3B,EAAoC5gB,SAAQ,CAAClM,MAAO2wB,EAAkB36B,UACrEJ,EAAAA,EAAAA,GAACs3B,EAAsChhB,SAAQ,CAAClM,MAAO4wB,EAAoB56B,SACxEA,OAGe,C,4KCtNnB,MAAM66B,EAAwBjgC,IAA8D,IAA7D,mBAAEkgC,GAAqDlgC,EAC3F,MAAMw9B,GAAsBC,EAAAA,EAAAA,OACtB,MAAE91B,IAAUC,EAAAA,EAAAA,MAEXu4B,EAAYC,IAAiBv0B,EAAAA,EAAAA,WAAS,IAAwB,OAAlBq0B,QAAkB,IAAlBA,EAAAA,EAAsB,MAClEG,EAAWC,IAAgBz0B,EAAAA,EAAAA,WAAS,IAErC,cAAEmU,IAAkB0D,EAAAA,EAAAA,KAEpB6c,GAAoBzb,EAAAA,EAAAA,cACvB1V,IACCouB,GAAqBxzB,IAAO,IACvBA,EACHk2B,mBAAoB9wB,MAEtBkxB,GAAa,EAAM,GAErB,CAAC9C,IAGGgD,GAA6BC,EAAAA,EAAAA,IAAqBF,EAAmB,KAE3E,OACEv7B,EAAAA,EAAAA,GAACyd,EAAAA,EAAK,CACJlb,YAAY,4GACZm5B,KAAK,YACLC,QACE37B,EAAAA,EAAAA,GAAA,OAAKW,KAAGC,EAAAA,EAAAA,IAAE,CAAEvF,MAAOsH,EAAMW,QAAQs4B,aAAcj4B,WAAY,GAAG,IAACvD,SAC5Di7B,GAAYr7B,EAAAA,EAAAA,GAAC67B,EAAAA,EAAO,CAACrnB,KAAK,WAAaxU,EAAAA,EAAAA,GAAC87B,EAAAA,IAAU,MAGvD1xB,MAAO+wB,EACPY,YAAU,EACVzuB,SAAW/S,IACT6gC,EAAc7gC,EAAEuQ,OAAOV,OACvBkxB,GAAa,GACbE,EAA2BjhC,EAAEuQ,OAAOV,MAAM,EAE5C2F,YAAaiL,EAAc,CAAArf,GAAA,SACzB6S,eAAe,0BAGjB,C,2IC3CkD,IAAA3M,EAAA,CAAAH,KAAA,UAAAC,OAAA,sCAIjD,MAAMq6B,EAA4BhhC,IAoBlC,IApB8C,UACnDgyB,EAAS,uBACTiP,GAAyB,EAAK,QAC9B/R,EAAO,gBACPgS,EAAe,SACfhiB,EAAQ,oBACRiiB,EAAmB,iBACnBC,EAAgB,mBAChB3kB,EAAkB,sBAClB0S,GAWDnvB,EACC,MAAM,MAAE2H,EAAK,qBAAE05B,IAAyBz5B,EAAAA,EAAAA,KAiBxC,OAAKs5B,GAKHl8B,EAAAA,EAAAA,GAAC4Z,EAAAA,EAAK,CACJrX,YAAY,gHACZsX,SAAO,EACPK,SAAUA,EACVhf,OACEmF,EAAAA,EAAAA,IAAA,OAAKM,IAAGkB,EAA+CzB,SAAA,CACpD87B,EAAgBhhC,OACjB8E,EAAAA,EAAAA,GAAA,QACEW,KAAGC,EAAAA,EAAAA,IAAE,CACHwD,MAAOzB,EAAMuB,OAAOI,cACpB8L,SAAUzN,EAAMiB,WAAWkO,WAC3BiC,YAAapR,EAAMgN,QAAQqC,IAC5B,IAAC5R,SAED87B,EAAgBI,cAIvBhoB,OAAQ,KACRioB,eAAe,YACfzd,wBAAyB,CAAEzjB,MAAO,OAClCsF,KAAGC,EAAAA,EAAAA,IAAE,CACH,CAAC,IAAIy7B,EAAqB,iBAAkB,CAC1CG,KAAM,IAET,IAACp8B,UAEFJ,EAAAA,EAAAA,GAACw2B,EAAAA,EAAwB,CAACC,YAAa0F,EAAqBxF,UAAWyF,EAAiBh8B,UACtFJ,EAAAA,EAAAA,GAACy8B,EAAAA,EAAc,CACbxS,WAAYiS,EAAgBvZ,OAC5B6R,aAAcxH,EACd9C,QAASA,EACTvR,MAAO,EACP+jB,aAAc,EACdC,YAAU,EACVllB,mBAAoBA,EACpB0S,sBAAuBA,EA/C7ByS,cAAeA,OACfC,gBAAiBA,OACjBC,iBAAkBA,OAClBC,mBAAoBA,OAXpBC,aAAa,EACbC,WAAW,EACXC,WAAYA,OACZC,SAAUA,OACVC,cAAeA,aAWR,IA6CC,C,qLCvF2C,IAAAv7B,EAAA,CAAAH,KAAA,UAAAC,OAAA,mBAAAF,EAAA,CAAAC,KAAA,UAAAC,OAAA,wBAAA6E,EAAA,CAAA9E,KAAA,SAAAC,OAAA,kCAGhD,MAAM07B,EAAwCriC,IAQ9C,IAR+C,sBACpDmvB,EAAqB,cACrB3L,EAAa,cACb8e,GAKDtiC,EACC,MAAM,MAAE2H,IAAUC,EAAAA,EAAAA,KACZmY,GAAO2D,EAAAA,EAAAA,MACP,eAAE0H,EAAc,uBAAE7C,EAAsB,SAAEzB,GAAaqI,GAAyB,CAAC,EAEjFoT,GAAgCzd,EAAAA,EAAAA,cACnC0d,GACCF,GAAennB,IAAK,IACfA,EACHgU,sBAAuB,IAClBhU,EAAMgU,yBACNqT,QAGT,CAACF,IAGGG,EAA2B3b,IAAaC,EAAAA,GAA6BC,OAErExE,EAAQzC,EAAKC,cAAc,CAAArf,GAAA,SAC/B6S,eAAe,qBAIjB,OACEnO,EAAAA,EAAAA,IAACq9B,EAAAA,IAAajqB,KAAI,CAACkqB,OAAO,EAAMv9B,SAAA,EAC9BJ,EAAAA,EAAAA,GAACwnB,EAAAA,EAAO,CACNjlB,YAAY,4HACZklB,QAASjK,EAAMpd,UAEfJ,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaE,QAAO,CAACC,SAAO,EAAAz9B,UAC3BJ,EAAAA,EAAAA,GAACiD,EAAAA,EAAM,CACLV,YAAY,qDACZL,MAAMlC,EAAAA,EAAAA,GAAC89B,EAAAA,IAAQ,IACf,aAAYtgB,SAIlBnd,EAAAA,EAAAA,IAACq9B,EAAAA,IAAa9pB,QAAO,CAACmqB,MAAM,MAAMp9B,IAAGkB,EAAoBzB,SAAA,EACvDC,EAAAA,EAAAA,IAACq9B,EAAAA,IAAa1a,MAAK,CACjB0Y,KAAK,SACL,aAAY3gB,EAAKC,cAAc,CAAArf,GAAA,SAC7B6S,eAAe,WAGdpO,SAAA,EAEHJ,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaM,MAAK,CAACr9B,IAAGc,EAA8BrB,UACnDJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,cAInBnO,EAAAA,EAAAA,IAACq9B,EAAAA,IAAaO,aAAY,CACxB17B,YAAY,4HACZ8lB,QAASvG,IAAaC,EAAAA,GAA6BoF,KACnDllB,QAASA,IAAMs7B,EAA8B,CAAEzb,SAAUC,EAAAA,GAA6BoF,OAAQ/mB,SAAA,EAE9FJ,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaQ,cAAa,KAC3Bl+B,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,aAInBnO,EAAAA,EAAAA,IAACq9B,EAAAA,IAAaO,aAAY,CACxB17B,YAAY,4HACZ8lB,QAASvG,IAAaC,EAAAA,GAA6BqF,KACnDnlB,QAASA,IAAMs7B,EAA8B,CAAEzb,SAAUC,EAAAA,GAA6BqF,OAAQhnB,SAAA,EAE9FJ,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaQ,cAAa,KAC3Bl+B,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,oBAInBnO,EAAAA,EAAAA,IAACq9B,EAAAA,IAAaO,aAAY,CACxB17B,YAAY,4HACZ8lB,QAASvG,IAAaC,EAAAA,GAA6BsF,cACnDplB,QAASA,IAAMs7B,EAA8B,CAAEzb,SAAUC,EAAAA,GAA6BsF,gBAAiBjnB,SAAA,EAEvGJ,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaQ,cAAa,KAC3Bl+B,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,wBAInBnO,EAAAA,EAAAA,IAACq9B,EAAAA,IAAaS,IAAG,CAAA/9B,SAAA,EACfC,EAAAA,EAAAA,IAACq9B,EAAAA,IAAaU,WAAU,CACtBz9B,KAAGC,EAAAA,EAAAA,IAAE,CACHgU,YAAajS,EAAMgN,QAAQqC,GAAKrP,EAAMgN,QAAQC,IAC/C,IAACxP,SAAA,EAEFJ,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaW,YAAW,CAAAj+B,UACvBJ,EAAAA,EAAAA,GAACs+B,EAAAA,EAAS,CACR39B,KAAGC,EAAAA,EAAAA,IAAE,CACH29B,WAAYd,EAA2B,UAAY,UACpD,SAGLz9B,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,eAInBxO,EAAAA,EAAAA,GAAC09B,EAAAA,IAAac,WAAU,CAAC79B,IAAG6F,EAAuCpG,SAChEoe,EAAc5P,KAAKmR,IAClB1f,EAAAA,EAAAA,IAACq9B,EAAAA,IAAaO,aAAY,CACxB17B,YAAY,6HAEZ8lB,QAAS9E,IAA2BxD,GAAa0d,EACjDx7B,QAASA,IACPs7B,EAA8B,CAC5Bzb,SAAUC,EAAAA,GAA6BC,OACvCuB,uBAAwBxD,IAE3B3f,SAAA,EAEDJ,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaQ,cAAa,IAC1Bne,IAVIA,cAgBf1f,EAAAA,EAAAA,IAACq9B,EAAAA,IAAa1a,MAAK,CACjB0Y,KAAK,SACL,aAAY3gB,EAAKC,cAAc,CAAArf,GAAA,SAC7B6S,eAAe,mBAGdpO,SAAA,EAEHJ,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaM,MAAK,CAAA59B,UACjBJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,sBAKnBxO,EAAAA,EAAAA,GAAA,OAAKW,KAAGC,EAAAA,EAAAA,IAAE,CAAEH,QAASkC,EAAMgN,QAAQC,IAAI,IAACxP,UACtCJ,EAAAA,EAAAA,GAACkpB,EAAAA,EAAgB,CACff,IAAK,EACLF,IAAK,IACL3a,SAAW8Y,GAAmBmX,EAA8B,CAAEnX,mBAC9D+C,aAAc/C,GAAkC,cAKtC,C,sJCjKjB,MAAMqY,EAAiCA,KAC5C,MAAMnB,GAAgB/mB,EAAAA,EAAAA,MAChB,MAAE5T,IAAUC,EAAAA,EAAAA,KAEZ87B,GAAkB5e,EAAAA,EAAAA,cAAY,KAClCwd,GAAennB,IAAK,IAAWA,EAAOuoB,iBAAiB,KAAQ,GAC9D,CAACpB,IAEJ,OACEt9B,EAAAA,EAAAA,GAAA,OACEW,KAAGC,EAAAA,EAAAA,IAAE,CACH47B,KAAM,EACNz4B,QAAS,OACTC,WAAY,SACZC,eAAgB,SAChB2Q,YAAajS,EAAMgN,QAAQa,GAC3BmuB,aAAch8B,EAAMgN,QAAQa,IAC7B,IAACpQ,UAEFJ,EAAAA,EAAAA,GAACyzB,EAAAA,IAAK,CACJC,aACE1zB,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,+GAEfmD,OAAQ,CACNitB,KAAOC,IACL7+B,EAAAA,EAAAA,GAACqQ,EAAAA,EAAW4B,KAAI,CACd1P,YAAY,qHACZN,QAASy8B,EAAgBt+B,SAExBy+B,OAMXlL,OAAO3zB,EAAAA,EAAAA,GAAC4zB,EAAAA,IAAM,OAEZ,C,kOCGV,MAoGMkL,EAA2BA,CAC/B7U,EACA8U,EACAC,KACI,IAADC,EAAAC,EACH,MAAQnf,UAAWof,EAAmB,SAAErd,GAAamI,EAC/ClK,GAAqB,OAATif,QAAS,IAATA,GAAuB,QAAdC,EAATD,EAAWI,oBAAY,IAAAH,OAAd,EAATA,EAAyBx5B,MAAO05B,EAI5CE,EAA+B,QAApBH,EAAY,OAATF,QAAS,IAATA,OAAS,EAATA,EAAWM,cAAM,IAAAJ,EAAAA,EAAa,OAATH,QAAS,IAATA,OAAS,EAATA,EAAWQ,QAAQxf,GAAW3V,MAEvE,IAAIo1B,EAAAA,EAAAA,OAAMH,GACR,OAAO,KAGT,MAAMI,EAhCiBC,EACvBV,EACAld,KAEuD,IAAD6d,EAI6CC,EAfrDx1B,EAW9C,OAAI0X,IAAaC,EAAAA,GAA6BC,OACpB,QAAxB2d,EAAgB,OAATX,QAAS,IAATA,OAAS,EAATA,EAAWS,cAAM,IAAAE,EAAAA,EAAI,IAG1BE,EAAAA,EAAAA,OAAsC/d,IAAaC,EAAAA,GAA6BsF,cAd/D,kBADyBjd,EAgBmB,QAAlBw1B,EAAU,OAATZ,QAAS,IAATA,OAAS,EAATA,EAAWS,cAAM,IAAAG,EAAAA,EAAI,IAd5Dx1B,EAEFA,EAAM4N,MAAM,KAAK,IAAM,WAgBd,OAATgnB,QAAS,IAATA,OAAS,EAATA,EAAWS,MAAM,EAmBTC,CAAiBV,EAAWld,GAC3C,OACEzhB,EAAAA,EAAAA,IAAAC,EAAAA,GAAA,CAAAF,SAAA,CACG4+B,IACC3+B,EAAAA,EAAAA,IAAA,OAAKM,IAAKgB,EAAOyI,MAAMhK,SAAA,EACrBC,EAAAA,EAAAA,IAAA,UAAAD,SAAA,CAAS4+B,EAAUxhB,MAAM,OAAU,IAAEiiB,MAGzCp/B,EAAAA,EAAAA,IAAA,OAAKM,IAAKgB,EAAOyI,MAAMhK,SAAA,EACrBC,EAAAA,EAAAA,IAAA,UAAAD,SAAA,CAAS2f,EAAU,OAAU,IAAEsf,OAEhC,EAwDDS,EAAY9kC,IAUX,IAVY,UACjB+jC,EAAS,WACT9U,EAAU,WACV8V,EAAU,UACVf,GAMDhkC,EACC,OAAIivB,EAAWxnB,OAASuvB,EAAAA,GAAcC,IAlMR+N,EAAC/V,EAAqC8U,KAAkC,IAADkB,EAAAC,EACrG,MAAM,UAAEngB,GAAckK,EAChBhL,EAAkB,OAAT8f,QAAS,IAATA,OAAS,EAATA,EAAWQ,QAAQxf,GAElC,IAAKd,EACH,OAAO,KAGT,MAAMkhB,EAA0BC,EAAAA,EAAyBnhB,EAAOxZ,KAC1D46B,EAAkD,QAAvCJ,EAA0B,OAAvBE,QAAuB,IAAvBA,OAAuB,EAAvBA,EAAyBE,mBAAW,IAAAJ,EAAAA,EAAIhhB,EAAOxZ,IAC7D66B,EAA+E,QAAnEJ,EAA0B,OAAvBC,QAAuB,IAAvBA,OAAuB,EAAvBA,EAAyBI,eAAe,CAAEn2B,MAAO6U,EAAO7U,eAAQ,IAAA81B,EAAAA,EAAIjhB,EAAO7U,MAEhG,OACE/J,EAAAA,EAAAA,IAAA,OAAKM,IAAKgB,EAAOyI,MAAMhK,SAAA,EACrBC,EAAAA,EAAAA,IAAA,UAAAD,SAAA,CAASigC,EAAY,OAAU,IAAEC,IAC7B,EAoLCN,CAAwB/V,EAAuC8U,GAGpE9U,EAAWxnB,OAASuvB,EAAAA,GAAc6B,QAnLJ2M,EAACvW,EAAyC8U,KAAkC,IAAD0B,EAAAC,EAAAC,EAAAC,EAC7G,MAAM,MAAE/R,EAAK,MAAEC,GAAU7E,EACnB4W,EAAOhS,EAAMppB,IACbq7B,EAAOhS,EAAMrpB,IAEbg6B,EAAwB,WAAf5Q,EAAMpsB,KAA2C,QAA1Bg+B,EAAG1B,EAAUQ,QAAQsB,UAAK,IAAAJ,OAAA,EAAvBA,EAAyBr2B,MAA8B,QAAzBs2B,EAAG3B,EAAUtoB,OAAOoqB,UAAK,IAAAH,OAAA,EAAtBA,EAAwBt2B,MAE5Fk1B,EAAwB,WAAfxQ,EAAMrsB,KAA2C,QAA1Bk+B,EAAG5B,EAAUQ,QAAQuB,UAAK,IAAAH,OAAA,EAAvBA,EAAyBv2B,MAA8B,QAAzBw2B,EAAG7B,EAAUtoB,OAAOqqB,UAAK,IAAAF,OAAA,EAAtBA,EAAwBx2B,MAElG,OACE/J,EAAAA,EAAAA,IAAAC,EAAAA,GAAA,CAAAF,SAAA,CACGq/B,IACCp/B,EAAAA,EAAAA,IAAA,OAAKM,IAAKgB,EAAOyI,MAAMhK,SAAA,EACrBC,EAAAA,EAAAA,IAAA,UAAAD,SAAA,CAAQ,MAAIygC,EAAK,QAAW,IAAEpB,KAGjCH,IACCj/B,EAAAA,EAAAA,IAAA,OAAKM,IAAKgB,EAAOyI,MAAMhK,SAAA,EACrBC,EAAAA,EAAAA,IAAA,UAAAD,SAAA,CAAQ,MAAI0gC,EAAK,QAAW,IAAExB,OAGjC,EA+JIkB,CAA4BvW,EAA2C8U,GAG5E9U,EAAWxnB,OAASuvB,EAAAA,GAAcO,QA9JJwO,EAAC9W,EAAyC8U,KAAkC,IAADiC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAC7G,MAAM,MAAExS,EAAK,MAAEC,EAAK,MAAEC,GAAU9E,EAC1B4W,EAAOhS,EAAMppB,IACbq7B,EAAOhS,EAAMrpB,IACb67B,EAAOvS,EAAMtpB,IAEbg6B,EAAwB,WAAf5Q,EAAMpsB,KAA2C,QAA1Bu+B,EAAGjC,EAAUQ,QAAQsB,UAAK,IAAAG,OAAA,EAAvBA,EAAyB52B,MAA8B,QAAzB62B,EAAGlC,EAAUtoB,OAAOoqB,UAAK,IAAAI,OAAA,EAAtBA,EAAwB72B,MAE5Fk1B,EAAwB,WAAfxQ,EAAMrsB,KAA2C,QAA1By+B,EAAGnC,EAAUQ,QAAQuB,UAAK,IAAAI,OAAA,EAAvBA,EAAyB92B,MAA8B,QAAzB+2B,EAAGpC,EAAUtoB,OAAOqqB,UAAK,IAAAK,OAAA,EAAtBA,EAAwB/2B,MAE5Fm3B,EAAwB,WAAfxS,EAAMtsB,KAA2C,QAA1B2+B,EAAGrC,EAAUQ,QAAQ+B,UAAK,IAAAF,OAAA,EAAvBA,EAAyBh3B,MAA8B,QAAzBi3B,EAAGtC,EAAUtoB,OAAO6qB,UAAK,IAAAD,OAAA,EAAtBA,EAAwBj3B,MAElG,OACE/J,EAAAA,EAAAA,IAAAC,EAAAA,GAAA,CAAAF,SAAA,CACGq/B,IACCp/B,EAAAA,EAAAA,IAAA,OAAKM,IAAKgB,EAAOyI,MAAMhK,SAAA,EACrBC,EAAAA,EAAAA,IAAA,UAAAD,SAAA,CAAQ,MAAIygC,EAAK,QAAW,IAAEpB,KAGjCH,IACCj/B,EAAAA,EAAAA,IAAA,OAAKM,IAAKgB,EAAOyI,MAAMhK,SAAA,EACrBC,EAAAA,EAAAA,IAAA,UAAAD,SAAA,CAAQ,MAAI0gC,EAAK,QAAW,IAAExB,KAGjCiC,IACClhC,EAAAA,EAAAA,IAAA,OAAKM,IAAKgB,EAAOyI,MAAMhK,SAAA,EACrBC,EAAAA,EAAAA,IAAA,UAAAD,SAAA,CAAQ,MAAIkhC,EAAK,QAAW,IAAEC,OAGjC,EAkIIR,CAA4B9W,EAA2C8U,GAG5E9U,EAAWxnB,OAASuvB,EAAAA,GAAcY,KAC7BkM,EAAyB7U,EAAwC8U,EAAWC,GAGjF/U,EAAWxnB,OAASuvB,EAAAA,GAAca,SA/EH2O,EACnCvX,EACA8U,EACAgB,KAEA,MAAM,eAAE1f,EAAc,gBAAEE,GAAoB0J,EACtCwX,EAAaphB,EAAezR,KAAKqkB,IACrC,MAAM7T,EAAiB,OAAT2f,QAAS,IAATA,OAAS,EAATA,EAAWtoB,OAAOwc,GAChC,OAAI7T,IAEA/e,EAAAA,EAAAA,IAAA,OAAAD,SAAA,EACEC,EAAAA,EAAAA,IAAA,UAAAD,SAAA,CAASgf,EAAM3Z,IAAI,OAAU,IAAE2Z,EAAMhV,QAD7B6oB,EAKH,IAEPyO,EAAcnhB,EAAgB3R,KAAKmR,IACvC,MAAMd,EAAkB,OAAT8f,QAAS,IAATA,OAAS,EAATA,EAAWQ,QAAQxf,GAClC,OAAId,IAEA5e,EAAAA,EAAAA,IAAA,OAAAD,SAAA,EACEC,EAAAA,EAAAA,IAAA,UAAAD,SAAA,CAAS6e,EAAOxZ,IAAI,OAAU,IAAEwZ,EAAO7U,QAD/B2V,EAKH,IAIb,OAAIggB,GAEA1/B,EAAAA,EAAAA,IAAAC,EAAAA,GAAA,CAAAF,SAAA,CACGqhC,EAAW3pB,MAAM,EAAG,IACnB2pB,EAAWhnC,OAAS,GAAKinC,EAAYjnC,OAAS,KAAMuF,EAAAA,EAAAA,GAAA,OAAAI,SAAK,QAC1DshC,EAAYA,EAAYjnC,OAAS,OAKpC4F,EAAAA,EAAAA,IAAAC,EAAAA,GAAA,CAAAF,SAAA,CACGqhC,EACAC,IAGP,EAmCSF,CAA6BvX,EAA4C8U,EAAWgB,GAGtF,IAAI,EAGAnJ,EAAwB/0B,IAY9B,IAZ+B,iBACpC8/B,EAAgB,YAChBlL,EAAW,UACXuI,EAAS,UACThS,EAAS,QACT7Y,EAAO,WACP4rB,EAAU,KACVtf,GAKD5e,EACC,MAAM,KAAE60B,EAAI,YAAEkL,EAAW,UAAEC,GAAcpL,GAClCljB,IAAgBiD,EAAAA,EAAAA,KACjBuoB,EAAgB,OAAJrI,QAAI,IAAJA,OAAI,EAAJA,EAAM1jB,MAAMqZ,GAAQA,EAAIK,OAASvY,IAEnD,IACE2tB,EAAAA,EAAAA,IAAgC9C,IAChCve,IAAS2M,EAAAA,GAAsBC,4BAC/B0S,EAEA,OAAO//B,EAAAA,EAAAA,GAAC+hC,EAAAA,EAA6B,CAAC/C,UAAWA,IAGnD,MAAMgD,GAAuBF,EAAAA,EAAAA,IAAgC9C,GAAaA,EAAUiD,iBAAmBjD,EAEvG,IAAKD,EACH,OAAO,KAGT,MAAM1qB,EAAU0qB,EAAUsB,aAAetB,EAAUrS,KAC7CwV,EAAmC,OAApBF,QAAoB,IAApBA,GAAAA,EAAsB5C,aAAe,KAAK4C,EAAqB5C,aAAa35B,OAAS,GAE1G,OACEpF,EAAAA,EAAAA,IAAA,OAAAD,SAAA,EACEC,EAAAA,EAAAA,IAAA,OAAKM,IAAKgB,EAAOwgC,eAAe/hC,SAAA,EAC9BC,EAAAA,EAAAA,IAAA,OAAKM,IAAKgB,EAAOygC,OAAOhiC,SAAA,EACtBJ,EAAAA,EAAAA,GAAA,OAAKW,IAAKgB,EAAO0gC,UAAWnjC,MAAO,CAAEkO,gBAAiB2xB,EAAU36B,SAC/D26B,EAAUvU,iBACTxqB,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWC,KAAI,CAAAlQ,SAAEiU,EAAU6tB,KAE5BliC,EAAAA,EAAAA,GAACiS,EAAAA,GAAI,CACH+B,GAAIC,EAAAA,EAAOC,gBAAgBX,EAAcY,GACzCrJ,OAAO,SACPnK,IAAKgB,EAAOyS,QACZnS,QAAS0/B,EAAiBvhC,SAEzBiU,EAAU6tB,QAIfnC,IACA//B,EAAAA,EAAAA,GAACiD,EAAAA,EAAM,CACLV,YAAY,oGACZiS,KAAK,QACLvS,QAAS0/B,EACTz/B,MAAMlC,EAAAA,EAAAA,GAAC0hB,EAAAA,EAAS,UAKtB1hB,EAAAA,EAAAA,GAAC8/B,EAAS,CACRC,WAAYA,EACZhB,UAAWA,EACX9U,WAAY+C,EACZgS,UAAWgD,KAGb3hC,EAAAA,EAAAA,IAAA,OAAKM,IAAKgB,EAAO2gC,eAAeliC,SAAA,CAC7B2+B,EAAUwD,UAAYX,IACrB5hC,EAAAA,EAAAA,GAACmV,EAAAA,IAAa,CACZja,MACE6jC,EAAUyD,QACRxiC,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,eAIjBxO,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,yBAKrBsZ,UAAU,SAAQ1nB,UAElBJ,EAAAA,EAAAA,GAACiD,EAAAA,EAAM,CACLV,YAAY,oGACZiS,KAAK,QACLvS,QAASA,KACP2/B,EAAYztB,GACZwtB,GAAkB,EAEpBz/B,KAAM68B,EAAUyD,QAASxiC,EAAAA,EAAAA,GAACyiC,EAAAA,IAAW,KAAMziC,EAAAA,EAAAA,GAAC0iC,EAAAA,IAAO,QAIxDb,IACC7hC,EAAAA,EAAAA,GAACmV,EAAAA,IAAa,CACZja,OACE8E,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,0BAInBsZ,UAAU,SAAQ1nB,UAElBJ,EAAAA,EAAAA,GAACiD,EAAAA,EAAM,CACLV,YAAY,oGACZ,cAAY,yDACZiS,KAAK,QACLvS,QAASA,KACP4/B,EAAU1tB,GACVwtB,GAAkB,EAEpBz/B,MAAMlC,EAAAA,EAAAA,GAAC2iC,EAAAA,IAAW,aAKtB,EAIJhhC,EAAS,CACbyS,QAAUzR,IAAY,CACpByB,MAAOzB,EAAMuB,OAAO0+B,QACpB,UAAW,CAAC,IAEdN,eAAgB,CACd5yB,UAAW,EACX3L,QAAS,OACTuE,IAAK,EACLtE,WAAY,UAEdo+B,OAAQ,CACNr+B,QAAS,OACTuE,IAAK,EACLtE,WAAY,UAEdoG,MAAO,CACLyH,WAAY,SACZ1R,SAAU,SACVuV,aAAc,YAEhBysB,eAAgB,CACdp+B,QAAS,OACTuE,IAAK,EACLtE,WAAY,SACZkJ,aAAc,GACdjJ,eAAgB,gBAChB3I,OAAQ,IAEV+mC,UAAW,CAAEhnC,MAAO,GAAIC,OAAQ,GAAIkI,aAAc,Q,4KC5WpD,MAAMq/B,EAAc,CAClBC,aAAa,EACbC,YAAY,EACZC,uBAAwB,CAAC,YAGrBC,EAA0C,CAC9C,CAAC,EAAG,iBACJ,CAAC,IAAM,kBACP,CAAC,GAAK,mBACN,CAAC,GAAK,mBACN,CAAC,GAAK,oBACN,CAAC,EAAG,qBAeOzQ,EAAkBvxB,EAAAA,MAC7BjG,IAkB6B,IAlB5B,SACC8yB,EAAQ,MACR2E,EAAK,MACLC,EAAK,MACLC,EAAK,WACLuQ,EAAa,GAAE,UACf73B,EAAS,aACT83B,EAAY,OACZ9Q,EAAS+Q,EAAAA,GAA6B,WACtCC,EAAaJ,EAAmB,SAChCK,EAAQ,QACRtV,EAAO,UACPC,EAAS,MACT5yB,EAAK,OACLC,EAAM,mBACNyyB,GAAqB,EAAI,gBACzBwV,EAAe,qBACfC,GACqBxoC,EACrB,MAAM,MAAE2H,IAAUC,EAAAA,EAAAA,MAEZ,aAAE6gC,EAAY,YAAEC,EAAW,gBAAEC,EAAe,aAAEC,EAAY,uBAAEC,IAA2BC,EAAAA,EAAAA,MAEvFC,GAAWh3B,EAAAA,EAAAA,UAAQ,KAEvB,MAAMi3B,EAA+B,GAC/BC,EAA+B,GAC/BC,EAA+B,GAC/BhgC,EAA8B,GAC9BigC,EAAuB,GAG7B,IAAK,MAAMtxB,KAAWib,EAAU,CAAC,IAADsW,EAAAC,EAAAC,EAC9B,MAAM,QAAE/E,EAAO,OAAE9oB,EAAM,MAAErS,EAAK,KAAEsoB,EAAI,YAAE2T,GAAgBxtB,EAChD0xB,EAA2B,WAAf9R,EAAMhwB,KAAoB88B,EAAU9oB,EAChD+tB,EAA2B,WAAf9R,EAAMjwB,KAAoB88B,EAAU9oB,EAChDguB,EAA2B,WAAf9R,EAAMlwB,KAAoB88B,EAAU9oB,EAEhD1a,GAAa,OAATwoC,QAAS,IAATA,GAAsB,QAAbH,EAATG,EAAY9R,EAAMhtB,YAAI,IAAA2+B,OAAb,EAATA,EAAwBh6B,aAASjD,EACrCnL,GAAa,OAATwoC,QAAS,IAATA,GAAsB,QAAbH,EAATG,EAAY9R,EAAMjtB,YAAI,IAAA4+B,OAAb,EAATA,EAAwBj6B,aAASjD,EACrCu9B,GAAa,OAATD,QAAS,IAATA,GAAsB,QAAbH,EAATG,EAAY9R,EAAMltB,YAAI,IAAA6+B,OAAb,EAATA,EAAwBl6B,aAASjD,EAEvCpL,GAAKC,GAAK0oC,IACZV,EAAQvpB,KAAK1e,GACbkoC,EAAQxpB,KAAKze,GACbkoC,EAAQzpB,KAAKiqB,GACbxgC,EAAOuW,KAAKrW,GAASzB,EAAMuB,OAAO0+B,SAClCuB,EAAY1pB,KAAK,CAACiS,EAAM2T,GAAe3T,EAAMgY,IAEjD,CAGA,MAAMC,EAAS,CAEb,CACE5oC,EAAGioC,EACHhoC,EAAGioC,EACHW,WAAYT,EACZU,KAAM/W,EAASlf,KAAI/M,IAAA,IAAC,YAAEw+B,GAAax+B,EAAA,OAAKw+B,CAAW,IACnDyE,cAAe/W,GAxEagX,EAwE8BpS,EAAMltB,IApExE,kHAAMs/B,mDAoEyE59B,EACvE69B,UAAWjX,OAAqB5mB,EAAY,OAC5C89B,WAAYlX,EAAqBmX,EAAAA,QAAsB/9B,EACvD1E,KAAM,UACNge,KAAM,UACN0kB,aAAc,gBACdC,OAAQ,CACN5wB,KAAM0uB,EACN9+B,MAAOF,EACPmhC,KAAM,CACJjhC,MAAO,QACP/I,MAAO,MAnFiB0pC,MA4GhC,OAlBIjX,EAASrzB,OAAS,GACpBkqC,EAAOW,QAAQ,CACbvpC,EAAGioC,EACHhoC,EAAGioC,EACHS,EAAGR,EACHzhC,KAAM,UACN8iC,aAAa,EACbP,UAAW,OACXQ,SAAU,CACRC,SAAU,WAEZC,WAAYrC,EACZsC,aAAcxC,EACdyC,SAAU,CACRC,SAAU,CAAErxB,KAAM,GAAIpQ,MAAOzB,EAAMuB,OAAOI,cAAewhC,OAAQ,OAIhEnB,CAAM,GACZ,CACDtB,EACAF,EACAD,EACApV,EACA2E,EAAMhwB,KACNgwB,EAAMhtB,IACNitB,EAAMjwB,KACNiwB,EAAMjtB,IACNktB,EAAMlwB,KACNkwB,EAAMltB,IACN9C,EAAMuB,OAAO0+B,QACbjgC,EAAMuB,OAAOI,cACbypB,IAGIgY,GAAqBh5B,EAAAA,EAAAA,UAAQ,KAAMi5B,EAAAA,EAAAA,GAAyBrjC,IAAQ,CAACA,KAEpEsa,EAAQgpB,IAAap/B,EAAAA,EAAAA,UAA0B,CACpDxL,MAAOA,GAASqoC,EAChBpoC,OAAQA,GAAUmoC,EAClBpR,SACAxD,MAAO,CAAE3zB,MAAOu3B,EAAMhtB,IAAKogC,SAAU,CAAErxB,KAAM,GAAIpQ,MAAOzB,EAAMuB,OAAOI,gBACrEwqB,MAAO,CACLoX,MAAO,SACPhrC,MAAO,CAAEirC,SAAU,GAAItB,KAAMnS,EAAMjtB,KACnCogC,SAAU,CAAErxB,KAAM,GAAIpQ,MAAOzB,EAAMuB,OAAOI,gBAE5C8hC,SAAU,CAAEnpB,OAAQ8oB,MAGtBn+B,EAAAA,EAAAA,YAAU,KACRq+B,GAAWjhC,IACT,MAAMqhC,EAAY,IACbrhC,EACH3J,MAAOA,GAASqoC,EAChBpoC,OAAQA,GAAUmoC,EAClBpR,UAWF,OARIgU,EAAUxX,QACZwX,EAAUxX,MAAM3zB,MAAQu3B,EAAMhtB,KAG5B4gC,EAAUvX,QACZuX,EAAUvX,MAAM5zB,MAAQ,CAAEirC,SAAU,GAAItB,KAAMnS,EAAMjtB,MAG/C4gC,CAAS,GAChB,GACD,CAAC3C,EAAaD,EAAcpR,EAAQI,EAAMhtB,IAAKitB,EAAMjtB,IAAKpK,EAAOC,IAEpE,MAAM,qBAAEgrC,IAAyBC,EAAAA,EAAAA,IAC/B3C,EACAL,EACAzV,EACA0Y,EAAAA,IAGIC,GAAgB3mB,EAAAA,EAAAA,cACpBre,IAAiC,IAADilC,EAAAC,EAAA,IAA/B,OAAEC,GAAwBnlC,EAEzB,MAAMolC,EAAgBD,EAAO5zB,MAAKxM,IAAA,IAAC,YAAEsgC,GAAatgC,EAAA,OAAqB,IAAhBsgC,CAAiB,IAIxE,GAFAR,EAA8C,QAA1BI,EAAc,OAAbG,QAAa,IAAbA,OAAa,EAAbA,EAAeE,kBAAU,IAAAL,EAAAA,GAAK,IAE9CG,EACH,OAKF,MAAMG,EAAuC,OAAbH,QAAa,IAAbA,GAAiC,QAApBF,EAAbE,EAAuBjC,kBAAU,IAAA+B,OAApB,EAAdA,EAAqC,GAChEK,IACK,OAAPhZ,QAAO,IAAPA,GAAAA,EAAUgZ,GACZ,GAEF,CAAChZ,EAASsY,IAGNW,GAAkBnnB,EAAAA,EAAAA,cAAY,KACzB,OAATmO,QAAS,IAATA,GAAAA,IACAqY,GAAsB,EAAE,GACvB,CAACrY,EAAWqY,IAOTY,GAAuBC,EAAAA,EAAAA,GAA6BV,GAEpDW,GAAkBr6B,EAAAA,EAAAA,UAAQ,KAAMs6B,EAAAA,EAAAA,IAAsBvZ,IAAW,CAACA,KAExElmB,EAAAA,EAAAA,YAAU,KACR,MAAM0/B,EAAuBvD,EAASn1B,KAAK24B,IAAW,IACjDA,EACH9mB,KAAM,mBAEY,OAApB+iB,QAAoB,IAApBA,GAAAA,GAAuBgE,EAAAA,EAAAA,GAAgCF,EAAcrqB,GAAQ,GAC5E,CAACA,EAAQumB,EAAsBO,IAElC,MAAMnK,GACJ55B,EAAAA,EAAAA,GAAA,OACEW,IAAG,CAAG8mC,EAAAA,GAAsBC,aAAa/kC,GAAQ8kC,EAAAA,GAAsBE,4BAA2B,IAClGt8B,UAAWA,EACX3P,IAAKioC,EAAgBvjC,UAErBJ,EAAAA,EAAAA,GAAC4nC,EAAAA,EAAQ,CACPlX,KAAMqT,EACN8D,kBAAmBhE,EACnBljC,IAAK8mC,EAAAA,GAAsB7N,MAAMj3B,GACjC2gC,SAAUA,EACVrmB,OAAQA,EACR0F,OAAQkgB,EACR7U,QAASkZ,EACTjZ,UAAWgZ,MAKjB,OAAOjnC,EAAAA,EAAAA,GAAC8nC,EAAAA,EAAwB,CAACC,UAAWX,EAAgBhnC,SAAEw5B,GAAiC,G,kMC9OnG,MAAMiJ,EAA+B,CACnCC,aAAa,EACbC,YAAY,EACZiF,YAAa,WACbC,UAAU,EACVjF,uBAAwB,CAAC,YAgBd9Q,EAAqBjxB,EAAAA,MAChCjG,IAgBgC,IAADilC,EAAAC,EAAA,IAhB9B,SACCpS,EAAQ,UACR/N,EAAS,UACT1U,EAAS,OACTgnB,EAAS6V,EAAAA,GAAsB,SAC/B5E,EAAQ,QACRtV,EAAO,UACPC,EAAS,SACTka,EAAW,EAAI,EAAC,MAChB9sC,EAAK,OACLC,EAAM,gBACN62B,GAAkB,EAAI,mBACtBpE,GAAqB,EAAI,iBACzBqE,GAAmB,EAAI,gBACvBmR,EAAe,qBACfC,GACwBxoC,EACxB,MAAM+oC,GAAWh3B,EAAAA,EAAAA,UAAQ,KAEvB,MAAMq7B,EAAMta,EAASlf,KAAKhT,GAAMA,EAAE8wB,OAG5B2b,EAAQva,EAASlf,KAAI/M,IAAA,IAAC,YAAEw+B,GAAax+B,EAAA,OAAKw+B,CAAW,IAGrD1uB,EAASmc,EAASlf,KAAKhT,IAAC,IAAA0sC,EAAA,OAAKC,EAAAA,EAAAA,IAAwC,QAArBD,EAAC1sC,EAAE2jC,QAAQxf,UAAU,IAAAuoB,OAAA,EAApBA,EAAsBl+B,MAAM,IAG7Eo+B,EAAa1a,EAASlf,KAAKhT,IAAO,IAAD6sC,EACrC,MAAMtI,EAA0BC,EAAAA,EAAyBrgB,GAC3B,IAAD2oB,EAA7B,OAAIvI,EACKA,EAAwBI,eAAe,CAAEn2B,MAA2B,QAAtBs+B,EAAE9sC,EAAE2jC,QAAQxf,UAAU,IAAA2oB,OAAA,EAApBA,EAAsBt+B,QAvC5D,SAACu+B,GAAoB,IAAEC,EAAMpuC,UAAAC,OAAA,QAAA0M,IAAA3M,UAAA,GAAAA,UAAA,GAAG,EAAC,MAAqB,kBAARmuC,EAAmBA,EAAIE,QAAQD,GAAUD,CAAG,CA0CtGG,CAAuC,QAArBL,EAAC7sC,EAAE2jC,QAAQxf,UAAU,IAAA0oB,OAAA,EAApBA,EAAsBr+B,MAAM,IAIlDlG,EAAS4pB,EAASlf,KAAKhT,GAAMA,EAAEwI,QAErC,MAAO,CACL,CACEpI,EAAGosC,EACHrsC,EAAG4V,EACH02B,QACAxD,KAAM2D,EACNrD,aAAcxzB,EAAO/C,KAAKxE,GAAqB,IAAVA,EAAc,UAAY,SAC/D2+B,SAAU,CACRv0B,KAAM,IAER+qB,QAASzR,EAASlf,KAAKhT,GAAMA,EAAE2jC,QAAQxf,KAGvCtd,KAAM,MACNqiC,cAAe/W,EAAqB,+BAA4B5mB,EAChE69B,UAAWjX,EAAqB,IAAM,OACtCkX,WAAYlX,EAAqBmX,EAAAA,QAAsB/9B,EACvD9L,MAAO8sC,EAEPa,YAAa,IACb5D,OAAQ,CACNhhC,MAAOF,IAGZ,GACA,CAAC4pB,EAAU/N,EAAWooB,EAAUpa,KAE7B,aAAE0V,EAAY,YAAEC,EAAW,gBAAEC,EAAe,aAAEC,EAAY,uBAAEC,IAA2BC,EAAAA,EAAAA,OAEvF,cAAE9oB,IAAkB0D,EAAAA,EAAAA,MACpB,MAAE/b,IAAUC,EAAAA,EAAAA,KACZmjC,GAAqBh5B,EAAAA,EAAAA,UAAQ,KAAMi5B,EAAAA,EAAAA,GAAyBrjC,IAAQ,CAACA,KAEpEsa,EAAQgpB,IAAap/B,EAAAA,EAAAA,UAA0B,CACpDxL,MAAOA,GAASqoC,EAChBpoC,OAAQA,GAAUmoC,EAClBwF,UAAW,IACX5W,SACAxD,MAAO,CACL3zB,MAAOk3B,EAAmBrS,OAAY5Y,EACtC0+B,SAAU,CAAErxB,KAAM,GAAIpQ,MAAOzB,EAAMuB,OAAOI,eAC1C4kC,WAAoE,QAA1DjJ,EAAqC,QAArCC,EAAEE,EAAAA,EAAyBrgB,UAAU,IAAAmgB,OAAA,EAAnCA,EAAqCiJ,2BAAmB,IAAAlJ,EAAAA,OAAI94B,GAE1E2nB,MAAO,CACLsa,eAAgBjX,EAChBj3B,MAAOi3B,EACHnX,EAAc,CAAArf,GAAA,SACZ6S,eAAe,kBAGjBrH,EACJ0+B,SAAU,CAAErxB,KAAM,GAAIpQ,MAAOzB,EAAMuB,OAAOI,eAC1C+kC,YAAY,GAEdjD,SAAU,CAAEnpB,OAAQ8oB,MAGtBn+B,EAAAA,EAAAA,YAAU,KACRq+B,GAAWjhC,IAAO,IACbA,EACH3J,MAAOA,GAASqoC,EAChBpoC,OAAQA,GAAUmoC,EAClBpR,SACAxD,MAAO,IACF7pB,EAAQ6pB,MACX3zB,MAAOk3B,EAAmBrS,OAAY5Y,MAEvC,GACF,CAACu8B,EAAaD,EAAcpR,EAAQtS,EAAW1kB,EAAOC,EAAQ82B,IAEjE,MAAM,qBAAEkU,IAAyBC,EAAAA,EAAAA,IAC/B3C,EACAL,EACAzV,EACAwb,EAAAA,IAGI7C,GAAgB3mB,EAAAA,EAAAA,cACpBre,IAAwB,IAAD8nC,EAAAC,EAAAC,EAAAC,EAAA,IAAtB,OAAE9C,EAAM,MAAExjC,GAAO3B,EAChB,MAAM29B,EAA6B,QAAjBmK,EAAG3C,EAAO,GAAGlW,YAAI,IAAA6Y,OAAA,EAAdA,EAAgBhK,QAAQqH,EAAO,GAAGG,YACvDT,EAA0C,QAAtBkD,EAAU,QAAVC,EAAC7C,EAAO,UAAE,IAAA6C,OAAA,EAATA,EAAW1C,kBAAU,IAAAyC,EAAAA,GAAK,GAE/C,MAAMxK,EAAyC,CAC7CS,OAAQmH,EAAO,GAAG7qC,EAClBujC,OAAQsH,EAAO,GAAGx8B,MAElBuO,MAAOiuB,EAAO,GAAGG,WACjB3H,gBAGIjrB,EAAmB,QAAZu1B,EAAG9C,EAAO,UAAE,IAAA8C,OAAA,EAATA,EAAWlsB,MACvBrJ,IACK,OAAP6Z,QAAO,IAAPA,GAAAA,EAAU7Z,EAAS/Q,EAAO47B,GAC5B,GAEF,CAAChR,EAASsY,IAGNW,GAAkBnnB,EAAAA,EAAAA,cAAY,KACzB,OAATmO,QAAS,IAATA,GAAAA,IACAqY,GAAsB,EAAE,GACvB,CAACrY,EAAWqY,IAOTY,GAAuBC,EAAAA,EAAAA,GAA6BV,GAEpDW,GAAkBr6B,EAAAA,EAAAA,UAAQ,KAAMs6B,EAAAA,EAAAA,IAAsBvZ,IAAW,CAACA,KAExElmB,EAAAA,EAAAA,YAAU,KAER,MAAM+hC,EAAiB,IAClB1sB,EACH6R,MAAO,IACF7R,EAAO6R,MACVsa,gBAAgB,EAChBQ,YAAY,IAIVtC,EAAevD,EAASn1B,KAAK24B,IAAK,IACnCA,EAEHvrC,EAAGurC,EAAMc,UAES,OAApB7E,QAAoB,IAApBA,GAAAA,GAAuBgE,EAAAA,EAAAA,GAAgCF,EAAcqC,GAAgB,GACpF,CAAC1sB,EAAQumB,EAAsBO,IAElC,MAAMnK,GACJ55B,EAAAA,EAAAA,GAAA,OACEW,IAAG,CAAG8mC,EAAAA,GAAsBC,aAAa/kC,GAAQhB,EAAOkoC,gBAAe,IACvEx+B,UAAWA,EACX3P,IAAKioC,EAAgBvjC,UAErBJ,EAAAA,EAAAA,GAAC4nC,EAAAA,EAAQ,CACPlX,KAAMqT,EACN8D,kBAAmBhE,EACnBljC,IAAK8mC,EAAAA,GAAsB7N,MAAMj3B,GACjC2gC,SAAUA,EACVrmB,OAAQA,EACR0F,OAAQkgB,EACR7U,QAASkZ,EACTjZ,UAAWgZ,MAKjB,OAAOjnC,EAAAA,EAAAA,GAAC8nC,EAAAA,EAAwB,CAACC,UAAWX,EAAgBhnC,SAAEw5B,GAAiC,IAI7Fj4B,EAAS,CACbkoC,gBAAiB,CACf,2BAA4B,CAC1BC,WAAY,2BAEd,wCAAyC,CACvC38B,QAAS,+CAEX,8CAA+C,CAC7CA,QAAS,+CAEX,kDAAmD,CACjDA,QAAS,8CACTtR,OAAQ,4BACRgC,YAAa,yC,qHCxQjB,IAAAgE,EAAA,CAAAH,KAAA,SAAAC,OAAA,6DAUF,MAAMooC,EAAwC/uC,IAAkC,IAAjC,MAAEwiB,EAAK,MAAEpZ,EAAK,UAAE4lC,GAAWhvC,EACxE,MAAM,MAAE2H,IAAUC,EAAAA,EAAAA,KAElB,OACEvC,EAAAA,EAAAA,IAAA,OACEM,KAAGC,EAAAA,EAAAA,IAAE,CACHmD,QAAS,OACTC,WAAY,SACZ0R,aAAc,WACdzI,WAAY,EACZ8G,YAAapR,EAAMgN,QAAQc,GAC3Bw5B,SAAU,QACX,IAAC7pC,SAAA,EAEFJ,EAAAA,EAAAA,GAACkqC,EAAwB,CAAC9lC,MAAOA,EAAO4lC,UAAWA,KACnDhqC,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWC,KAAI,CACdlM,MAAM,YACNoQ,KAAK,KACL7T,IAAGkB,EAAyEzB,SAE3Eod,MAEC,EAIG0sB,EAAmFzoC,IAGzF,IAH0F,MAC/F2C,EAAK,UACL4lC,GACDvoC,EACC,MAAM,MAAEkB,IAAUC,EAAAA,EAAAA,KACZunC,EAAkBH,EAxDJI,KACpB,OAAQA,GACN,IAAK,MACH,MAAO,IACT,IAAK,OACH,MAAO,OACT,IAAK,WACH,MAAO,OACT,IAAK,UACH,MAAO,aACT,IAAK,cACH,MAAO,aACT,QACE,MAAO,GACX,EA0CoCC,CAAaL,QAAa7iC,EACxDmjC,EAAc3nC,EAAMiB,WAAWkO,WAAa,EAElD,OACE9R,EAAAA,EAAAA,GAAA,OACEW,KAAGC,EAAAA,EAAAA,IAAE,CACHtF,OAAQqH,EAAMiB,WAAWkO,WACzBzW,MAAOkvC,GACPx2B,YAAapR,EAAMgN,QAAQqC,GAC3B/E,WAAY,GACb,IAAC7M,UAEFJ,EAAAA,EAAAA,GAAA,QACEpE,EAAG,MAAM0uC,OACTprC,MAAO,CACLrB,YA7EW,EA8EXhC,OAAQuI,EACR+lC,sBAGA,EAgCV,IAvB4D3jC,IAAwC,IAAvC,UAAEuhC,EAAS,OAAEzsC,EAAM,WAAEqhC,GAAYn2B,EAC5F,MAAM,MAAE7D,IAAUC,EAAAA,EAAAA,KAElB,OACE5C,EAAAA,EAAAA,GAAA,OACEW,KAAGC,EAAAA,EAAAA,IAAE,CACHmD,QAAS,OACTymC,SAAU,OACVlvC,SACAmvC,aAAc9N,EAAa,aAAe,SAC1Cr0B,IAAKq0B,EAAah6B,EAAMgN,QAAQC,GAAK,EACrC+lB,UAAW,OACXj1B,UAAW,SACXgP,UAAWitB,EAAah6B,EAAMgN,QAAQa,GAAK7N,EAAMgN,QAAQC,IAC1D,IAACxP,SAED2nC,EAAUn5B,KAAK87B,IACd1qC,EAAAA,EAAAA,GAAC+pC,EAAU,IAA4BW,GAAtBA,EAAWltB,UAE1B,C,gGCtFV,IAxBiCxiB,IAOzB,IAP0B,UAChC+sC,EAAS,WACTpL,EAAU,SACVv8B,GAIApF,EACA,MAAM,MAAE2H,IAAUC,EAAAA,EAAAA,KAKZtH,EAASqhC,EAHmB,IACZ,GAGhBgO,EAAehO,EAAah6B,EAAMgN,QAAQa,GAAK7N,EAAMgN,QAAQc,GAEnE,OACEpQ,EAAAA,EAAAA,IAAAC,EAAAA,GAAA,CAAAF,SAAA,EACEJ,EAAAA,EAAAA,GAAA,OAAKW,KAAGC,EAAAA,EAAAA,IAAE,CAAEtF,OAAQ,eAAeA,EAASqvC,QAAmB,IAACvqC,SAAEA,KAClEJ,EAAAA,EAAAA,GAAC4qC,EAAAA,EAAiB,CAAC7C,UAAWA,EAAWzsC,OAAQA,EAAQqhC,WAAYA,MACpE,C,uNCZP,MACMkO,EAA4B,iCAW5BC,EAAqBC,IAAgC,IAADC,EACxD,MAAMC,GACJC,EAAAA,EAAAA,UAASH,KAAuF,QAApEC,EAAID,EAAmBI,MAAM,+CAAuC,IAAAH,OAAA,EAAhEA,EAAmE,IACrG,OAAKC,EAKuC,IAApCljB,OAAO,KAAKkjB,KAAgC,EAJ3C,CAI4C,E,gDC3BvD,MAAMG,EAAkBA,CAACC,EAAuBvpB,IAC1CA,IAAaC,EAAAA,GAA6BoF,KAErCkkB,EAAQva,KAEfhP,IAAaC,EAAAA,GAA6BqF,MAC1CtF,IAAaC,EAAAA,GAA6BsF,cAGnCgkB,EAAQC,UAEV,KCuCHC,EAAqBvwC,IA+BA,IAADwwC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,IA/BE,SAC1BC,EAAQ,UACR9rB,EAAS,SACT+B,EAAQ,uBACRyB,EAAsB,mBACtBwK,EAAkB,eAClB3H,EAAc,UACd0lB,EAAS,SACTC,EAAQ,cACRjjB,EACAkjB,oBAAqBC,EAAY,eACjCjnB,EAAc,WACd5D,EAAU,mBACV8qB,GAkBDlxC,EACC,IAAK6wC,EAASvf,eACZ,MAAO,CAAC,EAGV,IAgBI0X,EACAC,EAjBAkI,EAAuC,GAC3C,GAAI/qB,GAAc8qB,EAChBC,ED1EkDnxC,KAa/C,IAbgD,WACrDomB,EAAU,SACVyqB,EAAQ,mBACRK,EAAkB,SAClBpqB,GASD9mB,EACC,MAAMoxC,EAAyBhrB,EAAWG,UAAU3S,KAAK4c,IAAc,IAAD6gB,EACpE,MAAMC,EAAkC,QAA1BD,EAAGR,EAASvf,sBAAc,IAAA+f,OAAA,EAAvBA,EAA0B7gB,GAC3C,YAAiBrkB,IAAbmlC,EACKA,EAAS3hB,SAAS0gB,IACvB,MAAMkB,EAAenB,EAAgBC,EAASvpB,GAC9C,OAAqB,OAAjByqB,EACK,CAACA,GAEH,EAAE,IAGN,EAAE,IAELC,GAAcC,EAAAA,EAAAA,iBAAgBL,GAIpC,OAHAI,EAAYlX,MAAK,CAAC9O,EAAGC,IAAMD,EAAIC,IAGxB+lB,EAAY7hB,SAAS+hB,IAC1B,MAAMnrB,EAAYH,EAAWG,UAAU9Y,QAAO,CAACkkC,EAAKnhB,KAAc,IAADohB,EAAAC,EAC/D,MAAMP,EAAkC,QAA1BM,EAAGf,EAASvf,sBAAc,IAAAsgB,OAAA,EAAvBA,EAA0BphB,GACrCphB,EAAgB,OAARkiC,QAAQ,IAARA,GAA8E,QAAtEO,EAARP,EAAUt5B,MAAMq4B,GAAYD,EAAgBC,EAASvpB,KAAc4qB,WAAW,IAAAG,OAAtE,EAARA,EAAgFziC,MAI9F,YAHcjD,IAAViD,IACFuiC,EAAInhB,GAAYphB,GAEXuiC,CAAG,GACT,CAAC,GAEEG,EAAkBZ,EAAmB9qB,EAAYG,GACvD,YAAwBpa,IAApB2lC,EACK,CACL,CACE1iC,MAAO0iC,EACPrnC,IAAK2b,EAAWA,cACZU,IAAaC,EAAAA,GAA6BoF,MAAQrF,IAAaC,EAAAA,GAA6BC,OAC5F,CAAE8O,KAAM4b,EAAYpB,UAAW,GAC/B,CAAEA,UAAWoB,EAAY5b,KAAM,KAIlC,EAAE,GACT,ECoBuBic,CAAuC,CAC5D3rB,aACAyqB,WACAK,qBACApqB,iBAEG,SAAkB3a,IAAd4Y,EAKT,MAAO,CAAC,EAL2B,IAADssB,EAClCF,EAAyD,QAArCE,EAAGR,EAASvf,eAAevM,UAAU,IAAAssB,OAAA,EAAlCA,EAAoC/W,MAAK,CAAC9O,EAAGC,IAClE3E,IAAaC,EAAAA,GAA6BoF,KAAOX,EAAEsK,KAAOrK,EAAEqK,KAAOtK,EAAE8kB,UAAY7kB,EAAE6kB,WAIvF,CAIA,GAAIxpB,IAAaC,EAAAA,GAA6BC,OAAQ,CAAC,IAADgrB,EAAAC,EACpD,MAAMC,EAAS,IAAIxhB,KAAyB,QAArBshB,EAACb,SAAoB,IAAAa,EAAAA,EAAI,IAAIp+B,KAAI/M,IAAA,IAAC,KAAEivB,GAAMjvB,EAAA,OAAKivB,CAAI,KACpEqc,EAAmBC,EAA8BF,EAAQrB,EAASvf,eAAe/I,IACjF8pB,EAAYF,EAAiBv+B,KAAInN,IAAA,IAAC,KAAEqvB,GAAMrvB,EAAA,OAAKqvB,CAAI,IACnDwc,EAAS,IAAI5hB,IAAI2hB,GACjBE,EAAgBC,EAAiC,QAArBP,EAACd,SAAoB,IAAAc,EAAAA,EAAI,GAAII,GAAW1/B,QAAOnH,IAAA,IAAC,KAAEsqB,GAAMtqB,EAAA,OAAK8mC,EAAOG,IAAI3c,EAAK,IAE/GkT,EAAUmJ,EAAiBv+B,KAAIE,IAAA,IAAC,MAAE1E,GAAO0E,EAAA,OAAK1E,CAAK,IACnD65B,EAAUsJ,EAAc3+B,KAAIG,IAAA,IAAC,MAAE3E,GAAO2E,EAAA,OAAKw5B,EAAAA,EAAAA,IAAoBn+B,EAAM,GACvE,KAAO,CAAC,IAADsjC,EAIL,GAHA1J,EAAU2J,EAA+BxB,EAAsBrqB,GAC/DmiB,EAA8B,QAAvByJ,EAAGvB,SAAoB,IAAAuB,OAAA,EAApBA,EAAsB9+B,KAAII,IAAA,IAAC,MAAE5E,GAAO4E,EAAA,OAAKu5B,EAAAA,EAAAA,IAAoBn+B,EAAM,IAEtD,QAAnB4a,EAA0B,CAE5B,MAAM4oB,EAAqB5J,EAAQhL,WAAWj9B,GAAMA,EAAI,KAC5B,IAAxB6xC,IACF5J,EAAUA,EAAQlsB,MAAM81B,GACxB3J,EAAUA,EAAQnsB,MAAM81B,GAE5B,CACF,CAIA,MAAMC,GAAqBC,EAAAA,EAAAA,IAAyB9J,GAAW,SAAW8H,EAGpEiC,GAAwB9B,IAA8B,OAAbnjB,QAAa,IAAbA,EAAAA,EAAiBkb,EAAQvpC,OApFzC,IAsFzBuzC,EAA0C,KAAb,QAAPxC,EAAAvH,SAAO,IAAAuH,OAAA,EAAPA,EAAS/wC,QAE/BuqC,EACAiH,EACK,OAELle,OAAJ,EAGO,OAGT,MAAO,CAELrB,KAAMmf,EAASnf,KACfhrB,MAAsB,QAAhB+pC,EAAAI,EAAS7gB,eAAO,IAAAygB,OAAA,EAAhBA,EAAkBp3B,UAAW,GACnCtY,EAAGioC,EAEHhoC,GAAGiyC,EAAAA,EAAAA,IAAW,QAARvC,EAACzH,SAAO,IAAAyH,EAAAA,EAAI,GAAIO,EAAe,EAAI7lB,GAEzC8nB,cAAe/B,EACfpsB,UAAWA,IAAuB,OAAVqB,QAAU,IAAVA,OAAU,EAAVA,EAAYA,YACpC+sB,WAA2B,QAAhBxC,EAAAE,EAAS7gB,eAAO,IAAA2gB,OAAA,EAAhBA,EAAkBt3B,UAAW,GACxCwwB,KAAM,IACNM,aAAc,UACd4D,SAAU,CACRv0B,KAAM,IAERiM,KAAMutB,GAAuBD,EAAuB,gBAAkB,QACtEjJ,cAAe/W,EAAqBqgB,GAAsC,QAAhBxC,EAAAC,EAAS7gB,eAAO,IAAA4gB,OAAA,EAAhBA,EAAkBv3B,UAAW,SAAMlN,EAC7F69B,YACAC,WAAYlX,EAAqBmX,EAAAA,QAAsB/9B,EACvD1E,KAAM,UACN4iC,KAAM,CAAEgJ,KAAMtC,EAAUuC,MAAOT,GAC/BzI,OAAQ,CACNhhC,MAAO6nC,GAAesC,EAAAA,EAAAA,IAAsB1C,EAASznC,MAAO,KAAQynC,EAASznC,OAEhF,EA+FGopC,EAAeA,CAACgB,EAA4BnB,KAChD,MAAMoB,EAAcpB,EAAU5kC,QAAO,CAACC,EAAKooB,EAAMjiB,KAC/CnG,EAAIooB,GAAQjiB,EACLnG,IACN,CAAC,GAGJ,OAAO8lC,EAAW12B,QAAQwd,MAAK,CAAC9O,EAAGC,KAAC,IAAAioB,EAAAC,EAAA,OAAyB,QAApBD,EAACD,EAAYjoB,EAAEsK,aAAK,IAAA4d,EAAAA,EAAIE,MAAgC,QAAxBD,EAAKF,EAAYhoB,EAAEqK,aAAK,IAAA6d,EAAAA,EAAIC,IAAS,GAAC,EAgH3G/L,EAA+B,CACnCC,aAAa,EACbkF,YAAa,WACbjF,YAAY,EACZC,uBAAwB,CAAC,YAGdoL,EAAyB/5B,GACpC,MAAMA,wGAWFs5B,EAAiCA,CACrCO,EACAW,KAEA,IAAKX,EACH,MAAO,GAET,GAAIW,IAAa9sB,EAAAA,GAA6BsF,cAAe,CAC3D,MAAQikB,UAAWwD,IAAiBC,EAAAA,EAAAA,OAAMb,EAAe,cAAgB,CAAC,EAC1E,OAAIY,GACEjP,EAAAA,EAAAA,MACKqO,EAAct/B,KAAIogC,IAAA,IAAC,UAAE1D,GAAW0D,EAAA,OAAK1D,EAAYwD,EAAeG,EAAAA,EAAmB,IAErFf,EAAct/B,KAAIsgC,IAAA,IAAC,UAAE5D,GAAW4D,EAAA,OAAM5D,EAAYwD,GAAgB,GAAI,IAExEZ,EAAct/B,KAAIugC,IAAA,IAAC,KAAEre,GAAMqe,EAAA,OAAKre,CAAI,GAC7C,CAAO,IAAI+O,EAAAA,EAAAA,OAAsCgP,IAAa9sB,EAAAA,GAA6BqtB,oBAAqB,CAC9G,MAAQ9D,UAAWwD,IAAiBC,EAAAA,EAAAA,OAAMb,EAAe,cAAgB,CAAC,EAC1E,GAAIY,EACF,OAAOZ,EAAct/B,KAAIygC,IAAA,IAAC,UAAE/D,GAAW+D,EAAA,OAAM/D,EAAYwD,GAAgBQ,EAAAA,EAAoB,GAEjG,MAAO,GAAIT,IAAa9sB,EAAAA,GAA6BqF,KACnD,OAAO8mB,EAAct/B,KAAI2gC,IAAA,IAAC,UAAEjE,GAAWiE,EAAA,OAAKjE,CAAS,IAGvD,OAAO4C,EAAct/B,KAAI4gC,IAAA,IAAC,KAAE1e,GAAM0e,EAAA,OAAK1e,CAAI,GAAC,EASxCsc,EAAgCA,CACpCF,EACAgB,IAKKA,EAIEA,EACJvgC,QAAQ8hC,GAAcvC,EAAOO,IAAIgC,EAAU3e,QAC3CliB,KAAK6gC,IAAS,CACbrlC,OAAOm+B,EAAAA,EAAAA,IAAoBkH,EAAUrlC,OACrC0mB,KAAM2e,EAAU3e,SAEjBwE,MAAK,CAAC9O,EAAGC,IAEDsB,OAAOvB,EAAEpc,OAAS2d,OAAOtB,EAAErc,SAX7B,GAqCEyjB,EAAsB5sB,EAAAA,MACjCyuC,IA4BiC,IA5BhC,SACC5hB,EAAQ,UACR/N,EAAS,mBACTY,EAAkB,UAClBuE,EAAY,SAAQ,eACpBF,EAAiB,SAAQ,SACzBlD,EAAWC,EAAAA,GAA6BoF,KAAI,SAC5CzE,EAAWO,EAAAA,GAA6BjB,OAAM,iBAC9CG,EAAmB,GAAE,uBACrBoB,EAAyB,GAAE,eAC3B6C,EAAiB,GAAE,UACnB/a,EAAS,OACTgnB,EAAS6V,EAAAA,GAAsB,UAC/B4D,EAAY,SAAQ,SACpBxI,EAAQ,QACRtV,EAAO,UACPC,EAAS,MACT5yB,EAAK,OACLC,EAAM,mBACNyyB,GAAqB,EAAI,gBACzBwV,EAAe,OACf5V,EAAM,OACNC,EAAM,cACN+hB,EAAa,WACbhT,EAAU,cACV7T,EAAa,qBACb0a,EAAoB,kBACpBoM,EAAoB,GACKF,EACzB,MAAM,MAAE/sC,IAAUC,EAAAA,EAAAA,KACZwnB,GAAgC1F,EAAAA,EAAAA,MAChCC,IAA2BC,EAAAA,EAAAA,OAC3B,mBAAEsnB,KAAuBjrB,EAAAA,EAAAA,KAEzB4uB,IAAkB9iC,EAAAA,EAAAA,UAAQ,KAC9B,IAAI8iC,EAAkB/tB,EACtB,IAAI+d,EAAAA,EAAAA,OAAsC/d,IAAaC,EAAAA,GAA6BsF,cAAe,CACjG,MAAMlC,EAAaxE,GAAsB,CAACZ,GAC1C,IAAI+vB,EAAU,EACdhiB,EAAS7V,SAASpF,IAChB,MAAMq7B,EAAgBr7B,EAAQyZ,eAC1B4hB,GACF/oB,EAAWlN,SAAS8H,IAClB,GAAImuB,EAAcnuB,GAAY,CAC5B,MAAQurB,UAAWwD,IAAiBC,EAAAA,EAAAA,OAAMb,EAAcnuB,GAAY,cAAgB,CAAC,GAC7EurB,UAAWyE,IAAiBC,EAAAA,EAAAA,OAAM9B,EAAcnuB,GAAY,cAAgB,CAAC,EACrF,GAAIgwB,GAAgBjB,EAAc,CAChC,MAAMmB,EAAOF,EAAejB,EAC5BgB,EAAUlsB,KAAKqE,IAAI6nB,EAASG,EAC9B,CACF,IAEJ,IAGEH,GAAWI,EAAAA,KACbL,EAAkB9tB,EAAAA,GAA6BqtB,oBAEnD,CACA,OAAOS,CAAe,GACrB,CAAC/hB,EAAUnN,EAAoBZ,EAAW+B,IAEvCquB,GAA4B/0C,IAChC,MAAM83B,EAAYqY,EAAmBnwC,GACrC,IAAIg1C,EAAAA,EAAAA,MAAgD,CAClD,MAAMC,EAAoB,IACrBj1C,EACHgrB,eAAgB,EAChB2H,oBAAoB,EACpBjF,eAAe,EACfkjB,qBAAqB,GAGvB,MAAO,CAAC9Y,EADkBqY,EAAmB8E,GAE/C,CACA,MAAO,CAACnd,EAAU,EAGd6Q,IAAWh3B,EAAAA,EAAAA,UAAQ,KAEvB,MAAMoY,EAA+B,OAAlBxE,QAAkB,IAAlBA,EAAAA,EAAsB,CAACZ,GAC1C,OAAO+N,EACJlf,KAAKi9B,IAEFhqB,EAAAA,EAAAA,OACAC,IAAaC,EAAAA,GAA6BC,QAC1CU,IAAaO,EAAAA,GAA6BC,WAEnCf,EAAiBwI,SAAQ,CAACvJ,EAA2CvS,IACnEshC,GAAyB,CAC9BtE,WACAzqB,aACAU,SAAU+tB,GACVtsB,yBACAwK,qBACA3H,iBACA0lB,YACAC,SAAUuE,EAAAA,GAAezhC,EAAMyhC,EAAAA,GAAe71C,QAC9CquB,gBACA9D,iBACAknB,0BAKF/mB,EAEGxX,QAAQoS,IAAS,IAAA6sB,EAAA,QAAMjuB,EAAAA,EAAAA,SAA+B,QAAxBiuB,EAACf,EAASvf,sBAAc,IAAAsgB,OAAA,EAAvBA,EAA0B7sB,GAAW,IACpE4K,SAAQ,CAAC5K,EAAWlR,IACZshC,GAAyB,CAC9BtE,WACA9rB,YACA+B,SAAU+tB,GACVtsB,yBACAwK,qBACA3H,iBACA0lB,YACAC,SAAUuE,EAAAA,GAAezhC,EAAMyhC,EAAAA,GAAe71C,QAC9CquB,gBACA9D,uBAMXurB,MAAM,GACR,CACDziB,EACAge,EACA+D,GACAzpB,EACArG,EACAgO,EACApN,EACA4C,EACAuF,EACA9D,EACAtC,EACAP,EACA+pB,GACApqB,IAGI0uB,IAAYzjC,EAAAA,EAAAA,UAAQ,KACxB,MAAMoY,EAA+B,OAAlBxE,QAAkB,IAAlBA,EAAAA,EAAsB,CAACZ,GAC1C,OAAO+N,EACJngB,QAAO8iC,IAAA,IAAC,gBAAEjmB,GAAiBimB,EAAA,OAAKjmB,CAAe,IAC/CG,SAASkhB,GACR1mB,EAAWvW,KAAKmR,GA1cC9Q,KAcA,IAADyhC,EAAA,IAdE,SAC1B7E,EAAQ,UACR9rB,EAAS,UACT+rB,EAAS,SACThqB,EAAQ,uBACRyB,EAAsB,eACtByB,GAQD/V,EACC,IAAK48B,EAAS8E,yBACZ,MAAO,CAAC,EAIV,MAAM,IAAE1oB,EAAG,IAAEE,GAAQ0jB,EAAS8E,yBAAyB5wB,GAEvD,IAAI6wB,EAAOC,EAAQC,EAAOC,EAC1B,GAAIjvB,IAAaC,EAAAA,GAA6BC,OAAQ,CACpD,IAAK6pB,EAASvf,eACZ,MAAO,CAAC,EAEV,MAAM4gB,EAAS,IAAIxhB,IAAIzD,EAAIrZ,KAAIM,IAAA,IAAC,KAAE4hB,GAAM5hB,EAAA,OAAK4hB,CAAI,KAC3Cqc,EAAmBC,EAA8BF,EAAQrB,EAASvf,eAAe/I,IACjF8pB,EAAYF,EAAiBv+B,KAAKrU,GAAMA,EAAEu2B,OAC1Cwc,EAAS,IAAI5hB,IAAI2hB,GACjBrJ,EAAUmJ,EAAiBv+B,KAAKrU,GAAMA,EAAE6P,QAE9C0mC,EAAQtD,EAAarlB,EAAKklB,GACvB1/B,QAAOwB,IAAA,IAAC,KAAE2hB,GAAM3hB,EAAA,OAAKm+B,EAAOG,IAAI3c,EAAK,IACrCliB,KAAIoiC,IAAA,IAAC,MAAE5mC,GAAO4mC,EAAA,OAAKzI,EAAAA,EAAAA,IAAoBn+B,EAAM,IAC7CgrB,UACH2b,EAASvD,EAAavlB,EAAKolB,GACxB1/B,QAAOsjC,IAAA,IAAC,KAAEngB,GAAMmgB,EAAA,OAAK3D,EAAOG,IAAI3c,EAAK,IACrCliB,KAAIsiC,IAAA,IAAC,MAAE9mC,GAAO8mC,EAAA,OAAK3I,EAAAA,EAAAA,IAAoBn+B,EAAM,IAChDwmC,EAAQ5M,EAAQlsB,QAAQsd,UACxByb,EAAS7M,CACX,KAAO,CAEL,MAAMmN,EAAchpB,EAAIrQ,QAAQsd,UAMhC,GALAwb,EAAQjD,EAA+BwD,EAAarvB,GACpD+uB,EAASlD,EAA+B1lB,EAAKnG,GAC7CgvB,EAAQK,EAAYviC,KAAIwiC,IAAA,IAAC,MAAEhnC,GAAOgnC,EAAA,OAAK7I,EAAAA,EAAAA,IAAoBn+B,EAAM,IACjE2mC,EAAS9oB,EAAIrZ,KAAIyiC,IAAA,IAAC,MAAEjnC,GAAOinC,EAAA,OAAK9I,EAAAA,EAAAA,IAAoBn+B,EAAM,IAEnC,QAAnB4a,EAA0B,CAE5B,MAAM4oB,EAAqBiD,EAAO7X,WAAWj9B,IAAMu1C,EAAAA,EAAAA,UAASv1C,IAAMA,EAAI,IAChEw1C,EAAoBX,EAAMn2C,OAASm2C,EAAM5X,WAAWj9B,IAAMu1C,EAAAA,EAAAA,UAASv1C,IAAMA,EAAI,KACvD,IAAxB6xC,IAAoD,IAAvB2D,IAC/BV,EAASA,EAAO/4B,MAAM81B,GACtBmD,EAASA,EAAOj5B,MAAM81B,GACtBgD,EAAQA,EAAM94B,MAAM,EAAGy5B,EAAoB,GAC3CT,EAAQA,EAAMh5B,MAAM,EAAGy5B,EAAoB,GAE/C,CACF,CAIA,MAAMvN,EAAU,IAAI4M,EAAO,QAASC,GAC9BW,EAAa,IAAIV,EAAO,QAASC,GAEvC,MAAO,CACLrvC,MAAsB,QAAhBgvC,EAAA7E,EAAS7gB,eAAO,IAAA0lB,OAAA,EAAhBA,EAAkBr8B,UAAW,GACnCtY,EAAGioC,EACHhoC,EAAGw1C,EACHC,WAAWlD,EAAAA,EAAAA,IAAsB1C,EAASznC,MAAO,IACjD0gC,mBAAe39B,EACf89B,gBAAY99B,EACZ69B,UAAW,OACXK,KAAM,CAAEjhC,MAAO,cAAekqC,MAAOxC,GACrCtwC,KAAM,UACNiH,KAAM,UACP,EA4XSivC,CAAmB,CACjB7F,WACA9rB,YACA+rB,YACAhqB,SAAU+tB,GACVtsB,yBACAyB,sBAGL,GACF,CAAC8mB,EAAW/rB,EAAW+N,EAAUnN,EAAoBkvB,GAAiBtsB,EAAwByB,IAE3F2sB,IAAoB5kC,EAAAA,EAAAA,UAAQ,IAAM,IAAIyjC,MAAczM,KAAW,CAACA,GAAUyM,MAE1E,aAAE/M,GAAY,YAAEC,GAAW,gBAAEC,GAAe,aAAEC,GAAY,uBAAEC,KAA2BC,EAAAA,EAAAA,OAEvF,cAAE9oB,KAAkB0D,EAAAA,EAAAA,MAEpB,qBAAE4nB,KAAyBC,EAAAA,EAAAA,IAC/B3C,GACAL,EACAoO,GACAC,EAAAA,GACApB,GAAU/1C,QAGNo3C,GAtMiBC,EACzBhwB,EACAkD,EACA6qB,IAGE/tB,IAAaC,EAAAA,GAA6BqF,OACzCyY,EAAAA,EAAAA,OAAsCgQ,IAAoB9tB,EAAAA,GAA6BsF,cAEjF,OAELvF,IAAaC,EAAAA,GAA6BoF,MAA2B,QAAnBnC,EAC7C,MAEF,SAwLmB8sB,CAAmBhwB,EAAUkD,EAAgB6qB,IAE/DkC,IAAgBhlC,EAAAA,EAAAA,UAAQ,IACxB8iC,KAAoB9tB,EAAAA,GAA6BC,OAC5CuB,EAGFvI,IAAcg3B,EAAAA,EAAAA,IAA4BnC,MAChD,CAAC70B,GAAe60B,GAAiBtsB,IAE9B0uB,IAAmCllC,EAAAA,EAAAA,UAAQ,IAC3C4X,GACK,CACLkhB,SAAU,CAAErxB,KAAM,GAAIpQ,MAAOzB,EAAMuB,OAAOI,eAC1C7B,KAAoB,QAAdyiB,EAAsB,MAAQ,SACpCmkB,WAAYsG,EACZ/sB,MAAOgL,EACPskB,eAAsB/qC,IAAXymB,EACXsb,WAAY,KAGP,CACLrD,SAAU,CAAErxB,KAAM,GAAIpQ,MAAOzB,EAAMuB,OAAOI,eAC1C7B,KAAoB,QAAdyiB,EAAsB,MAAQ,SACpCmkB,WAAYsG,IAGf,CAACzqB,EAAWyqB,EAAehtC,EAAOirB,EAAQjJ,KAEvCwtB,IAAmCplC,EAAAA,EAAAA,UAAQ,IAC3C4X,GACK,CACLzpB,MAAO62C,GACPlM,SAAU,CAAErxB,KAAM,GAAIpQ,MAAOzB,EAAMuB,OAAOI,eAC1Cse,MAAO+K,EACPukB,eAAsB/qC,IAAXwmB,EACXlrB,KAAMovC,IAGD,CACL32C,MAAO62C,GACPlM,SAAU,CAAErxB,KAAM,GAAIpQ,MAAOzB,EAAMuB,OAAOI,iBAG7C,CAAC3B,EAAOovC,GAAepkB,EAAQkkB,GAAiBltB,MAE5C1H,GAAQgpB,KAAap/B,EAAAA,EAAAA,UAA0B,CACpDxL,MAAOA,GAASqoC,GAChBpoC,OAAQA,GAAUmoC,GAClBpR,SACAxD,MAAOsjB,GACPrjB,MAAOmjB,GACPG,YAAY,KAGdxqC,EAAAA,EAAAA,YAAU,KACRq+B,IAAWjhC,IACT,MAAMqtC,EAAgB,IACjBrtC,EACH3J,MAAOA,GAASqoC,GAChBpoC,OAAQA,GAAUmoC,GAClBpR,SACAvD,MAAOmjB,GACPG,YAAY,GAKd,OAHIztB,KACF0tB,EAAcxjB,MAAQsjB,KAEpBG,EAAAA,EAAAA,SAAQD,EAAertC,GAClBA,EAEFqtC,CAAa,GACpB,GACD,CACD3O,GACAD,GACApR,EACA8f,GACAF,GACA52C,EACAC,EACAy2C,GACAptB,KAGF,MAAM4tB,IAA6BxlC,EAAAA,EAAAA,UAAQ,MAAyB,OAAlB4T,QAAkB,IAAlBA,OAAkB,EAAlBA,EAAoBlmB,SAAU,GAAK,GAAG,CAACkmB,IAEnF8lB,IAAgB3mB,EAAAA,EAAAA,cACpB0yB,IAAwB,IAADC,EAAAC,EAAA,IAAtB,OAAE9L,EAAM,MAAExjC,GAAOovC,EAChB,MAAMG,EAAe/L,EAAO,GACtBgM,EAA+B,OAAZD,QAAY,IAAZA,OAAY,EAAZA,EAAcjiB,KAGvC,GAFA4V,GAA8C,QAA1BmM,EAAa,OAAZE,QAAY,IAAZA,OAAY,EAAZA,EAAc7L,mBAAW,IAAA2L,EAAAA,GAAK,IAE9CG,EACH,OAEF,MAAMz+B,EAAUy+B,EAAiBlmB,KAG3B0S,EAA6C,QAAjCsT,EAAGE,EAAiB1E,qBAAa,IAAAwE,OAAA,EAA9BA,EAAiCC,EAAa5L,YAE7DrW,EAA0C,CAE9C+O,OAAQkT,EAAa52C,EAErBujC,OAAQqT,EAAa32C,EAErBojC,eAEAzmB,MAAOg6B,EAAa5L,WAEpBvpB,MAAOu0B,IAEL59B,IACK,OAAP6Z,QAAO,IAAPA,GAAAA,EAAU7Z,EAAS/Q,EAAOstB,GAC5B,GAEF,CAAC1C,EAASsY,GAAsByL,KAG5B9K,IAAkBnnB,EAAAA,EAAAA,cAAY,KACzB,OAATmO,QAAS,IAATA,GAAAA,IACAqY,IAAsB,EAAE,GACvB,CAACrY,EAAWqY,KAETuM,IAAqB9lC,EAAAA,EAAAA,UAAQ,KAAMi5B,EAAAA,EAAAA,GAAyBrjC,IAAQ,CAACA,IAiCrEmwC,GAAkB71B,GACpB61B,GAAgBjkB,QAClBikB,GAAgBjkB,MAAM3zB,MAAQ62C,GAC9Be,GAAgBjkB,MAAMpsB,KAAOovC,GACzBlkB,IACFmlB,GAAgBjkB,MAAMjM,MAAQ+B,GAC1BgJ,EArCcolB,EACpBjxB,EACA6L,EACA3I,KAEA,GACElD,IAAaC,EAAAA,GAA6BoF,MACrB,kBAAdwG,EAAO,IACO,kBAAdA,EAAO,IAES,QAAnB3I,EAA0B,CAC5B,GAAI2I,EAAO,GAAK,GAAKA,EAAO,GAAK,EAE/B,OACK,GAAIA,EAAO,GAAK,EAErB,MAAO,CAAC,EAAGA,EAAO,GAEtB,CAEF,MAAO,IAAIA,EAAO,EAkBZolB,CAAcjxB,EAAU6L,EAAQ3I,IAEtC8tB,GAAgBjkB,MAAM+a,YAAa,EACnCkJ,GAAgBjkB,MAAMqa,YACpBrJ,EAAAA,EAAAA,OAAsCgQ,KAAoB9tB,EAAAA,GAA6BsF,cACnF,gBACAlgB,GAER2rC,GAAgB1M,SAAW,CAAEnpB,OAAQ41B,IAEjCC,GAAgBhkB,OAASlB,IAC3BklB,GAAgBhkB,MAAMlM,MAAQgL,EAC9BklB,GAAgBhkB,MAAM8a,YAAa,EACnCkJ,GAAgBhkB,MAAMoa,WAAa,KAGrC,MAAM9B,IAAkBr6B,EAAAA,EAAAA,UACtB,KAAMimC,EAAAA,EAAAA,IAAuBllB,EAAUnN,EAAoBZ,EAAW2C,EAAUP,IAChF,CAAC2L,EAAUnN,EAAoBZ,EAAW2C,EAAUP,KAGhD,gBACJ8wB,GAAe,YACfC,GACAC,cAAeC,GACfC,aAAcC,GACdC,eAAgBC,IFpzB0Bx4C,KAuBzC,IAvB0C,UAC/CizB,EAAS,QACTD,EAAO,SACPF,EAAQ,SACRiW,EAAQ,gBACRqD,EAAe,2BACfmL,EAA0B,cAC1BR,EAAa,SACbjwB,EAAQ,SACRjd,EAAQ,qBACRyhC,EAAoB,eACpBthB,EAAiB,SAAQ,kBACzB4qB,EAAoB,GAWrB50C,EAEC,MAAMy4C,GAAkB1uC,EAAAA,EAAAA,QASrB,CACD2uC,oBAAqB,EACrBC,gBAAiB,EACjBC,iBAAkB,EAClBC,gBAAiB,EACjBC,WAAY,EACZC,cAAe,KACfC,UAAW,KACXC,aAAa,IAITC,GAAqBnvC,EAAAA,EAAAA,QAAuB,MAG5CovC,GAA0BpvC,EAAAA,EAAAA,aAAsDoC,GAGhFitC,GAAiBrnC,EAAAA,EAAAA,UAAQ,KAAMsnC,EAAAA,EAAAA,MAAKtQ,EAASn1B,KAAI/M,IAAA,IAAC,EAAE9F,GAAG8F,EAAA,OAAK9F,CAAC,IAAEw0C,SAAqB,CAACxM,KAGpFuQ,EAAmBC,IAAwB1tC,EAAAA,EAAAA,UAGxC,MAIJ2tC,GAAqBzvC,EAAAA,EAAAA,aAAyDoC,GAC9EstC,GAA2B1vC,EAAAA,EAAAA,QAAOqiC,GAClCsN,GAAoB3vC,EAAAA,EAAAA,QAAO+oB,GAC3B6mB,GAAoB5vC,EAAAA,EAAAA,QAAOg/B,GAC3B6Q,GAAuB7vC,EAAAA,EAAAA,QAAOqvC,GAC9BS,GAAkB9vC,EAAAA,EAAAA,QAAOuvC,GAG/BG,EAAyBzvC,QAAUoiC,EACnCsN,EAAkB1vC,QAAU8oB,EAC5B6mB,EAAkB3vC,QAAU++B,EAC5B6Q,EAAqB5vC,QAAUovC,EAC/BS,EAAgB7vC,QAAUsvC,EAG1B,MAAMQ,GAAkBh1B,EAAAA,EAAAA,cAAai1B,IAA8B,IAADC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAChE,MAAMC,EAAoC,QAAtBN,EAAGD,EAAO93B,OAAO4R,aAAK,IAAAmmB,GAAO,QAAPC,EAAnBD,EAAqBpyB,aAAK,IAAAqyB,OAAP,EAAnBA,EAA6B,GAC9CM,EAAoC,QAAtBL,EAAGH,EAAO93B,OAAO4R,aAAK,IAAAqmB,GAAO,QAAPC,EAAnBD,EAAqBtyB,aAAK,IAAAuyB,OAAP,EAAnBA,EAA6B,GAGpD,IAAIK,GAAgBlE,EAAAA,EAAAA,UAASgE,GAAkBA,EAAiB,IAAI/zC,KAAmB,OAAd+zC,QAAc,IAAdA,EAAAA,EAAkB,GAAGG,UAC1FC,GAAgBpE,EAAAA,EAAAA,UAASiE,GAAkBA,EAAiB,IAAIh0C,KAAmB,OAAdg0C,QAAc,IAAdA,EAAAA,EAAkB,GAAGE,UAE9FD,GAAiB1K,EAAkBwK,GACnCI,GAAiB5K,EAAkByK,GAGnC9B,EAAgBzuC,QAAQ6uC,gBAA+B,QAAhBuB,EAAGI,SAAa,IAAAJ,EAAAA,EAAI,EAC3D3B,EAAgBzuC,QAAQ8uC,YAA2B,QAAduB,EAACK,SAAa,IAAAL,EAAAA,EAAI,GAAK5B,EAAgBzuC,QAAQ6uC,eAAe,GAClG,IAEG8B,GAA0B71B,EAAAA,EAAAA,cAAY,KAC1C,MAAM,cAAEi0B,EAAa,UAAEC,GAAcP,EAAgBzuC,QAErD,GAAI+uC,GAAiBC,EAAW,CAC9B,MAAM4B,EAAgB7B,EAAc8B,wBAC9BC,EAAgB9B,EAAU6B,wBAGhCpC,EAAgBzuC,QAAQ0uC,oBAAsBkC,EAAc75C,EAC5D03C,EAAgBzuC,QAAQ2uC,gBAAkBmC,EAAcz6C,MACxDo4C,EAAgBzuC,QAAQ4uC,iBAAmBkC,EAAc/5C,EAAI65C,EAAc75C,EAC3E03C,EAAgBzuC,QAAQivC,YAAc6B,EAAcz6C,MAAQ,CAC9D,IACC,IAIG06C,GAAsBj2B,EAAAA,EAAAA,cAC1B,CAACi1B,EAA0BiB,KACzBlB,EAAgBC,GAEhB,MAAMhB,EAAmCiC,EAASC,cAzI5B,aA0IhBjC,EAA+BgC,EAASC,cAAcpL,GAE5D4I,EAAgBzuC,QAAQ+uC,cAAgBA,EACxCN,EAAgBzuC,QAAQgvC,UAAYA,EACpC2B,GAAyB,GAE3B,CAACb,EAAiBa,IAIdO,GAAoBp2B,EAAAA,EAAAA,cACxB,CAACi1B,EAA0BiB,KACzBzB,EAAqB,CAAEQ,SAAQiB,aAC/BD,EAAoBhB,EAAQiB,EAAS,GAEvC,CAACD,KAGHnuC,EAAAA,EAAAA,YAAU,KAERuuC,uBAAsB,KACftB,EAAgB7vC,SAGrB+wC,EAAoBlB,EAAgB7vC,QAAQ+vC,OAAQF,EAAgB7vC,QAAQgxC,SAAS,GACrF,GACD,CAACpG,EAAmBmG,IAGvB,MAAMK,GAA2Bt2B,EAAAA,EAAAA,cAC9BvlB,IAEKA,EAAE87C,yBAAyBC,SAAW/7C,EAAE87C,cAAcE,UAAUC,SAAS,eAGpE,OAATvoB,QAAS,IAATA,GAAAA,IACIimB,EAAmBlvC,UACrBkvC,EAAmBlvC,QAAQ9F,MAAM6E,QAAU,QAC7C,GAEF,CAACkqB,IAIGwoB,GAAuB32B,EAAAA,EAAAA,cAC3Bre,IAAiB,IAADgxC,EAAAC,EAAA,IAAf,OAAE9L,GAAQnlC,EACT,MAAMkxC,EAAe/L,EAAO,GACtBgM,EAA+B,OAAZD,QAAY,IAAZA,OAAY,EAAZA,EAAcjiB,KAIvC,GAFA4V,EAA8C,QAA1BmM,EAAa,OAAZE,QAAY,IAAZA,OAAY,EAAZA,EAAc7L,mBAAW,IAAA2L,EAAAA,GAAK,IAE9CG,EACH,OAIF,MAAMxT,EAA6C,QAAjCsT,EAAGE,EAAiB1E,qBAAa,IAAAwE,OAAA,EAA9BA,EAAiCC,EAAa5L,YAE7D2P,EAAqD,CAEzDjX,OAAQkT,EAAa52C,EAErBujC,OAAQqT,EAAa32C,EAErBojC,eAEAzmB,MAAOg6B,EAAa5L,WAEpBvpB,MAAOu0B,EAEP4E,UAAW/D,EAAiBlmB,MAI9BynB,EAAwBnvC,QAAU0xC,CAAe,GAEnD,CAAC3E,EAAezL,IAIZsQ,GAAyB92B,EAAAA,EAAAA,cAAY,KACzCq0B,EAAwBnvC,aAAUmC,EAClCm/B,GAAsB,EAAE,GACvB,CAACA,IAEEuQ,GAAmB/2B,EAAAA,EAAAA,cACtBg3B,IACC,MAAMC,EAAatD,EAAgBzuC,QAE7BgyC,GACHF,EAAiBC,EAAWnD,iBAAmBmD,EAAWrD,qBAAuBqD,EAAWpD,gBAG/F,IAAIsD,EAAcF,EAAWlD,gBAAkBkD,EAAWjD,WAAakD,EAWvE,MAVuB,QAAnBhyB,IACFiyB,EAAc,IAAMA,GAGArC,EAAqB5vC,QAAQyD,QAAO,CAACC,EAAK3M,IAC1D6nB,KAAKszB,IAAIn7C,EAAIk7C,GAAerzB,KAAKszB,IAAIxuC,EAAMuuC,GACtCl7C,EAEF2M,GACNksC,EAAqB5vC,QAAQ,GACZ,GAEtB,CAACggB,KAGHpd,EAAAA,EAAAA,YAAU,KAER,GAAI/C,EACF,OAGF,IAAKyvC,EACH,OAIFQ,EAAgBR,EAAkBS,QAGlC,MAAMf,EAA+BM,EAAkB0B,SAASC,cAAcpL,GAGxEsM,GAA2BC,EAAAA,EAAAA,WAC9B78C,IAEMk5C,EAAgBzuC,QAAQivC,aAC3B0B,IAEF,MAAM0B,EAAgBR,EAAiBt8C,EAAE+8C,SAGnC5mB,EAAO+jB,EAAyBzvC,QAAQ4J,KAAK2oC,IAAiB,IAADC,EAAAC,EAEjE,MAAMC,EAAyBhD,EAAkB1vC,QAAQgO,MAAKxM,IAAA,IAAC,KAAEkmB,GAAMlmB,EAAA,OAAKkmB,IAAS6qB,EAAY7qB,IAAI,IAC/FirB,EAAyBhD,EAAkB3vC,QAAQgO,MACvDlE,IAAA,IAAC,KAAE4d,EAAI,UAAE3M,GAAWjR,EAAA,OAAK4d,IAAS6qB,EAAY7qB,MAAQ6qB,EAAYx3B,YAAcA,CAAS,IAG3F,IAAK43B,EACH,OAKF,MAAMtX,EAAckS,EAA6BgF,EAAY/5B,MAA8B,OAAtBk6B,QAAsB,IAAtBA,OAAsB,EAAtBA,EAAwBrX,YAGvFuX,EAAiC,QAA3BJ,EAAGG,EAAuB57C,SAAC,IAAAy7C,OAAA,EAAxBA,EAA0B/c,QAAQ4c,GACjD,IAAI1zB,EAAAA,EAAAA,aAAYi0B,KAAuB,IAAZA,EACzB,OAEF,MAAMxtC,EAAgC,QAA3BqtC,EAAGE,EAAuB37C,SAAC,IAAAy7C,OAAA,EAAxBA,EAA2BG,GAGzC,MAAO,CACLvX,YAAaA,GAAe,GAC5Bj2B,OAAOknC,EAAAA,EAAAA,UAASlnC,GAASA,OAAQjD,EACjC/C,MAAkB,OAAXmzC,QAAW,IAAXA,OAAW,EAAXA,EAAanzC,MACpB4lC,UAAsB,OAAXuN,QAAW,IAAXA,OAAW,EAAXA,EAAavN,UACxBtd,KAAM,GAAG6qB,EAAY7qB,QAAQ6qB,EAAYx3B,YAC1C,IAIHy0B,EAAmBxvC,QAAU,CAC3B6yC,oBAAoBC,EAAAA,EAAAA,UAAQx5B,EAAAA,EAAAA,SAAQoS,GAAO,QAAS,QACpDuR,iBAAyC,OAAvBkS,QAAuB,IAAvBA,OAAuB,EAAvBA,EAAyBnvC,QAC3Cy6B,OAAQ4X,EACRv1B,WACAiwB,gBACD,GApT4B,GAuT/B,CAAEgG,SAAS,IAGPC,GAAsBZ,EAAAA,EAAAA,UAASzB,EA1TJ,IA8T3BsC,EAAgB19C,IAAqB,IAAD29C,EAAAC,EACxC,IAAK3D,EAAmBxvC,QACtB,OAGF,MAAM+xC,EAAatD,EAAgBzuC,QAC7BqyC,EAAgBR,EAAiBt8C,EAAE+8C,SAInCc,IAFiB,QAAnBpzB,EAA2BpB,KAAKC,MAAMwzB,GAAiBA,GAAiBN,EAAWlD,iBACrFkD,EAAWjD,WAC0CiD,EAAWpD,gBAG9DO,EAAmBlvC,UACrBkvC,EAAmBlvC,QAAQ9F,MAAM6E,QAAU,QAC3CmwC,EAAmBlvC,QAAQ9F,MAAM6B,KAAO,GAAGg2C,EAAWnD,iBAAmBwE,OAGpE,OAAPpqB,QAAO,IAAPA,GAAAA,GAC4B,QAA1BkqB,EAAA1D,EAAmBxvC,eAAO,IAAAkzC,GAAkB,QAAlBC,EAA1BD,EAA4BjW,wBAAgB,IAAAkW,OAAlB,EAA1BA,EAA8CxB,YAAa,GAC3D,CACE56C,EAAGg7C,EAAWrD,oBAAsBqD,EAAWnD,iBAAmBwE,EAClEp8C,EAAGzB,EAAE89C,QACLC,cAAe/9C,GAEjBi6C,EAAmBxvC,QACpB,EAGH,OAAIgvC,GAEFA,EAAUnsC,iBAAiB,cAAesvC,GAC1CnD,EAAUnsC,iBAAiB,cAAeowC,GAC1CzuC,OAAO3B,iBAAiB,SAAUmwC,GAGlChE,EAAUnsC,iBAAiB,eAAgBuuC,GACpC,KACLpC,EAAUuE,oBAAoB,cAAepB,GAC7CnD,EAAUuE,oBAAoB,cAAeN,GAC7CjE,EAAUuE,oBAAoB,eAAgBnC,GAC9C5sC,OAAO+uC,oBAAoB,SAAUP,EAAoB,GAItD,MAAQ,GACd,CACD5B,EACA9B,EACAQ,EACA9mB,EACAukB,EACA4B,EACAtvC,EACAid,EACAiwB,EACA/sB,EACA6xB,EACAlB,IAGF,MAAM1C,EAAkBpuC,EAAW,MACjC7E,EAAAA,EAAAA,GAAA,OACEW,KAAGC,EAAAA,EAAAA,IAAE,CACH43C,IAAK,EACLn9C,MAAO,EACPo9C,WAAY,6BACZn9C,OAAQ,OACR2E,SAAU,WACVy4C,cAAe,QAChB,IACDh9C,IAAKw4C,EACLh1C,MAAO,CAAE6E,QAAS,UAItB,MAAO,CACLovC,cAAe4C,EACf7C,YAAagD,EACbjD,kBACAI,aAAcoD,EACdlD,eAAgBqD,EACjB,EEwbK+B,CAAiC,CACnCvR,mBACArD,YACAjW,WACAykB,8BACAvkB,UACAC,UAAWgZ,GACX8K,iBACAjwB,SAAU+tB,GACV7qB,eAAgBlD,IAAaC,EAAAA,GAA6BoF,KAAOnC,EAAiB,SAClFshB,wBACAzhC,UAAWulB,EACXwlB,sBAQI1I,IAAuBC,EAAAA,EAAAA,GAC3B/c,EAAgCkpB,GAA4B7M,KAI9D7+B,EAAAA,EAAAA,YAAU,KAGR,MACM0/B,IAD6C,OAAlB3mB,QAAkB,IAAlBA,OAAkB,EAAlBA,EAAoBlmB,SAAU,GAAK,EAEhEk3C,GAAkB/iC,KAAKskB,GACrBA,EAAUnT,UACN,IACKmT,EACHxxB,KAAM,GAAGwxB,EAAUxxB,SAASwxB,EAAUnT,cAExCmT,IAENye,GAEEhI,EAAkC,IACnC1sB,GACHm1B,YAAY,EACZwG,OAAQ,CACN5P,YAAa,MAGG,OAApBxF,QAAoB,IAApBA,GAAAA,GAAuBgE,EAAAA,EAAAA,GAAgCF,EAAcqC,GAAgB,GACpF,CAAC1sB,GAAQumB,EAAsBmO,GAAqC,OAAlBhxB,QAAkB,IAAlBA,OAAkB,EAAlBA,EAAoBlmB,SAEzE,MAAMm/B,IACJv5B,EAAAA,EAAAA,IAAA,OACEM,IAAG,CAAG8mC,EAAAA,GAAsBC,aAAa/kC,GAAQhB,EAAOkoC,gBAAe,IACvEx+B,UAAWA,EACX3P,IAAKioC,GAAgBvjC,SAAA,EAErBJ,EAAAA,EAAAA,GAAC4nC,EAAAA,EAAQ,CACPlX,KAAMihB,GACN9J,kBAAmBhE,GACnBljC,IAAK8mC,EAAAA,GAAsB7N,MAAMj3B,GACjC2gC,SAAUA,CAACyR,EAA0BiB,KAC/B5rB,GACFgpB,GAA0B2B,EAAQiB,GAE5B,OAAR1S,QAAQ,IAARA,GAAAA,EAAWyR,EAAQiB,EAAS,EAE9B/4B,OAAQ61B,GACRnwB,OAAQkgB,EACR7U,QAASkZ,GACTjZ,UAAW7D,EAAgCopB,GAA8BvM,GACzE4R,cAAe3F,KAEhBD,MAIL,OACEjzC,EAAAA,EAAAA,GAAC8nC,EAAAA,EAAwB,CAACC,UAAWX,GAAiBzK,WAAYA,EAAWv8B,SAC1Ew5B,IACwB,IAK3Bj4B,EAAS,CACbkoC,gBAAiB,CACf,wBAAyB,CACvBC,WAAY,2BAEd,mDAAoD,CAClD38B,QAAS,8CAEX,yDAA0D,CACxDA,QAAS,+CAEX,6DAA8D,CAC5DA,QAAS,+CAEX,0DAA2D,CACzDtR,OAAQ,4BACRgC,YAAa,wCAEf,uEAAwE,CACtEsP,QAAS,2C,sLCp7Bf,MAAM2rC,EAA0B99C,IAAA,IAAC,MAAEoP,GAAmCpP,EAAA,OACpEqF,EAAAA,EAAAA,IAAAC,EAAAA,GAAA,CAAAF,SAAA,EACEJ,EAAAA,EAAAA,GAAC+4C,EAAAA,GAAa,CAAC3uC,MAAOA,EAAO4uC,KAAK,YAAY,KAC9Ch5C,EAAAA,EAAAA,GAAC+4C,EAAAA,GAAa,CAAC3uC,MAAOA,EAAO6uC,MAAM,YAAY,KAC/Cj5C,EAAAA,EAAAA,GAAC+4C,EAAAA,GAAa,CAAC3uC,MAAOA,EAAO8uC,IAAI,YAAY,KAACl5C,EAAAA,EAAAA,GAACm5C,EAAAA,GAAa,CAAC/uC,MAAOA,EAAOgvC,KAAK,UAAUC,UAAU,QAAQ,KAC5Gr5C,EAAAA,EAAAA,GAACm5C,EAAAA,GAAa,CAAC/uC,MAAOA,EAAOkvC,OAAO,YAAY,KAChDt5C,EAAAA,EAAAA,GAACm5C,EAAAA,GAAa,CAAC/uC,MAAOA,EAAOmvC,OAAO,UAAUC,uBAAwB,MACrE,EAKCC,EAA+B53C,IAAA,IAAC,MAAEuI,GAAmCvI,EAAA,OACzExB,EAAAA,EAAAA,IAAAC,EAAAA,GAAA,CAAAF,SAAA,EACEJ,EAAAA,EAAAA,GAACm5C,EAAAA,GAAa,CAAC/uC,MAAOA,EAAOgvC,KAAK,UAAUC,UAAU,QAAQ,KAC9Dr5C,EAAAA,EAAAA,GAACm5C,EAAAA,GAAa,CAAC/uC,MAAOA,EAAOkvC,OAAO,YAAY,KAChDt5C,EAAAA,EAAAA,GAACm5C,EAAAA,GAAa,CAAC/uC,MAAOA,EAAOmvC,OAAO,UAAUC,uBAAwB,MACrE,EAGL,IAAAhzC,EAAA,CAAA9E,KAAA,UAAAC,OAAA,oBAIO,MAAMogC,EAAgCtgC,IAAyE,IAAxE,UAAEu9B,GAAgEv9B,EAC9G,MAAM,mBAAEo2C,EAAoB5V,iBAAkBD,EAAoB,OAAEvC,EAAM,cAAEsS,GAAkB/S,GACtF2X,UAAWxiC,EAAO,aAAEirB,GAAiB4C,GAAwB,CAAC,EAEhEjnB,GAAO2D,EAAAA,EAAAA,MACP,MAAE/b,IAAUC,EAAAA,EAAAA,KAEZ82C,EAAmB,GAAGvlC,KAAuB,OAAZirB,QAAY,IAAZA,OAAY,EAAZA,EAAc35B,MAC/Ck0C,EACJ3a,EAAUld,WAAaC,EAAAA,GAA6BC,OAChD+vB,EACAh3B,EAAKC,eAAcg3B,EAAAA,EAAAA,IAA4BhT,EAAUld,WAE/D,OAAI+1B,GAEAx3C,EAAAA,EAAAA,IAAA,OAAAD,SAAA,GACIujB,EAAAA,EAAAA,aAAY8b,KACZp/B,EAAAA,EAAAA,IAAA,OAAKM,KAAGC,EAAAA,EAAAA,IAAE,CAAEsM,aAAcvK,EAAMgN,QAAQqC,IAAI,IAAC5R,SAAA,EAC3CJ,EAAAA,EAAAA,GAAA,QAAMW,IAAG6F,EAAyBpG,SAAEu5C,IAA6B,IAChE3a,EAAUld,WAAaC,EAAAA,GAA6BqF,MACnDpnB,EAAAA,EAAAA,GAAC84C,EAAuB,CAAC1uC,MAAOq1B,KAC9BI,EAAAA,EAAAA,OACFb,EAAUld,WAAaC,EAAAA,GAA6BsF,eACpDrnB,EAAAA,EAAAA,GAACy5C,EAA4B,CAACrvC,MAAOq1B,IAErCA,MAINz/B,EAAAA,EAAAA,GAAA,OACEW,KAAGC,EAAAA,EAAAA,IAAE,CACHmD,QAAS,OACTyE,oBAAqB,GAAG7F,EAAMW,QAAQ0zB,uBACtCjlB,UAAWpP,EAAMgN,QAAQC,GACzBgqC,OAAQj3C,EAAMgN,QAAQC,GAAK,EAC3B5L,WAAY,UACb,IAAC5D,SAEDy3C,EAAmBjpC,KAAIE,IAAA,IAAC,YAAEuxB,EAAW,MAAEj8B,EAAK,KAAEsoB,EAAI,MAAEtiB,EAAK,UAAE4/B,GAAWl7B,EAAA,OACrEzO,EAAAA,EAAAA,IAACY,EAAAA,SAAc,CAAAb,SAAA,EACbJ,EAAAA,EAAAA,GAACkqC,EAAAA,EAAwB,CAAC9lC,MAAOA,GAAS,cAAe4lC,UAAWA,KAEpEhqC,EAAAA,EAAAA,GAAA,OACEW,KAAGC,EAAAA,EAAAA,IAAE,CACHmT,YAAapR,EAAMgN,QAAQc,GAC3BL,SAAUzN,EAAMiB,WAAWkO,WAC3B1N,MAAOs1C,IAAqBhtB,EAAO,QAAU/pB,EAAMuB,OAAO21C,iBAC3D,IAACz5C,SAEDigC,KAEHrgC,EAAAA,EAAAA,GAAA,OAAAI,WACIujB,EAAAA,EAAAA,aAAYvZ,KACZpK,EAAAA,EAAAA,GAAA,QACEW,KAAGC,EAAAA,EAAAA,IAAE,CACHk5C,WAAYJ,IAAqBhtB,EAAO,OAAS,SACjDtoB,MAAOs1C,IAAqBhtB,EAAO,QAAU/pB,EAAMuB,OAAO21C,iBAC3D,IAACz5C,SAEDgK,QApBYsiB,EAwBJ,SAMpB,IAAI,C,sLCnEb,MAAMmW,EAAc,CAClBC,aAAa,EACbC,YAAY,EACZC,uBAAwB,CAAC,YAcdlP,EAAkB7yB,EAAAA,MAC7BjG,IAe6B,IAf5B,SACC8yB,EAAQ,MACR2E,EAAK,MACLC,EAAK,WACLwQ,EAAa,GAAE,UACf73B,EAAS,OACTgnB,EAAS6V,EAAAA,GAAsB,SAC/B5E,EAAQ,QACRtV,EAAO,UACPC,EAAS,MACT5yB,EAAK,OACLC,EAAM,mBACNyyB,GAAqB,EAAI,gBACzBwV,EAAe,qBACfC,GACqBxoC,EACrB,MAAM,MAAE2H,IAAUC,EAAAA,EAAAA,MAEZ,aAAE6gC,EAAY,YAAEC,EAAW,gBAAEC,EAAe,aAAEC,EAAY,uBAAEC,IAA2BC,EAAAA,EAAAA,MAEvFC,GAAWh3B,EAAAA,EAAAA,UAAQ,KAEvB,MAAMi3B,EAA+B,GAC/BC,EAA+B,GAC/B//B,EAA8B,GAC9BigC,EAAuB,GAG7B,IAAK,MAAMtxB,KAAWib,EAAU,CAAC,IAADsW,EAAAC,EAC9B,MAAM,QAAErZ,EAAO,QAAEuU,EAAO,OAAE9oB,EAAM,MAAErS,EAAK,KAAEsoB,EAAI,YAAE2T,GAAgBxtB,GACzD,QAAEsB,EAAO,QAAEE,GAAY2W,GAAW,CAAC,EACnCuZ,EAA2B,WAAf9R,EAAMhwB,KAAoB88B,EAAU9oB,EAChD+tB,EAA2B,WAAf9R,EAAMjwB,KAAoB88B,EAAU9oB,EAEhD1a,EAAa,OAATwoC,QAAS,IAATA,GAAsB,QAAbH,EAATG,EAAY9R,EAAMhtB,YAAI,IAAA2+B,OAAb,EAATA,EAAwBh6B,MAC5BpO,EAAa,OAATwoC,QAAS,IAATA,GAAsB,QAAbH,EAATG,EAAY9R,EAAMjtB,YAAI,IAAA4+B,OAAb,EAATA,EAAwBj6B,OAE7Bo1B,EAAAA,EAAAA,OAAMzjC,KAAOyjC,EAAAA,EAAAA,OAAMxjC,KACtBgoC,EAAQvpB,KAAK1e,GACbkoC,EAAQxpB,KAAKze,GACbkI,EAAOuW,KAAKrW,GAASzB,EAAMuB,OAAO0+B,SAC9BzuB,EACFgwB,EAAY1pB,KAAK,CAACtG,EAASE,GAAWF,IAEtCgwB,EAAY1pB,KAAK,CAACiS,EAAM2T,IAG9B,CAEA,MAAO,CACL,CACEtkC,EAAGioC,EACHhoC,EAAGioC,EACHW,WAAYT,EACZU,KAAM/W,EAASlf,KAAI/M,IAAA,IAAC,YAAEw+B,GAAax+B,EAAA,OAAKw+B,CAAW,IACnDyE,cAAe/W,EAlEvB,mIAkEsE5mB,EAC9D69B,UAAWjX,OAAqB5mB,EAAY,OAC5C89B,WAAYlX,EAAqBmX,EAAAA,QAAsB/9B,EACvD1E,KAAM,UACNge,KAAM,UACN0kB,aAAc,gBACdC,OAAQ,CACN5wB,KAAM0uB,EACN9+B,MAAOF,IAGZ,GACA,CAAC4pB,EAAU2E,EAAOC,EAAO/vB,EAAOugC,EAAYnV,IAEzCgY,GAAqBh5B,EAAAA,EAAAA,UAAQ,KAAMi5B,EAAAA,EAAAA,GAAyBrjC,IAAQ,CAACA,KAEpEsa,EAAQgpB,IAAap/B,EAAAA,EAAAA,UAA0B,CACpDxL,MAAOA,GAASqoC,EAChBpoC,OAAQA,GAAUmoC,EAClBpR,SACAxD,MAAO,CAAE3zB,MAAOu3B,EAAMhtB,IAAKogC,SAAU,CAAErxB,KAAM,GAAIpQ,MAAOzB,EAAMuB,OAAOI,gBACrEwqB,MAAO,CAAE5zB,MAAOw3B,EAAMjtB,IAAKogC,SAAU,CAAErxB,KAAM,GAAIpQ,MAAOzB,EAAMuB,OAAOI,gBACrE8hC,SAAU,CAAEnpB,OAAQ8oB,MAGtBn+B,EAAAA,EAAAA,YAAU,KACRq+B,GAAWjhC,IACT,MAAMqhC,EAAY,IACbrhC,EACH3J,MAAOA,GAASqoC,EAChBpoC,OAAQA,GAAUmoC,EAClBpR,UAWF,OARIgU,EAAUxX,QACZwX,EAAUxX,MAAM3zB,MAAQu3B,EAAMhtB,KAG5B4gC,EAAUvX,QACZuX,EAAUvX,MAAM5zB,MAAQw3B,EAAMjtB,KAGzB4gC,CAAS,GAChB,GACD,CAAC3C,EAAaD,EAAcpR,EAAQI,EAAMhtB,IAAKitB,EAAMjtB,IAAKpK,EAAOC,IAEpE,MAAM,qBAAEgrC,IAAyBC,EAAAA,EAAAA,IAC/B3C,EACAL,EACAzV,EACA0Y,EAAAA,IAGIC,GAAgB3mB,EAAAA,EAAAA,cACpBre,IAAiC,IAADgoC,EAAAsQ,EAAAvQ,EAAAE,EAAA,IAA/B,OAAE9C,GAAwBnlC,EAGzB,MAAMulC,EAAmC,QAAbyC,EAAI7C,EAAO,UAAE,IAAA6C,GAAoB,QAApBsQ,EAAVtQ,EAAoB7E,kBAAU,IAAAmV,OAApB,EAAVA,EAAiC,GAChEzT,EAA0C,QAAtBkD,EAAU,QAAVE,EAAC9C,EAAO,UAAE,IAAA8C,OAAA,EAATA,EAAW3C,kBAAU,IAAAyC,EAAAA,GAAK,GAE3CxC,IACK,OAAPhZ,QAAO,IAAPA,GAAAA,EAAUgZ,GACZ,GAEF,CAAChZ,EAASsY,IAGNW,GAAkBnnB,EAAAA,EAAAA,cAAY,KACzB,OAATmO,QAAS,IAATA,GAAAA,IACAqY,GAAsB,EAAE,GACvB,CAACrY,EAAWqY,IAOTY,GAAuBC,EAAAA,EAAAA,GAA6BV,GAEpDW,GAAkBr6B,EAAAA,EAAAA,UAAQ,KAAMs6B,EAAAA,EAAAA,IAAsBvZ,IAAW,CAACA,KAExElmB,EAAAA,EAAAA,YAAU,KACR,MAAM0/B,EAAuBvD,EAASn1B,KAAK24B,IAAW,IACjDA,EACH9mB,KAAM,mBAEY,OAApB+iB,QAAoB,IAApBA,GAAAA,GAAuBgE,EAAAA,EAAAA,GAAgCF,EAAcrqB,GAAQ,GAC5E,CAACA,EAAQumB,EAAsBO,IAElC,MAAMnK,GACJ55B,EAAAA,EAAAA,GAAA,OACEW,IAAG,CAAG8mC,EAAAA,GAAsBC,aAAa/kC,GAAQ8kC,EAAAA,GAAsBE,4BAA2B,IAClGt8B,UAAWA,EACX3P,IAAKioC,EAAgBvjC,UAErBJ,EAAAA,EAAAA,GAAC4nC,EAAAA,EAAQ,CACPlX,KAAMqT,EACN8D,kBAAmBhE,EACnBljC,IAAK8mC,EAAAA,GAAsB7N,MAAMj3B,GACjCsa,OAAQA,EACR0F,OAAQkgB,EACRS,SAAUA,EACVtV,QAASkZ,EACTjZ,UAAWgZ,MAKjB,OAAOjnC,EAAAA,EAAAA,GAAC8nC,EAAAA,EAAwB,CAACC,UAAWX,EAAgBhnC,SAAEw5B,GAAiC,G,mSClM5F,MAAMogB,EAA8B,cAC9BC,EAAiC,mBACjCC,EAAgC,OAAOD,KAE7C,IAAKE,EAAyB,SAAzBA,GAAyB,OAAzBA,EAAyB,4CAAzBA,EAAyB,4BAAzBA,CAAyB,MAyD9B,MAAMC,GAA0BC,EAAAA,EAAAA,OAAKr/C,IAA8D,IAA7D,aAAEs/C,GAAqDt/C,EAClG,MAAMu/C,EAAiBD,EAAa/vB,MAAK1oB,IAAA,IAAC,gBAAE2oB,GAAiB3oB,EAAA,OAAK2oB,CAAe,IAC3EgwB,EAAeF,EAAa/vB,MAAK9oB,IAAA,IAAC,QAAEupB,GAASvpB,EAAA,OAAKupB,CAAO,IAG/D,OAAIzL,EAAAA,EAAAA,MACK,KAGFi7B,GAAgBD,GACrBv6C,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,0CACfmD,OAAQ,CAAE8oC,MAAOH,EAAa7/C,UAG9B8/C,GACFv6C,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,iCACfmD,OAAQ,CAAE8oC,MAAOH,EAAa7/C,WAIhCuF,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,+BACfmD,OAAQ,CAAE8oC,MAAOH,EAAa7/C,SAGjC,IAGH,IAAAqU,EAAA,CAAApN,KAAA,SAAAC,OAAA,gCAAAoN,EAAA,CAAArN,KAAA,UAAAC,OAAA,wCAAAqN,EAAA,CAAAtN,KAAA,SAAAC,OAAA,6EAAAsN,EAAA,CAAAvN,KAAA,UAAAC,OAAA,yBAIO,MAAM+4C,EAA0Bl0C,IAsBU,IAtBT,MACtCtL,EAAK,SACLohC,EAAQ,SACRqe,EAAQ,OACRC,EAAM,SACNx6C,EAAQ,KACRssB,EAAI,aACJhoB,EAAY,QACZm2C,EAAU,GAAE,cACZzd,EAAgB0d,EAAAA,KAAI,YACpB9d,EAAW,UACXC,EAAS,kBACT8d,EAAiB,cACjBC,EAAa,sBACbC,EAAqB,sBACrBC,EAAqB,QACrBC,EAAO,yBACPC,EAA2B,GAAE,gBAC7BC,EAAe,SACfC,EAAQ,OACRhgD,EAAM,aACNigD,GAAe,GAC0B/0C,EACzC,MAAM,MAAE7D,IAAUC,EAAAA,EAAAA,MAEZ,cAAEoD,EAAa,eAAEC,EAAc,cAAEd,EAAa,qBAAEmB,EAAoB,OAAErB,IAGtEgzB,EAAAA,EAAAA,MACK,CACLjyB,mBAAemB,EACflB,oBAAgBkB,EAChBhC,mBAAegC,EACfb,sBAAsB,EACtBrB,QAAQ,IAKLR,EAAAA,EAAAA,GAAsB,CAC3BC,eACAC,QAAS+nB,GAAQ,GACjB9nB,OAAQw4B,IAIND,GAAWrd,EAAAA,EAAAA,cACf,IAAMsd,EAAc1Q,GAAQ,GAAIquB,GAAqB,KACrD,CAAC3d,EAAe1Q,EAAMquB,IAElB7d,GAAapd,EAAAA,EAAAA,cACjB,IAAMsd,EAAc1Q,GAAQ,GAAIsuB,GAAiB,KACjD,CAAC5d,EAAe1Q,EAAMsuB,IAGxB,OACE36C,EAAAA,EAAAA,IAAA,OACEM,KAAGC,EAAAA,EAAAA,IAAE,CAEHtF,QAAQ28B,EAAAA,EAAAA,OAAgD,OAAN38B,QAAM,IAANA,EAAAA,EAAgB,IAClE6E,SAAU,SACV4D,QAAS,OACTy3C,iBAAkB,WAClBpuC,gBAAiBzK,EAAMuB,OAAOu3C,kBAC9Bh7C,QAAS,GAGTsU,cAAepS,EAAMgN,QAAQC,GAC7B9L,OAAQ,aAAanB,EAAMuB,OAAOJ,SAClCN,aAAcb,EAAMW,QAAQo4C,iBAC5B5R,WAAY,gBACZ7pC,SAAU,YACX,IACDf,MAAO,CACLiO,QAAS7G,EAAuB,GAAMrB,EAAS,GAAM,GAEvD,cAAY,oCACZvJ,IAAM2vC,IAEU,OAAdplC,QAAc,IAAdA,GAAAA,EAAiBolC,GACJ,OAAblmC,QAAa,IAAbA,GAAAA,EAAgBkmC,EAAQ,EACxBjrC,SAAA,EAEFC,EAAAA,EAAAA,IAAA,OACEM,IAAGmO,EAGD1O,SAAA,EAEFJ,EAAAA,EAAAA,GAAA,OACEtE,IAAKsK,EACL,cAAY,gDACZrF,KAAGC,EAAAA,EAAAA,IAAE,CACH8O,UAAW/M,EAAMgN,QAAQqC,GACzB+B,YAAapR,EAAMgN,QAAQC,GAC3BvM,OAAQ,QACT,IACDgI,UAAW2uC,EAA4B55C,UAEvCJ,EAAAA,EAAAA,GAAC27C,EAAAA,IAAQ,OAEXt7C,EAAAA,EAAAA,IAAA,OAAKM,IAAGoO,EAAiD3O,SAAA,EACvDJ,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWwD,MAAK,CACf3Y,MAAO0gD,OAAO1gD,GACd4Y,MAAO,EACPnT,IAAGqO,EAKD5O,SAEDlF,IAEFohC,IAAYt8B,EAAAA,EAAAA,GAAA,QAAMW,IAAKgB,EAAO26B,SAAS35B,GAAOvC,SAAEk8B,IAChDue,IAAW76C,EAAAA,EAAAA,GAACmwB,EAAAA,IAAiB,CAACxvB,IAAGsO,EAA+B/T,MAAO2/C,OAEzEU,IACCv7C,EAAAA,EAAAA,GAAA,OACEW,KAAGC,EAAAA,EAAAA,IAAE,CACHvF,MAAOsH,EAAMW,QAAQC,SACrBjI,OAAQqH,EAAMW,QAAQC,SACtBQ,QAAS,OACTC,WAAY,SACZC,eAAgB,UACjB,IAAC7D,UAEFJ,EAAAA,EAAAA,GAAC67B,EAAAA,EAAO,MAGXsf,IACCn7C,EAAAA,EAAAA,GAAA,OACEW,KAAGC,EAAAA,EAAAA,IAAE,CACHmD,QAAS,OACTtD,QAAS,OAAOkC,EAAMgN,QAAQa,OAC9BlI,IAAK3F,EAAMgN,QAAQc,GACnBzM,WAAY,cACb,IAAC5D,SAED+6C,EAAQvsC,KAAKitC,IAEV77C,EAAAA,EAAAA,GAACooB,EAAAA,IAAM,CACL7lB,YAAY,8GAEZ8lB,QAASwzB,EAAOC,cAChBxuC,SAAUuuC,EAAOE,UACjBv+B,MAAOq+B,EAAOG,aAHTH,EAAOG,kBAStBh8C,EAAAA,EAAAA,GAACiD,EAAAA,EAAM,CACLV,YAAY,8BACZL,MAAMlC,EAAAA,EAAAA,GAACi8C,EAAAA,IAAc,IACrBh6C,QAASi5C,EACTr2C,UAAWq2C,KAEb76C,EAAAA,EAAAA,IAACq9B,EAAAA,IAAajqB,KAAI,CAACkqB,OAAO,EAAMv9B,SAAA,EAC9BJ,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaE,QAAO,CAACC,SAAO,EAAAz9B,UAC3BJ,EAAAA,EAAAA,GAACiD,EAAAA,EAAM,CACLV,YAAY,oGACZE,KAAK,WACLP,MAAMlC,EAAAA,EAAAA,GAACk8C,EAAAA,IAAY,IACnB,cAAY,8CAGhB77C,EAAAA,EAAAA,IAACq9B,EAAAA,IAAa9pB,QAAO,CAACmqB,MAAM,MAAMvM,SAAU,IAAIpxB,SAAA,EAC9CJ,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaxgB,KAAI,CAChB3a,YAAY,8GACZN,QAAS24C,EACT,cAAY,yCAAwCx6C,SACrD,eAGDJ,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaxgB,KAAI,CAChB3a,YAAY,8GACZN,QAAS04C,EACT,cAAY,2CAA0Cv6C,SACvD,WAGAg7C,EAAyB3gD,OAAS,GAAK4gD,IACtCh7C,EAAAA,EAAAA,IAAAC,EAAAA,GAAA,CAAAF,SAAA,EACEJ,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaye,UAAS,IACtBf,EAAyBntC,SAAS,SACjCjO,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaxgB,KAAI,CAChB3a,YAAY,8GACZN,QAASA,IAAMo5C,EAAgB,OAAOj7C,UAEtCJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,oBAKpB4sC,EAAyBntC,SAAS,SACjCjO,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaxgB,KAAI,CAChB3a,YAAY,8GACZN,QAASA,IAAMo5C,EAAgB,OAAOj7C,UAEtCJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,sBAKpB4sC,EAAyBntC,SAAS,SACjCjO,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaxgB,KAAI,CAChB3a,YAAY,8GACZN,QAASA,IAAMo5C,EAAgB,OAAOj7C,UAEtCJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,0BAOzBxO,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaye,UAAS,KACvBn8C,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaxgB,KAAI,CAChB3a,YAAY,8GACZsC,UAAWo4B,EACXh7B,QAASk7B,EACT,cAAY,uCAAsC/8B,UAElDJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,eAInBxO,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaxgB,KAAI,CAChB3a,YAAY,8GACZsC,UAAWm4B,EACX/6B,QAASi7B,EACT,cAAY,yCAAwC98B,UAEpDJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,gBAIlBysC,WAIN76C,IACG,EAIJuB,EAAS,CACby6C,WAAaz5C,IAAY,CACvBrH,OAAQ,IACR6E,SAAU,SACV4D,QAAS,OACTy3C,iBAAkB,WAClBpuC,gBAAiBzK,EAAMuB,OAAOu3C,kBAC9Bh7C,QAASkC,EAAMgN,QAAQc,GACvB3M,OAAQ,aAAanB,EAAMuB,OAAOJ,SAClCN,aAAcb,EAAMW,QAAQo4C,mBAE9BW,sBAAuBA,KAAA,CACrBl8C,SAAU,WAEZm8B,SAAW35B,IAAY,CACrByB,MAAOzB,EAAMuB,OAAOI,cACpB8L,SAAU,GACV2D,YAAa,EACbuoC,cAAe,YAINC,GAAuBlC,EAAAA,EAAAA,MAAKK,E,wNCtWlC,MAAMpoB,EAA4B,CACvC53B,EAAG,GACH+rB,EAAG,GACH9rB,EAAG,EACH6hD,EAAG,EACHC,IAAK,GAGMC,EAAyB1hD,IAUF,IAAD2hD,EAAAC,EAAA,IAVI,OACrCj6B,EAAM,aACN6R,EAAY,SACZmmB,EAAQ,OACRC,EAAM,WACNje,EAAU,mBACVI,EAAkB,gBAClB2B,EACAme,aAAcC,KACXC,GACyB/hD,EAC5B,MAAMgiD,GAAiC/kB,EAAAA,EAAAA,MAUjCglB,GAAalwC,EAAAA,EAAAA,UAAQ,KACrBwS,EAAAA,EAAAA,MACKiV,EAAa7mB,QAAO9L,IAAA,IAAC,OAAE6K,EAAM,QAAE6yB,GAAS19B,EAAA,OAAM6K,GAAU6yB,EAAQ5c,EAAO5C,UAAU,IAEnFyU,EAAa1c,MAAM,EAAG6K,EAAO1C,oBAAsB,IAAImV,WAC7D,CAACZ,EAAc7R,IAEZu6B,GAAiBnwC,EAAAA,EAAAA,UAAQ,KACPkwC,EAAWtyB,SAAQlpB,IAAA,IAAC,QAAE89B,GAAS99B,EAAA,OAAKtH,OAAO23B,KAAKyN,EAAQ,IACxDtxB,SAAS0U,EAAO5C,YACrC,CAAC4C,EAAQs6B,KAEN,WAAEhwB,EAAU,aAAEC,EAAY,gBAAEqW,IAAoBpW,EAAAA,EAAAA,IAAqBxK,IAErE,WAAEw6B,EAAYN,aAAcO,IAAyBC,EAAAA,EAAAA,GAAgB,CACzE3lC,SAAUslC,IAMNH,EAAelgB,IAA+B,OAAhBmgB,QAAgB,IAAhBA,EAAAA,EAAoBM,IAEjDE,EAAsBC,IAA2BC,EAAAA,EAAAA,KAElDC,GACJz9C,EAAAA,EAAAA,GAAA,OACEW,IAAG,CACDgB,EAAO+7C,oBACP,CACEpiD,OAAQqhC,EAAa,YAASx1B,GAC/B,IAEHzL,IAAKyhD,EAAW/8C,SAEfy8C,GACC78C,EAAAA,EAAAA,GAACkyB,EAAAA,EAAkB,CACjBpE,SAAUmvB,EACVl9B,UAAW4C,EAAO5C,UAClBoS,iBAAiB,EACjBC,kBAAkB,EAClBrE,oBAAoB,EACpBsE,OAAQC,EACRtE,QAASf,EACTgB,UAAWf,EACXqW,gBAAiBA,EACjBC,qBAAsB+Z,IAEtB,OAIR,OAAI5gB,EACK8gB,EAIL/e,GAAmBwe,EACd,MAIPl9C,EAAAA,EAAAA,GAACu8C,EAAAA,GAAoB,CACnB3B,OAAQA,EACRD,SAAUA,EACVz/C,MAA8D,QAAzDyhD,EAA4C,QAA5CC,EAAExc,EAAAA,EAAyBzd,EAAO5C,kBAAU,IAAA68B,OAAA,EAA1CA,EAA4Cvc,mBAAW,IAAAsc,EAAAA,EAAIh6B,EAAO5C,UACzEuc,UAAUt8B,EAAAA,EAAAA,GAACo6C,EAAAA,GAAuB,CAACE,aAAc2C,IACjDvwB,KAAM/J,EAAO+J,KACbhoB,aAAcy1C,EAAAA,GAA0BwD,aAExCzC,sBAAuBgC,OAAiB/1C,EA9Ed+zC,KAAO,IAADjb,EAAAC,EAChB,OAAlBnD,QAAkB,IAAlBA,GAAAA,EAAqB,CACnBpa,SACAznB,MAA8D,QAAzD+kC,EAA4C,QAA5CC,EAAEE,EAAAA,EAAyBzd,EAAO5C,kBAAU,IAAAmgB,OAAA,EAA1CA,EAA4CG,mBAAW,IAAAJ,EAAAA,EAAItd,EAAO5C,UACzEuc,UAAUt8B,EAAAA,EAAAA,GAACo6C,EAAAA,GAAuB,CAACE,aAAc9lB,KACjD,EA0EA4mB,yBAA0B,CAAC,MAAO,MAAO,OACzCC,gBAAkBuC,IAChB,GAAe,QAAXA,GAA+B,aAAXA,EAKJ,OAApBN,QAAoB,IAApBA,GAAAA,EAAuBM,EAAQj7B,EAAO5C,eALtC,CACE,MAAM89B,EAAe,IAAIZ,GAAY7nB,WACrC0oB,EAAAA,EAAAA,IAAqBD,EAAc,CAACl7B,EAAO5C,WAAY,GAAI4C,EAAO5C,UAEpE,CACgD,KAE9Cg9B,EAAY38C,SAEf88C,GAAiBl9C,EAAAA,EAAAA,GAACy+B,EAAAA,EAA8B,IAAMgf,GAClC,EAIrB97C,EAAS,CACb+7C,oBAAqB,CACnBv9C,SAAU,U,uSC1Gd,MAAM49C,EAAmB9zB,IACvB,IAAIpI,EAAAA,EAAAA,OAAkCoI,EAAWvH,WAAaO,EAAAA,GAA6BC,WAAY,CAAC,IAADkI,EACrG,MAAM4yB,GAAyC,QAA3B5yB,EAAAnB,EAAW9H,wBAAgB,IAAAiJ,OAAA,EAA3BA,EAA6Bxc,KAAK2c,GAAQA,EAAInK,eAAe,GACjF,OAAkB,OAAX48B,QAAW,IAAXA,OAAW,EAAXA,EAAa/0C,KAAK,UAAW,EACtC,CACA,OAAKghB,EAAWtJ,oBAA+D,IAAzCsJ,EAAWtJ,mBAAmBlmB,OAI7DwvB,EAAWtJ,mBAAmB1X,KAAK,QAHjCghB,EAAWlK,SAG6B,EA0B7Ck+B,EAA8F,CAClG,MACA,MACA,MACA,YAGWC,EAA0BljD,IAgBF,IAADmjD,EAAA,IAhBI,OACtCx7B,EAAM,aACN6R,EAAY,SACZmmB,EAAQ,OACRC,EAAM,+BACNwD,EAA8B,QAC9Bl0B,EAAO,WACPyS,EAAU,mBACVI,EAAkB,mBAClBtlB,EAAkB,gBAClBinB,EAAe,sBACfvU,EACA0yB,aAAcC,EACduB,qBAAsBC,EAAwB,kBAC9C1O,KACGmN,GAC0B/hD,EAC7B,MAAMovB,GAAgC1F,EAAAA,EAAAA,MAChCC,GAA2BC,EAAAA,EAAAA,MAC3Bo4B,GAAiC/kB,EAAAA,EAAAA,OAEjC,SAAEnW,EAAQ,uBAAEyB,EAAsB,eAAE6C,IAAmBiE,EAAAA,EAAAA,GAAyB1H,EAAQwH,GAExF+wB,GAAwBp7B,EAAAA,EAAAA,cAAY,KACtB,OAAlBid,QAAkB,IAAlBA,GAAAA,EAAqB,CACnBpa,SACAznB,MAAO6iD,EAAgBp7B,GACvB2Z,UAAUt8B,EAAAA,EAAAA,GAACo6C,EAAAA,GAAuB,CAACE,aAAc9lB,KACjD,GACD,CAACA,EAAc7R,EAAQoa,IAEpBkgB,GAAalwC,EAAAA,EAAAA,UAAQ,KACrBwS,EAAAA,EAAAA,MACKiV,EAAa7mB,QAAO9L,IAAA,IAAC,OAAE6K,GAAQ7K,EAAA,OAAM6K,CAAM,IAAE0oB,UAE/CZ,EAAa1c,MAAM,EAAG6K,EAAO1C,oBAAsB,IAAImV,WAC7D,CAACZ,EAAc7R,IAEZ2H,GAAYvd,EAAAA,EAAAA,UAAQ,IAAMkwC,EAAW1yB,MAAM5vB,GAAMA,EAAE6vB,mBAAkB,CAACyyB,IAEtEC,GAAiBnwC,EAAAA,EAAAA,UAAQ,KAAO,IAADwxC,EACnC,MAAMp5B,EAAsC,QAA5Bo5B,EAAG57B,EAAOhC,0BAAkB,IAAA49B,EAAAA,EAAI,CAAC57B,EAAO5C,WAClDy+B,EAAgBvB,EAAWtyB,SAAQlpB,IAAA,IAAC,QAAE89B,GAAS99B,EAAA,OAAKtH,OAAO23B,KAAKyN,EAAQ,IAC9E,OAAgE,KAAzDkN,EAAAA,EAAAA,cAAatnB,GAAYkvB,EAAAA,EAAAA,MAAKmK,IAAgB/jD,MAAY,GAChE,CAACkoB,EAAQs6B,IAENvyB,GAAkB3d,EAAAA,EAAAA,UAAQ,KAC9B,GAAIud,EAAW,CAQb,MAAO,KANchM,EAAAA,EAAAA,SAAQ2+B,EAAWruC,KAAKjU,GAAMA,EAAE6vB,mBAAkBG,SAASC,GAAMA,EAAErT,eAGlE+G,EAAAA,EAAAA,SACpB2+B,EAAWtvC,QAAQhT,IAAOA,EAAE6vB,kBAAoB7vB,EAAEkwB,iBAAgBjc,KAAKjU,IAAC,IAAAowB,EAAA,OAAc,QAAdA,EAAKpwB,EAAEqwB,eAAO,IAAAD,OAAA,EAATA,EAAW5W,OAAO,KAGnG,CAEA,OAAOmK,EAAAA,EAAAA,SAAQ2+B,EAAWruC,KAAKjU,IAAC,IAAA8jD,EAAA,OAAc,QAAdA,EAAK9jD,EAAEqwB,eAAO,IAAAyzB,OAAA,EAATA,EAAWtqC,OAAO,IAAE,GACxD,CAAC8oC,EAAY3yB,IAEVnF,GAAapY,EAAAA,EAAAA,UAAQ,KACzB,MAWMoe,EAXgBxI,KAAsC,IAAD+7B,EACzD,MAAMrzB,EAAW,CAAC1I,EAAO5C,WAC4E,IAAD4+B,EAApG,KAAK98B,EAAAA,EAAAA,OAAkCc,EAAOD,WAAaO,EAAAA,GAA6BC,WACtF,OAAgC,QAAhCy7B,EAAOh8B,EAAOhC,0BAAkB,IAAAg+B,EAAAA,EAAItzB,EAEtC,MAAMF,EAAmC,QAA1BuzB,EAAG/7B,EAAOR,wBAAgB,IAAAu8B,OAAA,EAAvBA,EAAyBj2C,QAAO,CAACC,EAAK6iB,KACtDA,EAAIhK,UAAUtJ,SAASuT,GAAa9iB,EAAI+iB,IAAID,KACrC9iB,IACN,IAAIgjB,KACP,YAAqBvkB,IAAdgkB,EAA0BE,EAAWM,MAAMC,KAAKT,EAAU,EAEjDU,CAAalJ,GACzBmJ,EAAavI,EAA8B,CAACA,GAAN,GAE5C,OAAO4H,EAAUY,OAAOD,EAAU,GACjC,CAACnJ,EAAQY,KAEN,WAAE0J,EAAU,aAAEC,EAAY,eAAE0xB,EAAc,gBAAErb,KAAoBpW,EAAAA,EAAAA,IACpExK,EACAyH,EAAgCgD,EAAAA,GAAsBC,2BAA6BD,EAAAA,GAAsBE,SAGrG,WACJ6vB,GACAN,aAAcO,GACdiB,qBAAsBQ,KACpBxB,EAAAA,EAAAA,GAAgB,CAClB3lC,SAAUslC,IAMNH,GAAelgB,IAA+B,OAAhBmgB,QAAgB,IAAhBA,EAAAA,EAAoBM,IAClDiB,GAAuB1hB,IAAuC,OAAxB2hB,QAAwB,IAAxBA,EAAAA,EAA4BO,KAElE,kBAAEp0B,IAAsBP,GAAW,CAAC,EAEpC40B,IAA0BC,EAAAA,EAAAA,KAC7B5oC,IAAsB6oC,EAAAA,EAAAA,MAAK7oC,EAAMmT,SAASw1B,wBAAyBp0B,IACpEu0B,EAAAA,KAOKC,GAAaC,KAAkBt4C,EAAAA,EAAAA,WAAuC,KAC3E,GAAI8b,EAAOC,SAAUe,EAAAA,EAAAA,aAAYhB,EAAOC,MAAMC,SAAUc,EAAAA,EAAAA,aAAYhB,EAAOC,MAAME,MAC/E,MAAO,CAACH,EAAOC,MAAMC,KAAMF,EAAOC,MAAME,KAE1B,IAIZs8B,IAAer6C,EAAAA,EAAAA,aAAqCoC,IAEpD,mBAAEk4C,GAAkB,UAAEC,GAAS,YAAEC,GAAW,eAAEC,IC/LP,SAC7C78B,EACAb,EACA/B,EACA++B,EACAvnC,GAEI,IADJ2N,EAA2B1qB,UAAAC,OAAA,QAAA0M,IAAA3M,UAAA,GAAAA,UAAA,GAAG,SAE9B,MAAO+kD,EAAaC,IAAkB34C,EAAAA,EAAAA,WAAyD,KAC7F,IACE+d,EAAAA,EAAAA,OACAjC,EAAOC,SACNe,EAAAA,EAAAA,aAAYhB,EAAOC,MAAMmC,SACzBpB,EAAAA,EAAAA,aAAYhB,EAAOC,MAAMqC,MAE1B,MAAO,CAACtC,EAAOC,MAAMmC,KAAMpC,EAAOC,MAAMqC,KAE1B,KAEXw6B,EAAiBJ,IAAsBx4C,EAAAA,EAAAA,eAAuCM,GA4CrF,MAAO,CAILk4C,qBAIAC,WAnDgBvyC,EAAAA,EAAAA,UAAsC,KACtD,GAAKwyC,EAAL,CAGA,GAAIz9B,IAAaC,EAAAA,GAA6BqF,OAAQ8jB,EAAAA,EAAAA,UAASqU,EAAY,MAAOrU,EAAAA,EAAAA,UAASqU,EAAY,IAQrG,OANeG,EAAAA,EAAAA,IACbZ,EACAvnC,EACAwI,EACAw/B,GAKJ,GACEz9B,IAAaC,EAAAA,GAA6BsF,eAC1Co4B,IACAnO,EAAAA,EAAAA,UAASiO,EAAY,MACrBjO,EAAAA,EAAAA,UAASiO,EAAY,IASrB,OANeG,EAAAA,EAAAA,IACbZ,EACAvnC,EACAwI,EACA0/B,GAKJ,GAAI39B,IAAaC,EAAAA,GAA6BoF,OAAQmqB,EAAAA,EAAAA,UAASiO,EAAY,MAAOjO,EAAAA,EAAAA,UAASiO,EAAY,IAAK,CAE1G,MAAMI,EAAa/7B,KAAKg8B,MAAoB,QAAd16B,EAAsB,IAAMq6B,EAAY,GAAKA,EAAY,IACjFM,EAAaj8B,KAAKk8B,KAAmB,QAAd56B,EAAsB,IAAMq6B,EAAY,GAAKA,EAAY,IACtF,OAAOI,GAAcE,EAAa,CAACF,EAAa,EAAGE,EAAa,QAAK14C,CACvE,CAjCA,CAqCgB,GACf,CAAC2a,EAAU/B,EAAWw/B,EAAaT,EAAyBvnC,EAAUkoC,EAAiBv6B,IAcxFq6B,cAIAC,iBAEJ,CD8GyEO,CACrEp9B,EACAb,EACAa,EAAO5C,UACP++B,GACAp0B,EACA5I,IAAaC,EAAAA,GAA6BoF,KAAOxE,EAAOqC,eAAiB,WAGrE,iBAAEgH,GAAgB,UAAEC,GAAS,aAAEsvB,KAAiBrvB,EAAAA,EAAAA,GAAwB,CAC5E3U,SAAUmT,EACVvF,aACAzN,QAAS2mC,GACTlyB,WAAY,IACZvJ,MAAO08B,GACP7nC,wBA6HF7P,EAAAA,EAAAA,YAAU,KACRg3C,GAAgB,GACf,CAACA,EAAgB3yB,KAEpB,MAAMG,IAAmCrf,EAAAA,EAAAA,UACvC,IACEkwC,EAAWruC,KAAKyd,IACd,MAAMC,EAAiBnH,EAAW1c,QAAO,CAACC,EAA0BjD,KAAS,IAAD8mB,EAAAC,EAC1E,MAAMC,EAAoC,QAA7BF,EAAGP,GAAiBK,EAAIK,aAAK,IAAAH,GAAO,QAAPC,EAA1BD,EAA6B9mB,UAAI,IAAA+mB,OAAP,EAA1BA,EAAmCF,eAInD,OAHIG,IACF/jB,EAAIjD,GAAOkd,EAAOuD,gBAAiByG,EAAAA,EAAAA,IAAgCF,GAAWA,GAEzE/jB,CAAG,GACT,CAAC,GAEJ,MAAO,IACF2jB,EACHC,iBACD,KAEL,CAACnH,EAAY6G,GAAkBixB,EAAYt6B,EAAOuD,iBAG9C0G,IAAmBC,EAAAA,EAAAA,GAAuB,CAC9CnV,QAAS4S,EACTwC,kBAAmBV,GACnBjH,aACA4H,4BAA6Bf,GAC7BvB,qBACAlH,uBAAwBzB,IAAaC,EAAAA,GAA6BC,OAASuB,OAAyBpc,EACpG+e,eAAqC,QAAvBi4B,EAAEx7B,EAAOuD,sBAAc,IAAAi4B,GAAAA,IAIjCnxB,GAAY1C,EAAYsC,GAAmBR,IAE1CkxB,GAAsBC,KAA2BC,EAAAA,EAAAA,KAGlDwC,GAAkBnD,GAGlBoD,GAAiBh0B,KAAcoyB,GAE/BZ,IACJz9C,EAAAA,EAAAA,GAAA,OACEW,IAAG,CACDgB,EAAOu+C,qBACP,CACE5kD,OAAQqhC,EAAa,YAASx1B,GAC/B,IAEHzL,IAAKyhD,GAAW/8C,SAEd4/C,GAAyBC,IACzBjgD,EAAAA,EAAAA,GAACutB,EAAAA,IAAc,KAEfvtB,EAAAA,EAAAA,GAAC6tB,EAAAA,EAAmB,CAClBC,SAAUd,GACVjN,UAAW4C,EAAO5C,UAClBY,mBAAoBgC,EAAOhC,mBAC3BuE,UAAWvC,EAAOuC,UAClBpD,SAAUA,EACVkD,eAAgBrC,EAAOqC,eACvBtC,SAAUC,EAAOD,SACjBP,iBAAkBQ,EAAOR,iBACzBoB,uBAAwBA,EACxB6C,eAAgBA,EAChB2H,oBAAoB,EACpBC,QAASf,EACTgB,UAAWf,EACXqW,gBAAiBA,GACjBD,SAAU3e,EAlMSne,IAAmC,IAAlC,OAAEyW,GAA0BzW,EAGtD,IAAKm2B,EAAY,CACf,IAAIwjB,EAAsB,OAAXjB,SAAW,IAAXA,QAAW,EAAXA,GAAc,GACzBkB,EAAsB,OAAXlB,SAAW,IAAXA,QAAW,EAAXA,GAAc,GACzBmB,EAAsB,OAAXd,SAAW,IAAXA,QAAW,EAAXA,GAAc,GACzBe,EAAsB,OAAXf,SAAW,IAAXA,QAAW,EAAXA,GAAc,GAE7B,MAAQrN,UAAWqO,EAAgB39B,MAAO49B,GAAcvjC,EAAO6R,OAAS,CAAC,IAClDwjB,EAAAA,EAAAA,SAAQiO,EAAiB,MAACp5C,OAAWA,GAAaq5C,EAAW,CAACL,EAAUC,KAI7FxB,IAGE2B,GACFJ,OAAWh5C,EACXi5C,OAAWj5C,GACFq5C,IACTL,EAAWK,EAAU,GACrBJ,EAAWI,EAAU,IAGvB,MAAQtO,UAAWuO,EAAgB79B,MAAO89B,GAAczjC,EAAO4R,OAAS,CAAC,EACzE,GAAI4xB,EAEFJ,OAAWl5C,EACXm5C,OAAWn5C,OACN,GAAIu5C,EAAW,CACpB,MAAMC,GAAoBriC,EAAAA,EAAAA,SAAQ2+B,EAAWruC,KAAIE,IAAA,IAAC,QAAEkc,GAASlc,EAAA,OAAY,OAAPkc,QAAO,IAAPA,OAAO,EAAPA,EAAS7W,OAAO,KAC5EysC,EAAkB3D,EAAWtyB,SAAQ5b,IAAA,IAAA8xC,EAAA,IAAC,gBAAEr2B,GAAiBzb,EAAA,OAA8B,QAA9B8xC,EAAoB,OAAfr2B,QAAe,IAAfA,OAAe,EAAfA,EAAiBjT,gBAAQ,IAAAspC,EAAAA,EAAI,EAAE,IAEnG,IAAKhhB,EAAAA,EAAAA,OAAsC/d,IAAaC,EAAAA,GAA6BsF,cAO9E,GAAIvF,IAAaC,EAAAA,GAA6BqtB,oBAAqB,CACxE,MAAM0R,GAAiBC,EAAAA,EAAAA,IACrB/0B,GACA,IAAI20B,KAAsBC,GAC1BF,EACA,MAEFrB,GAAmB,IAAKyB,GAC1B,MACEzB,QAAmBl4C,OAhB+E,CAClG,MAAM25C,GAAiBC,EAAAA,EAAAA,IACrB/0B,GACA,IAAI20B,KAAsBC,GAC1BF,GAEFrB,GAAmB,IAAKyB,GAC1B,CAWAT,EAAWK,EAAU,GACrBJ,EAAWI,EAAU,EACvB,EAGGpO,EAAAA,EAAAA,SACC,CAAEvtB,KAAiB,OAAXw6B,SAAW,IAAXA,QAAW,EAAXA,GAAc,GAAIt6B,KAAiB,OAAXs6B,SAAW,IAAXA,QAAW,EAAXA,GAAc,GAAI18B,KAAiB,OAAXq8B,SAAW,IAAXA,QAAW,EAAXA,GAAc,GAAIp8B,KAAiB,OAAXo8B,SAAW,IAAXA,QAAW,EAAXA,GAAc,IAC9F,CAAEn6B,KAAMs7B,EAAUp7B,KAAMq7B,EAAUz9B,KAAMs9B,EAAUr9B,KAAMs9B,MAG1DZ,IAAe77B,EAAAA,EAAAA,aAAY08B,KAAa18B,EAAAA,EAAAA,aAAY28B,QAAYn5C,EAAY,CAACk5C,EAAUC,IACvFnB,IAAex7B,EAAAA,EAAAA,aAAYw8B,KAAax8B,EAAAA,EAAAA,aAAYy8B,QAAYj5C,EAAY,CAACg5C,EAAUC,IAE3F,GAG+BpxC,IAAmC,IAAlC,OAAEiO,GAA0BjO,EAC5D,MAAQ4T,MAAO49B,GAAcvjC,EAAO6R,OAAS,CAAC,EAW9C,KAVuBwjB,EAAAA,EAAAA,SAAQkO,EAAWpB,GAAap6C,UAGrD45C,IAIFQ,GAAap6C,QAAU,IAAKw7C,IAGvBvjC,EAAO4R,MACV,OAEF,MAAM,UAAEqjB,EAAWtvB,MAAO89B,GAAczjC,EAAO4R,MAC/C,GAAIqjB,EAEFsN,QAAer4C,QAGjB,KAAImrC,EAAAA,EAAAA,SAAQoO,EAAWnB,MAOlBrN,GAAawO,EAAW,CAC3B,MAAMC,GAAoBriC,EAAAA,EAAAA,SAAQ2+B,EAAWruC,KAAIK,IAAA,IAAC,QAAE+b,GAAS/b,EAAA,OAAY,OAAP+b,QAAO,IAAPA,OAAO,EAAPA,EAAS7W,OAAO,KAC5EysC,EAAkB3D,EAAWtyB,SAAQzb,IAAA,IAAA8xC,EAAA,IAAC,gBAAEx2B,GAAiBtb,EAAA,OAA8B,QAA9B8xC,EAAoB,OAAfx2B,QAAe,IAAfA,OAAe,EAAfA,EAAiBjT,gBAAQ,IAAAypC,EAAAA,EAAI,EAAE,IAEnG,IAAKnhB,EAAAA,EAAAA,OAAsC/d,IAAaC,EAAAA,GAA6BsF,cAO9E,GAAIvF,IAAaC,EAAAA,GAA6BqtB,oBAAqB,CACxE,MAAM0R,GAAiBC,EAAAA,EAAAA,IACrB/0B,GACA,IAAI20B,KAAsBC,GAC1BF,EACA,MAEFrB,GAAmB,IAAKyB,GAC1B,MACEzB,QAAmBl4C,OAhB+E,CAClG,MAAM25C,GAAiBC,EAAAA,EAAAA,IACrB/0B,GACA,IAAI20B,KAAsBC,GAC1BF,GAEFrB,GAAmB,IAAKyB,GAC1B,CAWAtB,GAAe,IAAKkB,GACtB,GA4EM/yB,OAAQ4xB,GACR3xB,OAAQjJ,EAA2Bu6B,GAAcE,GAAap6C,QAC9D23B,WAAYA,EACZ7T,cAAenG,EAAOmG,cACtB0a,qBAAsB+Z,GACtB3N,kBAAoC,OAAjBA,QAAiB,IAAjBA,EAAAA,EAAqB,IAxBxB,OA8BlByL,IAAkBv7B,EAAAA,EAAAA,cACrB89B,IAAY,IAADqD,EAAAC,EACV,MAAMC,EAAsD,QAAvCF,EAA4B,QAA5BC,EAAGv+B,EAAOhC,0BAAkB,IAAAugC,OAAA,EAAzBA,EAA2Bj4C,KAAK,YAAI,IAAAg4C,EAAAA,EAAIt+B,EAAO5C,UACvE,GAAe,aAAX69B,EAWW,QAAXA,EAIgB,OAApBN,SAAoB,IAApBA,IAAAA,GAAuBM,EAAQuD,IAH7BC,EAAAA,EAAAA,IAA8Bp0B,GAAWrK,EAAOhC,oBAAsB,CAACgC,EAAO5C,WAAYohC,OAZ5F,CACE,MAMM5pC,EAAW,KANM+G,EAAAA,EAAAA,SAAQ0O,GAAUpe,KAAKhT,IAAC,IAAAylD,EAAA,OAAc,QAAdA,EAAKzlD,EAAEovB,eAAO,IAAAq2B,OAAA,EAATA,EAAWltC,OAAO,SAC3CmK,EAAAA,EAAAA,SACzB0O,GACGrf,QAAOwB,IAAA,IAAC,gBAAEqb,GAAiBrb,EAAA,OAAKqb,CAAe,IAC/CG,SAAS2E,IAAK,IAAAgyB,EAAA,OAA0B,QAA1BA,EAAKhyB,EAAM9E,uBAAe,IAAA82B,OAAA,EAArBA,EAAuB/pC,QAAQ,MAGzB,OAA9B6mC,QAA8B,IAA9BA,GAAAA,EAAiC7mC,EAAUoL,EAAOhC,oBAAsB,CAACgC,EAAO5C,WAElF,CAK+C,GAEjD,CAACiN,GAAWrK,EAAQ26B,GAAsBc,IAI5C,OAAI1f,GAAmBwe,EACd,KAGLvgB,EACK8gB,IAIPz9C,EAAAA,EAAAA,GAACu8C,EAAAA,GAAoB,CACnB3B,OAAQA,EACRD,SAAUA,EACVz/C,MAAO6iD,EAAgBp7B,GACvB2Z,UAAUt8B,EAAAA,EAAAA,GAACo6C,EAAAA,GAAuB,CAACE,aAAc2C,IACjDvwB,KAAM/J,EAAO+J,KACbhoB,aAAcy1C,EAAAA,GAA0BwD,aACxCvC,yBAA0B6C,EAC1B5C,gBAAiBA,GAEjBH,sBAAuBgC,OAAiB/1C,EAAY+zC,EACpDK,aAAcA,GACdD,UAAWuB,MACPE,EAAY38C,SAEf88C,GAAiBl9C,EAAAA,EAAAA,GAACy+B,EAAAA,EAA8B,IAAMgf,IAClC,EAIrB97C,EAAS,CACbu+C,qBAAsB,CACpB//C,SAAU,W,eEpcP,MAAMohD,EAA6BvmD,IAUF,IAVG,OACzC2nB,EAAM,aACN6R,EAAY,SACZmmB,EAAQ,OACRC,EAAM,WACNje,EAAU,mBACVI,EAAkB,gBAClB2B,EACAme,aAAcC,KACXC,GAC6B/hD,EAChC,MAAMgiD,GAAiC/kB,EAAAA,EAAAA,MACjC/8B,EAAQ,GAAGynB,EAAOkM,MAAMppB,WAAWkd,EAAOmM,MAAMrpB,MAUhDw3C,GAAalwC,EAAAA,EAAAA,UAAQ,KACrBwS,EAAAA,EAAAA,MACKiV,EAAa7mB,QAAO9L,IAAA,IAAC,OAAE6K,GAAQ7K,EAAA,OAAM6K,CAAM,IAE7C8nB,EAAa1c,MAAM,EAAG6K,EAAO1C,oBAAsB,IAAImV,WAC7D,CAACZ,EAAc7R,IAEZu6B,GAAiBnwC,EAAAA,EAAAA,UAAQ,KAC7B,MAAMoY,EAAa,CAACxC,EAAOkM,MAAMppB,IAAKkd,EAAOmM,MAAMrpB,KAC7C+4C,EAAgBvB,EAAWtyB,SAAQlpB,IAAA,IAAC,QAAE89B,GAAS99B,EAAA,OAAKtH,OAAO23B,KAAKyN,EAAQ,IAC9E,OAAgE,KAAzDkN,EAAAA,EAAAA,cAAatnB,GAAYkvB,EAAAA,EAAAA,MAAKmK,IAAgB/jD,MAAY,GAChE,CAACkoB,EAAQs6B,KAEN,WAAEhwB,EAAU,aAAEC,EAAY,gBAAEqW,IAAoBpW,EAAAA,EAAAA,IAAqBxK,IAErE,WAAEw6B,EAAYN,aAAcO,IAAyBC,EAAAA,EAAAA,GAAgB,CACzE3lC,SAAUslC,IAMNH,EAAelgB,IAA+B,OAAhBmgB,QAAgB,IAAhBA,EAAAA,EAAoBM,IAEjDE,EAAsBC,IAA2BC,EAAAA,EAAAA,KAElDC,GACJz9C,EAAAA,EAAAA,GAAA,OACEW,IAAG,CACDgB,EAAO6/C,wBACP,CACElmD,OAAQqhC,EAAa,YAASx1B,GAC/B,IAEHzL,IAAKyhD,EAAW/8C,SAEfy8C,GACC78C,EAAAA,EAAAA,GAAC8zB,EAAAA,EAAe,CACdhG,SAAUmvB,EACVxqB,MAAO9P,EAAOkM,MACd6D,MAAO/P,EAAOmM,MACdd,QAASf,EACTgB,UAAWf,EACXa,oBAAoB,EACpBwV,gBAAiBA,EACjBC,qBAAsB+Z,IAEtB,OAKR,OAAI7e,GAAmBwe,EACd,KAGLvgB,EACK8gB,GAIPz9C,EAAAA,EAAAA,GAACu8C,EAAAA,GAAoB,CACnB3B,OAAQA,EACRD,SAAUA,EACVz/C,MAAOA,EACPohC,UAAUt8B,EAAAA,EAAAA,GAACo6C,EAAAA,GAAuB,CAACE,aAAc2C,IACjDvwB,KAAM/J,EAAO+J,KACbhoB,aAAcy1C,EAAAA,GAA0BwD,aAExCzC,sBAAuBgC,OAAiB/1C,EA7Ed+zC,KACV,OAAlBne,QAAkB,IAAlBA,GAAAA,EAAqB,CACnBpa,SACAznB,QACAohC,UAAUt8B,EAAAA,EAAAA,GAACo6C,EAAAA,GAAuB,CAACE,aAAc9lB,KACjD,EAyEA4mB,yBAA0B,CAAC,MAAO,MAAO,OACzCC,gBAAkBuC,IAChB,MAAMuD,EAAkB,CAACx+B,EAAOkM,MAAMppB,IAAKkd,EAAOmM,MAAMrpB,KAAKwD,KAAK,KAClE,GAAe,QAAX20C,GAA+B,aAAXA,EAaJ,OAApBN,QAAoB,IAApBA,GAAAA,EAAuBM,EAAQuD,OAb/B,CACE,MAAMM,EAAiB,GACjBC,EAAkB,GACxB,IAAK,MAAMrzB,IAAQ,CAAC,QAAkB,SACV,UAAtB1L,EAAO0L,GAAM5rB,KACfg/C,EAAehnC,KAAKkI,EAAO0L,GAAM5oB,KAEjCi8C,EAAgBjnC,KAAKkI,EAAO0L,GAAM5oB,MAGtCq4C,EAAAA,EAAAA,IAAqBb,EAAYyE,EAAiBD,EAAgBN,EAEpE,CAC+C,KAE7CpE,EAAY38C,SAEf88C,GAAiBl9C,EAAAA,EAAAA,GAACy+B,EAAAA,EAA8B,IAAMgf,GAClC,EAIrB97C,EAAS,CACb6/C,wBAAyB,CACvBrhD,SAAU,W,eC/HP,MAAMwhD,EAA6B3mD,IASF,IATG,OACzC2nB,EAAM,aACN6R,EAAY,SACZmmB,EAAQ,OACRC,EAAM,WACNje,EAAU,mBACVI,EAAkB,gBAClB2B,KACGqe,GAC6B/hD,EAChC,MAAME,EAAQ,GAAGynB,EAAOkM,MAAMppB,WAAWkd,EAAOmM,MAAMrpB,WAAWkd,EAAOoM,MAAMtpB,MAUxEw3C,GAAalwC,EAAAA,EAAAA,UAAQ,KACrBwS,EAAAA,EAAAA,MACKiV,EAAa7mB,QAAO9L,IAAA,IAAC,OAAE6K,GAAQ7K,EAAA,OAAM6K,CAAM,IAE7C8nB,EAAa1c,MAAM,EAAG6K,EAAO1C,oBAAsB,IAAImV,WAC7D,CAACZ,EAAc7R,IAEZu6B,GAAiBnwC,EAAAA,EAAAA,UAAQ,KAC7B,MAAMoY,EAAa,CAACxC,EAAOkM,MAAMppB,IAAKkd,EAAOmM,MAAMrpB,IAAKkd,EAAOoM,MAAMtpB,KAC/D+4C,EAAgBvB,EAAWtyB,SAAQlpB,IAAA,IAAC,QAAE89B,GAAS99B,EAAA,OAAKtH,OAAO23B,KAAKyN,EAAQ,IAC9E,OAAgE,KAAzDkN,EAAAA,EAAAA,cAAatnB,GAAYkvB,EAAAA,EAAAA,MAAKmK,IAAgB/jD,MAAY,GAChE,CAACkoB,EAAQs6B,KAEN,WAAEhwB,EAAU,aAAEC,EAAY,gBAAEqW,IAAoBpW,EAAAA,EAAAA,IAAqBxK,IAEpE26B,EAAsBC,IAA2BC,EAAAA,EAAAA,KAElDC,GACJz9C,EAAAA,EAAAA,GAAA,OACEW,IAAG,CACDgB,EAAOigD,wBACP,CACEtmD,OAAQqhC,EAAa,YAASx1B,GAC/B,IACD/G,UAEFJ,EAAAA,EAAAA,GAACwyB,EAAAA,EAAe,CACd1E,SAAUmvB,EACVxqB,MAAO9P,EAAOkM,MACd6D,MAAO/P,EAAOmM,MACd6D,MAAOhQ,EAAOoM,MACdhB,oBAAoB,EACpBC,QAASf,EACTgB,UAAWf,EACXqW,gBAAiBA,EACjBC,qBAAsB+Z,MAM5B,OAAI7e,GAAmBwe,EACd,KAGLvgB,EACK8gB,GAIPz9C,EAAAA,EAAAA,GAACu8C,EAAAA,GAAoB,CACnB3B,OAAQA,EACRD,SAAUA,EACVz/C,MAAOA,EACPohC,UAAUt8B,EAAAA,EAAAA,GAACo6C,EAAAA,GAAuB,CAACE,aAAc2C,IACjDvwB,KAAM/J,EAAO+J,KACbhoB,aAAcy1C,EAAAA,GAA0BwD,aAExCzC,sBAAuBgC,OAAiB/1C,EAlEd+zC,KACV,OAAlBne,QAAkB,IAAlBA,GAAAA,EAAqB,CACnBpa,SACAznB,QACAohC,UAAUt8B,EAAAA,EAAAA,GAACo6C,EAAAA,GAAuB,CAACE,aAAc9lB,KACjD,EA8DA4mB,yBAA0B,CAAC,MAAO,MAAO,OACzCC,gBAAkBuC,IAChB,MAAMuD,EAAkB,CAACx+B,EAAOkM,MAAMppB,IAAKkd,EAAOmM,MAAMrpB,IAAKkd,EAAOoM,MAAMtpB,KAAKwD,KAAK,KACpF,GAAe,QAAX20C,GAA+B,aAAXA,EAaJ,OAApBN,QAAoB,IAApBA,GAAAA,EAAuBM,EAAQuD,OAb/B,CACE,MAAMM,EAAiB,GACjBC,EAAkB,GACxB,IAAK,MAAMrzB,IAAQ,CAAC,QAAkB,QAAkB,SAC5B,UAAtB1L,EAAO0L,GAAM5rB,KACfg/C,EAAehnC,KAAKkI,EAAO0L,GAAM5oB,KAEjCi8C,EAAgBjnC,KAAKkI,EAAO0L,GAAM5oB,MAGtCq4C,EAAAA,EAAAA,IAAqBb,EAAYyE,EAAiBD,EAAgBN,EAEpE,CAC+C,KAE7CpE,EAAY38C,SAEf88C,GAAiBl9C,EAAAA,EAAAA,GAACy+B,EAAAA,EAA8B,IAAMgf,GAClC,EAIrB97C,EAAS,CACbigD,wBAAyB,CACvBzhD,SAAU,W,ICtIVtG,EAAOqC,EAAQ4C,EAAIC,E,sBACvB,SAAS7E,IAAa,OAAOA,EAAWC,OAAOC,OAASD,OAAOC,OAAOC,OAAS,SAAUC,GAAK,IAAK,IAAIC,EAAI,EAAGA,EAAIC,UAAUC,OAAQF,IAAK,CAAE,IAAIG,EAAIF,UAAUD,GAAI,IAAK,IAAII,KAAKD,GAAG,CAAG,GAAEE,eAAeC,KAAKH,EAAGC,KAAOL,EAAEK,GAAKD,EAAEC,GAAK,CAAE,OAAOL,CAAG,EAAGJ,EAASY,MAAM,KAAMN,UAAY,CAEnR,SAASqnD,EAA4B7mD,EAAMC,GACzC,IAAI,MACFC,EAAK,QACLC,KACGC,GACDJ,EACJ,OAAoB,gBAAoB,MAAOd,EAAS,CACtDmB,MAAO,GACPC,OAAQ,GACRC,QAAS,YACTC,KAAM,OACNC,MAAO,6BACPC,IAAKT,EACL,kBAAmBE,GAClBC,GAAQF,EAAqB,gBAAoB,QAAS,CAC3DS,GAAIR,GACHD,GAAS,KAAMrB,IAAUA,EAAqB,gBAAoB,OAAQ,CAC3E+B,EAAG,mDACHC,OAAQ,UACRC,cAAe,WACZI,IAAWA,EAAsB,gBAAoB,OAAQ,CAChEN,EAAG,gGACHC,OAAQ,UACRC,cAAe,WACZgD,IAAOA,EAAkB,gBAAoB,IAAK,CACrDqO,QAAS,IACK,gBAAoB,OAAQ,CAC1CvR,EAAG,qBACHC,OAAQ,UACRC,cAAe,UACA,gBAAoB,OAAQ,CAC3CF,EAAG,2BACHC,OAAQ,UACRC,cAAe,UACA,gBAAoB,OAAQ,CAC3CF,EAAG,2BACHC,OAAQ,kCACRgC,YAAa,EACb/B,cAAe,aACXiD,IAAUA,EAAqB,gBAAoB,OAAQ,KAAmB,gBAAoB,iBAAkB,CACxHpD,GAAI,4BACJ6B,GAAI,QACJC,GAAI,QACJC,GAAI,QACJC,GAAI,QACJmkD,cAAe,kBACD,gBAAoB,OAAQ,CAC1CC,UAAW,YACI,gBAAoB,OAAQ,CAC3CC,OAAQ,EACRD,UAAW,eAEf,CACA,MAAM9lD,EAA0B,aAAiB4lD,GAClC,IAAf,I,4CCjCmF,IAAAhgD,EAAA,CAAAH,KAAA,UAAAC,OAAA,iEAAAF,EAAA,CAAAC,KAAA,UAAAC,OAAA,yEAmBnF,MAAMsgD,EAAyCjnD,IAAyC,IAAxC,OAAE4/C,GAAgC5/C,EAChF,MAAM,MAAE2H,IAAUC,EAAAA,EAAAA,KAElB,OACE5C,EAAAA,EAAAA,GAAA,OAAKW,IAAGkB,EAA+EzB,UACrFC,EAAAA,EAAAA,IAAA,OAAKM,IAAGc,EAAoFrB,SAAA,EAC1FJ,EAAAA,EAAAA,GAACkiD,EAAgB,KACjBliD,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWwD,MAAK,CAAClT,KAAGC,EAAAA,EAAAA,IAAE,CAAE8O,UAAW/M,EAAMgN,QAAQc,IAAI,IAAErM,MAAM,YAAY0P,MAAO,EAAE1T,UACjFJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,oCAInBxO,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWC,KAAI,CAAC3P,KAAGC,EAAAA,EAAAA,IAAE,CAAEsM,aAAcvK,EAAMgN,QAAQc,IAAI,IAAErM,MAAM,YAAWhE,UACzEJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,gHAInBxO,EAAAA,EAAAA,GAACiD,EAAAA,EAAM,CAACV,YAAY,uDAAuDE,KAAK,UAAUR,QAAS24C,EAAOx6C,UACxGJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,0BAKjB,EAIV,IAAAhI,EAAA,CAAA9E,KAAA,UAAAC,OAAA,iEAAAmN,EAAA,CAAApN,KAAA,UAAAC,OAAA,yEAGA,MAAMwgD,EAA6BA,KACjC,MAAM,MAAEx/C,IAAUC,EAAAA,EAAAA,KAElB,OACE5C,EAAAA,EAAAA,GAAA,OAAKW,IAAG6F,EAA+EpG,UACrFC,EAAAA,EAAAA,IAAA,OAAKM,IAAGmO,EAAoF1O,SAAA,EAC1FJ,EAAAA,EAAAA,GAACkiD,EAAgB,KACjBliD,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWwD,MAAK,CAAClT,KAAGC,EAAAA,EAAAA,IAAE,CAAE8O,UAAW/M,EAAMgN,QAAQc,GAAI2xC,UAAW,UAAU,IAAEh+C,MAAM,YAAY0P,MAAO,EAAE1T,UACtGJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,6EAInBxO,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWC,KAAI,CAAC3P,KAAGC,EAAAA,EAAAA,IAAE,CAAEsM,aAAcvK,EAAMgN,QAAQc,IAAI,IAAErM,MAAM,YAAWhE,UACzEJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,oEAKjB,EAIG6zC,EAA8BtzC,IAWF,IAXG,OAC1C4T,EAAM,aACN6R,EAAY,SACZmmB,EAAQ,OACRC,EAAM,QACN1wB,EAAO,WACPyS,EAAU,mBACVI,EAAkB,gBAClB2B,EACAme,aAAcC,KACXC,GAC8BhuC,EACjC,MAAMuuB,GAAgB/mB,EAAAA,EAAAA,KAUhB+rC,GAAyBv1C,EAAAA,EAAAA,UAAQ,MAChCwS,EAAAA,EAAAA,OAA8C,OAANoD,QAAM,IAANA,GAAAA,EAAQ4/B,YAC5C/tB,EAEU,OAAZA,QAAY,IAAZA,OAAY,EAAZA,EAAc7mB,QAAOqB,IAAA,IAAC,OAAEtC,GAAQsC,EAAA,OAAMtC,CAAM,KAClD,CAAC8nB,EAAoB,OAAN7R,QAAM,IAANA,OAAM,EAANA,EAAQ4/B,cAEpBC,GAAuBz1C,EAAAA,EAAAA,UAC3B,SAAA01C,EAAA,OACuB,QADvBA,EACE9/B,EAAOtC,sBAAc,IAAAoiC,OAAA,EAArBA,EAAuBl4B,MACpB0I,GAAmC,OAAtBqvB,QAAsB,IAAtBA,OAAsB,EAAtBA,EAAwB/3B,MAAM2I,IAAS,IAAAC,EAAA,OAAKC,MAAMrL,OAAiC,QAA3BoL,EAACD,EAAUzc,OAAOwc,UAAS,IAAAE,OAAA,EAA1BA,EAA4B/oB,OAAO,KAC1G,CAACuY,EAAOtC,eAAgBiiC,GACzB,GACH,CAAC3/B,EAAOtC,eAAgBiiC,IAGpBI,GAA2B5iC,EAAAA,EAAAA,cAC9ByiC,IACCjlB,GAAennB,IAAW,IAADwsC,EACvB,MAAMC,EAA4C,QAAzBD,EAAGxsC,EAAM2iB,wBAAgB,IAAA6pB,OAAA,EAAtBA,EAAwB/zC,KAAKi0C,IACvD,GAAIA,EAAoBn2B,OAAS/J,EAAO+J,KAAM,CAE5C,MAAO,IADqBm2B,EACKN,cACnC,CACA,OAAOM,CAAmB,IAG5B,MAAO,IAAK1sC,EAAO2iB,iBAAkB8pB,EAAqB,GAC1D,GAEJ,CAACjgC,EAAO+J,KAAM4Q,KAGTxK,EAAcgwB,IAAsB/1C,EAAAA,EAAAA,UAAQ,KACjD,MAAMg2C,GAAahwB,EAAAA,EAAAA,IAA0BpQ,GAO7C,MAAO,CAACogC,EAJKA,GACTzvB,EAAAA,EAAAA,IAA8BgvB,EAAwB3/B,EAAOtC,eAAgBsC,EAAOpC,iBACpF,GAEqB,GACxB,CAACoC,EAAQ2/B,IAENpF,GAAiBnwC,EAAAA,EAAAA,UAAQ,IACQ,IAA9B+1C,EAAmBroD,QACzB,CAACqoD,KAEE,WAAE3F,EAAYN,aAAcO,IAAyBC,EAAAA,EAAAA,GAAgB,CACzE3lC,UAAUugB,EAAAA,EAAAA,QAMN4kB,EAAelgB,IAA+B,OAAhBmgB,QAAgB,IAAhBA,EAAAA,EAAoBM,IAElD,WAAEnwB,EAAU,aAAEC,EAAY,gBAAEqW,EAAe,iBAAE5B,IAAqBxU,EAAAA,EAAAA,IAAqBxK,GAEvFqgC,EAA4BR,GAAwBt4B,EACpD+4B,EAAkBnwB,IAAiBkwB,EAEnC1mB,GAAW/c,EAAAA,EAAAA,OACfvf,EAAAA,EAAAA,GAAAM,EAAAA,GAAA,CAAAF,SACGuiB,EAAO4/B,aACNviD,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,sBAIjBxO,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,iCAMrBnO,EAAAA,EAAAA,IAAAC,EAAAA,GAAA,CAAAF,SAAA,CAAE,aAAW0iD,EAAmBroD,OAAO,WAGnCgjD,GACJz9C,EAAAA,EAAAA,GAAAM,EAAAA,GAAA,CAAAF,SACI0yB,EAEEkwB,GACFhjD,EAAAA,EAAAA,GAACmiD,EAA0B,IACK,IAA9BW,EAAmBroD,QACrBuF,EAAAA,EAAAA,GAACy+B,EAAAA,EAA8B,KAG/Bz+B,EAAAA,EAAAA,GAAA,OACEW,IAAG,CACDgB,EAAOuhD,yBACP,CACE5nD,OAAQqhC,EAAa,YAASx1B,GAC/B,IAEHzL,IAAKyhD,EAAW/8C,SAEfy8C,GACC78C,EAAAA,EAAAA,GAACuzB,EAAAA,EAA2B,CAC1B7C,KAAMoyB,EACNziC,eAAgBsC,EAAOtC,eACvBE,gBAAiBoC,EAAOpC,gBACxByN,QAASf,EACTgB,UAAWf,EACXsG,oBAAqB,EACrB+P,gBAAiBA,EACjB5B,iBAAkBA,IAElB,QA3BN3hC,EAAAA,EAAAA,GAACiiD,EAAsC,CAACrH,OAAQA,MAiCtD,GAAIje,EACF,OAAO8gB,EAIT,GAAI/e,GAAmBwe,EACrB,OAAO,KAGT,MAAMiG,EAAoBrwB,IAAiBkwB,IAA8B9F,EAEzE,OACEl9C,EAAAA,EAAAA,GAACu8C,EAAAA,GAAoB,CACnB3B,OAAQA,EACRD,SAAUA,EACVz/C,MAAM,uBACNohC,SAAU2mB,EAAkB3mB,EAAW,KACvC5P,KAAM/J,EAAO+J,KACbmuB,SACE76C,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,kRAInB9J,aAAcy1C,EAAAA,GAA0BiJ,qBAExClI,sBAAuBiI,EAtJGjI,KACV,OAAlBne,QAAkB,IAAlBA,GAAAA,EAAqB,CACnBpa,SACAznB,MAAO,uBACPohC,SAAU2mB,EAAkB3mB,EAAW,MACvC,OAiJmEn1B,EACnE8zC,uBACE17B,EAAAA,EAAAA,OACElf,EAAAA,EAAAA,IAAAC,EAAAA,GAAA,CAAAF,SAAA,EACEJ,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaye,UAAS,KACvB97C,EAAAA,EAAAA,IAACq9B,EAAAA,IAAaO,aAAY,CACxB17B,YAAY,yHACZ8lB,SAAU1F,EAAO4/B,YACjBtgD,QAASA,IAAMygD,GAAyB,GAAOtiD,SAAA,EAE/CJ,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaQ,cAAa,KAC3Bl+B,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,0BAInBnO,EAAAA,EAAAA,IAACq9B,EAAAA,IAAaO,aAAY,CACxB17B,YAAY,yHACZ8lB,QAAS1F,EAAO4/B,YAChBtgD,QAASA,IAAMygD,GAAyB,GAAMtiD,SAAA,EAE9CJ,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaQ,cAAa,KAC3Bl+B,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,wBAKnB,KAEN4sC,yBAA0B,CAAC,OAC3BC,gBAAkBuC,IAChB,MAAMuD,EAAkB,IAAIx+B,EAAOpC,mBAAoBoC,EAAOtC,gBAAgBpX,KAAK,KAEpE,QAAX20C,IACFE,EAAAA,EAAAA,IAAqBwE,EAAwB3/B,EAAOpC,gBAAiBoC,EAAOtC,eAAgB8gC,EAC9F,KAEEpE,EAAY38C,SAEfq9C,GACoB,EAIrB97C,EAAS,CACbuhD,yBAA0B,CAGxBn/C,QAAS,OACT5D,SAAU,SACVkD,OAAQ,Y,oDCnS0D,IAAAxB,GAAA,CAAAH,KAAA,UAAAC,OAAA,iEAAAF,GAAA,CAAAC,KAAA,UAAAC,OAAA,yEAgBtE,MAAM0hD,GAA0CroD,IAAyC,IAAxC,OAAE4/C,GAAgC5/C,EACjF,MAAM,MAAE2H,IAAUC,EAAAA,EAAAA,KAElB,OACE5C,EAAAA,EAAAA,GAAA,OAAKW,IAAGkB,GAA+EzB,UACrFC,EAAAA,EAAAA,IAAA,OAAKM,IAAGc,GAAoFrB,SAAA,EAC1FJ,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWwD,MAAK,CAAClT,KAAGC,EAAAA,EAAAA,IAAE,CAAE8O,UAAW/M,EAAMgN,QAAQc,IAAI,IAAErM,MAAM,YAAY0P,MAAO,EAAE1T,UACjFJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,oBAInBxO,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWC,KAAI,CAAC3P,KAAGC,EAAAA,EAAAA,IAAE,CAAEsM,aAAcvK,EAAMgN,QAAQc,IAAI,IAAErM,MAAM,YAAWhE,UACzEJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,uHAKnBxO,EAAAA,EAAAA,GAACiD,EAAAA,EAAM,CAACV,YAAY,kDAAkDE,KAAK,UAAUR,QAAS24C,EAAOx6C,UACnGJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,0BAKjB,EAIG80C,GAAgC98C,IAUF,IAVG,OAC5Cmc,EAAM,aACN6R,EAAY,SACZmmB,EAAQ,OACRC,EAAM,QACN1wB,EAAO,WACPyS,EAAU,mBACVI,EAAkB,gBAClB2B,KACGqe,GACgCv2C,EACnC,MAQOssB,EAAcmqB,IAAclwC,EAAAA,EAAAA,UAAQ,KAAO,IAADw2C,EAC/C,MAAMR,EAAax8C,QAA4B,QAArBg9C,EAAC5gC,EAAO0M,qBAAa,IAAAk0B,OAAA,EAApBA,EAAsB9oD,QACjD,OAAI8kB,EAAAA,EAAAA,MACK,CAACwjC,EAAYvuB,EAAa7mB,QAAOmB,IAAA,IAAC,OAAEpC,GAAQoC,EAAA,OAAMpC,CAAM,IAAE0oB,WAE5D,CAAC2tB,EAAYvuB,EAAa1c,MAAM,EAAG6K,EAAO1C,oBAAsB,IAAImV,UAAU,GACpF,CAACZ,EAAc7R,IAEZu6B,GAAiBnwC,EAAAA,EAAAA,UAAQ,KACrB+lB,GACP,CAACA,IAEE0wB,GAAgCC,EAAAA,GAAAA,MAEhCzvB,EAAiB0vB,IACrBF,EAA8BE,EAAO/gC,GAAQ,EAGzCghC,GAA+B7jC,EAAAA,EAAAA,cAAY,KAC/C0jC,EAA8B,IACzB7gC,EACH+M,wBAAyB/M,EAAO+M,wBACR,GACzB,CAAC/M,EAAQ6gC,IAENI,GAA4B9jC,EAAAA,EAAAA,cAAY,KAC5C0jC,EAA8B,IACzB7gC,EACHiN,qBAAsBjN,EAAOiN,qBACL,GACzB,CAACjN,EAAQ6gC,KAEN,cAAExoC,IAAkB0D,EAAAA,GAAAA,KAEpB++B,GACJz9C,EAAAA,EAAAA,GAAAM,EAAAA,GAAA,CAAAF,SACI0yB,GAEEmB,EAAAA,EAAAA,OACFj0B,EAAAA,EAAAA,GAACk0B,GAAAA,EAAoB,CACnBlK,YAAaizB,EACb/yB,QAASA,EACTD,WAAYtH,EACZqR,cAAeA,KAGjBh0B,EAAAA,EAAAA,GAACm0B,GAAAA,EAAkB,CACjBnK,YAAaizB,EACb/yB,QAASA,EACTD,WAAYtH,EACZqR,cAAeA,KAbjBh0B,EAAAA,EAAAA,GAACqjD,GAAuC,CAACzI,OAAQA,MAkBvD,IAAIiJ,EAQJ,OAPI35B,GAAW+F,EAAAA,GAA4B1F,MAAM+E,GAAU3M,EAAO0M,cAAcphB,SAASqhB,OACvFu0B,EAAc7oC,EAAc,CAAArf,GAAA,SAC1B6S,eAAe,oEAKfmuB,EACK8gB,EAIL/e,GAAmBwe,EACd,MAIPl9C,EAAAA,EAAAA,GAACu8C,EAAAA,GAAoB,CACnB3B,OAAQA,EACRD,SAAUA,EACVz/C,MAAOynB,EAAO6M,UACd8M,UAAUt8B,EAAAA,EAAAA,GAACo6C,EAAAA,GAAuB,CAACE,aAAc2C,IACjDvwB,KAAM/J,EAAO+J,KACbhoB,aAAcy1C,EAAAA,GAA0BwD,aACxCzC,sBAxF0BA,KACV,OAAlBne,QAAkB,IAAlBA,GAAAA,EAAqB,CACnBpa,SACAznB,MAAOynB,EAAO6M,UACd8M,UAAUt8B,EAAAA,EAAAA,GAACo6C,EAAAA,GAAuB,CAACE,aAAc9lB,KACjD,EAoFA2mB,QAAS,CACP,CACEa,YAAahhC,EAAc,CAAArf,GAAA,SACzB6S,eAAe,8BAIjBstC,cAAen5B,EAAO+M,uBACtBqsB,UAAW4H,GAEb,CACE3H,YAAahhC,EAAc,CAAArf,GAAA,SACzB6S,eAAe,0BAIjBstC,cAAen5B,EAAOiN,oBACtBmsB,UAAW6H,IAGf/I,QAASgJ,KACL9G,EAAY38C,SAEfq9C,GACoB,E,oDC5K2E,IAAAh8C,GAAA,CAAAC,KAAA,SAAAC,OAAA,eAY/F,MAAMmiD,GAA2B9oD,IASF,IATG,OACvC2nB,EAAM,aACN6R,EAAY,SACZmmB,EAAQ,OACRC,EAAM,QACN1wB,EAAO,WACPyS,EAAU,mBACVI,KACGggB,GAC2B/hD,EAC9B,MAAM,MAAE2H,IAAUC,EAAAA,EAAAA,KACZmhD,GAAeh/C,EAAAA,EAAAA,QAAO,OACrBuvB,EAAgB0vB,IAAqBn9C,EAAAA,EAAAA,UAAS,IAErDe,EAAAA,EAAAA,YAAU,KACR,MAAMgD,EAAiB,IAAID,gBAAgBs5C,IACzCD,EAAkBC,EAAQ,GAAGC,YAAY7oD,MAAM,IAKjD,OAHI0oD,EAAa/+C,SACf4F,EAAeI,QAAQ+4C,EAAa/+C,SAE/B,KACL4F,EAAeK,YAAY,CAC5B,GACA,CAAC84C,IAIJ,MAAOI,EAAWC,IAAgBv9C,EAAAA,EAAAA,UAAS8b,GACrC6gC,GAAgCC,EAAAA,GAAAA,MAChC5yB,GAAa/Q,EAAAA,EAAAA,cAChBgR,IACC0yB,EAA8B,IAAK7gC,EAAQmO,QAAoC,GAEjF,CAACnO,EAAQ6gC,IAMLh0B,EAAwC,IAA5B7M,EAAOiO,UAAUn2B,OAAekoB,EAAOiO,UAAU,GAAKyzB,GAAAA,GAUlEpH,GAAalwC,EAAAA,EAAAA,UAAQ,KACrBwS,EAAAA,EAAAA,MACKiV,EAAa7mB,QAAO9L,IAAA,IAAC,OAAE6K,GAAQ7K,EAAA,OAAM6K,CAAM,IAAE0oB,UAE/CZ,EAAa1c,MAAM,EAAG6K,EAAO1C,oBAAsB,IAAImV,WAC7D,CAACZ,EAAc7R,KAMZ,UAAE2N,EAAS,QAAEC,EAAO,QAAEC,IAAYC,EAAAA,GAAAA,GAAwB,CAC9DC,KAAMusB,EACNtsB,kBAAmBhO,EAAOiO,WAAa,KAGnC0zB,EAAiBnqD,OAAO23B,KAAKxB,GAAW71B,QAE9CmN,EAAAA,EAAAA,YAAU,KAEe,IAAnB08C,GAAwBH,EAAUrzB,OAASN,GAC7CK,EAAWL,EACb,GACC,CAACA,EAAS8zB,EAAgBH,EAAUrzB,KAAMD,IAE7C,MAAM0zB,EACJtH,EAAWtvC,QAAQ0e,GACVA,EAAItZ,KAAKyxC,GAAAA,MACf/pD,OAASsd,GAAAA,GAER0lC,GACJp9C,EAAAA,EAAAA,IAAA,OACEM,KAAGC,EAAAA,EAAAA,IAAE,CACHmD,QAAS,OACT2Q,cAAe,SACfpZ,OAAQqhC,EAAa,YAASx1B,EAC9B9L,MAAO,OACP8E,SAAU,QACX,IAACC,SAAA,EAEFJ,EAAAA,EAAAA,GAAA,OACEtE,IAAKqoD,EACLpjD,KAAGC,EAAAA,EAAAA,IAAE,CACHyC,OAAQ,UACR/H,OAAQ,eAAkC,EAAnBqH,EAAMgN,QAAQc,QACrCtQ,SAAU,QACX,IAACC,UAEFJ,EAAAA,EAAAA,GAACq0B,GAAAA,EAAa,CACZrK,YAAaizB,EACb/yB,QAASA,EACTD,WAAYk6B,EACZnwB,cA7Ce0vB,IACrBF,EAA8BE,EAAO/gC,GAAQ,EA6CvC2R,eAAgBA,OAGpBt0B,EAAAA,EAAAA,GAAA,OACEW,KAAGC,EAAAA,EAAAA,IAAE,CACHqD,eAAgB,SAChBD,WAAY,SACZD,QAAS,cACTuE,IAAK3F,EAAMgN,QAAQc,IACpB,IAACrQ,UAEFJ,EAAAA,EAAAA,GAAA,OAAKW,IAAGc,GAAqBrB,UAC3BJ,EAAAA,EAAAA,GAACkpB,GAAAA,EAAgB,CACfC,aAAcg7B,EAAUrzB,KACxBxjB,SAjFawjB,IACrBszB,GAAcK,IAAI,IAAWA,EAAM3zB,UAAQ,EAiFnC7I,IAAKsI,EACLpI,IAAKqI,EACLqB,MAAOvB,EACPQ,KAAM,KACNjsB,SAAU1K,OAAO23B,KAAKxB,GAAW71B,QAAU,EAC3CiqD,cAAe7zB,WAOzB,OAAI8L,EACK8gB,GAIPz9C,EAAAA,EAAAA,GAACu8C,EAAAA,GAAoB,CACnB3B,OAAQA,EACRD,SAAUA,EACVz/C,MAAOs0B,EACP8M,SACEioB,GAAoC,gCAAgCxsC,GAAAA,UAEtE2U,KAAM/J,EAAO+J,KACbhoB,aAAcy1C,EAAAA,GAA0BwD,aACxCzC,sBAtG0BA,KACV,OAAlBne,QAAkB,IAAlBA,GAAAA,EAAqB,CACnBpa,SACAznB,MAAOs0B,EACP8M,UAAUt8B,EAAAA,EAAAA,GAACo6C,EAAAA,GAAuB,CAACE,aAAc9lB,KACjD,KAkGIuoB,EAAY38C,SAEfq9C,GACoB,ECjIrBkH,GAAoB3pD,IAsBE,IAtBD,WACzBivB,EAAU,aACVuK,EAAY,MACZ7b,EAAK,aACL+jB,EAAY,iBACZI,EAAgB,cAChBF,EAAa,mBACbG,EAAkB,QAClB7S,EAAO,WACPyS,EAAU,YACVK,EAAW,UACXC,EAAS,kBACT8d,EAAiB,cACjBC,EAAa,cACb5d,EAAa,mBACb3lB,EAAkB,+BAClB2mC,EAA8B,gBAC9B1f,EAAe,sBACfvU,EAAqB,OACrB7uB,EAAM,aACNuhD,EAAY,qBACZwB,GACoBrjD,EACpB,MAAM4pD,GAAkB3sB,EAAAA,EAAAA,MAClB4sB,EAAkB,GAAG56B,EAAWyC,QAAQ/T,KAAS+jB,IAEjDqgB,GAAehwC,EAAAA,EAAAA,UACnB,MACEqwB,gBACAJ,cACAC,YACA8d,oBACAC,mBAEF,CAAC5d,EAAeJ,EAAaC,EAAW8d,EAAmBC,IAGvD8J,GAAY/3C,EAAAA,EAAAA,UAChB,MACE6tC,OAAQA,IAAM9d,EAAiB7S,GAC/B0wB,SAAUA,IAAM/d,EAAc3S,GAC9B8S,wBAEF,CAACD,EAAkBF,EAAeG,EAAoB9S,IAGlD86B,GAAmBh4C,EAAAA,EAAAA,UACvB,MACE4vB,aACAl3B,IAAKm/C,OAAkBz9C,EAAY09C,EACnCptC,qBACAyS,UACAwU,kBACApjC,SACAuhD,eACAwB,0BACGyG,KACA/H,KAEL,CACEpgB,EACAioB,EACAC,EACAptC,EACAyS,EACA46B,EACA/H,EACAre,EACApjC,EACAuhD,EACAwB,IAIEpB,GAAalwC,EAAAA,EAAAA,UAAQ,KACrBwS,EAAAA,EAAAA,MACKiV,EAAa7mB,QAAO9L,IAAA,IAAC,OAAE6K,GAAQ7K,EAAA,OAAM6K,CAAM,IAAE0oB,UAE/CZ,EAAa1c,MAAM,EAAGmS,EAAWhK,oBAAsB,IAAImV,WACjE,CAACZ,EAAcvK,EAAWhK,qBAE7B,OAAIgK,EAAWxnB,OAASuvB,EAAAA,GAAca,UAElC7yB,EAAAA,EAAAA,GAACqiD,EAA2B,CAC1B1/B,OAAQsH,EACRuK,aAAcA,KACVuwB,KAKN3uB,EAAAA,EAAAA,OAAsCnM,EAAWxnB,OAASuvB,EAAAA,GAAc+B,YAExE/zB,EAAAA,EAAAA,GAACsjD,GAA6B,CAC5B3gC,OAAQsH,EACRuK,aAAcA,KACVuwB,KAKNzuB,EAAAA,EAAAA,OAAiCrM,EAAWxnB,OAASuvB,EAAAA,GAAcoC,OAEnEp0B,EAAAA,EAAAA,GAAC8jD,GAAwB,CACvBnhC,OAAQsH,EACRuK,aAAcA,KACVuwB,IAKN96B,EAAWxnB,OAASuvB,EAAAA,GAAcC,KAElCjyB,EAAAA,EAAAA,GAAC08C,EAAAA,EAAsB,CACrB/5B,OAAQsH,EACRuK,aAAcyoB,KACV8H,IAGC96B,EAAWxnB,OAASuvB,EAAAA,GAAcY,MAEzC5yB,EAAAA,EAAAA,GAACk+C,EAAuB,CACtBv7B,OAAQsH,EACRuK,aAAcyoB,EACdmB,+BAAgCA,EAChCj0B,sBAAuBA,EACvBylB,kBAAmBj3B,KACfosC,IAGC96B,EAAWxnB,OAASuvB,EAAAA,GAAc6B,SAEzC7zB,EAAAA,EAAAA,GAACuhD,EAA0B,CACzB5+B,OAAQsH,EACRuK,aAAcyoB,KACV8H,IAGC96B,EAAWxnB,OAASuvB,EAAAA,GAAcO,SAEzCvyB,EAAAA,EAAAA,GAAC2hD,EAA0B,CACzBh/B,OAAQsH,EACRuK,aAAcyoB,KACV8H,IAIH,IAAI,EAGAtoB,IAAiB4d,EAAAA,EAAAA,MAAKsK,G,4MCvKnC,MAAMK,EAAoB,gBAG1B,IAAAhqD,EAAA,CAAA0G,KAAA,UAAAC,OAAA,iEAAAE,EAAA,CAAAH,KAAA,UAAAC,OAAA,yEAIA,MAAMsjD,EAA8BA,KAClC,MAAM,MAAEtiD,IAAUC,EAAAA,EAAAA,KAElB,OACE5C,EAAAA,EAAAA,GAAA,OAAKW,IAAG3F,EAA+EoF,UACrFC,EAAAA,EAAAA,IAAA,OAAKM,IAAGkB,EAAoFzB,SAAA,EAC1FJ,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWwD,MAAK,CAAClT,KAAGC,EAAAA,EAAAA,IAAE,CAAE8O,UAAW/M,EAAMgN,QAAQc,GAAI2xC,UAAW,UAAU,IAAEh+C,MAAM,YAAY0P,MAAO,EAAE1T,UACtGJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,qCAInBxO,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWC,KAAI,CAAC3P,KAAGC,EAAAA,EAAAA,IAAE,CAAEsM,aAAcvK,EAAMgN,QAAQc,GAAI2xC,UAAW,UAAU,IAAEh+C,MAAM,YAAWhE,UAC9FJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,iKAKjB,EAER,IAAAhI,EAAA,CAAA9E,KAAA,SAAAC,OAAA,iEAAAmN,EAAA,CAAApN,KAAA,SAAAC,OAAA,YAAAoN,EAAA,CAAArN,KAAA,SAAAC,OAAA,iEAAAqN,EAAA,CAAAtN,KAAA,UAAAC,OAAA,cAAAsN,EAAA,CAAAvN,KAAA,UAAAC,OAAA,6CAEK,MAAMwyB,EAAqB1yB,IAU3B,IAV4B,YACjCuoB,EAAW,WACXC,EAAU,QACVC,EAAO,cACP8J,GAMDvyB,EACC,MAAM,cAAEuZ,IAAkB0D,EAAAA,EAAAA,MACpB,MAAE/b,IAAUC,EAAAA,EAAAA,MAEZ,aAAEsiD,EAAY,cAAEC,EAAa,WAAEC,EAAU,KAAEryC,EAAI,WAAEsyC,IAAet4C,EAAAA,EAAAA,UACpE,KAAMu4C,EAAAA,EAAAA,IAA4Bt7B,EAAaC,EAAY+6B,EAAmB96B,IAC9E,CAACF,EAAaC,EAAYC,IAGtBq7B,EAAU,IACVt7B,EAAWoF,cAAcphB,SAAS6hB,EAAAA,GAAiC01B,eAAiBN,EAAe,MACnGj7B,EAAWoF,cAAcphB,SAAS6hB,EAAAA,GAAiC21B,gBAAkBN,EAAgB,MACrGl7B,EAAWoF,cAAcphB,SAAS6hB,EAAAA,GAAiC41B,YAAcN,EAAa,MAC9Fn7B,EAAWoF,cAAcphB,SAAS6hB,EAAAA,GAAiC61B,YAAcN,EAAa,MAC9Fp7B,EAAWoF,cAAcphB,SAAS6hB,EAAAA,GAAiC81B,MAAQ7yC,EAAO,KAGlF,eAAE8yC,EAAc,mBAAEC,IAAuB/4C,EAAAA,EAAAA,UAAQ,KAErD,IAAI84C,EAAiB77B,EAAYhX,MAAMH,GAAYA,EAAQ6Z,OAASzC,EAAW87B,0BACxD5+C,IAAnB0+C,GAAgC77B,EAAYvvB,OAAS,IAEvDorD,EAAiB77B,EAAY,IAG/B,MAAM87B,EAAqB97B,EAAYrc,QACpCkF,QAA+B1L,IAAnB0+C,GAAgChzC,EAAQ6Z,OAASm5B,EAAen5B,OAG/E,MAAO,CAAEm5B,iBAAgBC,qBAAoB,GAC5C,CAAC97B,EAAaC,EAAW87B,qBAGtBC,GAAaj5C,EAAAA,EAAAA,UAAQ,KACzB,MAAMk5C,EAAyBA,CAACpzC,EAA4BqzC,KAC1D,MAOMC,EAAsBt4C,GACnBA,EAAIgF,EAAQ6Z,MAErB,OAAIw5B,EACK,CACLvqD,GAAIkX,EAAQ6Z,KACZ0V,OAAQA,KAEJpiC,EAAAA,EAAAA,GAAA,QAAMW,IAAG6F,EAA6EpG,UACpFC,EAAAA,EAAAA,IAAA,QAAMM,KAAGC,EAAAA,EAAAA,IAAE,CAAEmD,QAAS,cAAeuE,IAAK3F,EAAMgN,QAAQC,GAAI5L,WAAY,UAAU,IAAC5D,SAAA,EACjFJ,EAAAA,EAAAA,GAACyM,EAAAA,EAAY,CAACrI,MAAOyO,EAAQzO,QAC5ByO,EAAQwtB,aACTrgC,EAAAA,EAAAA,GAACqV,EAAAA,IAAG,CACF9S,YAAY,iHACZ5B,IAAGmO,EAAgB1O,UAEnBJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,oBAQ3BgG,KA1GW,IA2GX4xC,WAAYD,EACZE,KAAOx4C,IAAa7N,EAAAA,EAAAA,GAAA,QAAAI,UAAOkmD,EAAAA,EAAAA,IAAiCz4C,EAAI04C,eAG7D,CACL5qD,GAAIkX,EAAQ6Z,KACZ0V,OAAQA,KAEJpiC,EAAAA,EAAAA,GAAA,QAAMW,IAAGoO,EAA6E3O,UACpFC,EAAAA,EAAAA,IAAA,QAAMM,KAAGC,EAAAA,EAAAA,IAAE,CAAEmD,QAAS,cAAeuE,IAAK3F,EAAMgN,QAAQC,GAAI5L,WAAY,UAAU,IAAC5D,SAAA,EACjFJ,EAAAA,EAAAA,GAACyM,EAAAA,EAAY,CAACrI,MAAOyO,EAAQzO,QAC5ByO,EAAQwtB,iBAKjB7rB,KA3Ha,IA4Hb4xC,WAlDkBv4C,IAA0C,IAAD24C,EAC3D,MAAO,CACL3hB,KAAMh3B,EAAIgF,EAAQ6Z,MAClB+5B,WAAYZ,EAA4E,QAA9DW,GAAGE,EAAAA,EAAAA,IAAe74C,EAAIgF,EAAQ6Z,MAAO7e,EAAIg4C,EAAen5B,cAAM,IAAA85B,OAAA,EAA3DA,EAA6DhpC,MAAQ,KACnG,EA+CD6oC,KAAOx4C,IACLxN,EAAAA,EAAAA,IAAA,QAAMM,KAAGC,EAAAA,EAAAA,IAAE,CAAEmD,QAAS,cAAeuE,IAAK3F,EAAMgN,QAAQc,GAAI6rC,cAAe,UAAU,IAACl8C,SAAA,EACpFJ,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWC,KAAI,CAAAlQ,UAAEkmD,EAAAA,EAAAA,IAAiCz4C,EAAI04C,WAAW1hB,QACjEghB,GACC57B,EAAWyF,wBACX7hB,EAAI04C,WAAWE,aACmB,MAAjC54C,EAAI04C,WAAWE,WAAW,IACzBpmD,EAAAA,EAAAA,IAAA,OAAKM,KAAGC,EAAAA,EAAAA,IAAE,CAAEmD,QAAS,cAAeuE,IAAK3F,EAAMgN,QAAQqC,IAAI,IAAC5R,SAAA,EAC1DJ,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWs2C,UAAS,CAACviD,MAAM,QAAOhE,SAAEyN,EAAI04C,WAAWE,cACpDzmD,EAAAA,EAAAA,GAAC4mD,EAAAA,IAAa,CAACxiD,MAAM,eAGvB/D,EAAAA,EAAAA,IAAA,OAAKM,KAAGC,EAAAA,EAAAA,IAAE,CAAEmD,QAAS,cAAeuE,IAAK3F,EAAMgN,QAAQqC,IAAI,IAAC5R,SAAA,EAC1DJ,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWs2C,UAAS,CAACviD,MAAM,UAAShE,SAAEyN,EAAI04C,WAAWE,cACtDzmD,EAAAA,EAAAA,GAAC6mD,EAAAA,IAAW,CAACziD,MAAM,mBAK9B,EAGH,MAAO,CACL,CACEzI,GAAIqpD,EACJ5iB,OAAQpnB,EAAc,CAAArf,GAAA,SACpB6S,eAAe,eAGjBs4C,YAAa9B,EACbxwC,KA3Ja,QA6JXqxC,EAAiB,CAACI,EAAuBJ,GAAgB,IAAS,MACnEC,EAAmBl3C,KAAKiE,GAAYozC,EAAuBpzC,GAAS,KACxE,GACA,CAAClQ,EAAMgN,QAASqL,EAAe6qC,EAAgBC,EAAoB77B,EAAWyF,yBAE3Eq3B,GAAQC,EAAAA,EAAAA,IAAc,CAC1Bt2B,KAAM60B,EACN0B,QAASjB,EACTkB,sBAAsB,EACtBC,iBAAkB,WAClBC,iBAAiBA,EAAAA,EAAAA,QAGbC,GAA2BvnC,EAAAA,EAAAA,cAC9BimC,IACK/xB,GACFA,GAAehvB,IAAO,IAChBA,EACJ+gD,wBAEJ,GAEF,CAAC/xB,IAGH,OAA2B,IAAvBhK,EAAYvvB,OACP,KAG+B,IAApCssD,EAAMO,cAAcC,KAAK9sD,QACpBuF,EAAAA,EAAAA,GAACilD,EAA2B,KAInCjlD,EAAAA,EAAAA,GAAA,OACEW,KAAGC,EAAAA,EAAAA,IAAE,CACHmD,QAAS,OACT5D,SAAU,cACVkD,OAAQ,UACR/H,YAAQ6L,EACR9L,MAAO,QACR,IAAC+E,UAEFJ,EAAAA,EAAAA,GAAA,OAAKW,IAAGqO,EAAoB5O,UAC1BC,EAAAA,EAAAA,IAAC6N,EAAAA,IAAK,CAAChP,MAAO,CAAE7D,MAAO0rD,EAAMS,gBAAkBr5C,YAAU,EAAA/N,SAAA,CACtD2mD,EAAMU,kBAAkB74C,KAAK84C,IAC5B1nD,EAAAA,EAAAA,GAACoO,EAAAA,IAAQ,CAAsBC,UAAQ,EAAAjO,SACpCsnD,EAAYC,QAAQ/4C,KAAI,CAACwzB,EAAQzpB,KAE9B3Y,EAAAA,EAAAA,GAACsO,EAAAA,IAAW,CACV/L,YAAY,iHAEZrD,MAAO,CACL+qC,SAAU7H,EAAOwlB,OAAOC,WAE1BC,UAAW1lB,EAAOwlB,OAAOG,eACzBC,cAAe5lB,EAAO6lB,mBAAmB7nD,UAEzCC,EAAAA,EAAAA,IAAA,OACEM,KAAGC,EAAAA,EAAAA,IAAE,CACHmD,QAAS,OACT2Q,cAAe,MACfpM,IAAK3F,EAAMgN,QAAQqC,GACnBhO,WAAY,UACb,IAAC5D,SAAA,EAEFJ,EAAAA,EAAAA,GAAA,OAAKW,IAAGsO,EAAqD7O,UAC1D8nD,EAAAA,EAAAA,IAAW9lB,EAAOwlB,OAAOO,UAAU/lB,OAAQA,EAAOgmB,gBAE1C,IAAVzvC,GAAeqb,IACdh0B,EAAAA,EAAAA,GAAA,OAAAI,UACEC,EAAAA,EAAAA,IAACq9B,EAAAA,IAAajqB,KAAI,CAAArT,SAAA,EAChBJ,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaE,QAAO,CAACC,SAAO,EAAAz9B,UAC3BJ,EAAAA,EAAAA,GAACiD,EAAAA,EAAM,CAACV,YAAY,yBAAyBL,MAAMlC,EAAAA,EAAAA,GAACk8C,EAAAA,IAAY,SAElEl8C,EAAAA,EAAAA,GAAC09B,EAAAA,IAAa9pB,QAAO,CAAAxT,UACnBJ,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaxgB,KAAI,CAChB3a,YAAY,iHACZN,QAASA,IAAMolD,EAAyBjlB,EAAOzmC,IAAIyE,UAEnDJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,iCA9BxB4zB,EAAOzmC,OALL+rD,EAAY/rD,MAiD5BorD,EAAMO,cAAcC,KAAK34C,KAAKf,IAC7B7N,EAAAA,EAAAA,GAACoO,EAAAA,IAAQ,CAAAhO,SACNyN,EAAIw6C,cAAcz5C,KAAKy3C,IACtBrmD,EAAAA,EAAAA,GAAC2O,EAAAA,IAAS,CAAezP,MAAO,CAAE+qC,SAAUoc,EAAKuB,OAAOC,WAAaS,WAAS,EAAAloD,UAC3E8nD,EAAAA,EAAAA,IAAW7B,EAAKuB,OAAOO,UAAU9B,KAAMA,EAAK+B,eAD/B/B,EAAK1qD,OAFVkS,EAAIlS,YAUrB,C,qNCjQV,MAAMqpD,EAAoB,gBACO,IAAAhqD,EAAA,CAAA0G,KAAA,UAAAC,OAAA,4FAAAE,EAAA,CAAAH,KAAA,SAAAC,OAAA,oEAEjC,MA8CM4mD,EAAoBntD,GAKnBA,EAAMotD,OAAOpoD,UAKhBJ,EAAAA,EAAAA,GAAA,QAAAI,UACEJ,EAAAA,EAAAA,GAACiD,EAAAA,EAAM,CACLf,KAAM9G,EAAMqtD,UAAWzoD,EAAAA,EAAAA,GAAC0oD,EAAAA,IAAe,KAAM1oD,EAAAA,EAAAA,GAAC2oD,EAAAA,EAAgB,IAC9D1mD,QAAU1H,IACRa,EAAMwtD,SAASxtD,EAAMotD,OAAQjuD,EAAE,EAEjCgI,YAAY,+CAEZrD,MAAO,CAAE2pD,MAAO,OAAQx2B,OAAQ,qBAChC7d,KAAK,aAZFxU,EAAAA,EAAAA,GAAA,OAAKd,MAAO,CAAEuB,QAAS,WAAYooD,MAAO,UA4B/CC,EAAep4B,IACnB,MA2CMq4B,EAAcA,CAClBC,EACAt7C,IAEOvT,OAAO23B,KAAKpkB,GAAQkB,KAAKnJ,IAC9B,GAA2B,mBAAhBiI,EAAOjI,GAAoB,CACpC,IAAIwjD,EAAS,CACXxjD,IAAKA,EACL,CAACu/C,GAAoBv/C,GASvB,OAPAtL,OAAO23B,KAAKk3B,GAA4B/wC,SAAS9D,IAAa,IAAD+0C,EAC3D,MAAM9+C,EAA2C,QAAtC8+C,EAAGF,EAA2B70C,UAAQ,IAAA+0C,OAAA,EAAnCA,EAAsCzjD,GACpDwjD,EAAS,IACJA,EACH,CAAC90C,QAAoBhN,IAAViD,EAAsB++C,EAAAA,GAAuC/+C,EACzE,IAEI6+C,CACT,CAEA,MAAMG,EAAgE,CAAC,EAKvE,OAJAjvD,OAAO23B,KAAKk3B,GAA4B/wC,SAAS9D,IAAa,IAADk1C,EAC3DD,EAAaj1C,GAA8C,QAAtCk1C,EAAGL,EAA2B70C,UAAQ,IAAAk1C,OAAA,EAAnCA,EAAsC5jD,EAAI,IAG7D,CACLA,IAAKA,EACL,CAACu/C,GAAoBv/C,EACrBrF,SAAU2oD,EAAYK,EAAc17C,EAAOjI,IAC5C,IAyCL,OAAOirB,EAAK9hB,KArCef,IACzB,IAAIy7C,EACAC,GAAY,EAChB,MAAMC,EAAiC,CAAC,EAoBxC,GAlBArvD,OAAO23B,KAAKjkB,GAAKoK,SAAS9D,IACxB,GAAIA,IAAY6wC,GACVn3C,EAAIsG,KAAag1C,EAAAA,GAAsC,CACzD,MAAM1pD,EApFa2K,KACzB,IACE,MAAMlJ,EAASC,KAAKC,MAAMgJ,GAC1B,OAAe,OAAXlJ,GAAqC,kBAAXA,GAAuByqB,MAAM89B,QAAQvoD,IAA0C,IAA/B/G,OAAO23B,KAAK5wB,GAAQzG,OACzF,KAEFyG,CACT,CAAE,MAAO3G,GACP,OAAO,IACT,GA2EmBmvD,CAAkB77C,EAAIsG,IAEnC,GADAq1C,EAAUr1C,GAAW1U,EACR,OAATA,EACF8pD,GAAY,MACP,CACL,MAAMI,EA7EmBC,EAACC,EAAuCC,KACzE,QAAgB3iD,IAAZ0iD,GAAyD,IAAhC1vD,OAAO23B,KAAK+3B,GAASpvD,OAEhD,OAAO,KACF,QAAgB0M,IAAZ2iD,GAAyD,IAAhC3vD,OAAO23B,KAAKg4B,GAASrvD,OACvD,OAAO,KAGT,MAAMiT,EAAkC,CAAC,EAEnCq8C,EAAcA,CAACj/C,EAA0BsH,KAC7C,IAAK,MAAM3M,KAAO2M,EACXtH,EAAOlQ,eAAe6K,KAAQqF,EAAOrF,KACb,kBAAhB2M,EAAO3M,IAAqC,OAAhB2M,EAAO3M,IAAkBkmB,MAAM89B,QAAQr3C,EAAO3M,IAG1E2M,EAAO3M,KAAS0jD,EAAAA,GACzBr+C,EAAOrF,IAAO,EAEdqF,EAAOrF,IAAO,GALdqF,EAAOrF,GAAOqF,EAAOrF,IAAQ,CAAC,EAC9BskD,EAAYj/C,EAAOrF,GAAM2M,EAAO3M,KAOtC,EAMF,YAHY0B,IAAZ0iD,GAAyBE,EAAYr8C,EAAQm8C,QACjC1iD,IAAZ2iD,GAAyBC,EAAYr8C,EAAQo8C,GAEtCp8C,CAAM,EAiDgBk8C,CAA2BN,EAAY7pD,GACvC,OAAjBkqD,EACFJ,GAAY,EAEZD,EAAaK,CAEjB,CACF,CACF,KAEEJ,QAA4BpiD,IAAfmiD,EAWf,OAAOz7C,EAVP,IACE,MAAO,CACL,CAACm3C,GAAoBn3C,EAAIm3C,GACzB5kD,SAAU2oD,EAAYS,EAAWF,GACjC7jD,IAAKoI,EAAIm3C,GAEb,CAAE,MACA,OAAOn3C,CACT,CAGF,GAEgC,EAG9Bm8C,EAAsBC,IAC1B,IAAKA,EAAa,OAAO,EAEzB,OAAOA,EADc,EACY,EAG7BC,EAAsB,CAC1B9nB,OAAQ,CACNikB,KA7MFjrD,IAEA,MAAM,SAAE+uD,EAAQ,MAAE9uD,KAAU+uD,GAAchvD,EAC1C,OAAKC,GAKH2E,EAAAA,EAAAA,GAACqqD,EAAAA,UAAS,CACRhvD,MAAOA,EACPC,OAAQ,EACRgvD,QACEtqD,EAAAA,EAAAA,GAAA,QACEW,IAAG3F,EASHiH,QAAU1H,IACRA,EAAEmU,iBAAiB,IAIzBy7C,SAAUA,EACVI,cAAe,CAAEC,sBAAsB,GACvC7pD,IAAGkB,EAKDzB,UAEFJ,EAAAA,EAAAA,GAAA,SAAQoqD,OAhCHpqD,EAAAA,EAAAA,GAAA,SAAQoqD,GAiCH,IA0Kd,IAAA5jD,EAAA,CAAA9E,KAAA,SAAAC,OAAA,YAEK,MAAM8oD,EAAiBhpD,IAAuF,IAAtF,MAAE+b,EAAK,UAAEktC,GAAuEjpD,EAC7G,MAAM,MAAEkB,IAAUC,EAAAA,EAAAA,KAClB,IAAI+nD,EACAzoD,EAAO,KACX,OAAQwoD,GACN,KAAKE,EAAAA,GAA6BC,SAChCF,EAAiB,QACjBzoD,GAAOlC,EAAAA,EAAAA,GAAC4mD,EAAAA,IAAa,CAACxiD,MAAM,SAAS,cAAY,4BACjD,MACF,KAAKwmD,EAAAA,GAA6BE,SAChCH,EAAiB,UACjBzoD,GAAOlC,EAAAA,EAAAA,GAAC6mD,EAAAA,IAAW,CAACziD,MAAM,UAAU,cAAY,4BAChD,MACF,KAAKwmD,EAAAA,GAA6BG,KAChCJ,EAAiB,OACjBzoD,GAAOlC,EAAAA,EAAAA,GAACgrD,EAAAA,IAAQ,CAACrqD,KAAGC,EAAAA,EAAAA,IAAE,CAAEwD,MAAOzB,EAAMuB,OAAOI,eAAe,IAAE,cAAY,wBAM7E,OACEjE,EAAAA,EAAAA,IAAA,OAAKM,KAAGC,EAAAA,EAAAA,IAAE,CAAEmD,QAAS,cAAeuE,IAAK3F,EAAMgN,QAAQqC,GAAIhO,WAAY,UAAU,IAAC5D,SAAA,EAChFJ,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWs2C,UAAS,CAACviD,MAAOumD,EAAgBhqD,IAAG6F,EAAgBpG,SAC7Dod,IAEFtb,IACG,EAER,IAAA8M,EAAA,CAAAtN,KAAA,SAAAC,OAAA,iEAAAsN,EAAA,CAAAvN,KAAA,SAAAC,OAAA,YAAAuN,EAAA,CAAAxN,KAAA,UAAAC,OAAA,2EAEK,MAAMuyB,EAAuBplB,IAU7B,IAV8B,YACnCkb,EAAW,WACXC,EAAU,QACVC,EAAO,cACP8J,GAMDllB,EACC,MAAM,cAAEkM,IAAkB0D,EAAAA,EAAAA,MACpB,MAAE/b,IAAUC,EAAAA,EAAAA,MAEZ,cAAEsI,EAAa,cAAET,IAAkBJ,EAAAA,EAAAA,MAEnC,aAAE66C,EAAY,cAAEC,EAAa,WAAEC,EAAU,KAAEryC,EAAI,WAAEsyC,IAAet4C,EAAAA,EAAAA,UACpE,KAAMu4C,EAAAA,EAAAA,IAA4Bt7B,EAAaC,EAAY+6B,EAAmB96B,IAC9E,CAACF,EAAaC,EAAYC,KAIrB+gC,EAAcC,IAAmBrkD,EAAAA,EAAAA,WAAS,IAAM8kB,MAAM3B,EAAYvvB,OAAS,GAAGe,KAzQ1D,QA2Q3BoM,EAAAA,EAAAA,YAAU,KACRsjD,EAAgBv/B,MAAM3B,EAAYvvB,OAAS,GAAGe,KA5QrB,KA4QgD,GACxE,CAACwuB,EAAYvvB,SAEhB,MAAM,eAAEorD,EAAc,mBAAEC,IAAuB/4C,EAAAA,EAAAA,UAAQ,KAErD,IAAI84C,EAAiB77B,EAAYhX,MAAMH,GAAYA,EAAQ6Z,OAASzC,EAAW87B,0BACxD5+C,IAAnB0+C,GAAgC77B,EAAYvvB,OAAS,IAEvDorD,EAAiB77B,EAAY,IAG/B,MAAM87B,EAAqB97B,EAAYrc,QACpCkF,QAA+B1L,IAAnB0+C,GAAgChzC,EAAQ6Z,OAASm5B,EAAen5B,OAE/E,MAAO,CAAEm5B,iBAAgBC,qBAAoB,GAC5C,CAAC97B,EAAaC,EAAW87B,qBAEtBsB,GAA2BvnC,EAAAA,EAAAA,cAC9BimC,IACK/xB,GACFA,GAAehvB,IAAO,IAChBA,EACJ+gD,wBAEJ,GAEF,CAAC/xB,IAKGm3B,EAAalhC,EAAWoF,cAAc5mB,QAAO,CAACC,EAAY4mB,KAC9D,OAAQA,GACN,KAAKQ,EAAAA,GAAiC01B,cACpC98C,EAAI+R,KAAK,CACP,CAACuqC,GAAoBhqC,EAAc,CAAArf,GAAA,SACjC6S,eAAe,kBAIjBpO,SAAU,IAAI8kD,GACdz/C,IAAK,iBAEP,MACF,KAAKqqB,EAAAA,GAAiC21B,eACpC/8C,EAAI+R,KAAK,CACP,CAACuqC,GAAoBhqC,EAAc,CAAArf,GAAA,SACjC6S,eAAe,mBAIjBpO,SAAU,IAAI+kD,GACd1/C,IAAK,kBAEP,MACF,KAAKqqB,EAAAA,GAAiC41B,WACpCh9C,EAAI+R,KAAK,CACP,CAACuqC,GAAoBhqC,EAAc,CAAArf,GAAA,SACjC6S,eAAe,eAIjBpO,SAAU0oD,EAAY1D,GACtB3/C,IAAK,eAEP,MACF,KAAKqqB,EAAAA,GAAiC61B,WACpCj9C,EAAI+R,KAAK,CACP,CAACuqC,GAAoBhqC,EAAc,CAAArf,GAAA,SACjC6S,eAAe,eAIjBpO,SAAU,IAAIilD,GACd5/C,IAAK,eAEP,MACF,KAAKqqB,EAAAA,GAAiC81B,KACpCl9C,EAAI+R,KAAK,CACP,CAACuqC,GAAoBhqC,EAAc,CAAArf,GAAA,SACjC6S,eAAe,SAGjBpO,SAAU,IAAI2S,GACdtN,IAAK,SAIX,OAAOiD,CAAG,GACT,IAEGu+C,GAAUl6C,EAAAA,EAAAA,UAAQ,KACtB,MAAMq+C,EACHzyC,GACD,CAAC7K,EAAMiB,KAAqB,IAAnB,KAAEyF,GAAWzF,EACpBm8C,GAAiBlmD,IACf,MAAMqmD,EAAO,IAAIrmD,GAEjB,OADAqmD,EAAK1yC,GAASnE,EAAKnZ,MACZgwD,CAAI,GACX,EAGApF,EAAyBA,CAACpzC,EAA4BqzC,EAAqBvtC,KACxE,CACLlT,IAAKoN,EAAQ6Z,KACb4+B,UAAWz4C,EAAQ6Z,KACnBxxB,OACE8E,EAAAA,EAAAA,GAAA,QAAMW,IAAGqO,EAA6E5O,UACpFC,EAAAA,EAAAA,IAAA,QAAMM,KAAGC,EAAAA,EAAAA,IAAE,CAAEmD,QAAS,cAAeuE,IAAK3F,EAAMgN,QAAQC,GAAI5L,WAAY,UAAU,IAAC5D,SAAA,EACjFJ,EAAAA,EAAAA,GAACyM,EAAAA,EAAY,CAACrI,MAAOyO,EAAQzO,QAC5ByO,EAAQwtB,YACR6lB,IACClmD,EAAAA,EAAAA,GAACqV,EAAAA,IAAG,CACF9S,YAAY,mHACZ5B,IAAGsO,EAAgB7O,UAEnBJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,oBAQ3BmL,OAAQA,CAACvP,EAAwBo+C,KAC/B,GAAItC,EACF,OAAOI,EAAAA,EAAAA,IAAiCl8C,GAE1C,QAAcjD,IAAViD,EACF,OAAO,KAET,MAAMmhD,EAAgB1F,GAAiBa,EAAAA,EAAAA,IAAet8C,EAAOo+C,EAAO3C,EAAen5B,OAAS,KAC5F,OACErsB,EAAAA,EAAAA,IAAA,QAAMM,KAAGC,EAAAA,EAAAA,IAAE,CAAEmD,QAAS,cAAeuE,IAAK3F,EAAMgN,QAAQc,GAAI6rC,cAAe,UAAU,IAACl8C,SAAA,EACpFJ,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWC,KAAI,CAAAlQ,UAAEkmD,EAAAA,EAAAA,IAAiCl8C,KAClDy7C,GAAkB57B,EAAWyF,wBAA0B67B,IACtDvrD,EAAAA,EAAAA,GAACyqD,EAAc,CAACjtC,MAAO+tC,EAAc/tC,MAAOktC,UAAWa,EAAcb,cAElE,EAGXt1C,UAAU,EACV/Z,MAAO4vD,EAAatyC,GACpB6yC,aAAe5D,IAAW,CACxBvsD,MAAOusD,EAAOvsD,MACd8uD,SAAUiB,EAAazyC,GACvBzZ,MAAO,CAAE8B,WAAY,iBAEvByqD,YACEprD,EAAAA,EAAAA,IAACq9B,EAAAA,IAAajqB,KAAI,CAAArT,SAAA,EAChBJ,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaE,QAAO,CAACC,SAAO,EAAAz9B,UAC3BJ,EAAAA,EAAAA,GAACk8C,EAAAA,IAAY,OAEfl8C,EAAAA,EAAAA,GAAC09B,EAAAA,IAAa9pB,QAAO,CAAAxT,UACnBJ,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaxgB,KAAI,CAChB3a,YAAY,mHACZN,QAASA,IAAMolD,EAAyBx0C,EAAQ6Z,MAAMtsB,UAEtDJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,2BAQzBk9C,eAAgBA,IAAM,OAI1B,MAAO,CACL,CACEJ,UAAWtG,EACX9pD,MAAO8f,EAAc,CAAArf,GAAA,SACnB6S,eAAe,eAGjB/I,IAAKu/C,EACL5vC,UAAU,EACVu2C,OAAO,EACPtwD,MAAO4vD,EAAa,GACpBO,aAAe5D,IAAW,CACxBvsD,MAAOusD,EAAOvsD,MACd8uD,SAAUiB,EAAa,GACvBlsD,MAAO,CAAE8B,WAAY,eAGrB6kD,EAAiB,CAACI,EAAuBJ,GAAgB,EAAM,IAAM,MACtEC,EAAmBl3C,KAAI,CAACiE,EAAS8F,IAAUstC,EAAuBpzC,GAAS,EAAO8F,EAAQ,KAC9F,GACA,CACDhW,EAAMgN,QACNqL,EACA6qC,EACAC,EACA77B,EAAWyF,uBACXu7B,EACAC,EACA7D,IAGF,OACErnD,EAAAA,EAAAA,GAAA,OACEW,IAAGuO,EAOHxT,IAAKwP,EAAc9K,UAEnBJ,EAAAA,EAAAA,GAACkO,EAAAA,EAAK,CACJ09C,WAAY1B,EACZ11C,KAAK,QACLyyC,QAASA,EACTkE,WAAYA,EACZU,OAAQ,CAAE7vD,EAAGguD,EAAmBv/C,IAChCqhD,YAAY,EACZC,WAAY,CACVC,WAAYzD,EACZ0D,sBAAsB,EACtBC,WAAY,IAEdC,QAAM,KAEJ,C,kQCnhBH,MAEMC,EAAiB,GAEjBC,EAAeA,CAACC,EAAmBjxD,KAE9C,MAAMkxD,EAAkB3oC,KAAKg8B,MAAMvkD,EALP,KAM5B,OAAIixD,EAAYC,EACP3oC,KAAKuE,IAAI9sB,EAAQixD,EAAYF,EARV,KAUrB/wD,EAAQkxD,EAAkBH,CAAc,EAUpCI,EAAYxxD,IAAgF,IAA/E,SAAEyxD,EAAQ,mBAAEC,EAAkB,UAAEC,EAAS,aAAEC,GAA8B5xD,EACjG,MAAO6xD,EAAgBC,IAAqBjmD,EAAAA,EAAAA,WAAS,IAC/C,MAAElE,IAAUC,EAAAA,EAAAA,KAElB,OACE5C,EAAAA,EAAAA,GAAA,OAAKW,KAAGC,EAAAA,EAAAA,IAAE,CAAEvF,MAAOsxD,EAAWrxD,OAAQqxD,GAAa,QAAQ,IAACvsD,UAC1DJ,EAAAA,EAAAA,GAAA,OAAKW,KAAGC,EAAAA,EAAAA,IAAE,CAAEtF,OAAQqxD,GAAa,QAAQ,IAACvsD,cAChB+G,IAAvBulD,GACC1sD,EAAAA,EAAAA,GAAC+sD,EAAAA,IAAe,CAACvvC,MAAM,aAAa7c,KAAGC,EAAAA,EAAAA,IAAE,CAAEtF,OAAQqxD,EAAWtxD,MAAOsxD,GAAW,OAEhF3sD,EAAAA,EAAAA,GAAA,OACEW,KAAGC,EAAAA,EAAAA,IAAE,CACHmD,QAAS,OACTC,WAAY,SACZC,eAAgB,SAChB5I,MAAOsxD,GAAa,OACpBrxD,OAAQqxD,GAAa,OACrB1iB,SAAU2iB,EACV1sD,UAAW0sD,EACXx/C,gBAAiBzK,EAAMuB,OAAO4Q,oBAC9B,eAAgB,CACdxZ,OAAQ,OACRyI,QAAS,OACTC,WAAY,WAEf,IAAC5D,UAEFJ,EAAAA,EAAAA,GAACgtD,EAAAA,EAAiB,CAACnzC,QAASgzC,EAAgBI,gBAAiBH,EAAkB1sD,UAC7EJ,EAAAA,EAAAA,GAACktD,EAAAA,EAAK,CACJC,IAAKT,EACLU,QAAS,CAAED,IAAKV,GAChBvtD,MAAO,CAAE+qC,SAAU2iB,GAAgB,OAAQ1sD,UAAW0sD,GAAgB,iBAM5E,EAIGS,EAAuBxrD,IAU7B,IAV8B,eACnCyrD,EAAc,UACdX,EAAS,KACT77B,EAAI,QACJ3c,GAMDtS,EACC,MAAM,MAAEc,IAAUC,EAAAA,EAAAA,KAElB,YAA6BuE,IAAzBmmD,EAAex8B,IAEfzwB,EAAAA,EAAAA,IAAA,OACEM,KAAGC,EAAAA,EAAAA,IAAE,CACHmD,QAAS,OACT2Q,cAAe,SACf1Q,WAAY,SACZC,eAAgB,SAChBm+C,UAAW,SACX/mD,MAAOsxD,EACPrxD,OAAQqxD,EACRv/C,gBAAiBzK,EAAMuB,OAAO4Q,oBAC9BrU,QAASkC,EAAMgN,QAAQc,IACxB,IAACrQ,SAAA,EAEFJ,EAAAA,EAAAA,GAACutD,EAAAA,IAAS,KACVvtD,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,qCAOrBxO,EAAAA,EAAAA,GAACwsD,EAAS,CACRC,UAAUe,EAAAA,EAAAA,IAAuBF,EAAex8B,GAAM28B,SAAUt5C,GAChEu4C,oBAAoBc,EAAAA,EAAAA,IAAuBF,EAAex8B,GAAM48B,oBAAqBv5C,GACrFw4C,UAAWA,GACX,EAEJ,IAAAlrD,EAAA,CAAAC,KAAA,UAAAC,OAAA,sHAAA6E,EAAA,CAAA9E,KAAA,SAAAC,OAAA,mBAAAmN,EAAA,CAAApN,KAAA,UAAAC,OAAA,sBAEK,MAAMgsD,EAAqBA,KAE9BttD,EAAAA,EAAAA,IAAA,OACEM,IAAGc,EAQDrB,SAAA,EAEFJ,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWwD,MAAK,CAAClT,IAAG6F,EAAqBpC,MAAM,YAAY0P,MAAO,EAAE1T,SAAC,2BAGtEJ,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWC,KAAI,CAAC3P,IAAGmO,EAAwB1K,MAAM,YAAWhE,SAAC,qE,sJC9H4C,IAAAyB,EAAA,CAAAH,KAAA,SAAAC,OAAA,0DAGzG,MAAMisD,EAAyB5yD,IAU/B,IAVgC,YACrCgvB,EAAW,WACXC,EAAU,MACV5uB,GAODL,EACC,MAAM,MAAE2H,IAAUC,EAAAA,EAAAA,KAEZirD,EAAc7jC,EAAYrc,QAAQ0e,IACtC,MAAMyhC,EAAgBzhC,EAAIgJ,OAAOpL,EAAW2G,UAAU,IACtD,OAAOk9B,GAAiB3zD,OAAO23B,KAAKg8B,GAAerzD,OAAS,CAAC,IAGzDkyD,GAAY5/C,EAAAA,EAAAA,UAAQ,KACjBs/C,EAAAA,EAAAA,IAAawB,EAAYpzD,OAAQY,IACvC,CAACwyD,EAAaxyD,IAEjB,OAA2B,IAAvBwyD,EAAYpzD,QACPuF,EAAAA,EAAAA,GAAC2tD,EAAAA,GAAkB,KAG1B3tD,EAAAA,EAAAA,GAAA,OAAKW,IAAGkB,EAAsEzB,SAC3EytD,EAAYj/C,KAAKyd,IAEhB,MAAM0hC,EAAsB5zD,OAAOwX,OAAO0a,EAAIgJ,OAAOpL,EAAW2G,UAAU,KAAKnoB,QAC7E,CAACC,EAAKslD,UACkB7mD,IAAlB6mD,EAASl9B,OACXpoB,EAAIslD,EAASl9B,MAAQk9B,GAEhBtlD,IAET,CAAC,GAEH,OACErI,EAAAA,EAAAA,IAAA,OAAoBM,KAAGC,EAAAA,EAAAA,IAAE,CAAEH,QAAY2rD,EAAAA,GAAiB,EAApB,MAA2B,IAAChsD,SAAA,EAC9DJ,EAAAA,EAAAA,GAACmV,EAAAA,IAAa,CAACja,MAAOmxB,EAAIgU,YAAYjgC,UACpCC,EAAAA,EAAAA,IAAA,OACEM,KAAGC,EAAAA,EAAAA,IAAE,CACHvF,MAAOsxD,EACPrxD,OAAQqH,EAAMiB,WAAWqqD,aACzB9tD,SAAU,SACV0R,WAAY,SACZ9N,QAAS,cACTC,WAAY,SACZsE,IAAK3F,EAAMgN,QAAQC,IACpB,IAACxP,SAAA,EAEFJ,EAAAA,EAAAA,GAACyM,EAAAA,EAAY,CAACrI,MAAOioB,EAAIjoB,QACxBioB,EAAIgU,kBAGTrgC,EAAAA,EAAAA,GAACqtD,EAAAA,GAAoB,CAEnBv8B,KAAM7G,EAAW6G,KACjBw8B,eAAgBS,EAChBpB,UAAWA,EACXx4C,QAASkY,EAAIK,MAJRL,EAAIK,QAlBHL,EAAIK,KAwBR,KAGN,E,eC3DoC,IAAA7qB,EAAA,CAAAH,KAAA,UAAAC,OAAA,0BAEvC,MAAMusD,EAA2BlzD,IAUjC,IAVkC,YACvCgvB,EAAW,WACXC,EAAU,MACV5uB,GAODL,EACC,MAAM,MAAE2H,IAAUC,EAAAA,EAAAA,KAEZirD,EAAc7jC,EAAYrc,QAAQ0e,GAA8D,IAAnClyB,OAAO23B,KAAKzF,EAAIgJ,QAAQ56B,SAErFkyD,GAAY5/C,EAAAA,EAAAA,UAAQ,KACjBs/C,EAAAA,EAAAA,IAAawB,EAAYpzD,OAAQY,IACvC,CAACwyD,EAAaxyD,IAEjB,OAA2B,IAAvBwyD,EAAYpzD,QACPuF,EAAAA,EAAAA,GAAC2tD,EAAAA,GAAkB,KAG1B3tD,EAAAA,EAAAA,GAAA,OAAKW,IAAGkB,EAAoCzB,UAC1CC,EAAAA,EAAAA,IAAC6N,EAAAA,IAAK,CAACigD,MAAI,EAAChgD,YAAU,EAAA/N,SAAA,EACpBC,EAAAA,EAAAA,IAAC+N,EAAAA,IAAQ,CAACC,UAAQ,EAAAjO,SAAA,EAChBJ,EAAAA,EAAAA,GAACsO,EAAAA,IAAW,CACV/L,YAAY,sHACZ5B,KAAGC,EAAAA,EAAAA,IAAE,CAAE4wB,SAAUm7B,EAAYhqD,EAAMgN,QAAQc,IAAI,IAACrQ,UAEhDJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,aAIlBq/C,EAAYj/C,KAAKyd,IAEdrsB,EAAAA,EAAAA,GAACsO,EAAAA,IAAW,CACV/L,YAAY,sHAEZ5B,KAAGC,EAAAA,EAAAA,IAAE,CAAE4wB,SAAUm7B,EAAYhqD,EAAMgN,QAAQc,IAAI,IAACrQ,UAEhDJ,EAAAA,EAAAA,GAACmV,EAAAA,IAAa,CAACja,MAAOmxB,EAAIgU,YAAYjgC,UACpCC,EAAAA,EAAAA,IAAA,OACEM,KAAGC,EAAAA,EAAAA,IAAE,CACHtF,OAAQqH,EAAMiB,WAAWqqD,aACzBp8C,WAAY,SACZ9N,QAAS,cACTC,WAAY,SACZquB,OAAQ,OACR/pB,IAAK3F,EAAMgN,QAAQC,IACpB,IAACxP,SAAA,EAEFJ,EAAAA,EAAAA,GAACyM,EAAAA,EAAY,CAACrI,MAAOioB,EAAIjoB,QACxBioB,EAAIgU,kBAfJhU,EAAIK,WAsBhBzC,EAAW2G,UAAUhiB,KAAKoiB,IAEvB3wB,EAAAA,EAAAA,IAAC+N,EAAAA,IAAQ,CAAAhO,SAAA,EACPJ,EAAAA,EAAAA,GAAC2O,EAAAA,IAAS,CAAChO,KAAGC,EAAAA,EAAAA,IAAE,CAAE4wB,SAAUm7B,EAAYhqD,EAAMgN,QAAQc,IAAI,IAACrQ,UACzDJ,EAAAA,EAAAA,GAAA,OAAKd,MAAO,CAAE2S,WAAY,UAAWzR,SAAE4wB,MAExC68B,EAAYj/C,KAAKyd,IAChB,GAAIA,EAAIgJ,OAAOrE,IAAa72B,OAAO23B,KAAKzF,EAAIgJ,OAAOrE,IAAWv2B,OAAS,EAAG,CACxE,MAAM6yD,EAAiBnzD,OAAOwX,OAAO0a,EAAIgJ,OAAOrE,IAAWvoB,QAAO,CAACC,EAAKslD,UAChD7mD,IAAlB6mD,EAASl9B,OACXpoB,EAAIslD,EAASl9B,MAAQk9B,GAEhBtlD,IACN,CAAC,GACJ,OACE1I,EAAAA,EAAAA,GAAC2O,EAAAA,IAAS,CAAgBhO,KAAGC,EAAAA,EAAAA,IAAE,CAAE4wB,SAAUm7B,EAAYhqD,EAAMgN,QAAQc,IAAI,IAACrQ,UACxEJ,EAAAA,EAAAA,GAACqtD,EAAAA,GAAoB,CACnBC,eAAgBA,EAChBX,UAAWA,EACX77B,KAAM7G,EAAW6G,KACjB3c,QAASkY,EAAIK,QALDL,EAAIK,KASxB,CACA,OAAO1sB,EAAAA,EAAAA,GAAC2O,EAAAA,IAAS,CAAgBhO,KAAGC,EAAAA,EAAAA,IAAE,CAAE4wB,SAAUm7B,EAAYhqD,EAAMgN,QAAQc,IAAI,KAAzD4b,EAAIK,KAAyD,MAvBzEsE,SA6BjB,E,eC9FH,MAAMqD,EAAgBr5B,IAYtB,IAZuB,YAC5BgvB,EAAW,WACXC,EAAU,QACVC,EAAO,cACP8J,EAAa,eACbM,GAODt5B,EACC,MAAMozD,EAAsBpkC,EACzBrc,QAAQ0e,GACAA,EAAItZ,KAAKyxC,EAAAA,MAEjB1sC,OAAOC,EAAAA,IAEV,OAAoC,IAAhCkS,EAAW2G,UAAUn2B,QAChBuF,EAAAA,EAAAA,GAAC4tD,EAAsB,CAAC5jC,YAAaokC,EAAqBnkC,WAAYA,EAAY5uB,MAAOi5B,IACvFrK,EAAW2G,UAAUn2B,OAAS,GAErCuF,EAAAA,EAAAA,GAACkuD,EAAwB,CAAClkC,YAAaokC,EAAqBnkC,WAAYA,EAAY5uB,MAAOi5B,IAGxF,IAAI,C,0ECtCb,MAAM+5B,EAA0BptD,EAAAA,MAAW,IAAM,yDAUjD,IARqC7F,IAEjC4E,EAAAA,EAAAA,GAACsuD,EAAAA,SAAQ,CAACjjC,UAAUrrB,EAAAA,EAAAA,GAACutB,EAAAA,IAAc,IAAIntB,UACrCJ,EAAAA,EAAAA,GAACquD,EAAuB,IAAKjzD,K,mHCG5B,MAAMivB,EAA2BA,CACtCkkC,EACApkC,KAEApd,EAAAA,EAAAA,UAAQ,KACN,MAAMk8C,GAASjK,EAAAA,EAAAA,MAAKuP,EAAoB,CAAC,WAAY,yBAA0B,mBAE/E,KAAKjnC,EAAAA,EAAAA,QAAwC6C,EAC3C,OAAO8+B,EAGT,MAAMuF,EAAiBrkC,EAAsBrI,SAM7C,GAJIysC,EAAmBtlC,0BAA2BtF,EAAAA,EAAAA,aAAYwG,EAAsB/D,kBAClF6iC,EAAO7iC,eAAiB+D,EAAsB/D,kBAG3CzC,EAAAA,EAAAA,aAAY6qC,IAAmBD,EAAmBjpC,kBAAmB,CACxE2jC,EAAOnnC,SAAW0sC,EAClB,MAAMC,EAAoD,OAArBtkC,QAAqB,IAArBA,OAAqB,EAArBA,EAAuB5G,uBACxDirC,IAAmBzsC,EAAAA,GAA6BC,QAAUysC,IAC5DxF,EAAO1lC,uBAAyBkrC,EAEpC,CAEA,OAAOxF,CAAM,GACZ,CAACsF,EAAoBpkC,G,4ICwD1B,MAhF8BnvB,IAKK,IALJ,UAC7B0zD,EAAS,kBACTC,EAAiB,SACjBvuD,EAAQ,gBACRwuD,GAAkB,GACS5zD,EAC3B,MAAM,MAAE2H,EAAK,qBAAE05B,IAAyBz5B,EAAAA,EAAAA,KAClCisD,EAAYxyB,EAAqB,YAEjC16B,GAASoL,EAAAA,EAAAA,UAAQ,KACrB,MAAM+hD,EAAY,IAAID,SAChBE,EAAkB,GAAGD,WACrBE,EAAc,IAAIH,WAClBI,EAAe,IAAIJ,YACnBK,EAAkB,IAAIL,gBACtBM,EAAa,IAAIN,UAiDvB,MA/C0B,CACxB,CAACI,GAAe,CACdxuD,QAAS,iBACT2M,gBAAiB,0BAGnB,CAAC8hD,GAAkB,CACjBzuD,QAAS,0BACT2M,gBAAiB,0BAGnB,CAAC,OAAO0hD,OAAeE,OAAiBG,KAAe,CACrD/+C,SAAUzN,EAAMW,QAAQ0zB,SACxBj2B,KAAM,GAENu7C,cAAe,OACf8S,UAAW,iBACXrrD,QAAS6qD,EAAkB,YAASznD,GAGtC,CAAC,OAAO4nD,OAAqBC,OAAiBG,KAAe,CAC3DC,UAAW,gBAGb,CAACJ,GAAc,CACbjrD,QAAS,OACTK,MAAOzB,EAAMuB,OAAOmrD,YACpBvV,WAAY,IACZ91C,WAAY,SAEZ,kBAAmB,CACjBsrD,aAAc,GAAG3sD,EAAMuB,OAAO0+B,qBAC9B2sB,aAAc,oBAIlB,CAAC,OAAOT,KAAc,CACpBl5B,aAAc,aAAajzB,EAAMuB,OAAOJ,SACxCN,aAAc,GAGhB,CAAC,OAAOsrD,OAAeE,KAAgB,CACrCvuD,QAAS,EACTkD,WAAY,OACZrI,OAtEwC,IAyE/B,GACZ,CAACqH,EAAOksD,EAAWD,IAEtB,OACE5uD,EAAAA,EAAAA,GAACwvD,EAAAA,IAAS,CACRjtD,YAAY,wFACPmsD,EAAY,CAAEA,aAAc,CAAC,KAC7BC,EAAoB,CAAErhD,SAAUqhD,GAAsB,CAAC,EAC5Dc,6BAA6B9uD,EAAAA,EAAAA,IAAIgB,EAAM,IACvCmd,wBAAyB,CAAE4wC,mBAAoB,QAAStvD,SAEvDA,GACS,E,wHCnET,MAAMuvD,EAAyB30D,IAAuE,IAAtE,WAAE40D,EAAU,oBAAEn7B,GAAkDz5B,EACrG,MAAM05B,EAAwBjyB,IAAyBgyB,GAAuBA,EAAoBxmB,SAASxL,GAC3G,OACEpC,EAAAA,EAAAA,IAACq9B,EAAAA,IAAajqB,KAAI,CAACkqB,OAAO,EAAMv9B,SAAA,EAC9BJ,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaE,QAAO,CAACC,SAAO,EAAAz9B,UAC3BJ,EAAAA,EAAAA,GAACiD,EAAAA,EAAM,CACLV,YAAY,oGACZ5B,IAAKgB,EAAOkuD,eACZ3tD,MAAMlC,EAAAA,EAAAA,GAACmjB,EAAAA,IAAQ,IACf,cAAY,yCAAwC/iB,UAEpDJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,mBAKrBnO,EAAAA,EAAAA,IAACq9B,EAAAA,IAAa9pB,QAAO,CAACmqB,MAAM,MAAK39B,SAAA,CAC9Bs0B,EAAqB1C,EAAAA,GAAcC,OAClC5xB,EAAAA,EAAAA,IAACq9B,EAAAA,IAAaxgB,KAAI,CAChB3a,YAAY,6GACZN,QAASA,IAAM2tD,EAAW59B,EAAAA,GAAcC,KACxC,cAAY,8CAA6C7xB,SAAA,EAEzDJ,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaW,YAAW,CAAC19B,IAAKgB,EAAOmuD,YAAY1vD,UAChDJ,EAAAA,EAAAA,GAAC+1B,EAAAA,EAAY,OAEf/1B,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,iBAKpBkmB,EAAqB1C,EAAAA,GAAcY,QAClCvyB,EAAAA,EAAAA,IAACq9B,EAAAA,IAAaxgB,KAAI,CAChB3a,YAAY,6GACZN,QAASA,IAAM2tD,EAAW59B,EAAAA,GAAcY,MACxC,cAAY,+CAA8CxyB,SAAA,EAE1DJ,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaW,YAAW,CAAC19B,IAAKgB,EAAOmuD,YAAY1vD,UAChDJ,EAAAA,EAAAA,GAACi2B,EAAAA,EAAa,OAEhBj2B,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,kBAKpBkmB,EAAqB1C,EAAAA,GAAca,YAClCxyB,EAAAA,EAAAA,IAACq9B,EAAAA,IAAaxgB,KAAI,CAChB3a,YAAY,6GACZN,QAASA,IAAM2tD,EAAW59B,EAAAA,GAAca,UACxC,cAAY,mDAAkDzyB,SAAA,EAE9DJ,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaW,YAAW,CAAC19B,IAAKgB,EAAOmuD,YAAY1vD,UAChDJ,EAAAA,EAAAA,GAACk2B,EAAAA,EAAiB,OAEpBl2B,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,4BAKpBkmB,EAAqB1C,EAAAA,GAAc6B,WAClCxzB,EAAAA,EAAAA,IAACq9B,EAAAA,IAAaxgB,KAAI,CAChB3a,YAAY,6GACZN,QAASA,IAAM2tD,EAAW59B,EAAAA,GAAc6B,SACxC,cAAY,kDAAiDzzB,SAAA,EAE7DJ,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaW,YAAW,CAAC19B,IAAKgB,EAAOmuD,YAAY1vD,UAChDJ,EAAAA,EAAAA,GAACg2B,EAAAA,EAAgB,OAEnBh2B,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,qBAKpBkmB,EAAqB1C,EAAAA,GAAcO,WAClClyB,EAAAA,EAAAA,IAACq9B,EAAAA,IAAaxgB,KAAI,CAChB3a,YAAY,6GACZN,QAASA,IAAM2tD,EAAW59B,EAAAA,GAAcO,SACxC,cAAY,kDAAiDnyB,SAAA,EAE7DJ,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaW,YAAW,CAAC19B,IAAKgB,EAAOmuD,YAAY1vD,UAChDJ,EAAAA,EAAAA,GAACm2B,EAAAA,EAAgB,OAEnBn2B,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,sBAKpB4nB,EAAAA,EAAAA,OAAsC1B,EAAqB1C,EAAAA,GAAc+B,cACxE1zB,EAAAA,EAAAA,IAACq9B,EAAAA,IAAaxgB,KAAI,CAChB3a,YAAY,8GACZN,QAASA,IAAM2tD,EAAW59B,EAAAA,GAAc+B,YACxC,cAAY,qDAAoD3zB,SAAA,EAEhEJ,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaW,YAAW,CAAC19B,IAAKgB,EAAOmuD,YAAY1vD,UAChDJ,EAAAA,EAAAA,GAACq2B,EAAAA,EAAmB,OAEtBr2B,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,wBAKpB8nB,EAAAA,EAAAA,OAAiC5B,EAAqB1C,EAAAA,GAAcoC,SACnE/zB,EAAAA,EAAAA,IAACq9B,EAAAA,IAAaxgB,KAAI,CAChB3a,YAAY,8GACZN,QAASA,IAAM2tD,EAAW59B,EAAAA,GAAcoC,OACxC,cAAY,gDAA+Ch0B,SAAA,EAE3DJ,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaW,YAAW,CAAC19B,IAAKgB,EAAOmuD,YAAY1vD,UAChDJ,EAAAA,EAAAA,GAACu2B,EAAAA,EAAc,OAEjBv2B,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,uBAML,EAIlB7M,EAAS,CACbkuD,eAAiBltD,IAAY,CAE3ByK,gBAAiB,GAAGzK,EAAMuB,OAAOu3C,iCAEnCqU,YAAcntD,IAAY,CACxBtH,MAAOsH,EAAMW,QAAQ0zB,SAAWr0B,EAAMgN,QAAQqC,M,mCCzItB,IAAAvQ,EAAA,CAAAC,KAAA,SAAAC,OAAA,kFAqBrB,MAAMouD,EAA0B/0D,IAcF,IAdG,MACtC2d,EAAK,QACLohB,EAAO,oBACPi2B,EAAmB,gBACnBC,EAAe,gBACfC,EAAe,aACfC,EAAY,YACZC,EAAW,iBACXC,EAAgB,iBAChBC,EAAgB,iBAChBC,EAAgB,WAChBC,EAAU,kBACVC,EAAiB,oBACjBh8B,GAC6Bz5B,EAC7B,MAAM,MAAE2H,IAAUC,EAAAA,EAAAA,MAEX8tD,EAAgBC,IAAqB9pD,EAAAA,EAAAA,UAASkzB,EAAQr4B,OAEtDkvD,EAAkBC,IAAuBhqD,EAAAA,EAAAA,WAAS,GAGnDiqD,GAAiB/rD,EAAAA,EAAAA,QAAuB,MACxCgsD,GAAmBhsD,EAAAA,EAAAA,QAA0B,OAC5CisD,EAAkBC,IAAuBpqD,EAAAA,EAAAA,UAAS,IAGlDqqD,EAA0BC,IAA+BtqD,EAAAA,EAAAA,WAAS,GAEnE6H,EAAmBnU,IACvBA,EAAEmU,iBAAiB,EAgCfkN,EAAYrhB,IAChBA,EAAEmU,kBACGgiD,EAAezyC,QAIpBoyC,GAAkB,GAClBC,EAAiBv2B,EAAQrN,KAAMgkC,IAJ7Bn2D,EAAEkpB,gBAI0C,GAmBhD7b,EAAAA,EAAAA,YAAU,KACR,IAAKkpD,EAAe9rD,QAClB,OAGF,MAAM4F,EAAiB,IAAID,gBAAe9I,IAAc,IAAZgJ,GAAMhJ,EAChDovD,EAAoBpmD,EAAMq5C,YAAY7oD,MAAM,IAK9C,OAFAuP,EAAeI,QAAQ8lD,EAAe9rD,SAE/B,IAAM4F,EAAeK,YAAY,GACvC,IAGH,MAIMmmD,EAAoBhB,IAAgBz3C,GACnC04C,EAAoBC,IAAyBzqD,EAAAA,EAAAA,WAAS,IAEvD,cAAEb,EAAa,eAAEC,EAAc,cAAEd,EAAa,OAAEF,EAAM,WAAEc,IAAetB,EAAAA,EAAAA,GAAsB,CACjGC,aAAc,WACdC,QAASo1B,EAAQrN,KACjB9nB,OAAQ2rD,IAGV,OACEvwD,EAAAA,EAAAA,GAAAM,EAAAA,GAAA,CAAAF,UACEC,EAAAA,EAAAA,IAAA,OACEq7B,KAAK,SACL/6B,KAAGC,EAAAA,EAAAA,IAAE,CACHmD,QAAS,OACTC,WAAY,SACZ3I,MAAO,OACPoF,QAAS,GAAGkC,EAAMgN,QAAQqC,WAC1B1W,OAAQ,OACR,uCAAwC,CACtCijC,WAAY8yB,EAAqB,UAAY,SAC7ClkD,QAASkkD,EAAqB,EAAI,GAEpC,oDAAqD,CACnD9yB,WAAY8yB,EAAqB,UAAY,SAC7ClkD,QAASkkD,EAAsBT,EAAmB,EAAI,EAAK,GAE7D,kCAAmC,CAAE7sD,QAASqtD,EAAoB,OAAS,YAC5E,IACDG,YAAaA,IAAMD,GAAsB,GACzChvD,aAAcA,IAAMgvD,GAAsB,GAC1C51D,IAAM2vC,IAES,OAAblmC,QAAa,IAAbA,GAAAA,EAAgBkmC,GACF,OAAdplC,QAAc,IAAdA,GAAAA,EAAiBolC,EAAQ,EAE3B,cAAY,8CAA6CjrC,SAAA,CAExD6E,IAECjF,EAAAA,EAAAA,GAAA,OACEW,KAAGC,EAAAA,EAAAA,IAAE,CACHX,SAAU,WACVuxD,MAAO,EACPpkD,gBAAiBzK,EAAM8uD,WAAa9uD,EAAMuB,OAAOwtD,QAAU/uD,EAAMuB,OAAOytD,QACxE7tD,OAAQ,cAAcnB,EAAMuB,OAAO0tD,UACnCzkD,QAAS,KACV,OAGL9M,EAAAA,EAAAA,IAAA,OACEnB,MAAO,CACL+qC,SAAU,MACVlmC,QAAS,OACTC,WAAY,UACZ5D,SAAA,EAEFJ,EAAAA,EAAAA,GAAA,OACEtE,IAAKo1D,EACL5xD,MAAO,CACLe,SAAWmxD,EAAiC,WAAb,WAC/B7yB,WAAa6yB,EAAgC,SAAZ,UACjC17C,aAAc07C,OAAoBjqD,EAAY,WAC9C8iC,SAAU,OACV9pC,SAAU,OACVyU,YAnEkBi9C,EAoElBhgD,WAAY,OACZzR,SAEDswD,IAEFN,IAAgBz3C,IACf3Y,EAAAA,EAAAA,GAACyd,EAAAA,EAAK,CACJlb,YAAY,wHACZsa,WAAS,EACT5a,QAASyM,EACTojD,YAAapjD,EACbqjD,UAAWrjD,EACXsjD,cAAetjD,EACfpB,SAhIM/S,IAChBo2D,EAAkBp2D,EAAEuQ,OAAOV,MAAM,EAgIvBA,MAAOsmD,EACP/vD,KAAGC,EAAAA,EAAAA,IAAE,CACHwD,MAAOzB,EAAMuB,OAAOmrD,YACpBvV,WAAY,IACZr5C,QAAS,kBACTO,WAAY2B,EAAMuB,OAAO4Q,oBACzB0c,SAAU,OACVn2B,MAAO21D,EAAmB,GAC1B/wD,SAAU,WACV0D,WAAYhB,EAAMiB,WAAWC,eAC7BomC,SAAU,QACX,IACDgoB,UA/HG13D,IACC,WAAVA,EAAEkL,MACJlL,EAAEmU,kBACF2hD,GAAkB,GAClBM,EAAkB52B,EAAQr4B,MAC5B,EA2HUwwD,aAAct2C,EACd6zC,4BAA6B,CAAE,KAAM,CAAE0C,UAAW,oBAClDhwD,OA1HI5H,IACVA,EAAE87C,gBAAkB0a,EAAiB/rD,UAGzCqrD,GAAkB,GAClBC,EAAiBv2B,EAAQrN,KAAMgkC,GAAe,KAwHxC1wD,EAAAA,EAAAA,GAAA,OACEW,KAAGC,EAAAA,EAAAA,IAAE,CACHH,QAASkC,EAAMgN,QAAQqC,GACvB/R,SAAU,YACX,IACDf,MAAO,CACLq/B,WAAa6yB,EAAgC,SAAZ,UACjCrtD,QAASqtD,EAAoB,OAAS,WACtChxD,SAED,IAAI4vD,QAELS,IACAzwD,EAAAA,EAAAA,GAAA,OAAKqL,UAAU,kFAAiFjL,UAC9FJ,EAAAA,EAAAA,GAACiD,EAAAA,EAAM,CACLV,YAAY,+GACZN,QAxKE1H,IACdA,EAAEmU,kBACF2hD,EAAiB13C,EAAM,EAuKX,aAAW,aACXzW,MAAMlC,EAAAA,EAAAA,GAACoyD,EAAAA,IAAU,WAKxBhC,IAAgBz3C,IAAU83C,IACzBzwD,EAAAA,EAAAA,GAAA,OAAKd,MAAO,CAAEuB,QAAS,KAAKkC,EAAMgN,QAAQqC,QAAS5R,UACjDJ,EAAAA,EAAAA,GAACiD,EAAAA,EAAM,CACLV,YAAY,+GACZN,QAAS2Z,EACT1Z,MAAMlC,EAAAA,EAAAA,GAACs+B,EAAAA,EAAS,IAChB5iC,IAAKq1D,OAITN,IACAzwD,EAAAA,EAAAA,GAAA,OACEqL,UAAU,qEACV1K,IAAGc,EAAwGrB,UAE3GJ,EAAAA,EAAAA,GAAC27C,EAAAA,IAAQ,CACP0W,OAAQ,GACRnzD,MAAO,CAAEkF,MAAOzB,EAAMuB,OAAOI,eAC7B5I,IAAKsK,EACL8rD,YAAaA,IAAMjB,GAAoB,GACvCvuD,aAAcA,KACZuuD,GAAoB,EAAM,EAE5B,cAAY,+DAIhBJ,IACApwD,EAAAA,EAAAA,IAAA,OACEnB,MAAO,CACLe,SAAU,WACVu4C,IAAK,MACL13C,MAAO,IACPsuD,UAAW,qBACXrrD,QAAS,OACTC,WAAY,UACZ5D,SAAA,EAEFC,EAAAA,EAAAA,IAAA,OACE4B,QAASyM,EACTojD,YAAapjD,EACbqjD,UAAWrjD,EACXsjD,cAAetjD,EACfrD,UAAU,kFAAiFjL,SAAA,EAE3FC,EAAAA,EAAAA,IAACq9B,EAAAA,IAAajqB,KAAI,CAACkqB,OAAO,EAAMv9B,SAAA,EAC9BJ,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaE,QAAO,CAACC,SAAO,EAAAz9B,UAC3BJ,EAAAA,EAAAA,GAACiD,EAAAA,EAAM,CACLV,YAAY,+GACZL,MAAMlC,EAAAA,EAAAA,GAACk8C,EAAAA,IAAY,SAGvB77C,EAAAA,EAAAA,IAACq9B,EAAAA,IAAa9pB,QAAO,CAAAxT,SAAA,EACnBJ,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaxgB,KAAI,CAChB3a,YAAY,wHACZN,QA9OMqwD,KACtBnC,EAAap2B,EAAQrN,MAAM,EAAK,EA6OStsB,UAEzBJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,yBAInBxO,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaxgB,KAAI,CAChB3a,YAAY,wHACZN,QAnPMswD,KACtBpC,EAAap2B,EAAQrN,MAAM,EAAM,EAkPQtsB,UAEzBJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,yBAInBxO,EAAAA,EAAAA,GAAC09B,EAAAA,IAAaxgB,KAAI,CAChB3a,YAAY,wHACZN,QApQIuwD,KACpBrB,GAA4B,EAAK,EAmQM/wD,UAEvBJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,4BAMvBxO,EAAAA,EAAAA,GAACyyD,EAAAA,EAAW,CACVlwD,YAAY,wHACZsX,QAASq3C,EACTp3C,KAxRa44C,KACzBxC,EAAgBn2B,EAAQrN,KAAK,EAwRjBxS,SArRYy4C,KACxBxB,GAA4B,EAAM,EAqRtBj2D,MAAM,iBAAgBkF,UAEtBJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,6GAMrBxO,EAAAA,EAAAA,GAAA,OACEiC,QAASyM,EACTojD,YAAapjD,EACbqjD,UAAWrjD,EACXsjD,cAAetjD,EACfrD,UAAW5M,IACT,CACE,oDAAqD+xD,GAEvD,kCAEF7vD,KAAGC,EAAAA,EAAAA,IAAE,CACHgyD,UAAW,WACXriD,WAAY5N,EAAMgN,QAAQqC,IAC3B,IAAC5R,UAEFJ,EAAAA,EAAAA,GAAC2vD,EAAsB,CACrBC,WAAYK,EAAgBl2B,EAAQrN,MACpC+H,oBAAqBA,aAM9B,E,kCCrWA,MAAMo+B,EAAa73D,IAeF,IAfG,UACzB83D,EAAS,aACTt+B,EAAY,YACZu+B,EAAW,uBACX92B,EAAsB,cACtBW,EAAa,iBACbE,EAAgB,gBAChBD,EAAe,eACfm2B,EAAc,QACd9oC,EAAO,aACPwS,EAAY,mBACZK,EAAkB,mBAClBtlB,EAAkB,gBAClBinB,EAAe,sBACfvU,GACgBnvB,EAChB,MAAM,MAAE2H,IAAUC,EAAAA,EAAAA,MAEXqwD,EAAoBC,EAAsBC,EAAiBC,IAAuBrmD,EAAAA,EAAAA,UAAQ,IAE1F4e,MAAM89B,QAAQsJ,GAGZ,CACLA,EAAYplD,QAAQsrB,GAAMA,EAAEx2B,OAASuvB,EAAAA,GAAca,WACnDkgC,EAAYplD,QAAQsrB,GAAMA,EAAEx2B,OAASuvB,EAAAA,GAAc+B,aACnDg/B,EAAYplD,QAAQsrB,GAAMA,EAAEx2B,OAASuvB,EAAAA,GAAcoC,QACnD2+B,EAAYplD,QACTsrB,GACCA,EAAEx2B,OAASuvB,EAAAA,GAAca,UAAYoG,EAAEx2B,OAASuvB,EAAAA,GAAc+B,YAAckF,EAAEx2B,OAASuvB,EAAAA,GAAcoC,SARlG,CAAC,GAAI,GAAI,GAAI,KAWrB,CAAC2+B,IAEEM,GAAYtmD,EAAAA,EAAAA,UAChB,KACE7E,EAAAA,EAAAA,GAAmB,CACjBE,WAAY,EACZE,IAAK3F,EAAMgN,QAAQc,GACnBlI,sBAAuB,CAAC,CAAEI,gBAAiB,KAASC,4BAA6B,SAErF,CAACjG,KAGKwC,cAAemuD,EAAsBruD,OAAQsuD,IAAkB9uD,EAAAA,EAAAA,GAAsB,CAC3FC,aAAcy1C,EAAAA,GAA0BwD,aACxCh5C,QAASmuD,EACTluD,OAAQouD,KAGF7tD,cAAequD,EAAuBvuD,OAAQwuD,IAAmBhvD,EAAAA,EAAAA,GAAsB,CAC7FC,aAAcy1C,EAAAA,GAA0BiJ,qBACxCz+C,QAASmuD,EACTluD,OAAQouD,IAGJU,GACHT,EAAmBx4D,SACnBy4D,EAAqBz4D,SACrB04D,EAAgB14D,SAChB24D,EAAoB34D,OAEvB,OACE4F,EAAAA,EAAAA,IAAA,OACEq7B,KAAK,SACLhgC,IAAM2vC,IAEgB,OAApBioB,QAAoB,IAApBA,GAAAA,EAAuBjoB,GACF,OAArBmoB,QAAqB,IAArBA,GAAAA,EAAwBnoB,EAAQ,EAElC1qC,KAAGC,EAAAA,EAAAA,IAAE,CACHH,QAAgC,IAAvBsyD,EAAYt4D,OAAekI,EAAMgN,QAAQa,GAAK,EACvDvQ,SAAU,WACVE,SAAU,UACX,IAACC,SAAA,EAEAmzD,GAAiBE,IAA0C,IAAvBV,EAAYt4D,SAEhDuF,EAAAA,EAAAA,GAAA,OACEW,KAAGC,EAAAA,EAAAA,IAAE,CACHX,SAAU,WACVuxD,MAAO,EACPpkD,gBAAiBzK,EAAM8uD,WAAa9uD,EAAMuB,OAAOwtD,QAAU/uD,EAAMuB,OAAOytD,QACxE7tD,OAAQ,cAAcnB,EAAMuB,OAAO0tD,UACnCzkD,QAAS,KACV,MAGJumD,IACC1zD,EAAAA,EAAAA,GAAA,OAAKd,MAAO,CAAE6E,QAAS,OAAQC,WAAY,SAAUC,eAAgB,UAAW7D,UAC9EJ,EAAAA,EAAAA,GAACyzB,EAAAA,IAAK,CACJv4B,OACE8E,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,8BAInBklB,aACE1zB,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,+DAOxB,CAAC0kD,EAAsBD,EAAoBE,GAAiBvkD,KAAI,CAAC+kD,EAAYh7C,IACxEg7C,EAAWl5D,QAEXuF,EAAAA,EAAAA,GAAA,OAEEW,KAAGC,EAAAA,EAAAA,IAAE,CACHmD,QAAS,OACT2Q,cAAe,SACfpM,IAAK3F,EAAMgN,QAAQc,GACnBvD,aAAcvK,EAAMgN,QAAQc,IAC7B,IAACrQ,SAEDuzD,EAAW/kD,KAAI,CAACqb,EAAYtR,KAC3B,MAAMokC,EAAe,CACnB3f,cAAeP,EACfG,YAAarkB,EAAQg7C,EAAWl5D,OAAS,EACzCwiC,UAAWtkB,EAAQ,EACnBukB,WAAYA,KAAA,IAAA02B,EAAA,OAAM/2B,EAAgB5S,EAAWyC,MAAQ,IAAyB,QAArBknC,EAAAD,EAAWh7C,EAAQ,UAAE,IAAAi7C,OAAA,EAArBA,EAAuBlnC,OAAQ,GAAG,EAC3FyQ,SAAUA,KAAA,IAAA02B,EAAA,OAAMh3B,EAAgB5S,EAAWyC,MAAQ,IAAyB,QAArBmnC,EAAAF,EAAWh7C,EAAQ,UAAE,IAAAk7C,OAAA,EAArBA,EAAuBnnC,OAAQ,GAAG,GAE3F,OACE1sB,EAAAA,EAAAA,GAACy8B,EAAAA,EAAc,CACbxS,WAAYA,EACZuK,aAAcA,EACdsI,iBAAkBA,EAClBF,cAAeA,EACfG,mBAAoBA,EACpBpkB,MAAOA,EACP+jB,aAAcA,EACdxS,QAASA,EACTzS,mBAAoBA,EACpBinB,gBAAiBA,KAEbqe,GADC,GAAG9yB,EAAWyC,QAAQ/T,KAAS+jB,IAEpC,KA9BD,eAAe/jB,KAoCnB,QAET3Y,EAAAA,EAAAA,GAAA,OAAKW,IAAK0yD,EAAUjzD,SACjBgzD,EAAoBxkD,KAAI,CAACqb,EAAYtR,KAAW,IAADm7C,EAAAC,EAC9C,MAAMhX,EAAe,CACnB3f,cAAeP,EACfG,YAAarkB,EAAQy6C,EAAoB34D,OAAS,EAClDwiC,UAAWtkB,EAAQ,EACnBoiC,kBAAiD,QAAhC+Y,EAAEV,EAAoBz6C,EAAQ,UAAE,IAAAm7C,OAAA,EAA9BA,EAAgCpnC,KACnDsuB,cAA6C,QAAhC+Y,EAAEX,EAAoBz6C,EAAQ,UAAE,IAAAo7C,OAAA,EAA9BA,EAAgCrnC,MAGjD,OACE1sB,EAAAA,EAAAA,GAACy8B,EAAAA,EAAc,CACbxS,WAAYA,EACZuK,aAAcA,EACdsI,iBAAkBA,EAClBF,cAAeA,EACfG,mBAAoBA,EACpBpkB,MAAOA,EACP+jB,aAAcA,EACdxS,QAASA,EACTzS,mBAAoBA,EACpBinB,gBAAiBA,EAEjBvU,sBAAuBA,KACnB4yB,GAFC,GAAG9yB,EAAWyC,QAAQ/T,KAAS+jB,IAGpC,QAIJ,E,2DC3MV,IAAIs3B,EAA8C,KAClD,MAAMC,EAAmB,IAAIC,QAa7B,SAASC,EAAe9oB,EAAkB+oB,GAA8C,IAADC,EAKrF,OAfKL,IACHA,EAAiB,IAAIM,sBAAsBrQ,IACzC,IAAK,MAAMp5C,KAASo5C,EAAS,CAC3B,MAAMsQ,EAAgBN,EAAiBO,IAAI3pD,EAAMC,QACpC,OAAbypD,QAAa,IAAbA,GAAAA,EAAgB1pD,EAAM4pD,eACxB,MAOJR,EAAiBS,IAAIrpB,EAAS+oB,GAChB,QAAdC,EAAAL,SAAc,IAAAK,GAAdA,EAAgBrpD,QAAQqgC,GAEjB,KACS,IAADspB,EAATtpB,IACY,QAAdspB,EAAAX,SAAc,IAAAW,GAAdA,EAAgBC,UAAUvpB,GAC1B4oB,EAAiBY,OAAOxpB,GAC1B,CAEJ,C,qCClBA,MAUaypB,GAA0Bza,EAAAA,EAAAA,OAAMj/C,IAAyC,IAAD25D,EAAAC,EACnF,MAAM,cAAEC,EAAa,aAAEpY,GDaQ,WAAwE,IAApD,QAAEnlC,GAAU,GAA6Bld,UAAAC,OAAA,QAAA0M,IAAA3M,UAAA,GAAAA,UAAA,GAAG,CAAC,EAChG,MAAO6wC,EAAS4pB,IAAiBpuD,EAAAA,EAAAA,UAAmB,OAC7Cg2C,EAAcqY,IAAmBruD,EAAAA,EAAAA,WAAU6Q,GAkBlD,OAhBA9P,EAAAA,EAAAA,YAAU,KAER,GAAKyjC,EAAL,CAKA,GAAK7hC,OAAO8qD,sBAAyB58C,EAKrC,OAAOy8C,EAAe9oB,EAAS6pB,GAJ7BA,GAAgB,EAJlB,CAQ+C,GAC9C,CAACx9C,EAAS2zB,IAGN,CAAEwR,eAAcoY,gBACzB,CClC0CE,IAClC,KAAEzoC,EAAI,YAAE0oC,EAAW,cAAEC,EAAa,SAAElL,EAAQ,aAAEmL,KAAiBC,GAAcn6D,EAEnF,IAAIijD,EAAuBxB,EAE3B,IAAI2Y,EAAAA,EAAAA,MAAiC,CAGnC,MAAOC,IAAiBC,EAAAA,EAAAA,IAAY7Y,EAnBX,KAoBzBwB,EAAuBoX,CACzB,CAEA,MAAOE,EAAaC,IAAkB/uD,EAAAA,EAAAA,UAAS,IACxCgvD,EAAcC,IAAmBjvD,EAAAA,EAAAA,UAAS,IAC1Cd,EAAYgwD,IAAiBlvD,EAAAA,EAAAA,WAAS,IACtCmvD,EAAQC,IAAapvD,EAAAA,EAAAA,UAAmC,CAAE9K,EAAG,EAAGC,EAAG,KAEpE,mBAAEu7B,EAAkB,gBAAEG,IAAoBI,EAAAA,EAAAA,MAE1Co+B,GAAwBnxD,EAAAA,EAAAA,QAA8B,MAEtDoxD,GAAcr2C,EAAAA,EAAAA,cAClB,CAAChS,EAAC9S,KAAgB,IAAd,EAAEe,EAAC,EAAEC,GAAGhB,EACV+6D,GAAc,GACdx+B,EAAuB,OAAJ7K,QAAI,IAAJA,EAAAA,EAAQ,MAC3BupC,EAAU,CAAEl6D,IAAGC,KAAI,GAErB,CAACu7B,EAAoB7K,IAGjB0pC,GAASt2C,EAAAA,EAAAA,cACb,CAAChS,EAACjM,KAAgB,IAAd,EAAE9F,EAAC,EAAEC,GAAG6F,EACNq0D,EAAsBlxD,UACxBkxD,EAAsBlxD,QAAQ9F,MAAMkwD,UAAY,eAAerzD,EAAIi6D,EAAOj6D,QAAQC,EAAIg6D,EAAOh6D,UAC/F,GAEF,CAACg6D,IAGGK,GAAav2C,EAAAA,EAAAA,cAAY,KAC7B4X,IACAH,EAAmB,MACf2+B,EAAsBlxD,UACxBkxD,EAAsBlxD,QAAQ9F,MAAMkwD,UAAY,IAElD2G,GAAc,EAAM,GACnB,CAACr+B,EAAiBH,EAAoB2+B,IAEnCI,GAAwBx2C,EAAAA,EAAAA,cAAY,KAAO,IAADy2C,EAC9C,MAAMC,EAAoC,QAAhCD,EAAGL,EAAsBlxD,eAAO,IAAAuxD,OAAA,EAA7BA,EAA+B1gB,wBACjC,IAAD4gB,EAAAC,EAANF,IACFZ,EAA0B,QAAZa,EAAK,OAAJD,QAAI,IAAJA,OAAI,EAAJA,EAAMn7D,aAAK,IAAAo7D,EAAAA,EAAI,GAC9BX,EAA4B,QAAbY,EAAK,OAAJF,QAAI,IAAJA,OAAI,EAAJA,EAAMl7D,cAAM,IAAAo7D,EAAAA,EAAI,GACnB,OAAbrB,QAAa,IAAbA,GAAAA,EAAgBmB,GAClB,GACC,CAACnB,EAAea,IAEbS,GAAmB72C,EAAAA,EAAAA,cACvB,CAAChS,EAACrM,KAAgB,IAAd,KAAE+S,GAAM/S,EACVm0D,EAAephD,EAAKnZ,OACpBy6D,EAAgBthD,EAAKlZ,QACrB6uD,EAAS31C,EAAKnZ,MAAOmZ,EAAKlZ,OAAO,GAEnC,CAAC6uD,IAGH,OACEnqD,EAAAA,EAAAA,GAAC42D,EAAAA,cAAa,CACZpM,sBAAsB,EACtBqM,QAASV,EACTC,OAAQA,EACRU,OAAQT,EACR/L,OAAQ,IAAItQ,EAAAA,KAA8B55C,UAE1CJ,EAAAA,EAAAA,GAACqqD,EAAAA,UAAS,CACRhvD,MAAOs6D,EACPr6D,OAAQu6D,EACRxnC,KAAK,OACLgnC,cAAeiB,EACfhB,aAAcA,EACdnL,SAAUwM,EACVrM,QAAQtqD,EAAAA,EAAAA,GAAC+2D,EAAe,IAAI32D,UAE5BJ,EAAAA,EAAAA,GAAA,OACEtE,IAAM2vC,IACJ6qB,EAAsBlxD,QAAUqmC,EAChC4pB,EAAc5pB,EAAQ,EAExBnsC,MACE6G,EACI,CAEEixD,OAAQC,EAAAA,EAAuBC,aAC/Bxe,cAAe,QAEjB,CACE5O,WAAYoQ,EAAAA,GACZkV,UAAW,eAA6B,QAA7B2F,EAA0B,OAAXK,QAAW,IAAXA,OAAW,EAAXA,EAAar5D,SAAC,IAAAg5D,EAAAA,EAAI,OAAqB,QAApBC,EAAiB,OAAXI,QAAW,IAAXA,OAAW,EAAXA,EAAap5D,SAAC,IAAAg5D,EAAAA,EAAI,SACrE7nD,QAAoB,OAAXioD,QAAW,IAAXA,GAAAA,EAAa+B,YAAc,EAAI,GAE/C/2D,UAEDJ,EAAAA,EAAAA,GAACy8B,EAAAA,EAAc,IAAK84B,EAAW1Y,aAAcA,EAAcwB,qBAAsBA,SAGvE,IAId0Y,GAAkBK,EAAAA,EAAAA,aAAW,CAACh8D,EAAOM,KACzC,MAAM,MAAEiH,IAAUC,EAAAA,EAAAA,KAClB,OACE5C,EAAAA,EAAAA,GAAA,OACEtE,IAAKA,KACDN,EACJ,cAAY,+BACZuF,KAAGC,EAAAA,EAAAA,IAAE,CACHX,SAAU,WACVY,OAAQ,EACRC,MAAO,EACPuC,OAAQ,YACRM,WAAY,EACZlD,QAASkC,EAAMgN,QAAQqC,GACvB5N,MAAOzB,EAAMuB,OAAOmzD,0BACrB,IAACj3D,UAEFJ,EAAAA,EAAAA,GAAA,OAAK3E,MAAM,IAAIC,OAAO,IAAIC,QAAQ,UAAS6E,UACzCJ,EAAAA,EAAAA,GAAA,QAAMpE,EAAE,oBAAoBJ,KAAK,oBAE/B,ICvJyD,IAAAqG,EAAA,CAAAH,KAAA,SAAAC,OAAA,6BAE5D,MAAM21D,EAA6Bt8D,IAUnC,IAVoC,EACzCe,EAAC,EACDC,EAAC,MACDX,EAAK,OACLC,GAMDN,EACC,MAAM,MAAE2H,IAAUC,EAAAA,EAAAA,KAClB,OACEvC,EAAAA,EAAAA,IAAAC,EAAAA,GAAA,CAAAF,SAAA,EAEEJ,EAAAA,EAAAA,GAAA,OACEW,IAAGkB,KAKL7B,EAAAA,EAAAA,GAAA,OACEW,KAAGC,EAAAA,EAAAA,IAAE,CACHX,SAAU,WACVmN,gBAAiBzK,EAAMuB,OAAOK,6BAC9BowB,YAAa,SACb4iC,YAAa50D,EAAMuB,OAAO0wB,2BAC1B8jB,cAAe,OACfl1C,aAAcb,EAAMW,QAAQo4C,iBAC5B8b,YAAa,EACbhG,MAAO,EAEPwF,OAAQC,EAAAA,EAAuBQ,cAChC,IACDv4D,MAAO,CACLkwD,UAAW,eAAerzD,QAAQC,UAClCX,MAAOA,EACPC,OAAQA,OAGX,ECzBP,MAAMo8D,EAAuB,CAAC,IAAK,IAAK,IAAK,IAAK,KAQ5CC,EAAoBC,OAAO,eAmBjC,IAAA58D,EAAA,CAAA0G,KAAA,UAAAC,OAAA,kCAAAF,EAAA,CAAAC,KAAA,UAAAC,OAAA,wDACO,MAAMk2D,GAAsCxd,EAAAA,EAAAA,OACjDx4C,IAO0C,IAADi2D,EAAAC,EAAA,IAPxC,YACChF,EAAW,cACXiF,EAAa,aACbxjC,EAAY,UACZs+B,EAAS,gBACTp0B,KACG62B,GAC+B1zD,EAClC,MAAM,MAAEc,IAAUC,EAAAA,EAAAA,KAKZqkD,GADgBgR,EAAAA,EAAAA,GAAc,eAAet1D,EAAMu1D,WAAWC,YAAY1nD,SAChD,EAAyB,QAAxBqnD,EAAGE,EAAc/Q,eAAO,IAAA6Q,EAAAA,EAAI,EAGvDM,EAAqC,QAA3BL,EAAGC,EAAcI,kBAAU,IAAAL,EAAAA,EAAI,IAEzCM,GAAatzD,EAAAA,EAAAA,QAA8B,OAE3C,gBAAEqyB,EAAe,WAAErxB,IAAe6xB,EAAAA,EAAAA,OAClC,iBAAEJ,EAAgB,kBAAEC,EAAiB,YAAEE,IAAgBG,EAAAA,EAAAA,MAEvDwF,GAAgB7E,EAAAA,EAAAA,MAEhB6/B,GAAax4C,EAAAA,EAAAA,cAChBy4C,IACCj7B,GAAet4B,IAAa,IAADw0B,EAAAC,EAEzB,OAD0C,QAA7BD,EAAGx0B,EAAQ80B,0BAAkB,IAAAN,OAAA,EAA1BA,EAA4BxmB,MAAM+mB,GAAYA,EAAQrN,OAASomC,KAKxE,IACF9tD,EACH80B,mBAA8C,QAA5BL,EAAEz0B,EAAQ80B,0BAAkB,IAAAL,OAAA,EAA1BA,EAA4B7qB,KAAK4pD,GAC/CA,EAAE9rC,OAASomC,EACN,IACF0F,EACHvR,QAASsR,GAGNC,KAZFxzD,CAcR,GACD,GAEJ,CAAC8tD,EAAWx1B,IAGRm7B,GAAgB34C,EAAAA,EAAAA,cACnBxkB,IACCgiC,GAAet4B,IAAa,IAAD0zD,EAAAC,EAEzB,OAD0C,QAA7BD,EAAG1zD,EAAQ80B,0BAAkB,IAAA4+B,OAAA,EAA1BA,EAA4B1lD,MAAM+mB,GAAYA,EAAQrN,OAASomC,KAKxE,IACF9tD,EACH80B,mBAA8C,QAA5B6+B,EAAE3zD,EAAQ80B,0BAAkB,IAAA6+B,OAAA,EAA1BA,EAA4B/pD,KAAK4pD,GAC/CA,EAAE9rC,OAASomC,EACN,IACF0F,EACHJ,WAAY98D,GAGTk9D,KAZFxzD,CAcR,GACD,GAEJ,CAAC8tD,EAAWx1B,IAGRs7B,GAAmB7zD,EAAAA,EAAAA,QAAe,IAEjC6qC,EAAmBipB,IAAwBhyD,EAAAA,EAAAA,UAAwB,OACnEiyD,EAAeC,IAAoBlyD,EAAAA,EAAAA,UAAkC,MAE5E+xD,EAAiB5zD,QAAU+tD,EAAYt4D,OACvC,MAAMwF,EAAYm3B,EAAyBwY,EAAP,KAG9BopB,GAAal5C,EAAAA,EAAAA,cAChB7f,IAAc,IAADg5D,EAAAxC,EACZ,MAAMnuD,EAAM3F,EAAMgN,QAAQC,GACpBspD,EAAWt1C,KAAKk8B,KAAKiT,EAAYt4D,OAASwsD,GAE1Cp5C,EAAM+V,KAAKg8B,MAAM3/C,EAAWgnD,GAC5BkS,EAAMl5D,EAAWgnD,EAEjBmS,EAAenS,EAAU,EAEzBoS,EAAgBF,EAChBG,EAAgBzrD,EAChB2oD,EAAyB,QAArByC,EAAGZ,EAAWrzD,eAAO,IAAAi0D,OAAA,EAAlBA,EAAoBpjB,wBAMjC,MAAO,CACLshB,YAHkBtpD,GAAOqrD,EAIzBrrD,MACAsrD,MACAp9D,EAAGo9D,KAR4B,QAAZ1C,EAAK,OAAJD,QAAI,IAAJA,OAAI,EAAJA,EAAMn7D,aAAK,IAAAo7D,EAAAA,EAAI,GAAK2C,EAAe9wD,GAAO2+C,GAQvCoS,EAAgB/wD,EACvCtM,EAAG6R,EAAMuqD,EAAakB,EAAgBhxD,EACvC,GAEH,CAAC2+C,EAASmR,EAAYz1D,EAAOowD,EAAYt4D,SAGrC8+D,GAAgBxsD,EAAAA,EAAAA,UAAQ,IACrBgmD,EAAYplD,QAAQsc,IACpByU,KAGG86B,EAAAA,EAAAA,IAAiBhlC,EAAcvK,MAExC,CAAC8oC,EAAav+B,EAAckK,IAGzB+6B,GAAiB1sD,EAAAA,EAAAA,UAAQ,KAC7B,IAAKqqB,GAAgC,OAAbn3B,EACtB,MAAO,CAAC,EAGV,MAAMgpD,EAAyE,CAAC,EAE1EyQ,EAAgEH,EAAczhD,QAC9E6hD,EAAYJ,EAAcvgC,WAAWj9B,GAAMA,EAAE2wB,OAAS0K,IACtDwiC,EAAU35D,GAEG,IAAf05D,GAEFD,EAASn3C,OAAOo3C,EAAW,GAC3BD,EAASn3C,OAAOq3C,EAAS,EAAGL,EAAcI,KAG1CD,EAASn3C,OAAOq3C,EAAS,EAAGjC,GAG9B,IAAK,MAAM1tC,KAAcsvC,EAAe,CACtC,MAAMM,EAAWH,EAASj/B,QAAQxQ,GAC5B6vC,EAAWP,EAAc9+B,QAAQxQ,GAEjC8vC,EAAYf,EAAWc,GACvBE,EAAYhB,EAAWa,GAG7B,GAAIG,EAAUj+D,IAAMg+D,EAAUh+D,GAAKi+D,EAAUh+D,IAAM+9D,EAAU/9D,EAC3D,SAIF,MAAMi+D,EAASD,EAAUj+D,EAAIg+D,EAAUh+D,EACjCm+D,EAASF,EAAUh+D,EAAI+9D,EAAU/9D,EAEnCiuB,EAAWyC,OACbu8B,EAAOh/B,EAAWyC,MAAQ,CACxB3wB,EAAGk+D,EACHj+D,EAAGk+D,EACH/C,YAAa6C,EAAU7C,aAG7B,CAEA,OAAOlO,CAAM,GACZ,CAAC7xB,EAAiBn3B,EAAUs5D,EAAeP,IAGxCmB,GAAcptD,EAAAA,EAAAA,UAAQ,KAAO,IAADqtD,EAAAC,EAChC,GAAiB,OAAbp6D,EACF,OAAO,KAET,GAA6B,IAAzBs5D,EAAc9+D,OAChB,MAAO,CAAEsB,EAAG,EAAGC,EAAG,EAAGX,MAAO,OAAQC,OAAQ,QAE9C,MAAM,EAAES,EAAC,EAAEC,GAAMg9D,EAAW/4D,GACtBm5D,EAAenS,EAAU,EACzBuP,EAAyB,QAArB4D,EAAG/B,EAAWrzD,eAAO,IAAAo1D,OAAA,EAAlBA,EAAoBvkB,wBAKjC,MAAO,CAAE95C,IAAGC,IAAGX,QAHkB,QAAZg/D,EAAK,OAAJ7D,QAAI,IAAJA,OAAI,EAAJA,EAAMn7D,aAAK,IAAAg/D,EAAAA,EAAI,GAAKjB,EAAez2D,EAAMgN,QAAQC,IAAMq3C,EAG1C3rD,OADpB88D,EAC4B,GAC1C,CAACn4D,EAAU+4D,EAAY/R,EAASmR,EAAYz1D,EAAO42D,EAAc9+D,SAE9D6/D,GAAYx6C,EAAAA,EAAAA,cACfvlB,IACC,IAAKwL,MAAiBsyD,EAAWrzD,QAC/B,OAGF,MAAMwxD,EAAO6B,EAAWrzD,QAAQ6wC,wBAC1BqjB,EAAWt1C,KAAKk8B,KAAK8Y,EAAiB5zD,QAAUiiD,GAEtDzvB,EAAiBs7B,GACjB,MAAMv6B,EACJ3U,KAAKg8B,OAAQrlD,EAAE89C,QAAUme,EAAKhe,KAAOge,EAAKl7D,OAAU49D,GAAYjS,EAChErjC,KAAKg8B,OAAQrlD,EAAE+8C,QAAUkf,EAAKz1D,MAAQy1D,EAAKn7D,MAAS4rD,GAEtD4R,EAAqBtgC,GACrBd,EAAkBc,EAAI,GAGxB,CAAC0uB,EAASlhD,EAAY+sD,EAAWt7B,EAAkBC,KAG9C8iC,EAAmBC,IAAwB3zD,EAAAA,EAAAA,UAA4C,IAExF4zD,GAAyB11D,EAAAA,EAAAA,QAAsB,MAC/C21D,GAAyB31D,EAAAA,EAAAA,QAAsB,MAE/CswD,GAAgBv1C,EAAAA,EAAAA,cAAa02C,IAAmB,IAADmE,EACnD,MAAMC,EAAmC,QAArBD,EAAGtC,EAAWrzD,eAAO,IAAA21D,OAAA,EAAlBA,EAAoB9kB,wBACtC+kB,IAIL7B,EAAiB,CACfh9D,EAAGy6D,EAAKz1D,KAAO65D,EAAe75D,KAC9B/E,EAAGw6D,EAAKhe,IAAMoiB,EAAepiB,IAC7Bn9C,MAAOm7D,EAAKn7D,MACZC,OAAQk7D,EAAKl7D,SAGfk/D,EA/PuB,SAAClmC,GAAsB,IAAEumC,EAAOrgE,UAAAC,OAAA,QAAA0M,IAAA3M,UAAA,GAAAA,UAAA,GAAG,EAAC,MAC/D,CAAC,EAAG,EAAG,EAAG,EAAG,GAAGoU,KAAKtU,IAAC,CACpBwgE,KAAMxgE,EACNe,OAAQi5B,GAAkBh6B,EAAI,GAAKugE,GAAWvgE,KAC5C,CA2PqBygE,CAAqBH,EAAev/D,QAAO,GAC/D,IAEGi6D,IAAex1C,EAAAA,EAAAA,cAAY,KAAO,IAADk7C,EAAAC,EACrC3C,EAAyC,QAA/B0C,EAACP,EAAuBz1D,eAAO,IAAAg2D,EAAAA,EAAI/T,GAC7CwR,EAA4C,QAA/BwC,EAACP,EAAuB11D,eAAO,IAAAi2D,EAAAA,EAAI7C,GAChDW,EAAiB,KAAK,GACrB,CAACX,EAAYnR,EAASwR,EAAeH,IAElCnO,IAAWrqC,EAAAA,EAAAA,cACf,CAACzkB,EAAeC,KACd,MAAM4/D,EAAmBX,EAAkB9xD,QAAO,CAACod,EAAMs1C,IACvDv3C,KAAKszB,IAAIikB,EAAK9/D,MAAQA,GAASuoB,KAAKszB,IAAIrxB,EAAKxqB,MAAQA,GAAS8/D,EAAOt1C,IAGjEu1C,EAAsB1D,EAAqBjvD,QAAO,CAACod,EAAMs1C,IAC7Dv3C,KAAKszB,IAAIikB,EAAO7/D,GAAUsoB,KAAKszB,IAAIrxB,EAAOvqB,GAAU6/D,EAAOt1C,IAG7D40C,EAAuBz1D,QAAUk2D,EAAiBJ,KAClDJ,EAAuB11D,QAAUo2D,EAEjCrC,GAAkB/zD,GACXA,EAGDA,EAAQ3J,QAAU6/D,EAAiB7/D,OAAS2J,EAAQ1J,SAAW8/D,EAC1D,IAAKp2D,EAAS3J,MAAO6/D,EAAiB7/D,MAAOC,OAAQ8/D,GAEvDp2D,EALE,MAMT,GAEJ,CAACu1D,IAGH,OACEl6D,EAAAA,EAAAA,IAAA,OACE3E,IAAK28D,EACL13D,IAAG,sBAED44D,EAAc9+D,OAAS,GAAK,CAC1BsJ,QAAS,OACTuE,IAAK3F,EAAMgN,QAAQC,IACpB,IAEH1Q,MAAO,CACLsJ,oBAAqB,UAAYy+C,EAAU,YACvC7vB,GAAmB,CACrB,CAAC6iB,EAAAA,IAAiC,mBAGtC,cAAY,6BACZsX,YAAa+I,EACbh4D,aAAcA,KACZu2D,EAAqB,KAAK,EAC1Bz4D,SAAA,EAEAg3B,GAAmB0hC,KACnB94D,EAAAA,EAAAA,GAACq7D,EAAAA,GAAM,CACL15D,OAAM3G,IAOgB,IAAzBu+D,EAAc9+D,SACbuF,EAAAA,EAAAA,GAAA,OAAKW,IAAGc,EAAgErB,UACtEJ,EAAAA,EAAAA,GAACyzB,EAAAA,IAAK,CACJv4B,OACE8E,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,8BAInBklB,aACE1zB,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,+DAOxB+qD,EAAc3qD,KAAI,CAACqb,EAAYtR,EAAO2iD,KAAW,IAADC,EAAAC,EAAAC,EAAAC,EAC/C,OACE17D,EAAAA,EAAAA,GAAC80D,EAAuB,CAEtBpoC,KAAqB,QAAjB6uC,EAAEtxC,EAAWyC,YAAI,IAAA6uC,EAAAA,EAAI,GACzBnG,YAAaqE,EAA8B,QAAhB+B,EAACvxC,EAAWyC,YAAI,IAAA8uC,EAAAA,EAAI,IAC/CnG,cAAeA,EACfC,aAAcA,GACdnL,SAAUA,GACVlgC,WAAYA,EACZuK,aAAcA,EACd4I,cAAezF,EACfhf,MAAOA,EACPrd,OAAQ88D,EACRp7B,YAAaz2B,QAAQ+0D,EAAM3iD,EAAQ,IACnCskB,UAAW12B,QAAQ+0D,EAAM3iD,EAAQ,IACjCoiC,kBAAmC,QAAlB0gB,EAAEH,EAAM3iD,EAAQ,UAAE,IAAA8iD,OAAA,EAAhBA,EAAkB/uC,KACrCsuB,cAA+B,QAAlB0gB,EAAEJ,EAAM3iD,EAAQ,UAAE,IAAA+iD,OAAA,EAAhBA,EAAkBhvC,KACjCgS,gBAAiBA,KACb62B,GAhBCtrC,EAAWyC,KAiBhB,IAGLytC,IAAen6D,EAAAA,EAAAA,GAACs3D,EAA0B,IAAK6C,IAC/CrB,IAAiB94D,EAAAA,EAAAA,GAACs3D,EAA0B,IAAKwB,MAC9C,ICpWC6C,EAAoB3gE,IAgBF,IAhBG,UAChC83D,EAAS,cACT8I,EAAa,cACbC,EAAa,aACbC,EAAY,uBACZ7/B,EAAsB,UACtBjP,EAAS,eACT+uC,EAAc,YACdC,EAAW,QACX9xC,EAAO,aACPwS,EAAY,mBACZK,EAAkB,mBAClBtlB,EAAkB,gBAClBinB,EAAe,sBACfvU,EAAqB,cACrB6tC,GACuBh9D,EAEvB,OAAIi9B,EAAAA,EAAAA,OAEAj4B,EAAAA,EAAAA,GAAC63D,EAAmC,CAClCG,cAAeA,EACfjF,YAAa6I,EACbpnC,aAAcxH,EACd8P,iBAAkBi/B,EAClBn/B,cAAeo/B,EACfj/B,mBAAoBA,EACpB+1B,UAAWA,EACX5oC,QAASA,EACTzS,mBAAoBA,EACpBinB,gBAAiBA,EACjBvU,sBAAuBA,KAM3BnqB,EAAAA,EAAAA,GAAC6yD,EAAU,CACTC,UAAWA,EACXt+B,aAAcxH,EACd+lC,YAAa6I,EACb3/B,uBAAwBA,EACxBW,cAAeo/B,EACfl/B,iBAAkBi/B,EAClBl/B,gBAAiBg/B,EACjB7I,eAAgB8I,EAChB5xC,QAASA,EACTwS,aAAcA,EACdK,mBAAoBA,EACpBtlB,mBAAoBA,EACpBinB,gBAAiBA,EACjBvU,sBAAuBA,GACvB,E,yBCjDN,MAgDM8xC,GAA4Bt5C,IAChC,GAAIA,EAAOlgB,OAASuvB,EAAAA,GAAcC,IAAK,CAErC,MAAO,CADWtP,EACA5C,UACpB,CAAO,GAAI4C,EAAOlgB,OAASuvB,EAAAA,GAAcY,KAAM,CAC7C,MAAMspC,EAAav5C,EACnB,OAAI8mC,EAAAA,GAAAA,SAAQyS,EAAWv7C,oBACdu7C,EAAWv7C,mBAEb,CAACu7C,EAAWn8C,UACrB,CAAO,GAAI4C,EAAOlgB,OAASuvB,EAAAA,GAAc6B,QAAS,CAChD,MAAMsoC,EAAgBx5C,EACtB,MAAO,CAACw5C,EAActtC,MAAMppB,IAAIuI,cAAemuD,EAAcrtC,MAAMrpB,IAAIuI,cACzE,CAAO,GAAI2U,EAAOlgB,OAASuvB,EAAAA,GAAca,SAAU,CACjD,MAAMupC,EAAiBz5C,EACvB,MAAO,IAAIy5C,EAAe77C,mBAAoB67C,EAAe/7C,eAC/D,CAAO,CACL,MAAMg8C,EAAgB15C,EACtB,MAAO,CAAC05C,EAAcxtC,MAAMppB,IAAK42D,EAAcvtC,MAAMrpB,IAAK42D,EAActtC,MAAMtpB,IAChF,GAsBW62D,GAA6BthE,IAiBF,IAjBG,mBACzC8+B,EAAkB,iBAClBhB,EAAgB,cAChB+iC,EAAa,aACbC,EAAY,UACZ9uC,EAAS,uBACTiP,GAAyB,EAAK,mBAC9BxkB,GAAqB,EAAK,eAC1BskD,EAAc,YACdC,EAAW,gBACX/L,EAAe,OACfl5C,EAAM,QACNmT,EAAO,oBACPuK,EAAmB,gBACnBiK,EAAe,mBACf3B,EAAqBA,SAAQ,sBAC7B5S,GACgCnvB,EAChC,MAAMsiC,GAAgB7E,EAAAA,EAAAA,OACf23B,EAAamM,IAAkB11D,EAAAA,EAAAA,WAAU,IAC1C,MAAElE,IAAUC,EAAAA,EAAAA,KAKZ8rD,GAAY3hD,EAAAA,EAAAA,UAAQ,KACA+sB,GAAsB,IAAInP,SAASqtC,GACrDA,EAAcj0D,QACT,CAACi0D,EAActrC,MAEf,MAIV,CAACoN,IAKE0iC,GAAsB18C,EAAAA,EAAAA,cACzBra,IACC63B,GAAet4B,IACb,MAAMy3D,GAAuBz3D,EAAQ80B,oBAAsB,IAAIlrB,KAAKopD,IAClE,MAAMlF,EAAYkF,EAActrC,KAC1BgwC,EACY,kBAARj3D,GAAoBqtD,IAAcrtD,GAASkmB,MAAM89B,QAAQhkD,IAAQA,EAAIwI,SAAS6kD,GACxF,MAAO,IACFkF,EACHj0D,QAAS24D,EACV,IAEH,MAAO,IACF13D,EACH80B,mBAAoB2iC,EACrB,GACD,GAEJ,CAACn/B,IAMGk1B,GAAgB1yC,EAAAA,EAAAA,cACnBgzC,IACCx1B,GAAet4B,IACb,MAAM49C,GAAuB59C,EAAQ8zB,kBAAoB,IAEtDnrB,QAAQgvD,GACAA,EAAYC,aAAeD,EAAY3iC,kBAAoB84B,IAGnElkD,KAAK+tD,GACAA,EAAYC,aAAeD,EAAY3iC,kBAAoB84B,EACtD,IAAK6J,EAAa/hC,SAAS,GAE3B+hC,IAKPE,GAAyB73D,EAAQ80B,oBAAsB,IAC1DhiB,QACAnK,QAAQqqD,GACAA,EAActrC,OAASomC,IAGlC,MAAO,IACF9tD,EACH8zB,iBAAkB8pB,EAClB9oB,mBAAoB+iC,EACpBC,sBAAsB,EACvB,GACD,GAEJ,CAACx/B,IAQGy/B,GAAaj9C,EAAAA,EAAAA,cACjB,CAACgzC,EAAmBkK,KAClB,IAAInuD,GAAO,EAqBX,OApBAyuB,GAAet4B,IAEb,MAAM63D,EAAwB,IAAK73D,EAAQ80B,oBAAsB,IACjEjrB,EAAMguD,EAAsB7jC,WAAWg/B,GAAsCA,EAActrC,OAASomC,IACpG,MAAMmK,EAAa,CAAEv7D,KAAM,GAAIgrB,MAAM3O,EAAAA,EAAAA,MAAWha,SAAS,EAAOm5D,aAAa,GAU7E,OATIruD,EAAM,EAERguD,EAAsBpiD,KAAKwiD,IAClBD,IAGTnuD,GAAO,GAFPguD,EAAsBt6C,OAAO1T,EAAK,EAAGouD,IAKhC,IACFj4D,EACH80B,mBAAoB+iC,EACpBC,sBAAsB,EACvB,IAEIjuD,CAAG,GAEZ,CAACyuB,IAMG6/B,GAAgBr9C,EAAAA,EAAAA,cAAY,KAChCwd,GAAet4B,IACb,MAAM63D,EAAwB,IACxB73D,EAAQ80B,oBAAsB,GAClC,CAAEp4B,KAAM,GAAIgrB,MAAM3O,EAAAA,EAAAA,MAAWha,SAAS,EAAOm5D,aAAa,IAE5D,MAAO,IACFl4D,EACH80B,mBAAoB+iC,EACpBC,sBAAsB,EACvB,IAEHP,GAAiC,OAAlBziC,QAAkB,IAAlBA,OAAkB,EAAlBA,EAAoBr/B,UAAW,EAAE,GAC/C,CAAC6iC,EAAiC,OAAlBxD,QAAkB,IAAlBA,OAAkB,EAAlBA,EAAoBr/B,SAOjC2iE,GAAiBt9C,EAAAA,EAAAA,cACrB,CAACgzC,EAAmBpxD,KAClB47B,GAAet4B,IACb,MAAM63D,GAAyB73D,EAAQ80B,oBAAsB,IAAIlrB,KAAKopD,GAChEA,EAActrC,OAASomC,EAClB,IAAKkF,EAAet2D,KAAMA,GAE1Bs2D,IAGX,MAAO,IACFhzD,EACH80B,mBAAoB+iC,EACpBC,sBAAsB,EACvB,GACD,GAEJ,CAACx/B,IAQG+/B,GAAiBv9C,EAAAA,EAAAA,cACrB,CAACw9C,EAAyBjkC,KACxBiE,GAAet4B,IACb,MAAM63D,GAAyB73D,EAAQ80B,oBAAsB,IAAIhiB,QAC3DylD,EAAmBV,EAAsB7jC,WAC5Cg/B,GAAsCA,EAActrC,OAAS4wC,IAE1DE,EAAmBX,EAAsB7jC,WAC5Cg/B,GAAsCA,EAActrC,OAAS2M,IAE1DQ,EAAgBgjC,EAAsBt6C,OAAOg7C,EAAkB,GAAG,GAGxE,OADAV,EAAsBt6C,OAAOi7C,EAAkB,EAAG3jC,GAC3C,IACF70B,EACH80B,mBAAoB+iC,EACpBC,sBAAsB,EACvB,GACD,GAEJ,CAACx/B,IAGGmgC,GAAiB1wD,EAAAA,EAAAA,UAAQ,IAA2D,IAArDigB,EAAUrf,QAAO9L,IAAA,IAAC,OAAE6K,GAAQ7K,EAAA,OAAM6K,CAAM,IAAEjS,QAAc,CAACuyB,KAExF,iBAAE0wC,EAAgB,eAAEC,IAAmB5wD,EAAAA,EAAAA,UAAQ,KACnD,GAAe,KAAXgK,EACF,MAAO,CAAE2mD,iBAAkB5jC,EAAoB6jC,eAAgB7kC,GAGjE,MAAM8kC,GAA4B9kC,GAAoB,IAAInrB,QAAQgV,IACxDA,EAAOiY,SA3SMijC,EAAClwD,EAAgBgV,KAE1C,IAAIm7C,EAAAA,EAAAA,KAAsC,CAExC,GAAIn7C,EAAOlgB,OAASuvB,EAAAA,GAAcoC,OAASzR,EAAOlgB,OAASuvB,EAAAA,GAAc+B,WACvE,OAAO,EAGT,IACE,MAAMgqC,EAAc,IAAIC,OAAOrwD,EAAQ,KACvC,OAAOsuD,GAAyBt5C,GAAQ4H,MAAM0zC,GAAkBA,EAAc9yB,MAAM4yB,IACtF,CAAE,MAEA,OAAO,CACT,CACF,CAEA,MAAMG,EAAkBvwD,EAAOK,cAE/B,GAAI2U,EAAOlgB,OAASuvB,EAAAA,GAAcC,IAEhC,OADkBtP,EACD5C,UAAU/R,cAAcC,SAASiwD,GAC7C,GAAIv7C,EAAOlgB,OAASuvB,EAAAA,GAAcY,KAAM,CAC7C,MAAMspC,EAAav5C,EACnB,OAAI8mC,EAAAA,GAAAA,SAAQyS,EAAWv7C,oBACdu7C,EAAWv7C,mBAAmB4J,MAAMxK,GAAcA,EAAU/R,cAAcC,SAASiwD,KAErFhC,EAAWn8C,UAAU/R,cAAcC,SAASiwD,EACrD,CAAO,GAAIv7C,EAAOlgB,OAASuvB,EAAAA,GAAc6B,QAAS,CAChD,MAAMsoC,EAAgBx5C,EACtB,OACEw5C,EAActtC,MAAMppB,IAAIuI,cAAcC,SAASiwD,IAC/C/B,EAAcrtC,MAAMrpB,IAAIuI,cAAcC,SAASiwD,EAEnD,CAAO,GAAIv7C,EAAOlgB,OAASuvB,EAAAA,GAAca,SACvC,MAAO,uBAAuB7kB,cAAcC,SAASiwD,GAChD,GAAIv7C,EAAOlgB,OAASuvB,EAAAA,GAAcO,QAAS,CAChD,MAAM8pC,EAAgB15C,EACtB,OACE05C,EAAcxtC,MAAMppB,IAAIuI,cAAcC,SAASiwD,IAC/C7B,EAAcvtC,MAAMrpB,IAAIuI,cAAcC,SAASiwD,IAC/C7B,EAActtC,MAAMtpB,IAAIuI,cAAcC,SAASiwD,EAEnD,CAEA,OAAO,CAAI,EA8PmBL,CAAmB9mD,EAAQ4L,KAGjDw7C,EAAqB,IAAIzyC,IAC/BkyC,EAAyB3lD,SAAS0K,IAC5BA,EAAOqX,iBACTmkC,EAAmB1yC,IAAI9I,EAAOqX,gBAChC,IAOF,MAAO,CAAE0jC,kBAJ2B5jC,GAAsB,IAAInsB,QAAQqqD,GAC7DmG,EAAmB1wB,IAAIuqB,EAActrC,QAGSixC,eAAgBC,EAA0B,GAChG,CAAC7mD,EAAQ+hB,EAAkBgB,IAExBskC,EAAyB,KAAXrnD,EAEpB,OAAK+iB,GAAuBhB,EAIxB2kC,GAEAz9D,EAAAA,EAAAA,GAAA,OAAKW,KAAGC,EAAAA,EAAAA,IAAE,CAAE8O,UAAW/M,EAAMgN,QAAQa,IAAI,IAACpQ,UACxCJ,EAAAA,EAAAA,GAACyzB,EAAAA,IAAK,CACJC,aACE1zB,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,qEASvB4vD,GAA0C,KAAb,OAAdT,QAAc,IAAdA,OAAc,EAAdA,EAAgBljE,SAG/B4F,EAAAA,EAAAA,IAAAC,EAAAA,GAAA,CAAAF,SAAA,EACEJ,EAAAA,EAAAA,GAACuU,EAAAA,EAAM,CAACC,KAAK,QACbxU,EAAAA,EAAAA,GAACyzB,EAAAA,IAAK,CACJv4B,OACE8E,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,qBAInBklB,aACE1zB,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,wFAUzBnO,EAAAA,EAAAA,IAAA,OAAAD,SAAA,EACEJ,EAAAA,EAAAA,GAACq+D,EAAqB,CAAC3P,UAAWA,EAAWC,kBAAmB6N,EAAoBp8D,UAChFs9D,GAAoB,IAAI9uD,KAAI,CAACopD,EAAmCr/C,KAChE,MAAMijD,GAAiB+B,GAAkB,IAAIhwD,QAAQgV,IACnD,MAAMoX,EAAWpX,EAAmCqX,gBACpD,OAAQrX,EAAOiY,SAAWb,IAAYi+B,EAActrC,IAAI,IAG1D,OACE1sB,EAAAA,EAAAA,GAACwvD,EAAAA,IAAU8O,MAAK,CACdl8B,QACEpiC,EAAAA,EAAAA,GAAC+vD,EAAuB,CACtBp3C,MAAOA,EACPohB,QAASi+B,EACT9H,gBAAiBsC,EACjBrC,aAAc4M,EACd3M,YAAaA,EACbC,iBAAkBkM,EAClBjM,iBAAkB8M,EAClBpN,oBAAqB4L,EAAcnhE,OACnCw1D,gBAAiBA,EACjBM,iBAAkB8M,EAClB7M,WAAY9B,EAAUzgD,SAAS+pD,EAActrC,MAC7C+H,oBAAqBA,EAErBg8B,kBAAmB2N,IAIvB,eAAc1P,EAAUzgD,SAAS+pD,EAActrC,MAAMtsB,UAErDJ,EAAAA,EAAAA,GAAC27D,EAAiB,CAChB7I,UAAWkF,EAActrC,KACzBsrC,cAAeA,EACf4D,cAAeA,EACfC,cAAeA,EACfC,aAAcA,EACd7/B,uBAAwBA,EACxBjP,UAAWA,EACX+uC,eAAgBA,EAChBC,YAAaA,EACb9xC,QAASA,EACTwS,aAAc/jB,EACdokB,mBAAoBA,EACpBtlB,mBAAoBA,EACpBinB,gBAAiBA,EACjBvU,sBAAuBA,KAlBpB6tC,EAActrC,KAoBH,OAItB0xC,IACAp+D,EAAAA,EAAAA,GAAA,OAAAI,UACEJ,EAAAA,EAAAA,GAACiD,EAAAA,EAAM,CACLV,YAAY,kHACZg8D,OAAK,EACLt8D,QAASk7D,EACTj7D,MAAMlC,EAAAA,EAAAA,GAACmjB,EAAAA,IAAQ,IACfjkB,MAAO,CAAE4E,OAAQ,OAAQ4L,UAAW,OAAQtP,UAE5CJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,uBAxGlB,IA8GD,C,8FCxcV,MACMgwD,EAAuB,iBAAiB,IAEzCC,EAAQ,SAARA,GAAQ,OAARA,EAAQ,QAARA,EAAQ,aAARA,EAAQ,aAARA,EAAQ,WAARA,EAAQ,UAARA,EAAQ,kBAARA,EAAQ,kBAARA,CAAQ,EAARA,GAAQ,IAURC,EAAW,SAAXA,GAAW,OAAXA,EAAW,SAAXA,EAAW,UAAXA,CAAW,EAAXA,GAAW,IAIXC,EAAmB,SAAnBA,GAAmB,OAAnBA,EAAmB,SAAnBA,EAAmB,UAAnBA,CAAmB,EAAnBA,GAAmB,IAKxB,MAAMC,EAAa,CACjB,CAACH,EAASI,KAAM,EAChB,CAACJ,EAASK,UAAW,EACrB,CAACL,EAASM,UAAW,EACrB,CAACN,EAASO,QAAS,EACnB,CAACP,EAASQ,OAAQ,EAClB,CAACR,EAASS,eAAgB,EAC1B,CAACT,EAASU,eAAgB,GAGtBC,EAAoBC,GACJ,kBAATA,GACF,CAACZ,EAASI,IAAKJ,EAASK,SAAUL,EAASM,SAAUN,EAASO,OAAQP,EAASQ,OAAOhxD,SAC3FoxD,GAMAC,EAAmBD,GACH,kBAATA,GACF,CAACZ,EAASS,cAAeT,EAASU,eAAelxD,SAASoxD,GAO/DE,EAAyB/zC,GAAqBA,EAAS1T,MAAM,GAAI,GA2BjE0nD,EAAiBA,CAACC,EAA4BC,KAClD,MAAMC,EAAcF,EAAMG,MAC1B,QAAoBz4D,IAAhBw4D,EACF,MAAM,IAAIzhD,MAAM,sCACX,GAAIkhD,EAAiBO,GAAc,CACxC,GAAID,EAAaA,EAAajlE,OAAS,GAAK,EAC1C,MAAM,IAAIyjB,MAAM,yEAElBwhD,EAAaA,EAAajlE,OAAS,IACrC,KAAO,KAAI6kE,EAAgBK,GAKzB,MAAM,IAAIzhD,MAAM,kDAJhB,GAAIwhD,EAAaA,EAAajlE,OAAS,GAAK,EAC1C,MAAM,IAAIyjB,MAAM,uEAIpB,CACA,OAAOyhD,CAAW,EAIdE,EAAsBA,CAACJ,EAA4BK,EAA6BJ,KACpF,KAAOD,EAAMhlE,OAAS,GAAK6kE,GAAgBS,EAAAA,EAAAA,MAAKN,KAC9CK,EAAOrlD,KAAK+kD,EAAeC,EAAOC,GACpC,EAsJWz+C,EAA2BA,KAyD/B,CACLD,mBAzDwBlB,EAAAA,EAAAA,cACxB,CAACsB,EAAoB5C,KACnB,IAEE,MAAMwhD,EAAuB5+C,EAAW6+C,QAAQzB,EAAsB,IACtE,IAAK,sBAAsB0B,KAAKF,GAC9B,OAGF,MAAQ5+C,WAAY++C,EAAgB,UAAE5+C,GA/MIH,KAChD,MAAMg/C,EAAUh/C,EAAW+pB,MAAMqzB,GACjC,IAAK4B,EACH,MAAO,CAAEh/C,aAAYG,UAAW,IAGlC,MAAM8+C,GAAehsB,EAAAA,EAAAA,MAAK+rB,GACpBE,EAAqC,CAAC,EAa5C,OAZAD,EAAapoD,SAAQ,CAACkzB,EAAOxyB,KAC3B2nD,EAAWn1B,GAbiC,MAaFxyB,IAAM,IAW3C,CAAEyI,WARkBA,EAAW6+C,QAAQzB,GAAuBrzB,GAC/DA,KAASm1B,EACJA,EAAWn1B,GAEbA,IAIgC5pB,UADvB8+C,EAAazxD,IAAI2wD,GACiB,EA2LMgB,CAAkCn/C,GAEtF,IAAK,MAAMoK,KAAYjK,EACrB,IAAK/C,EAAcvQ,SAASud,GAC1B,OAGJ,MAAMg1C,EAAoBL,EAAiBF,QAAQ,MAAO,IAMpD3+C,EA1KCF,KACb,MAAMq+C,EAA6B,GAC7BK,EAA8B,GAC9BJ,EAAyB,CAAC,GAE1Be,EAAmBA,KACvBf,EAAaA,EAAajlE,OAAS,IAAI,EAEzC,IAAK,IAAIimE,EAAI,EAAGA,EAAIt/C,EAAW3mB,OAAQimE,IAAK,CAC1C,IAAIrB,EAAOj+C,EAAWs/C,GAGtB,MAAMC,EAAoB,IAAND,GAAWtB,EAAiBh+C,EAAWs/C,EAAI,KAAOt/C,EAAWs/C,EAAI,KAAOhC,EAAYkC,KAOxG,GANIvB,IAASZ,EAASK,UAAY6B,EAChCtB,EAAOZ,EAASS,cACPG,IAASZ,EAASI,KAAO8B,IAClCtB,EAAOZ,EAASU,eAvHI,MA0HlBE,EAA4B,CAC9B,IAAI7zC,EAAW,GACf,GAAIk1C,EAAI,GAAKt/C,EAAW3mB,QAAU2mB,EAAWs/C,EAAI,KAAO/B,EAAoBiC,KAC1E,MAAM,IAAI1iD,MAAM,sDAGlB,IADAwiD,IACOA,EAAI,EAAIt/C,EAAW3mB,QAAU2mB,EAAWs/C,EAAI,KAAO/B,EAAoBkC,OAC5Er1C,GAAYpK,IAAas/C,GAE3BA,IACAZ,EAAOrlD,KAAK+Q,GACZi1C,IACAZ,EAAoBJ,EAAOK,EAAQJ,EACrC,MAAO,GAAI,KAAKQ,KAAKb,IAAkB,MAATA,EAAc,CAE1C,IAAIyB,EAAMzB,EAEV,KAAOqB,EAAI,EAAIt/C,EAAW3mB,SAAW,KAAKylE,KAAK9+C,EAAWs/C,EAAI,KAA6B,MAAtBt/C,EAAWs/C,EAAI,KAClFI,GAAO1/C,IAAas/C,GAEtB,MAAMK,EAAgBD,EAAI31B,MAAM,OAChC,GAAI41B,GAAiBA,EAActmE,OAAS,EAC1C,MAAM,IAAIyjB,MAAM,0DAElB,MAAM8iD,EAAWC,WAAWH,GAC5BL,IACAX,EAAOrlD,KAAKumD,GACZnB,EAAoBJ,EAAOK,EAAQJ,EACrC,MAAO,GAAIJ,EAAgBD,GACzBI,EAAMhlD,KAAK4kD,QACN,GAAID,EAAiBC,GAAO,CAEjC,GAAsB,IAAlBS,EAAOrlE,OACT,MAAM,IAAIyjB,MAAM,wDAElB,KACEuhD,EAAMhlE,OAAS,GACf2kE,GAAiBW,EAAAA,EAAAA,MAAKN,MAhHFyB,GAiHAnB,EAAAA,EAAAA,MAAKN,GAjH4Bb,EAAWsC,GAAOtC,EAiH1BS,KAC1CU,EAAAA,EAAAA,MAAKN,KAAWJ,GAAQA,IAASZ,EAASQ,QAE7Ca,EAAOrlD,KAAK+kD,EAAeC,EAAOC,IAEpCD,EAAMhlD,KAAK4kD,EACb,MAAO,GAAIA,IAASX,EAAYkC,KAC9BnB,EAAMhlD,KAAK4kD,GACXK,EAAajlD,KAAK,OACb,IAAI4kD,IAASX,EAAYmC,MAe9B,MAAM,IAAI3iD,MAAM,uDAdhB,KAAOuhD,EAAMhlE,OAAS,IAAKslE,EAAAA,EAAAA,MAAKN,KAAWf,EAAYkC,MACrDd,EAAOrlD,KAAK+kD,EAAeC,EAAOC,IAGpC,GADkBD,EAAMG,QACNlB,EAAYkC,KAC5B,MAAM,IAAI1iD,MAAM,4CAElB,GAA8C,IAA1CwhD,EAAaA,EAAajlE,OAAS,GACrC,MAAM,IAAIyjB,MAAM,qEAElBwhD,EAAaE,MACba,IACAZ,EAAoBJ,EAAOK,EAAQJ,EAGrC,CACF,CAEA,IA7IyByB,IAACD,EA6InBzB,EAAMhlE,OAAS,GACpBqlE,EAAOrlD,KAAK+kD,EAAeC,EAAOC,IAEpC,GAA4B,IAAxBA,EAAajlE,QAAoC,IAApBilE,EAAa,GAC5C,MAAM,IAAIxhD,MAAM,kDAElB,OAAO4hD,CAAM,EA+EKsB,CALeZ,EAAkBP,QAAQzB,GAAuBrzB,IAC1E,MAAMxyB,EAAQ0oD,SAASl2B,EAAMrzB,MAAM,GAAI,GAAI,IAC3C,MAAO,MAAwByJ,EAAU5I,KAAS,KAIpD,MAAO,CACL2I,MACAC,YACAH,aAEJ,CAAE,MAAO7mB,GAEP,MACF,IAEF,IAyBA2xC,mBAtByBA,CACzBrrB,EACAU,KAEA,QAAwBpa,IAApB0Z,EAGJ,IAOE,MAxGWygD,KACf,MAAM7B,EAA6B,GA8CnC,GA7CA6B,EAAOrpD,SAASspD,IACd,GAAqB,kBAAVA,EAIX,GAAIjC,EAAgBiC,GAAQ,CAC1B,MAAMxlE,EAAI0jE,EAAMG,MAChB,GAAiB,kBAAN7jE,EACT,MAAM,IAAImiB,MAAM,sDAElB,OAAQqjD,GACN,KAAK9C,EAASS,cACZO,EAAMhlD,MAAM1e,GACZ,MACF,KAAK0iE,EAASU,cACZM,EAAMhlD,KAAK1e,GAGjB,KAAO,KAAIqjE,EAAiBmC,GAwB1B,MAAM,IAAIrjD,MAAM,mDAxBkB,CAClC,MAAMuI,EAAIg5C,EAAMG,MACVp5C,EAAIi5C,EAAMG,MAChB,GAAiB,kBAANp5C,GAA+B,kBAANC,EAClC,MAAM,IAAIvI,MAAM,+DAElB,OAAQqjD,GACN,KAAK9C,EAASI,IACZY,EAAMhlD,KAAK+L,EAAIC,GACf,MACF,KAAKg4C,EAASK,SACZW,EAAMhlD,KAAK+L,EAAIC,GACf,MACF,KAAKg4C,EAASM,SACZU,EAAMhlD,KAAK+L,EAAIC,GACf,MACF,KAAKg4C,EAASO,OACZS,EAAMhlD,KAAK+L,EAAIC,GACf,MACF,KAAKg4C,EAASQ,MACZQ,EAAMhlD,KAAKmJ,KAAKG,IAAIyC,EAAGC,IAG7B,CAEA,MAzCEg5C,EAAMhlD,KAAK8mD,EAyCb,IAEmB,IAAjB9B,EAAMhlE,QAAoC,kBAAbglE,EAAM,GACrC,MAAM,IAAIvhD,MAAM,iDAElB,OAAOuhD,EAAM,EAAE,EAsDJ+B,CANW3gD,EAAgBS,IAAI1S,KAAK2yD,GACpB,kBAAVA,GAAsB1gD,EAAgBU,UAAUtT,SAASszD,GAC3DhgD,EAAUggD,GAEZA,IAGX,CAAE,MAAOhnE,GACP,MACF,I,sHC3SJ,MAAMknE,EAA6D,CACjEC,cAAe,QACfC,aAAc,SAGVC,EAA8C,CAClDvmE,MAAO,KACPC,OAAQ,KAGJumE,EAAiE,CACrE/+B,aAAa,EACbE,uBAAwB,CAAC,YAGdwE,EACXA,CAAC9W,EAAczT,IAA4B,CAAC2gC,EAAuB1iD,KACjE4mE,EAAAA,EAAAA,eACE,CACEpxC,OACAzT,OAAQ,IAAKA,KAAWwkD,GACxB9+C,OAAQk/C,GAEV,IAAKD,EAA6ChkB,SAAQmkB,SAAU7mE,IAO7DsiD,EAA+BA,KAC1C,MAAMwkB,GAAqBj9D,EAAAA,EAAAA,QAAmD,OACvEk9D,EAAiBC,IAAsBr7D,EAAAA,EAAAA,UAAqD,MAE7Fs7D,GAA2BriD,EAAAA,EAAAA,cAAamiD,IAC5CD,EAAmBh9D,QAAUi9D,EAC7BC,GAAoBE,GACdA,GAIG,EAACxkB,EAAgDykB,KAAkB,IAAAC,EAAA,OAC9C,QAD8CA,EACxEN,EAAmBh9D,eAAO,IAAAs9D,OAAA,EAA1BA,EAAAznE,KAAAmnE,EAA6BpkB,EAAQykB,EAAW,IAClD,GACD,IAEH,MAAO,CAACJ,EAAiBE,EAAyB,C,qECpD7C,MAAM1xC,EAA0Bz1B,IAMhC,IANiC,KACtC01B,EAAI,kBACJC,GAID31B,EACC,MAAMs1B,EAAYI,EAAKjoB,QAAO,CAACC,EAAK2jB,KAClC,IAAK,MAAM2E,KAAY72B,OAAO23B,KAAKzF,EAAIgJ,QACrC,GAAqB,OAAjB1E,QAAiB,IAAjBA,GAAAA,EAAmB1iB,SAAS+iB,GAAW,CACzC,MAAMg9B,EAAW3hC,EAAIgJ,OAAOrE,GAC5B,IAAK,MAAMuxC,KAAQpoE,OAAOwX,OAAOq8C,QACb7mD,IAAdo7D,EAAKzxC,OACPpoB,EAAI65D,EAAKzxC,MAAQ,CACf5xB,MAAO,CAAE6E,QAAS,QAClByZ,MAAO,IAIf,CAEF,OAAO9U,CAAG,GACT,CAAC,GAEJ,MAAO,CACL4nB,YACAC,QAAS3M,KAAKqE,OAAO9tB,OAAO23B,KAAKxB,GAAW1hB,IAAImZ,SAChDyI,QAAS5M,KAAKuE,OAAOhuB,OAAO23B,KAAKxB,GAAW1hB,IAAImZ,SACjD,C,0GC3BH,MAAMy6C,EAAuB,IAMhBnlB,EAAkB,WAG6B,IAH5B,QAC9B3lC,GAAU,EAAI,eACd+qD,EAAiBD,GAC8BhoE,UAAAC,OAAA,QAAA0M,IAAA3M,UAAA,GAAAA,UAAA,GAAG,CAAC,EACnD,MAAMkoE,GAAiB39D,EAAAA,EAAAA,QAAoC,OACpD83C,EAAcqY,IAAmBruD,EAAAA,EAAAA,WAAU6Q,GAE5CirD,GAAgB7iD,EAAAA,EAAAA,cACnBurB,IAEC,IAAK3zB,IAAYlO,OAAO8qD,qBAEtB,OADAY,GAAgB,GACT,OAGT,IAAK7pB,EACH,MAAO,OAIT,MAAMu3B,EAAuB,IAAItO,sBAAqBt5D,IAAc,IAAZ6P,GAAM7P,EAC5Dk6D,EAAgBrqD,EAAM4pD,eAAe,IAavC,OARA37C,YAAW,KACLuyB,GACFu3B,EAAqB53D,QAAQqgC,EAC/B,IAGFq3B,EAAe19D,QAAU49D,EAElBA,CAAoB,GAE7B,CAAClrD,IAGGzM,GAAa6U,EAAAA,EAAAA,cAAY,KACzB4iD,EAAe19D,UACjB09D,EAAe19D,QAAQiG,aACvBy3D,EAAe19D,QAAU,KAC3B,GACC,IAEGiwD,GAAgBn1C,EAAAA,EAAAA,cACnBpkB,IAECuP,IAGA03D,EAAcjnE,EAAI,GAEpB,CAACuP,EAAY03D,IAOf,IAHA/6D,EAAAA,EAAAA,YAAU,IAAMqD,GAAY,CAACA,KAGzBuqD,EAAAA,EAAAA,MAAiC,CAGnC,MAAOnX,IAAwBqX,EAAAA,EAAAA,IAAY7Y,EAAc4lB,GACzD,MAAO,CAAE5lB,eAAcM,WAAY8X,EAAe5W,uBACpD,CAGA,MAAO,CAAExB,eAAcM,WAAY8X,EAAe5W,qBAAsBxB,EAC1E,C,oFCxEO,MAAM1V,EAAqFitB,IAChG,MAAMyO,GAAa99D,EAAAA,EAAAA,QAAUqvD,GAM7B,OAJAxsD,EAAAA,EAAAA,YAAU,KACRi7D,EAAW79D,QAAUovD,CAAQ,GAC5B,CAACA,IAEIhxD,IACNy/D,EAAW79D,QAAQ5B,EAAM,CAC1B,C,0PCOH,MAAM0/D,EACJA,CAACC,EAAuBC,IAMxB,SAACC,EAAqBC,EAAoBC,GAA4C,IAADC,EAAAC,EAAA,IAAtBC,EAAa9oE,UAAAC,OAAA,QAAA0M,IAAA3M,UAAA,GAAAA,UAAA,GAAG,EAC7E,MAAM+oE,GAA6B,IAAhBL,IAAsC,IAAjBC,EAGlB,IAADK,EAKCC,EAeNC,EAETC,GAvBoC,QAA3CP,EAAAH,EAAOhtB,cAAc,8BAAsB,IAAAmtB,GAA3CA,EAA6C7sB,UAAUqtB,OAAO,sBAC1DV,GAAc,KACkC,QAAlDM,EAAAP,EAAOY,iBAAiBd,GAAeG,UAAW,IAAAM,GAAlDA,EAAoDjtB,UAAU9qB,IAAI,wBAGrB,QAA/C43C,EAAAJ,EAAOhtB,cAAc,kCAA0B,IAAAotB,GAA/CA,EAAiD9sB,UAAUqtB,OAAO,0BAC9DT,GAAe,KACkC,QAAnDM,EAAAR,EAAOY,iBAAiBd,GAAeI,UAAY,IAAAM,GAAnDA,EAAqDltB,UAAU9qB,IAAI,2BAGrE,GAAI63C,EAAgB,EAAG,CACrB,MAAMQ,EACJX,GAAe,EAAIA,EAAcG,EAAgBJ,GAAc,EAAIA,EAAaI,GAAiB,EACnGL,EAAOY,iBAAiBd,GAAe9qD,SAAQ,CAAC1d,EAAGoe,KACjDpe,EAAEg8C,UAAUsF,OAAO,UAAWljC,GAAS,GAAKA,EAAQ2qD,GACpD/oE,EAAEg8C,UAAUsF,OAAO,sBAAuBljC,IAAUmrD,EAAe,GAEvE,MACEb,EAAOY,iBAAiBd,GAAe9qD,SAAS1d,GAAMA,EAAEg8C,UAAUqtB,OAAO,aAGvEL,EACkC,QAApCG,EAAAT,EAAOhtB,cAAc+sB,UAAe,IAAAU,GAApCA,EAAsCntB,UAAUqtB,OAAO,gBAEnB,QAApCD,EAAAV,EAAOhtB,cAAc+sB,UAAe,IAAAW,GAApCA,EAAsCptB,UAAU9qB,IAAI,eAExD,EAKW6d,EAAqBw5B,EAAuB,0BAA2B,eAKvElxB,EAAsBkxB,EAAuB,4BAA6B,iBAK1Et8B,EAAyBs8B,EAAuB,+BAAgC,kBAWhFv8B,EAAmC,SAC9C3C,EACAL,EACAzV,EACAi2C,GAEI,IADJT,EAAa9oE,UAAAC,OAAA,QAAA0M,IAAA3M,UAAA,GAAAA,UAAA,GAAG,EAGhB,MAAMwpE,GAAej/D,EAAAA,EAAAA,QAAO+oB,GAC5Bk2C,EAAah/D,QAAU8oB,EAEvB,MAAMm2C,GAAqBl3D,EAAAA,EAAAA,UAAQ,IAC5B62B,GAAiBL,EAGfzV,EAASkL,WAAUh+B,IAAA,IAAC,KAAE0xB,GAAM1xB,EAAA,OAAK0xB,IAAS6W,CAAe,KAFtD,GAGT,CAACzV,EAAU8V,EAAcL,KAErB2gC,EAAmB59B,IAAwBz/B,EAAAA,EAAAA,WAAU,IACtD,kBAAEs9D,GAAsBC,KAE9Bx8D,EAAAA,EAAAA,YAAU,MAEJy8D,EAAAA,EAAAA,OAGCzgC,GAGLmgC,EAAYngC,EAAcsgC,EAAmBD,EAAoBX,EAAc,GAC9E,CAACS,EAAangC,EAAcqgC,EAAoBC,EAAmBZ,KAEtE17D,EAAAA,EAAAA,YAAU,MAEHy8D,EAAAA,EAAAA,OAGAzgC,GAILmgC,EAAYngC,GAAe,EAAGqgC,EAAoBX,EAAc,GAC/D,CAACS,EAAangC,EAAcqgC,EAAoBX,IAGnD,MAAMgB,GAAyBv/D,EAAAA,EAAAA,QAAOk/D,GACtCK,EAAuBt/D,QAAUi/D,EAEjC,MAAMM,GAA0BzkD,EAAAA,EAAAA,cAC7B0kD,IACC,IAAK5gC,EACH,OAGF,MAAM6gC,EAAgCT,EAAah/D,QAAQg0B,WAAUn3B,IAAA,IAAC,KAAE6qB,GAAM7qB,EAAA,OAAK6qB,IAAS83C,CAAS,IACrGT,EAAYngC,EAAc6gC,EAA+BH,EAAuBt/D,QAASs+D,EAAc,GAEzG,CAACS,EAAangC,EAAc0/B,IAM9B,OAFA17D,EAAAA,EAAAA,YAAU,IAAMu8D,EAAkBI,IAA0B,CAACJ,EAAmBI,IAEzE,CACLN,qBACAC,oBAEA59B,sBAAsB+9B,EAAAA,EAAAA,MAA+CvpB,EAAAA,KAAOxU,EAEhF,EAEO,IAAKo+B,EAA0B,SAA1BA,GAA0B,OAA1BA,EAAAA,EAA0B,eAA1BA,EAAAA,EAA0B,iBAA1BA,EAAAA,EAA0B,iBAA1BA,CAA0B,MActC,MAAMC,GAAgCxtC,EAAAA,EAAAA,eAAiD,CACrFytC,mBAAoBA,OACpBT,kBAAmBA,IAAM,SAGdU,EAAwCpjE,IAA+C,IAA9C,SAAErB,GAAsCqB,EAC5F,MAAMqjE,GAAuB//D,EAAAA,EAAAA,QAAoF,IAC3Gw5D,GAAQx5D,EAAAA,EAAAA,SAAO,GAGfggE,GAAeh4D,EAAAA,EAAAA,UAA2C,KAE9D,KAAKs3D,EAAAA,EAAAA,MACH,MAAO,CACLO,mBAAoBA,OACpBT,kBAAmBA,IAAM,QA6B7B,MAAO,CACLS,mBApByB,SACzBjuB,GAEI,IADJ,YAAEquB,EAAW,OAAE5yD,GAAwE5X,UAAAC,OAAA,QAAA0M,IAAA3M,UAAA,GAAAA,UAAA,GAAG,CAAC,EAE3F,IAAKmpB,EAAAA,EAAAA,aAAYqhD,IAEV,GAAIzG,EAAMv5D,QACf,YAFAu5D,EAAMv5D,QAAUggE,EAXIC,EAACtuB,EAA0BvkC,KACjD,IAAK,MAAM8yD,KAAMJ,EAAqB9/D,QACpCkgE,EAAGvuB,EAAWvkC,EAChB,EAYA6yD,CAAgBtuB,EAAWvkC,EAC7B,EAWE+xD,kBATyBgB,IACzBL,EAAqB9/D,QAAQyV,KAAK0qD,GAC3B,KACLL,EAAqB9/D,QAAU8/D,EAAqB9/D,QAAQ2I,QAAQu3D,GAAOA,IAAOC,GAAS,GAO9F,GACA,IAEH,OAAOC,EAAAA,EAAAA,eAAcT,EAA8BruD,SAAU,CAAElM,MAAO26D,GAAgB3kE,EAAS,EAGpFgkE,EAA6BA,KAAMvsC,EAAAA,EAAAA,YAAW8sC,E,wMCrMpD,IAAKv3C,EAAqB,SAArBA,GAAqB,OAArBA,EAAAA,EAAqB,mBAArBA,EAAAA,EAAqB,2DAArBA,CAAqB,MAOjC,MAAMi4C,EAA2BpkE,EAAAA,cAYvB,MAEH,IAAKqkE,EAAqB,SAArBA,GAAqB,OAArBA,EAAAA,EAAqB,mBAArBA,EAAAA,EAAqB,iBAArBA,EAAAA,EAAqB,qBAArBA,CAAqB,MAM1B,MAAMxjC,EACX9C,GACsDA,GAAa,uBAAwBA,EAMvFumC,EAA8Bl6B,IAClC,GAAgB,OAAZA,KAAsBA,aAAmBiL,SAC3C,OAAO,KAET,GAAIjL,aAAmBm6B,YACrB,OAAOn6B,EAGT,IAAIo6B,EAAiCp6B,EACrC,KAAOo6B,KAAoBA,aAA0BD,cACnDC,EAAiBA,EAAeC,cAGlC,OAAOD,CAAc,EAGvB,IAAA5jE,EAAA,CAAAH,KAAA,UAAAC,OAAA,eAIO,MAAM60B,EAA2Bx7B,IAgBhC,IAXN,UACAqQ,EAAS,SACTjL,EAAQ,YACRq2B,EACAE,UAAWzd,EAAS,UACpB2d,GAAY,GAMZ77B,EAEA,MAAM+oD,GAAeh/C,EAAAA,EAAAA,QAAuB,MAGtC4gE,GAAa5gE,EAAAA,EAAAA,QAAuB,MAGpC6gE,GAAa7gE,EAAAA,EAAAA,QAAiC,CAAEhJ,EAAG,EAAGC,EAAG,IAEzD6pE,GAA8BnhD,EAAAA,EAAAA,MAI9BohD,GAA4B/gE,EAAAA,EAAAA,QAAiC,CAAEhJ,EAAG,EAAGC,EAAG,KAEvEykB,EAAMslD,IAAWl/D,EAAAA,EAAAA,UAAgCumB,EAAsBE,SAGvE04C,EAAkBC,IAAuBp/D,EAAAA,EAAAA,UAAgCy+D,EAAsBY,SAE/FC,EAAsBC,IAA2Bv/D,EAAAA,EAAAA,UAAqB,OACtEw/D,EAAgBC,IAAqBz/D,EAAAA,EAAAA,UAAiB,KAGtD0/D,EAAoBC,IAAyB3/D,EAAAA,EAAAA,UAAc,MAG5D4/D,GAAiB1hE,EAAAA,EAAAA,QAAyD,MAG1E2hE,GAA6B3hE,EAAAA,EAAAA,QAA8BihE,GAC3DW,GAAwB5hE,EAAAA,EAAAA,QAAOshE,GAC/BO,GAA8B7hE,EAAAA,EAAAA,QAAOohE,GACrCU,GAA4B9hE,EAAAA,EAAAA,QAAOwhE,IAGnC,mBAAE3B,IAAuBR,EAAAA,EAAAA,MAGzB0C,GAAmBhnD,EAAAA,EAAAA,cACvB,WAAuC,IAAtCinD,EAAwBvsE,UAAAC,OAAA,QAAA0M,IAAA3M,UAAA,IAAAA,UAAA,GACvB,IAAKmrE,EAAW3gE,UAAY++C,EAAa/+C,QACvC,OAKF,IAAIgiE,EACFvmD,IAAS2M,EAAsBC,2BAC3By4C,EAA0B9gE,QAAQjJ,EAClC6pE,EAAW5gE,QAAQjJ,EAErBkrE,EAAUrB,EAAW5gE,QAAQhJ,EAEjC,MAAMkrE,EAAiBvB,EAAW3gE,QAC5B4wC,EAAgBmO,EAAa/+C,QAAQ6wC,wBAEvCp1B,IAAS2M,EAAsBC,6BAGjC25C,GAAWpxB,EAAc75C,EACzBkrE,GAAWrxB,EAAc55C,GAG3B2pE,EAAW3gE,QAAQ9F,MAAM6B,KAAO,MAChC4kE,EAAW3gE,QAAQ9F,MAAMs5C,IAAM,MAC/BmtB,EAAW3gE,QAAQ9F,MAAMkwD,UAAY,eAAe4X,EAAU,QAAQC,EAAU,UAGhF,MAAME,EAAaA,KACjB,MAAMC,EAAWF,EAAerxB,wBAE5BmxB,EAAUI,EAAS/rE,OAASu6C,EAAcv6C,QAC5C2rE,GAAWI,EAAS/rE,OAGlB4rE,EAAUG,EAAS9rE,QAAUs6C,EAAct6C,SAC7C2rE,GAAWG,EAAS9rE,QAGtB4rE,EAAehoE,MAAMkwD,UAAY,eAAe4X,EAAU,QAAQC,EAAU,SAAS,EAMnFF,EACF5wB,sBAAsBgxB,GAEtBA,GAEJ,GACA,CAAC1mD,KAIH7Y,EAAAA,EAAAA,YAAU,KACR8+D,EAA2B1hE,QAAUghE,CAAgB,GACpD,CAACA,IAGJ,MAAMqB,GAAiCvnD,EAAAA,EAAAA,cAAY,CAACwnD,EAA4BlkE,KAAuB,IAADmkE,EACpG,MAAMC,EAAaF,EAAczxB,wBAC3BD,GAAoC,QAApB2xB,EAAAxjB,EAAa/+C,eAAO,IAAAuiE,OAAA,EAApBA,EAAsB1xB,0BAA2B,CAAE90C,KAAM,EAAGy3C,IAAK,GAGvF,MAAO,CAAEz8C,EAFCqH,EAAMqkE,SAAWD,EAAWzmE,KAAO60C,EAAc70C,MAE/C/E,EADFoH,EAAMskE,SAAWF,EAAWhvB,IAAM5C,EAAc4C,KAC3C,GACd,IAEG8hB,GAAqDx6C,EAAAA,EAAAA,cACxD1c,IAEC,GACEsjE,EAA2B1hE,UAAYsgE,EAAsBqC,OAC7DhC,EAAW3gE,SACX++C,EAAa/+C,QACb,CACAyhE,EAAezhE,QAAU,KACzB,MAAMsiE,EAAgB/B,EAA2BniE,EAAM0H,QACnDw8D,IACF1B,EAAW5gE,QAAUqiE,EAA+BC,EAAelkE,EAAMwkE,aACzEd,IAEJ,IAEF,CAACA,EAAkBO,IAIfQ,GAAgB/nD,EAAAA,EAAAA,cACpB,CACE3L,EACAsM,EACAuM,EACA5pB,EACA0kE,KACI,IAADC,EACHpB,EAAsB3hE,QAAUmP,EAChCyyD,EAA4B5hE,QAAUgoB,EACtC65C,EAA0B7hE,QAAU8iE,EAGhCpB,EAA2B1hE,UAAYsgE,EAAsB0C,UAKjE5B,EAAwBp5C,IAInB7Y,GAAiC,QAA1B4zD,EAAItB,EAAezhE,eAAO,IAAA+iE,GAAtBA,EAAwB5zD,UAIpCsM,IAAS2M,EAAsBC,6BACjCy4C,EAA0B9gE,QAAQjJ,GAAS,OAALqH,QAAK,IAALA,OAAK,EAALA,EAAOrH,IAAK,GAIpDgqE,EAAQtlD,GAGR6lD,GAAmB2B,IACbH,GACFtB,EAAsBsB,GAKtBpB,EAA2B1hE,UAAYsgE,EAAsBY,QAC5DQ,EAA2B1hE,UAAYsgE,EAAsBqC,OAASxzD,IAAY8zD,GAEnFhC,EAAoBX,EAAsBqC,OACnCxzD,GAEF8zD,MACP,GAEJ,IAGIC,GAA4DpoD,EAAAA,EAAAA,cAC/D1c,IACKyzB,GAMiB,IAAjBzzB,EAAM+kE,QAAgBxB,EAAsB3hE,UAC9CyhE,EAAezhE,QAAU,CACvBjJ,EAAGqH,EAAMglE,MACTpsE,EAAGoH,EAAMilE,MACTl0D,QAASwyD,EAAsB3hE,SAEnC,GAEF,CAAC6xB,IAKGyxC,GAA8DxoD,EAAAA,EAAAA,cACjE1c,IACC,GAAIyzB,EACF,OAuBF,GAAI4vC,EAAezhE,SApBWujE,MAAO,IAADC,EACAC,EAAlC,IAAK5C,EACH,OACwB,QAAtB4C,EAAAhC,EAAezhE,eAAO,IAAAyjE,OAAA,EAAtBA,EAAwBt0D,UACxB/Q,EAAMglE,QAAU3B,EAAezhE,QAAQjJ,GACvCqH,EAAMilE,QAAU5B,EAAezhE,QAAQhJ,EAK3C,OACwB,QAAtBwsE,EAAA/B,EAAezhE,eAAO,IAAAwjE,OAAA,EAAtBA,EAAwBr0D,UACxByP,KAAKszB,IAAI9zC,EAAMglE,MAAQ3B,EAAezhE,QAAQjJ,GAJ1B,GAKpB6nB,KAAKszB,IAAI9zC,EAAMilE,MAAQ5B,EAAezhE,QAAQhJ,GAL1B,CAK4C,EAOtCusE,GAAyB,CAGrD,GAAI7B,EAA2B1hE,UAAYsgE,EAAsB0C,QAAS,CACxE1B,EAAkBG,EAAezhE,QAAQmP,SACzCqyD,EAAsBK,EAA0B7hE,SAChD,MAAMsiE,EAAgB/B,EAA2BniE,EAAMwkE,YAAY98D,QAC/Dw8D,IACF1B,EAAW5gE,QAAUqiE,EAA+BC,EAAelkE,EAAMwkE,aACzEd,GAAiB,GAErB,MAEEb,EAAoBX,EAAsB0C,SAC1ClB,GAAiB,GAEnB1jE,EAAMsL,iBACR,CAEA+3D,EAAezhE,QAAU,IAAI,GAE/B,CAAC8hE,EAAkBjwC,EAAWwwC,EAAgCxB,IAI1DlkC,GAAmB7hB,EAAAA,EAAAA,cAAY,IAAMmmD,EAAoBX,EAAsBY,SAAS,KAG9Fp/D,EAAAA,EAAAA,kBAAgB,KACd,IAAKi9C,EAAa/+C,QAChB,OAIF,MAAM0jE,EAAU3kB,EAAa/+C,QAAQ2jE,cAI/BC,EAAqBruE,IAAmB,IAADsuE,EAE3C,GAAInC,EAA2B1hE,UAAYsgE,EAAsB0C,QAC/D,OAGF,MAAMV,EAAgB/B,EAA2BhrE,EAAEuQ,QAEnD,IAAKw8D,EACH,OAMAA,aAAyB9B,cACf,OAAVG,QAAU,IAAVA,OAAU,EAAVA,EAAY3gE,mBAAmBwgE,aAC/BG,EAAW3gE,QAAQwxC,SAAS8wB,IAIoB,QAAvBuB,EAACpC,EAAezhE,eAAO,IAAA6jE,GAAtBA,EAAwB10D,SAClD8xD,EAAoBX,EAAsBY,OAC5C,EAIF,OAFAwC,EAAQ7gE,iBAAiB,QAAS+gE,EAAmB,CAAEE,SAAS,IAEzD,KACLJ,EAAQnwB,oBAAoB,QAASqwB,EAAmB,CAAEE,SAAS,GAAO,CAC3E,GACA,CAACzB,EAAgCP,IAGpC,MAAM55C,GAAepN,EAAAA,EAAAA,cAAY,KAAO,IAADipD,EACrCpC,EAAsB3hE,QAAU,GACN,QAAtB+jE,EAAAtC,EAAezhE,eAAO,IAAA+jE,GAAtBA,EAAwB50D,SAAWuyD,EAA2B1hE,UAAYsgE,EAAsB0C,UAGpG1B,EAAkB,IAClBL,EAAoBX,EAAsBY,QAAO,GAChD,IAGGtnB,GAAiB9+B,EAAAA,EAAAA,cAAY,WACjC6mD,EAAsB3hE,QAAU,GAChCshE,EAAkB,IAClBL,EAAoBX,EAAsBY,OAC5C,GAAG,IAGG3iC,GAAkBx2B,EAAAA,EAAAA,UAAQ,IAC1Bi5D,IAAqBV,EAAsB0C,QACtC,KAEF3B,GACN,CAACL,EAAkBK,KAGtBz+D,EAAAA,EAAAA,YACE,IACEg9D,EAAmBrhC,EAAiB,CAClCnxB,OAAQsyD,EAAAA,GAA2BsE,MAEnChE,YAAaz+D,QAAQg9B,MAEzB,CAACqhC,EAAoBrhC,IAGvB,MAAMwhC,GAAeh4D,EAAAA,EAAAA,UACnB,MAAS86D,gBAAe36C,eAAc0xB,iBAAgBrb,kBAAiB5B,sBACvE,CAACkmC,EAAe36C,EAAc0xB,EAAgBrb,EAAiB5B,IAO3DsnC,EACJjD,IAAqBV,EAAsBY,SAC1CzlD,IAAS2M,EAAsBC,4BAAiD,KAAnBg5C,GAEhE,OACEhmE,EAAAA,EAAAA,IAACglE,EAAyB/uD,SAAQ,CAAClM,MAAO26D,EAAa3kE,SAAA,EAGrDJ,EAAAA,EAAAA,GAAA,OACEuxD,YAAa+I,EACb4O,mBAAoBhB,EACpBiB,eAAgBb,EAChB3nE,IAAGkB,EAAqBzB,SAEvBA,KAGHJ,EAAAA,EAAAA,GAAA,OAAKW,IAAKgB,EAAOynE,qBAAsB/9D,UAAWA,EAAW3P,IAAKqoD,EAAa3jD,SAC5E6oE,IACCjpE,EAAAA,EAAAA,GAAA,OACEtE,IAAKiqE,EACLhlE,IAAKgB,EAAO0nE,mBACZ,cAAY,oBACZnqE,MAAO,CACLoqE,WAAYtD,IAAqBV,EAAsBqC,MAAQ,OAAS,QACxEjvB,cAAestB,IAAqBV,EAAsBqC,MAAQ,OAAS,OAC3EvnE,UAGFJ,EAAAA,EAAAA,GAACkZ,EAAS,CACR/E,QAASkyD,EACTrnC,UAAWunC,EACXv5C,UAAWm5C,EACX1vC,YAAaA,EACbsJ,WAAYimC,IAAqBV,EAAsBqC,MACvDhmC,iBAAkBA,EAClBlhB,KAAMA,UAKoB,EAU3B0M,EAAuB,SAKlCH,GAEI,IADJvM,EAAIjmB,UAAAC,OAAA,QAAA0M,IAAA3M,UAAA,GAAAA,UAAA,GAAG4yB,EAAsBE,OAE7B,MAAMy3C,GAAeltC,EAAAA,EAAAA,YAAWwtC,GAEhC,IAAKN,EACH,MAAM,IAAI7mD,MACR,yGAIJ,MAAM,cAAE2pD,EAAa,aAAE36C,EAAY,gBAAEqW,EAAe,iBAAE5B,EAAgB,eAAEid,GAAmBmmB,GACrF,mBAAEH,IAAuBR,EAAAA,EAAAA,MAEzBn3C,GAAanN,EAAAA,EAAAA,cACjB,WAAsF,IAArF3L,EAAO3Z,UAAAC,OAAA,QAAA0M,IAAA3M,UAAA,GAAAA,UAAA,GAAG,GACTqtE,EAAc1zD,EAASsM,EAAMuM,EADiBxyB,UAAAC,OAAA,EAAAD,UAAA,QAAA2M,EAAgC3M,UAAAC,OAAA,EAAAD,UAAA,QAAA2M,GAE9Ey9D,EAAmBzwD,EAAS,CAC1B/B,OAAQsyD,EAAAA,GAA2BsE,OAEvC,GACA,CAACnB,EAAe76C,EAAWvM,EAAMmkD,IAQnC,MAAO,CAAE33C,aAAYC,cALapN,EAAAA,EAAAA,cAAY,KAC5CoN,IACA03C,EAAmB,KAAK,GACvB,CAAC13C,EAAc03C,IAE4CrhC,kBAAiB5B,mBAAkBid,iBACnG,EAEMj9C,EAAS,CACbynE,qBAAsB,CACpBjpE,SAAU,SACVq4C,IAAK,EACLz3C,KAAM,EACN1F,MAAO,OACPC,OAAQ,OACR2E,SAAU,QACVy4C,cAAe,OACfse,OAAQC,EAAAA,EAAuBsS,mBAEjCF,mBAAqB1mE,IAAY,CAC/Bq0D,OAAQC,EAAAA,EAAuBuS,QAC/BvpE,SAAU,WACVQ,QAASkC,EAAMgN,QAAQC,GACvBxC,gBAAiBzK,EAAMuB,OAAOu3C,kBAC9B33C,OAAQ,aAAanB,EAAMuB,OAAOJ,SAClC/C,MAAO,IACPy3C,KAAM,IACNh1C,aAAcb,EAAMW,QAAQo4C,iBAC5B+tB,UAAW9mE,EAAMW,QAAQomE,YAE3BC,eAAgBA,KAAA,CACd,WAAY,CACVliD,QAAS,KACTxnB,SAAU,WACVc,KAAM,EACNy3C,IAAK,EACL13C,MAAO,EACPD,OAAQ,EACRuM,gBAAiB,iB,6OCxiBvB,MAAMw8D,EAAmC3oE,EAAAA,eACvC,SAOW4oE,EAA2C7uE,IAAA,IAAC,SACvDoF,EAAQ,oBACRo4B,GAIDx9B,EAAA,OACCgF,EAAAA,EAAAA,GAAC4pE,EAAiCtzD,SAAQ,CAAClM,MAAOouB,EAAoBp4B,SACnEA,GACyC,EAMjCq4B,EAAqCA,IAAMx3B,EAAAA,WAAiB2oE,GAE5DE,EAAyBA,KACpC,MAAMtxC,EAAsBC,IAE5B,OAAO3Y,EAAAA,EAAAA,cACL,CAAC4Y,EAAyBC,KACxBH,GAAqBxzB,IAAa,IAAD4zB,EAAAY,EAC/B,MAAMX,EAAyC,QAA3BD,EAAG5zB,EAAQ8zB,wBAAgB,IAAAF,OAAA,EAAxBA,EAA0B9gB,QAC3CiyD,EAA6C,QAA7BvwC,EAAGx0B,EAAQ80B,0BAAkB,IAAAN,OAAA,EAA1BA,EAA4B1hB,QACrD,IAAK+gB,IAAmBkxC,EACtB,OAAO/kE,EAGT,MAAM+zB,EAAcF,EAAeG,WAAWC,GAAMA,EAAEvM,OAASgM,IACzDQ,EAAcL,EAAeG,WAAWC,GAAMA,EAAEvM,OAASiM,IAG/D,GAAII,EAAc,GAAKG,EAAc,EACnC,OAAOl0B,EAGT,MAAMm0B,EAAcN,EAAeE,GAC7BixC,EAAcnxC,EAAeK,GAE7B+wC,EAAsBD,EAAYhwC,kBAAoBb,EAAYa,gBAGlEujC,EAAmBwM,EAAiB/wC,WAAWC,GAAMA,EAAEvM,OAASyM,EAAYa,kBAC5EwjC,EAAmBuM,EAAiB/wC,WAAWC,GAAMA,EAAEvM,OAASs9C,EAAYhwC,kBAClF+vC,EAAiBxnD,OAAOg7C,EAAkB,EAAG,IAAKwM,EAAiBxM,GAAmBL,aAAa,IACnG6M,EAAiBxnD,OAAOi7C,EAAkB,EAAG,IAAKuM,EAAiBvM,GAAmBN,aAAa,IAGnG,MAAMgN,EAAiB,IAAK/wC,GAiB5B,OAhBA+wC,EAAelwC,gBAAkBgwC,EAAYhwC,gBAG7CnB,EAAetW,OAAOwW,EAAa,GAC9BkxC,EASHpxC,EAAetW,OAAO2W,EAAa,EAAGgxC,GAPtCrxC,EAAetW,OACbsW,EAAeG,WAAWC,GAAMA,EAAEvM,OAASiM,IAC3C,EACAuxC,GAOG,IACFllE,EACH8zB,iBAAkBD,EAClBiB,mBAAoBiwC,EACrB,GACD,GAEJ,CAACvxC,GACF,EAGUirB,EAAqCA,KAChD,MAAMjrB,EAAsBC,IAC5B,OAAQ0xC,IACN,MAAMC,EAAiBl1C,EAAAA,GAAqBm1C,UAAU,IACjDF,EACHz9C,MAAM3O,EAAAA,EAAAA,QAIHosD,EAAez9C,KAOlB8L,GAAqBxzB,IAAO,IAAAu0B,EAAA,MAAM,IAC7Bv0B,EACH8zB,iBAA0C,QAA1BS,EAAEv0B,EAAQ8zB,wBAAgB,IAAAS,OAAA,EAAxBA,EAA0B3qB,KAAK07D,GAC3CA,EAAkB59C,OAASy9C,EAAez9C,KACrC09C,EAEFE,IAEV,IAdD9xC,GAAqBxzB,IAAO,IACvBA,EAEH8zB,iBAAkB9zB,EAAQ8zB,kBAAoB,IAAI9zB,EAAQ8zB,iBAAkBsxC,MAYhF,CACD,EAGUG,EAAwBA,KACnC,MAAM/xC,EAAsBC,IAC5B,MAAO,CAACC,EAAyBW,KAC/Bb,GAAqBxzB,IAAa,IAAD00B,EAAAD,EAC/B,MAAMZ,EAAyC,QAA3Ba,EAAG10B,EAAQ8zB,wBAAgB,IAAAY,OAAA,EAAxBA,EAA0B5hB,QAC3CiyD,EAA6C,QAA7BtwC,EAAGz0B,EAAQ80B,0BAAkB,IAAAL,OAAA,EAA1BA,EAA4B3hB,QACrD,IAAK+gB,IAAmBkxC,EACtB,OAAO/kE,EAGT,MAAM+zB,EAAcF,EAAeG,WAAWC,GAAMA,EAAEvM,OAASgM,IAC/D,GAAIK,EAAc,EAChB,OAAO/zB,EAET,MAAMm0B,EAAcN,EAAeE,GAE7BmxC,EAAiB,IAAK/wC,GAC5B+wC,EAAelwC,gBAAkBX,EAGjC,MAAMkkC,EAAmBwM,EAAiB/wC,WAAWC,GAAMA,EAAEvM,OAASyM,EAAYa,kBAC5EwjC,EAAmBuM,EAAiB/wC,WAAWC,GAAMA,EAAEvM,OAAS2M,IAQtE,OAPA0wC,EAAiBxnD,OAAOg7C,EAAkB,EAAG,IAAKwM,EAAiBxM,GAAmBL,aAAa,IACnG6M,EAAiBxnD,OAAOi7C,EAAkB,EAAG,IAAKuM,EAAiBvM,GAAmBN,aAAa,IAGnGrkC,EAAetW,OAAOwW,EAAa,GACnCF,EAAepe,KAAKyvD,GAEb,IACFllE,EACH8zB,iBAAkBD,EAClBiB,mBAAoBiwC,EACrB,GACD,CACH,EAGUS,EAAuBA,KAClC,MAAMhyC,EAAsBC,IAE5B,OAAO3Y,EAAAA,EAAAA,cACJ2qD,IACCjyC,GAAqBxzB,IAAO,IAAAm1B,EAAAO,EAAA,MAAM,IAC7B11B,EACH8zB,iBAAkB2xC,EAAe7N,YACL,QADgBziC,EACxCn1B,EAAQ8zB,wBAAgB,IAAAqB,OAAA,EAAxBA,EAA0BvrB,KAAK87D,GAC7BA,EAAMh+C,OAAS+9C,EAAe/9C,KAAO,IAAKg+C,EAAO9vC,SAAS,GAAS8vC,IAE7C,QADvBhwC,EACD11B,EAAQ8zB,wBAAgB,IAAA4B,OAAA,EAAxBA,EAA0B/sB,QAAQ+8D,GAAUA,EAAMh+C,OAAS+9C,EAAe/9C,OAC/E,GAAE,GAEL,CAAC8L,GACF,C,4MCtKH,MAAMmyC,EAAmCC,EAAAA,EAAG;;;;;;;;;;;;;;;;;;EC2K/B1+C,EAA2BzV,IAQtC,MAAM,WAAE0O,EAAU,QAAEzN,EAAO,mBAAED,EAAkB,SAAEF,GAAad,EAIxDo0D,GAAmBC,EAAAA,EAAAA,OAA6D,IAAtB3lD,EAAW1qB,QAAgB8c,EAAS9c,QAAU,IAExGswE,EAtKoCt0D,KAQ1C,MAAM,WAAE0O,EAAU,SAAE5N,EAAQ,QAAEG,EAAO,WAAEyU,EAAU,MAAEvJ,EAAK,mBAAEnL,GAAuBhB,EAC3EkB,GAAWC,EAAAA,EAAAA,OAEX,iBAAEoU,EAAgB,UAAEC,EAAS,aAAEsvB,IAAiBwD,EAAAA,EAAAA,KACnDisB,IACC,MAAMC,GAAWC,EAAAA,EAAAA,IAAwBtoD,GAEzC,IAAIuoD,GAAmB,EACnBC,GAAgB,EAEpB,MAAMC,EAAsC9zD,EAAS3I,KAAKuF,IACxD,MAAMm3D,EAAqBnmD,EAAW1c,QACpC,CAAC8iE,EAAuDxrD,KAAuB,IAADyrD,EAAAC,EAC5E,MAAMC,EAA+D,QAAlDF,EAAGR,EAAM1hD,SAASw1B,wBAAwB3qC,UAAQ,IAAAq3D,GAAa,QAAbC,EAA/CD,EAAkDzrD,UAAU,IAAA0rD,OAAb,EAA/CA,EAA+DR,GAErF,OAAKS,GAILN,EAAgBA,GAAiB7kE,QAAQmlE,EAAcC,SACvDR,EAAmBA,GAAoB5kE,QAAQmlE,EAAcE,YAE7DL,EAAgBxrD,GAAa2rD,EACtBH,GAPEA,CAOa,GAExB,CAAC,GAGH,MAAO,CACLp3D,aACGm3D,EACJ,IAGH,MAAO,CACLr/C,UAAWm/C,EACX7vB,aAAc4vB,EACdn/C,kBAAkB6/C,EAAAA,EAAAA,OAAMR,EAAc,WACvC,IAEH,CAACtqE,EAAMD,KACLwxC,EAAAA,EAAAA,SAAQvxC,EAAKirB,iBAAkBlrB,EAAMkrB,mBACrCjrB,EAAKkrB,YAAcnrB,EAAMmrB,WACzBlrB,EAAKw6C,eAAiBz6C,EAAMy6C,eAG1BuwB,GAAYhsD,EAAAA,EAAAA,cAAY,KAC5BqF,EAAWlN,SAAS8H,KAClBgsD,EAAAA,EAAAA,OAAMx0D,EAjEiC,KAiEeU,SAAS+zD,IAC7D,MAAMC,GAASC,EAAAA,EAAAA,GAAkCF,EAAejsD,EAAWoM,EAAYvJ,EAAO,OAC9FjL,EAASs0D,EAAO,GAChB,GACF,GACD,CAACt0D,EAAUwU,EAAY5U,EAAU4N,EAAYvC,IAE1CzK,GAAoBpT,EAAAA,EAAAA,aAA2BoC,GAC/CiR,GAAwBrT,EAAAA,EAAAA,QAAO0S,GAAsBhB,EAAOiB,SAClEU,EAAsBpT,QAAUyS,GAAsBhB,EAAOiB,QAI7D,MAAMG,GAAqB9K,EAAAA,EAAAA,UAAQ,IAAMwK,EAAStO,KAAK,MAAM,CAACsO,IA4E9D,OAzEA3P,EAAAA,EAAAA,YAAU,KACH8P,IAAWD,GAGhB0N,EAAWlN,SAAS8H,KAClBgsD,EAAAA,EAAAA,OAAMx0D,EAtFiC,KAsFeU,SAAS+zD,IAC7D,MAAMC,GAASC,EAAAA,EAAAA,GAAkCF,EAAejsD,EAAWoM,EAAYvJ,GACvFjL,EAASs0D,EAAO,GAChB,GACF,GACD,CAACt0D,EAAUwU,EAAY5U,EAAU4N,EAAYvC,EAAOlL,EAASD,KAGhE7P,EAAAA,EAAAA,YAAU,KACR,IAAI0Q,GAAgB,EACpB,IAAKZ,IAAYD,EACf,OAIF,MAAM00D,EAAiB3zD,iBAAqC,IAA9B4zD,EAAgB5xE,UAAAC,OAAA,QAAA0M,IAAA3M,UAAA,IAAAA,UAAA,GAC5C,MAAM+c,EAAWM,EAAmBG,MAAM,KAAKrK,QAAQwG,GAAgC,KAAZA,UACrEwG,QAAQC,IACZuK,EAAWvW,KAAI4J,SACbmC,QAAQC,KACNmxD,EAAAA,EAAAA,OAAMx0D,EA1G2B,KA0GqB3I,KAAI4J,SACxDb,GACEu0D,EAAAA,EAAAA,GACEF,EACAjsD,EACAoM,EACAvJ,EACAwpD,EAAmB,YAASjlE,SAO1C,EAEMyR,EAAkBJ,UAEtB,GAAKJ,EAAsBpT,UAAWsT,EAAtC,CAGA,UACQ6zD,GAAe,EACvB,CAAE,MAAO5xE,GAEPub,EAAAA,EAAMuB,sBAAsB9c,EAC9B,CACAse,aAAaV,EAAkBnT,SAG1BoT,EAAsBpT,UAAWsT,IAItCH,EAAkBnT,QAAUwE,OAAOsP,WAAWF,EAAiByzD,EAAAA,IAd/D,CAc4G,EAK9G,OAFAF,IAAiBnzD,KAAKJ,GAEf,KAELN,GAAgB,EAGhBO,aAAaV,EAAkBnT,QAAQ,CACxC,GACA,CAAC2S,EAAUwU,EAAYtU,EAAoBsN,EAAYvC,EAAOlL,EAASD,IAEnE,CAAEwU,YAAWsvB,eAAcvvB,mBAAkBsgD,QAASR,EAAW,EAqBnDS,CAA4B,IAC5C91D,EACHiB,QAASA,IAAYmzD,EACrBpzD,mBAAoBA,IAAuBozD,IAGvC2B,ED3KsCxxE,KAcvC,IAADyxE,EAAAC,EAAAC,EAAA,IAdyC,UAC7C5sD,EAAS,SACTxI,EAAQ,mBACRE,EAAkB,QAClBC,EAAO,WACPyU,EAAa,IAAG,MAChBvJ,GAQD5nB,EACC,MAAM+f,GAAO2D,EAAAA,EAAAA,MACP,KAAEgS,EAAI,QAAEk8C,EAAO,aAAEC,EAAY,YAAEC,EAAW,cAAEC,EAAa,MAAEC,IAAUC,EAAAA,EAAAA,GACzEtC,EACA,CACEuC,MAAOx1D,EACPy1D,6BAA6B,EAC7BC,aAAc31D,EAAqB40D,EAAAA,QAA+CllE,EAClFkmE,WAAAA,CAAY38C,GAAO,IAAD48C,EAAAC,EAAAC,EAAAC,EACgD,6BAArB,QAAvCH,EAAA58C,EAAKg9C,0CAAkC,IAAAJ,GAAU,QAAVC,EAAvCD,EAAyCK,gBAAQ,IAAAJ,OAAV,EAAvCA,EAAmDK,MACrD93D,EAAAA,EAAM+3D,+BACJ9yD,EAAKC,cAAc,CAAArf,GAAA,SACjB6S,eAAe,uCAK6B,QAA3Cg/D,EAAI98C,EAAKg9C,0CAAkC,IAAAF,GAAU,QAAVC,EAAvCD,EAAyCG,gBAAQ,IAAAF,GAAjDA,EAAmDnwD,SAC5DxH,EAAAA,EAAMuB,sBAAsB,IAAI6G,MAAMwS,EAAKg9C,mCAAmCC,SAASrwD,SAE3F,EACAiE,UAAW,CACTmP,KAAM,CACJo9C,OAAQv2D,EACRwI,YACAguD,UAAqB,QAAZtB,EAAO,OAAL7pD,QAAK,IAALA,OAAK,EAALA,EAAQ,UAAE,IAAA6pD,EAAAA,EAAI,KACzBuB,QAAmB,QAAZtB,EAAO,OAAL9pD,QAAK,IAALA,OAAK,EAALA,EAAQ,UAAE,IAAA8pD,EAAAA,EAAI,KACvBvgD,iBA4CR,OAtCAvkB,EAAAA,EAAAA,YAAU,KACJ6P,EACFo1D,EAAaR,EAAAA,IAEbS,GACF,GACC,CAACr1D,EAAoBo1D,EAAcC,IAgC/B,CACL9gD,kBA/BuBjf,EAAAA,EAAAA,UAA6C,KACpE,GAAI2jB,EAAM,CAAC,IAADu9C,EACR,MAAM1uC,EAAc,OAAJ7O,QAAI,IAAJA,GAAwC,QAApCu9C,EAAJv9C,EAAMg9C,0CAAkC,IAAAO,OAApC,EAAJA,EAA0C1uC,QACpD2uC,GAAiBhkD,EAAAA,EAAAA,SAAQqV,EAAS,SAGxC,OAAOssC,EAAAA,EAAAA,OACLt0D,EAAS3I,KACN4L,IAAK,IAAA2zD,EAAA,MACH,CACCh6D,QAASqG,EACT,CAACuF,GAAY,CACXuM,eAAqC,QAAvB6hD,EAAED,EAAe1zD,UAAM,IAAA2zD,OAAA,EAArBA,EAAuBv/D,KAAI/M,IAAA,IAAC,IAAE4D,EAAG,KAAEqrB,EAAI,UAAEwa,EAAS,MAAElhC,GAAOvI,EAAA,MAAM,CAC/E4D,IAAQ,OAAHA,QAAG,IAAHA,EAAAA,OAAO0B,EACZ2pB,KAAM/I,OAAO+I,GACbwa,UAAWvjB,OAAOujB,GAClBlhC,MAAY,OAALA,QAAK,IAALA,EAAAA,OAASjD,EACjB,KAEJ,IAEL,UAEJ,CAEA,MAAO,CAAC,CAAC,GACR,CAACupB,EAAM3Q,EAAWxI,IAMnB0U,UAJgB8gD,IAAkBqB,EAAAA,EAAczC,SAAWoB,IAAkBqB,EAAAA,EAAcC,aAK3F9yB,aAJmBwxB,IAAkBqB,EAAAA,EAAcE,KAKnDhC,QAASM,EACTI,QACAW,SAAc,OAAJj9C,QAAI,IAAJA,GAAwC,QAApCi8C,EAAJj8C,EAAMg9C,0CAAkC,IAAAf,OAApC,EAAJA,EAA0CgB,SACrD,EC+EqBY,CAA+B,IAChD93D,EACHsJ,UAAWoF,EAAW,GACtBzN,QAASA,GAAWmzD,EACpBpzD,mBAAoBA,GAAsBozD,IAG5C,OAAOA,EAAmB2B,EAAgBzB,CAAY,C,2MCxMjD,MAAM5hB,EAAuC,IAEvC7C,EAAmC,SAAC3d,GAA0B,IAAhBC,EAAMpuC,UAAAC,OAAA,QAAA0M,IAAA3M,UAAA,GAAAA,UAAA,GAAG,EAClE,GAAmB,kBAARmuC,EACT,OAAOA,EAAIE,QAAQD,GACd,GAAmB,kBAARD,EAChB,OAAOA,EAET,IACE,OAAOxnC,KAAKK,UAAUmnC,EACxB,CAAE,MACA,OAAOwgB,CACT,CACF,EAEO,IAAKyB,EAA4B,SAA5BA,GAA4B,OAA5BA,EAAAA,EAA4B,uBAA5BA,EAAAA,EAA4B,uBAA5BA,EAAAA,EAA4B,eAA5BA,CAA4B,MAKjC,MAAMlE,EAAiBA,CAAClgC,EAAQC,KACrC,GAAiB,kBAAND,GAA+B,kBAANC,EAE7B,CACL,MAAMwpB,EAAOzpB,EAAIC,EACjB,OAAa,IAATwpB,EACK,CAAEzyB,MAAO8oC,EAAiCrW,GAAM74B,WAAYszC,UAAWE,EAA6BG,MAClG9a,EAAO,EACT,CAAEzyB,MAAO,IAAI8oC,EAAiCrW,KAASya,UAAWE,EAA6BE,UAE/F,CACLttC,MAAO8oC,EAAiCrW,GAAM74B,WAC9CszC,UAAWE,EAA6BC,SAG9C,GAGW2jB,EAAcA,CAAChoD,EAAQC,IAC9BD,IAAM2iC,GAAwC1iC,IAAM0iC,WAI7C3iC,WAAaC,IAEA,kBAAND,GAA+B,kBAANC,EAClC7C,KAAKszB,IAAI1wB,EAAIC,GA7CG,KA8CD,kBAAND,GAA+B,kBAANC,GAClCD,IAAMC,IAKJ6+B,EAA8BA,CACzCt7B,EACAC,EACAwkD,EACAvkD,KAEA,MAAMwkD,EAAaA,CACjBC,EACAC,EACAC,IAQaljD,MAAMC,KAAK,IAAIF,IAAI1B,EAAYW,SAAS9X,GAAY+7D,EAAY/7D,OAC1ElF,QAAQlI,GAAQkpE,EAAgBlpE,KAChC6vB,OACiB3K,SAASllB,IAC3B,MAAMirB,EAAwC,CAAC,EAC/C,IAAIo+C,GAAgB,EAcpB,OAZA9kD,EAAY/R,SAAQ,CAACpF,EAAS8F,KAK5B,GAHA+X,EAAK7d,EAAQ6Z,MAAQmiD,EAAiBh8D,GAASpN,GAC3CopE,EAAiBh8D,GAASpN,GAAK2E,MAC/B++C,EACAxwC,EAAQ,EAAG,CACb,MAAMkN,EAAOmE,EAAYrR,EAAQ,GAC7B61D,EAAY99C,EAAK7K,EAAK6G,MAAOgE,EAAK7d,EAAQ6Z,SAC5CoiD,GAAgB,EAEpB,KAEE7kD,EAAW2F,sBAAwBk/C,EAC9B,GAEF,CACL,CACE,CAACL,GAAkBhpE,KAChBirB,GAEN,IAKCw0B,EAAewpB,GAClBzvD,IAAoBA,EAAOiI,WAAW6nD,EAAAA,MACtCl8D,GAA+B1Y,OAAO23B,KAAKjf,EAAQ0sB,WACnD1sB,GAA+BA,EAAQ0sB,UAGpC4lB,EAAgBupB,GACnBzvD,GAAmBA,EAAOiI,WAAW6nD,EAAAA,MACrCl8D,GAA+B1Y,OAAO23B,KAAKjf,EAAQ0sB,WACnD1sB,GAA+BA,EAAQ0sB,UAG1C,GAAIrV,EACF,MAAO,CAAEg7B,eAAcC,gBAAeC,WAAY,GAAIryC,KAAM,GAAIsyC,WAAY,IAwD9E,MAAO,CAAEH,eAAcC,gBAAeC,WArDnBspB,GACjB,KAAM,IACL77D,GAA+B1Y,OAAO23B,KAAKjf,EAAQ4D,UACnD5D,GAA+BA,EAAQ4D,SAkDQ1D,KA/CrC27D,GACX,KAAM,IACL77D,GAA+BiD,EAAAA,EAAMk5D,oBAAoBn8D,EAAQE,MAAMnE,KAAI5T,IAAA,IAAEyK,GAAIzK,EAAA,OAAKyK,CAAG,MACzFoN,GAA+BA,EAAQE,OA4CcsyC,WAxChC,CACtB4pB,EAAAA,GAAyBC,KACzBD,EAAAA,GAAyBE,OACzBF,EAAAA,GAAyBG,QACzBH,EAAAA,GAAyBI,QAEQ1kD,SAAS2kD,IAC1C,MAAMC,EAAiD,CAAC,EACxD,IAAIT,GAAgB,EAsBpB,OArBA9kD,EAAY/R,SAAQ,CAACpF,EAAS8F,KAC5B,GAAI22D,IAAcL,EAAAA,GAAyBC,KAAM,CAC/C,MAAMM,EAAO15D,EAAAA,EAAM25D,QAAQ58D,EAAQmY,QAASnY,EAAQE,MACpDw8D,EAAc18D,EAAQ6Z,MAAQ8iD,CAChC,MAAO,GAAIF,IAAcL,EAAAA,GAAyBE,OAAQ,CACxD,MAAM/8D,EAAS0D,EAAAA,EAAM45D,cAAc78D,EAAQE,MAC3Cw8D,EAAc18D,EAAQ6Z,MAAQta,CAChC,MAAO,GAAIk9D,IAAcL,EAAAA,GAAyBG,QAAS,CACzD,MAAMjmE,EAAU2M,EAAAA,EAAM65D,iBAAiB98D,EAAQE,MAC/Cw8D,EAAc18D,EAAQ6Z,MAAQvjB,CAChC,KAAO,CACL,MAAMymE,EAAS95D,EAAAA,EAAM+5D,wBAAwBh9D,EAAQE,MACrDw8D,EAAc18D,EAAQ6Z,MAAQkjD,EAAO3mE,KAAK,IAC5C,CACA,GAAI0P,EAAQ,EAAG,CACb,MAAMkN,EAAOmE,EAAYrR,EAAQ,GAC7B61D,EAAYe,EAAc1pD,EAAK6G,MAAO6iD,EAAc18D,EAAQ6Z,SAC9DoiD,GAAgB,EAEpB,KAEE7kD,EAAW2F,sBAAwBk/C,EAC9B,GAEF,CACL,CACE,CAACL,GAAkBa,KAChBC,GAEN,IAEiE,C,mIC3K/D,MAAMO,EAA4B,SAEvCC,EAOAntD,GAIkC,IADlCotD,IAAoBx1E,UAAAC,OAAA,QAAA0M,IAAA3M,UAAA,KAAAA,UAAA,GAIpB,MAAMy1E,GAAcn4B,EAAAA,EAAAA,UAClBx5B,EAAAA,EAAAA,UACE3M,EAAAA,EAAAA,QAAOo+D,GACJnhE,KAAI5T,IAAA,IAAC,eAAEsxB,GAAgBtxB,EAAA,OAAKsxB,CAAc,IAC1CikB,QAEL,aAIF,GAAI0/B,EAAYx1E,OAAS,EACvB,OAKF,MAAMklD,EAAa,IAAIp+C,KAAKqhB,EAAM,IAAIstD,UAChCrwB,EAAa,IAAIt+C,KAAKqhB,EAAM,IAAIstD,UAGtC,IAAIC,EAAaH,GAAuBI,EAAAA,EAAAA,OAAMH,QAAe9oE,EAE7D,IAAK,IAAIwR,EAAQ,EAAGA,EAAQs3D,EAAYx1E,OAAQke,IAAS,CACvD,MAAM9N,EAAQolE,EAAYt3D,GAC1B,GAAI9N,EAAMygC,UAAYqU,EAAY,CAChCwwB,EAAaF,EAAYt3D,EAAQ,IAAM9N,EACvC,KACF,CACF,CAGA,IAAIwlE,EAAaL,GAAuBjQ,EAAAA,EAAAA,MAAKkQ,QAAe9oE,EAE5D,IAAK,IAAIwR,EAAQs3D,EAAYx1E,OAAS,EAAGke,GAAS,EAAGA,IAAS,CAC5D,MAAM9N,EAAQolE,EAAYt3D,GAC1B,GAAI9N,EAAMygC,UAAYuU,EAAY,CAChCwwB,EAAaJ,EAAYt3D,EAAQ,IAAM9N,EACvC,KACF,CACF,CAGA,OAAI8Y,EAAAA,EAAAA,aAAYwsD,KAAexsD,EAAAA,EAAAA,aAAY0sD,QAA3C,EAKO,CAACF,EAAWr/C,KAAMu/C,EAAWv/C,KACtC,EAWa4uB,EAAmCA,CAC9C4wB,EACA/4D,EACAwI,EACA6C,KAEA,MAAM2tD,GAAmBjyD,EAAAA,EAAAA,SACvB/G,EAAS3I,KAAKuF,IAAa,IAADq8D,EACxB,MAAMC,EAA6C,QAA1BD,EAAGF,EAAen8D,UAAQ,IAAAq8D,OAAA,EAAvBA,EAA0BzwD,GACtD,OAAO0wD,EAAsBX,EAA0BW,EAAqB7tD,GAAO,QAASzb,CAAS,KAGnGw4C,GAAax3B,EAAAA,EAAAA,KAAIooD,EAAiB3hE,KAAI/M,IAAA,IAAE6uE,GAAM7uE,EAAA,OAAK6uE,CAAK,KACxD7wB,GAAa53B,EAAAA,EAAAA,KAAIsoD,EAAiB3hE,KAAInN,IAAA,IAAE,CAAEivE,GAAMjvE,EAAA,OAAKivE,CAAK,KAEhE,KAAK/sD,EAAAA,EAAAA,aAAYg8B,MAAgBh8B,EAAAA,EAAAA,aAAYk8B,GAC3C,MAAO,CAACF,EAAYE,EAGN,EAYLkB,EAA6C,SACxD4vB,EACAp5D,EACAq5D,GAEkC,IADlCC,EAAUr2E,UAAAC,OAAA,QAAA0M,IAAA3M,UAAA,GAAAA,UAAA,GAAG,IAEb,MAAM+1E,GAAmBjyD,EAAAA,EAAAA,SACvB/G,EAAS3I,KAAKuF,IAAa,IAAD28D,EACxB,MAAMj+D,EAAU89D,EAAwBx8D,GAExC,IAAKtB,EACH,OAAO,KAIT,MAAQsB,QAASrG,KAAMijE,GAAel+D,EAGhCm+D,GAA6Br/D,EAAAA,EAAAA,QAAOo/D,GAAYpmD,SAAS1L,IAAM,IAAAgyD,EAAA,OAA0B,QAA1BA,EAAKhyD,EAAOqN,sBAAc,IAAA2kD,EAAAA,EAAI,EAAE,IAG/FC,GAAgE,QAA9CJ,GAAA/hC,EAAAA,EAAAA,OAAMiiC,EAA4B,oBAAY,IAAAF,OAAA,EAA9CA,EAAgDxlC,YAAa,EAIrF,MAAO,CAACslC,EAAc,GAAKC,EAAaK,EAAiBN,EAAc,GAAKC,EAAaK,EAAgB,KAMvGvxB,GAAax3B,EAAAA,EAAAA,KAAIooD,EAAiB3hE,KAAIpI,IAAA,IAAEkqE,GAAMlqE,EAAA,OAAKkqE,CAAK,KACxD7wB,GAAa53B,EAAAA,EAAAA,KAAIsoD,EAAiB3hE,KAAIE,IAAA,IAAE,CAAE4hE,GAAM5hE,EAAA,OAAK4hE,CAAK,KAChE,KAAK/sD,EAAAA,EAAAA,aAAYg8B,MAAgBh8B,EAAAA,EAAAA,aAAYk8B,GAC3C,MAAO,CAACF,EAAYE,EAIxB,C,qECxJO,MAAMoX,EAAyB,CACpCQ,aAAc,EACdP,aAAc,EACdqS,kBAAmB,EACnB4H,WAAY,EACZ3H,QAAS,E,uIC0BJ,MAAM38C,EAAyB7xB,IAQD,IARE,kBACrC8xB,EAAiB,QACjBpV,EAAO,kBACP+S,EAAiB,WACjBtF,EAAU,4BACV4H,EAA2B,uBAC3BxJ,EAAsB,eACtB2C,GAC6BlrB,EAC7B,OAAO+R,EAAAA,EAAAA,UAAQ,KACb,IAAK2K,IAAY+S,EACf,OAAOqC,EA0DT,MAAO,IAtDmCA,EACvCnf,QAAO9L,IAAA,IAAC,gBAAE2oB,GAAiB3oB,EAAA,OAAK2oB,CAAe,IAC/C5b,KAAK0gB,IACJ,MAAMqhB,EAAmE,CAAC,EAC1ExrB,EAAWlN,SAAS8H,IAAe,IAADuhC,EAChC8vB,IAAU9hD,EAAM9E,gBAAiB,qCAEjC,MAAM6mD,EACwC,QADf/vB,EAC7BhyB,EAAM9E,gBAAgB8mD,8BAAsB,IAAAhwB,EAAAA,EAAIhyB,EAAM9E,gBAAgBjT,SAExE,IAAIg6D,EACJ,IAAK/xC,EAAAA,EAAAA,OAAMjc,GAOJ,CACL,MAAMiuD,GAAwBlzD,EAAAA,EAAAA,SAC5B+yD,EAA0B1mD,SAASxW,IAAa,IAADs9D,EAAAC,EAC7C,MAAMplD,EAAqD,QAAvCmlD,EAAG1kD,EAA4B5Y,UAAQ,IAAAs9D,GAAa,QAAbC,EAApCD,EAAuC1xD,UAAU,IAAA2xD,OAAb,EAApCA,EAAmDplD,eAC1E,OAAIpG,EACKoG,GAAiBK,EAAAA,EAAAA,IAAgCL,QAAkBnlB,EAErEmlB,CAAc,KAKnBqlD,GAAQt9B,EAAAA,EAAAA,MAAKm9B,EAAsB5iE,KAAKgjE,GAAMA,EAAE9gD,QAAOwE,MAAK,CAAC9O,EAAGC,IAAMD,EAAIC,IAEhF8qD,GAAoCM,EAAAA,EAAAA,IAA8BF,EAAO5xD,EAAWyxD,EACtF,MArBED,GAAoCO,EAAAA,EAAAA,KAClC9yB,EAAAA,EAAAA,MAAKjyB,EAA6BskD,GAClCtxD,EACAwD,EACA2C,GAmBJyqB,EAAyB5wB,GAAawxD,CAAiC,IAEzE,MAAMjlD,EAAiBnH,EAAW1c,QAA4B,CAACC,EAAKjD,KAClE,MAAMgnB,EAAUkkB,EAAyBlrC,GAAKglB,GAI9C,OAHIgC,GAAWA,EAAQhyB,OAAS,IAC9BiO,EAAIjD,GAAOgnB,GAEN/jB,CAAG,GACT,CAAC,GAEJ,MAAO,IACF4mB,EACHhD,iBACAqkB,2BACD,OAGiB7jB,EAAkBnf,QAAOlM,IAAA,IAAC,eAAEopB,GAAgBppB,EAAA,OAAwB,IAAnBopB,CAAwB,IAErD,GACzC,CACD1F,EACA4H,EACAD,EACApV,EACA+S,EACAlH,EACA2C,GACA,C,iKCnGJ,MAAM6rD,EAA2B,sCAC3BC,EAAoC,oCAEpCC,EAAgC16D,GAE7B,cADgBA,EAAS3I,KAAK4L,GAAe,IAAIA,OACpBvR,KAAK,QAiD9BipE,EAAsBl3E,IAe5B,IAf6B,cAClCm3E,EAAa,QACbC,EAAO,OACPzkE,EAAS,GAAE,QACXwG,EAAO,cACPk+D,GAUDr3E,EACC,MAAOs3E,EAAQC,IAAa1rE,EAAAA,EAAAA,UAAsC,KAC3D8kE,EAAS6G,IAAc3rE,EAAAA,EAAAA,WAAkB,IACzCmmE,EAAOyF,IAAY5rE,EAAAA,EAAAA,eAA4BM,GAGhDurE,GAAgB3lE,EAAAA,EAAAA,UAAQ,KAC5B,MAAM4lE,GAAqBvC,EAAAA,EAAAA,OAAMgC,GACjC,OAAIO,GAAsBC,EAAAA,GAAmC3kE,SAAS0kE,EAAmBh3E,IAChF,GAAGg3E,EAAmBh3E,MAAMg3E,EAAmBE,KAAO,OAAS,QAEjE,mBAAmB,GACzB,CAACT,IAEEU,GAAe/lE,EAAAA,EAAAA,UAAQ,IACtBoH,GAAYk+D,GAIbU,EAAAA,EAAAA,OAAuCV,EACrC1kE,EACK,GAAGA,SAAcqkE,MAAsCK,KAEzD,GAAGL,MAAsCK,KAG9C1kE,EACK,GAAGA,SAAcokE,MAA6B59D,KAGhD,GAAG49D,MAA6B59D,KAd9BxG,GAeR,CAACA,EAAQwG,EAASk+D,KAEdW,EAAYC,IAAiBpsE,EAAAA,EAAAA,UAA6C,CAAE,OAAGM,KAC/E+rE,EAAaC,IAAkBtsE,EAAAA,EAAAA,UAAS,GACzCusE,EAAmBJ,EAAWE,GAE9BG,GAAcvzD,EAAAA,EAAAA,cAClBtH,UAcO,IAdA,cACL25D,EAAa,YACbe,EAAc,EAAC,UACfI,EAAS,OACTC,EAAM,cACNb,EAAgB,GAAE,aAClBI,EAAe,IAQhBjxE,EACM0xE,GACHf,GAAW,GAEbC,OAAStrE,GAET,IACE,MAAMqsE,QAAiBC,EAAAA,EAAcC,oBAAoBvB,EAAeO,EAAeY,EAAWR,GAElG,IAAKU,EAASlB,OAEZ,YADAC,EAAU,IAIZ,MAAMoB,OA5HiBn7D,OAAO25D,EAAyBG,KAC7D,MAAMsB,EAAoBtB,EAAO7pE,QAA+B,CAACC,EAAK6+B,KACpE,MAAMssC,EAAUtsC,EAAMusC,WAChBt5D,GAAQu5D,EAAAA,EAAAA,GAAkBxsC,GAChC,OAAKssC,GAAYr5D,EAGV,IAAK9R,EAAK,CAACmrE,GAAUr5D,GAFnB9R,CAE0B,GAClC,CAAC,GAEE6O,GAAW88B,EAAAA,EAAAA,OAAK1iC,EAAAA,EAAAA,QAAOiiE,IAC7B,GAAIr8D,EAAS9c,OAAS,EACpB,MAAO,CAAC,EAEV,MAQMu5E,UARqBP,EAAAA,EAAcQ,WAAW,CAClDC,eAAgB/B,EAChBxkE,OAAQskE,EAA6B16D,GACrC48D,cAAeC,EAAAA,GAASC,OAGD39C,MAES,IAAIjuB,QAA+B,CAACC,EAAK2jB,KAClE,IAAK3jB,EAAK,CAAC2jB,EAAIioD,KAAKngE,SAAUkY,EAAIioD,KAAKjgE,WAC7C,CAAC,GAYJ,OAV2Bi+D,EAAO7pE,QAA+B,CAACC,EAAK6+B,KACrE,MAAMssC,EAAUtsC,EAAMusC,WACtB,IAAKD,EACH,OAAOnrE,EAET,MAAM8R,EAAQo5D,EAAkBC,GAEhC,MAAO,IAAKnrE,EAAK,CAACmrE,GAAUG,EAAiBx5D,IAAUA,EAAO,GAC7D,CAAC,EAEqB,EAwFa+5D,CAAuBpC,EAAeqB,EAASlB,QACzEkC,EAAqBhB,EAASlB,OAAO1jE,KAAK24B,IAC9C,MAAMssC,EAAUtsC,EAAMusC,WACtB,IAAKD,EACH,MAAO,IAAKtsC,GAEd,MAAMlzB,EAAUs/D,EAAkBE,GAClC,MAAO,IAAKtsC,EAAOlzB,UAAS,IAG9Bk+D,EAAUiC,GACVvB,GAAewB,IACN,IAAKA,EAAW,CAACvB,EAAc,GAAIM,EAASkB,mBAEvD,CAAE,MAAOn6E,GACPk4E,EAASl4E,EACX,CAAC,QACCi4E,GAAW,EACb,IAEF,IAGImC,GAAehJ,QAA2CxkE,IAAhC6rE,EAAWE,EAAc,GACnD0B,GAAmBjJ,IAA4B,IAAhBuH,QAAqD/rE,IAAhC6rE,EAAWE,EAAc,KAEnFtrE,EAAAA,EAAAA,YAAU,KACRyrE,EAAY,CAAElB,gBAAeW,eAAcJ,iBAAgB,GAC1D,CAACW,EAAaP,EAAcX,EAAeO,IAE9C,MAAMmC,GAAQ/0D,EAAAA,EAAAA,cAAY,KACxByyD,EAAU,IACVU,EAAc,CAAE,OAAG9rE,IACnBgsE,EAAe,GACfE,EAAY,CAAElB,iBAAgB,GAC7B,CAACkB,EAAalB,IAEX2C,GAAgBh1D,EAAAA,EAAAA,cAAY,KAChCqzD,GAAgB4B,GAAaA,EAAW,IACxC1B,EAAY,CACVlB,gBACAe,YAAaA,EAAc,EAC3BI,UAAWN,EAAWE,EAAc,GACpCJ,eACAJ,iBACA,GACD,CAACP,EAAee,EAAaG,EAAaL,EAAYF,EAAcJ,IAEjEsC,GAAgBl1D,EAAAA,EAAAA,cAAY,KAChCqzD,GAAgB4B,GAAaA,EAAW,IACxC1B,EAAY,CACVlB,gBACAe,YAAaA,EAAc,EAC3BI,UAAWN,EAAWE,EAAc,GACpCJ,eACAJ,iBACA,GACD,CAACP,EAAee,EAAaG,EAAaL,EAAYF,EAAcJ,IAEjEuC,GAAqBn1D,EAAAA,EAAAA,cACzB,WACE,OAAOuzD,EAAY,CACjBlB,gBACAe,cACAI,UAAWF,EACXG,OALG/4E,UAAAC,OAAA,QAAA0M,IAAA3M,UAAA,IAAAA,UAAA,GAMHs4E,eACAJ,iBAEJ,GACA,CAACP,EAAee,EAAaG,EAAaD,EAAkBN,EAAcJ,IAG5E,MAAO,CACLJ,SACA3G,UACAqB,QACA2H,cACAC,kBACAE,gBACAE,gBACAC,qBACAJ,QACD,E,uIClOkE,IAAApzE,EAAA,CAAAC,KAAA,UAAAC,OAAA,kBAE9D,MAAMuzE,EAAyBl6E,IAQ/B,IARgC,cACrCm6E,EAAa,KACbpiE,EAAI,gBACJqiE,GAKDp6E,EACC,MAAM,MAAE2H,IAAUC,EAAAA,EAAAA,KACZyyE,GAAqB,OAAJtiE,QAAI,IAAJA,OAAI,EAAJA,EAAMpF,QAAO9L,IAAA,IAAC,IAAE4D,GAAK5D,EAAA,OAAK4D,IAAQA,EAAIyhB,WAAWouD,EAAAA,GAAuB,MAAK,GAC9FC,EAAeF,EAAe56E,OAAS,EAC7C,OACE4F,EAAAA,EAAAA,IAAA,OACEM,KAAGC,EAAAA,EAAAA,IAAE,CACHmD,QAAS,OACTC,WAAY,aACZwmC,SAAU,OACVz4B,UAAWpP,EAAMgN,QAAQqC,GAAK,EAC9B4nC,OAAQj3C,EAAMgN,QAAQqC,GAAK,GAC5B,IAAC5R,SAAA,CAEDi1E,EAAezmE,KAAKqE,IACnBjT,EAAAA,EAAAA,GAACw1E,EAAAA,GAAW,CAEVviE,IAAKA,EACLtS,IAAGc,EACHg0E,UAAW,GACXxrC,SAAU,IACVyrC,qBAAmB,GALdziE,EAAIxN,OAOT,KACJzF,EAAAA,EAAAA,GAACiD,EAAAA,EAAM,CACLV,YAAa,GAAG6yE,0BAChB5gE,KAAK,QACLtS,KAAOqzE,GAA0Cv1E,EAAAA,EAAAA,GAACoyD,EAAAA,IAAU,KAAtCpyD,EAAAA,EAAAA,GAAC21E,EAAAA,IAAoB,IAC3C1zE,QAASkzE,MAEP,E,eCnCV,MAAMS,EAAUA,CAACtpE,EAA6C3J,IAC7C,gBAAX2J,GACKtM,EAAAA,EAAAA,GAACuM,EAAAA,EAAS,CAAC5L,KAAGC,EAAAA,EAAAA,IAAE,CAAEwD,MAAOzB,EAAMuB,OAAO2xE,uBAAuB,MAGvD,OAAXvpE,GACKtM,EAAAA,EAAAA,GAACmM,EAAAA,IAAe,CAACxL,KAAGC,EAAAA,EAAAA,IAAE,CAAEwD,MAAOzB,EAAMuB,OAAOkI,uBAAuB,MAG7D,UAAXE,GACKtM,EAAAA,EAAAA,GAACgM,EAAAA,IAAW,CAACrL,KAAGC,EAAAA,EAAAA,IAAE,CAAEwD,MAAOzB,EAAMuB,OAAO+H,sBAAsB,MAGhE,KAGI6pE,EAAgG96E,IAEtG,IADL6S,KAAK,SAAEkoE,IACR/6E,EACC,MAAM,MAAE2H,IAAUC,EAAAA,EAAAA,KACZmY,GAAO2D,EAAAA,EAAAA,KAEPs3D,EAAkBC,EAAAA,GAAiCF,EAASzpE,QAAU,SAE5E,OACEjM,EAAAA,EAAAA,IAAA,OAAKM,KAAGC,EAAAA,EAAAA,IAAE,CAAEmD,QAAS,OAAQuE,IAAK3F,EAAMgN,QAAQqC,GAAIhO,WAAY,UAAU,IAAC5D,SAAA,CACxEw1E,EAAQG,EAASzpE,OAAQ3J,GACzBqzE,EAAkBj7D,EAAKC,cAAcg7D,GAAmB,KACrD,EC3BqG,IAAAn0E,EAAA,CAAAH,KAAA,SAAAC,OAAA,iBAAAF,EAAA,CAAAC,KAAA,UAAAC,OAAA,0CAE/G,MAAMu0E,EAA6Bl7E,IAQ5B,IAR6B,MAClCoP,EAAK,QACLypE,EAAO,iBACPsC,GAKDn7E,EACC,MAAM,MAAE2H,IAAUC,EAAAA,EAAAA,MACX4tD,EAAY4lB,IAAiBvvE,EAAAA,EAAAA,WAAS,IACtCwvE,EAAUC,IAAezvE,EAAAA,EAAAA,UAAwB,OAEjD8kE,EAAS6G,IAAc3rE,EAAAA,EAAAA,WAAkB,GAE1C0vE,GAAgBz2D,EAAAA,EAAAA,cAAYtH,UAChCg6D,GAAW,GACX,IACE,MAAMgB,QAAiBC,EAAAA,EAAc+C,uBAGlC3C,GAEH,GAAIsC,KAAoB3C,EAAU,CAChC,MAAMiD,EAAejD,EAAS2C,GACxBO,GAAcxrC,EAAAA,EAAAA,UAASurC,GAAgBA,EAAet1E,KAAKK,UAAUi1E,GAC3EH,EAAYI,EACd,CACF,CAAE,MAAOn8E,GACP,MAAMo8E,EAAep8E,aAAaq8E,EAAAA,EAAer8E,EAAEs8E,sBAAwBt8E,EAAE+iB,QAC7ExH,EAAAA,EAAMuB,sBAAsB,4BAA4Bs/D,IAC1D,CACAnE,GAAW,EAAM,GAChB,CAAC2D,EAAkBtC,IAEhBiD,GAASh3D,EAAAA,EAAAA,cAAYtH,UACpB69D,SACGE,IAERH,GAAc,EAAK,GAClB,CAACC,EAAUE,IAERQ,GAAWj3D,EAAAA,EAAAA,cAAY,KAC3Bs2D,GAAc,EAAM,GACnB,IAEGY,GAAeC,EAAAA,EAAAA,IAAiC7sE,GAEtD,OACE/J,EAAAA,EAAAA,IAAA,OAAKM,KAAGC,EAAAA,EAAAA,IAAE,CAAEmD,QAAS,OAAQuE,IAAK3F,EAAMgN,QAAQqC,IAAI,IAAC5R,SAAA,CAClD42E,IACCh3E,EAAAA,EAAAA,GAACiD,EAAAA,EAGC,CACAV,YAAY,iDACZiS,KAAK,QACLtS,KAAMsuD,GAAaxwD,EAAAA,EAAAA,GAAC0oD,EAAAA,IAAe,KAAM1oD,EAAAA,EAAAA,GAAC2oD,EAAAA,EAAgB,IAC1D1mD,QAASuuD,EAAaumB,EAAWD,EACjCn2E,IAAGkB,EACH8pE,QAASA,EACTlpE,KAAK,aAGTzC,EAAAA,EAAAA,GAAA,OACE9E,MAAOkP,EACPzJ,IAAGc,EAGDrB,SAEDowD,GAAaxwD,EAAAA,EAAAA,GAACk3E,EAAiB,CAAC9sE,MAAe,OAARisE,QAAQ,IAARA,EAAAA,EAAYjsE,IAAYA,MAE9D,EAIJ8sE,EAAoB1wE,IAAmC,IAAlC,MAAE4D,GAA0B5D,EACrD,MAAM2wE,GAAsBpqE,EAAAA,EAAAA,UAAQ,KAGlC,IACE,MAAMqqE,EAAaj2E,KAAKC,MAAMgJ,GAC9B,OAAOjJ,KAAKK,UAAU41E,EAAY,KAAM,EAC1C,CAAE,MAAO78E,GACP,OAAO,IACT,IACC,CAAC6P,IACJ,OACEpK,EAAAA,EAAAA,GAAA,OACEW,KAAGC,EAAAA,EAAAA,IAAE,CACHiR,WAAY,WACZwlE,UAAW,aACXC,WAAYH,EAAsB,iBAAchwE,GACjD,IAAC/G,SAED+2E,GAAuB/sE,GACpB,EAIGmtE,EAAwGzoE,IAAA,IACnHjB,KAAK,SAAEkoE,IACRjnE,EAAA,OACC9O,EAAAA,EAAAA,GAACk2E,EAA0B,CACzBC,iBAAiB,UACjBtC,QAASkC,EAASjC,YAAc,GAChC1pE,OAAOotE,EAAAA,EAAAA,GAAmBzB,IAAa,IACvC,EAGS0B,EAAyG1oE,IAAA,IACpHlB,KAAK,SAAEkoE,IACRhnE,EAAA,OACC/O,EAAAA,EAAAA,GAACk2E,EAA0B,CACzBC,iBAAiB,WACjBtC,QAASkC,EAASjC,YAAc,GAChC1pE,OAAOstE,EAAAA,EAAAA,IAAoB3B,IAAa,IACxC,E,eC3HG,MAAM4B,EAAgG38E,IAAA,IAC3G6S,KAAK,SAAEkoE,IACR/6E,EAAA,OAAKgF,EAAAA,EAAAA,GAAC4V,EAAAA,EAAkB,CAACxL,OAAOyhE,EAAAA,EAAAA,OAAMkK,EAAShjE,KAAM,QAAU,ECInD6kE,EAA0Bj8E,GAAe,YAAYA,SACrDk8E,EAA0Bl8E,GAAe,SAASA,SCGlDm8E,EAAqB72E,EAAAA,MAChCjG,IAAuC,IAAtC,IAAE6S,GAA8B7S,EAC/B,MAAM,MAAE2H,IAAUC,EAAAA,EAAAA,KAElB,OACE5C,EAAAA,EAAAA,GAAA,OACE07B,KAAK,MAEL,cAAY,4BACZ/6B,KAAGC,EAAAA,EAAAA,IAAE,CACHuxD,UAAWxvD,EAAMW,QAAQy0E,aACzBh0E,QAAS,OACT2Q,cAAe,MACf,SAAU,CACRtH,gBAAiB,2BAEpB,IAAChN,SAEDyN,EAAIw6C,cAAcz5C,KAAKy3C,IAAU,IAAD2xB,EAAAC,EAC/B,MAAM3vB,EAA2D,QAAlD0vB,EAAI3xB,EAAKuB,OAAOO,UAA8Boa,YAAI,IAAAyV,OAAA,EAA/CA,EAAiD1vB,UAE7D7nD,EADW4lD,EAAKuB,OAAOjsD,KAAOu8E,EAAAA,GACTv1E,EAAMgN,QAAQC,GAAK,GAAGjN,EAAMgN,QAAQC,QAAQjN,EAAMgN,QAAQqC,OAErF,OACEhS,EAAAA,EAAAA,GAAA,OACE07B,KAAK,OACL/6B,IAAG,CACD,CACE,+BAAgC,GAAGgC,EAAMgN,QAAQC,OACjD4sB,KAAM,YAAYq7C,EAAuBxxB,EAAKuB,OAAOjsD,cACrDwE,SAAU,SACVy1B,aAAc,yCACd/jB,WAAYy2C,EAAY,WAAa,SACrC5yC,aAAc4yC,EAAY,gBAAanhD,EACvC1G,WAE6C,QAD9Cw3E,EACA5xB,EAAKuB,OAAOO,UAA8Boa,YAAI,IAAA0V,OAAA,EAA/CA,EAAiDt2E,OAAM,IACvDvB,UAGD8nD,EAAAA,EAAAA,IAAW7B,EAAKuB,OAAOO,UAAU9B,KAAMA,EAAK+B,eAFxC/B,EAAK1qD,GAGN,KAlCLkS,EAAIlS,GAqCL,IAGV,CAACkqB,EAAMwlC,IAEHxlC,EAAKohC,UAAYoE,EAAKpE,SACtBphC,EAAKsyD,WAAa9sB,EAAK8sB,WACvB7lC,EAAAA,EAAAA,SAAQzsB,EAAKhY,IAAIkoE,SAAShjE,KAAMs4C,EAAKx9C,IAAIkoE,SAAShjE,QC5D3CqlE,EACXn3E,EAAAA,MACEjG,IAA4B,IAAzB6S,KAAK,SAAEkoE,IAAY/6E,EACpB,OAAK+6E,EAASsC,cAIZr4E,EAAAA,EAAAA,GAACmV,EAAAA,IAAa,CACZja,MAAO,IAAIqG,KAAKw0E,EAASsC,cAAcC,eAAeC,UAAU/3E,SAAU,CACxEg4E,aAAc,UAEhB1wD,UAAU,QAAO1nB,UAEjBJ,EAAAA,EAAAA,GAAA,QAAAI,SAAO0V,EAAAA,EAAM2iE,aAAa1C,EAASsC,kBAT9B,IAUS,IAGpB,KAAM,ICdGK,EAAgC19E,IAA8C,IAA7C,MAAE+rD,GAAqC/rD,EACnF,MAAMk1B,EAAY62B,EAAM4xB,0BAA2B5xB,EAAM6xB,yBAA0B,KAEnF,OACE54E,EAAAA,EAAAA,GAAC6vB,EAAAA,IAAQ,CACPttB,YAAY,oGACZ,cAAY,8BACZ2tB,UAAWA,EACXxwB,aAAc,CAAEe,QAAS,EAAG4xB,OAAQ,GACpC/kB,SAAUy5C,EAAM8xB,uBAChB,ECVOC,EAA8B99E,IAA2C,IAA1C,IAAE6S,GAAkC7S,EAC9E,OACEgF,EAAAA,EAAAA,GAAC6vB,EAAAA,IAAQ,CACPttB,YAAY,kGACZ,cAAa,6BAA6BsL,EAAIlS,KAC9CkJ,UAAWgJ,EAAIkrE,eACf7oD,UAAWriB,EAAImrE,gBACft5E,aAAc,CAAEe,QAAS,EAAG4xB,OAAQ,GACpC/kB,SAAUA,IAAMO,EAAIorE,kBACpB,E,0BCf4E,IAAAp3E,EAAA,CAAAH,KAAA,UAAAC,OAAA,uCAE3E,MAAMu3E,EAAuCl+E,IAQ7C,IAR8C,gBACnDo6E,EAAe,aACf7hE,EAAY,QACZY,GAKDnZ,EACC,MAAM,MAAE2H,IAAUC,EAAAA,EAAAA,KACZgrE,EAAO,0GAGbr6D,EAAe,0CAA0CA,MAAmB,uRAS5EY,EAAU,iCAAmC,oCAE7C,OACE9T,EAAAA,EAAAA,IAAA,OAAAD,SAAA,EACEJ,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWC,KAAI,CAAAlQ,UACdJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,+GAEfmD,OAAQ,CACNi8D,MAAM5tE,EAAAA,EAAAA,GAAA,QAAAI,SAAM,qCAIlBC,EAAAA,EAAAA,IAAA,OAAKM,IAAGkB,EAAiDzB,SAAA,EACvDJ,EAAAA,EAAAA,GAACoR,EAAAA,EAAU,CACT7O,YAAa,GAAG6yE,mDAChBz0E,KAAGC,EAAAA,EAAAA,IAAE,CAAEo2D,OAAQ,EAAG/2D,SAAU,WAAYu4C,IAAK71C,EAAMgN,QAAQqC,GAAIlR,MAAO6B,EAAMgN,QAAQqC,IAAI,IACxFmnE,WAAW,EACX7nE,SAAUs8D,EACV1rE,MAAMlC,EAAAA,EAAAA,GAACqR,EAAAA,IAAQ,OAEjBrR,EAAAA,EAAAA,GAACO,EAAAA,GAAW,CACV64E,iBAAe,EACfl6E,MAAO,CACLuB,QAAS,GAAGkC,EAAMgN,QAAQC,QAAQjN,EAAMgN,QAAQc,OAChDf,UAAW/M,EAAMgN,QAAQc,IAE3BjQ,SAAS,SAAQJ,SAEhBwtE,SAGD,ECxDwE,IAAA/rE,EAAA,CAAAH,KAAA,UAAAC,OAAA,uCAE3E,MAAM03E,EAAwCr+E,IAQ9C,IAR+C,gBACpDo6E,EAAe,aACf7hE,EAAY,QACZY,GAKDnZ,EACC,MAAM,MAAE2H,IAAUC,EAAAA,EAAAA,KACZgrE,EAAO,2EAEbr6D,EAAe,0CAA0CA,MAAmB,uQAQ5EY,EAAU,iCAAmC,8CAE7C,OACE9T,EAAAA,EAAAA,IAAA,OAAAD,SAAA,EACEJ,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWC,KAAI,CAAAlQ,UACdJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,+FAEfmD,OAAQ,CACNi8D,MAAM5tE,EAAAA,EAAAA,GAAA,QAAAI,SAAM,uCAIlBC,EAAAA,EAAAA,IAAA,OAAKM,IAAGkB,EAAiDzB,SAAA,EACvDJ,EAAAA,EAAAA,GAACoR,EAAAA,EAAU,CACT7O,YAAa,GAAG6yE,qDAChBz0E,KAAGC,EAAAA,EAAAA,IAAE,CAAEo2D,OAAQ,EAAG/2D,SAAU,WAAYu4C,IAAK71C,EAAMgN,QAAQqC,GAAIlR,MAAO6B,EAAMgN,QAAQqC,IAAI,IACxFmnE,WAAW,EACX7nE,SAAUs8D,EACV1rE,MAAMlC,EAAAA,EAAAA,GAACqR,EAAAA,IAAQ,OAEjBrR,EAAAA,EAAAA,GAACO,EAAAA,GAAW,CACV64E,iBAAe,EACfl6E,MAAO,CACLuB,QAAS,GAAGkC,EAAMgN,QAAQC,QAAQjN,EAAMgN,QAAQc,OAChDf,UAAW/M,EAAMgN,QAAQc,IAE3BjQ,SAAS,SAAQJ,SAEhBwtE,SAGD,ECtDwE,IAAA/rE,EAAA,CAAAH,KAAA,UAAAC,OAAA,uCAE3E,MAAM23E,EAAoCt+E,IAQ1C,IAR2C,gBAChDo6E,EAAe,aACf7hE,EAAY,QACZY,GAKDnZ,EACC,MAAM,MAAE2H,IAAUC,EAAAA,EAAAA,KACZgrE,EAAO,kBACbr6D,EAAe,0CAA0CA,QAAqB,qUAY9EY,EAAU,iCAAmC,WAE7C,OACE9T,EAAAA,EAAAA,IAAA,OAAAD,SAAA,EACEJ,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWC,KAAI,CAAAlQ,UACdJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eACE,+MAIFmD,OAAQ,CACNi8D,MAAM5tE,EAAAA,EAAAA,GAAA,QAAAI,SAAM,wBAIlBC,EAAAA,EAAAA,IAAA,OAAKM,IAAGkB,EAAiDzB,SAAA,EACvDJ,EAAAA,EAAAA,GAACoR,EAAAA,EAAU,CACT7O,YAAa,GAAG6yE,gDAChBz0E,KAAGC,EAAAA,EAAAA,IAAE,CAAEo2D,OAAQ,EAAG/2D,SAAU,WAAYu4C,IAAK71C,EAAMgN,QAAQqC,GAAIlR,MAAO6B,EAAMgN,QAAQqC,IAAI,IACxFmnE,WAAW,EACX7nE,SAAUs8D,EACV1rE,MAAMlC,EAAAA,EAAAA,GAACqR,EAAAA,IAAQ,OAEjBrR,EAAAA,EAAAA,GAACO,EAAAA,GAAW,CACV64E,iBAAe,EACfl6E,MAAO,CACLuB,QAAS,GAAGkC,EAAMgN,QAAQC,QAAQjN,EAAMgN,QAAQc,OAChDf,UAAW/M,EAAMgN,QAAQc,GACzBvD,aAAcvK,EAAMgN,QAAQc,IAE9BjQ,SAAS,SAAQJ,SAEhBwtE,QAGL5tE,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWC,KAAI,CAAAlQ,UACdJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eACE,kOAQFmD,OAAQ,CACN6U,EAAIqe,IACF7kC,EAAAA,EAAAA,GAACqQ,EAAAA,EAAW4B,KAAI,CACd/W,MAAM,yBACNqH,YAAa,GAAG6yE,0CAChBlkE,KAAK,6EACLgB,cAAY,EAAA9R,SAEXykC,WAMP,ECtFwE,IAAAhjC,GAAA,CAAAH,KAAA,UAAAC,OAAA,uCAE3E,MAAM43E,GAAqCv+E,IAQ3C,IAR4C,gBACjDo6E,EAAe,aACf7hE,EAAY,QACZY,GAKDnZ,EACC,MAAM,MAAE2H,IAAUC,EAAAA,EAAAA,KACZgrE,EAAO,iFAGbr6D,EAAe,0CAA0CA,MAAmB,mYAU5EY,EAAU,iCAAmC,gFAG7C,OACE9T,EAAAA,EAAAA,IAAA,OAAAD,SAAA,EACEJ,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWC,KAAI,CAAAlQ,UACdJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,kGAEfmD,OAAQ,CACNi8D,MAAM5tE,EAAAA,EAAAA,GAAA,QAAAI,SAAM,mCAIlBC,EAAAA,EAAAA,IAAA,OAAKM,IAAGkB,GAAiDzB,SAAA,EACvDJ,EAAAA,EAAAA,GAACoR,EAAAA,EAAU,CACT7O,YAAa,GAAG6yE,iDAChBz0E,KAAGC,EAAAA,EAAAA,IAAE,CAAEo2D,OAAQ,EAAG/2D,SAAU,WAAYu4C,IAAK71C,EAAMgN,QAAQqC,GAAIlR,MAAO6B,EAAMgN,QAAQqC,IAAI,IACxFmnE,WAAW,EACX7nE,SAAUs8D,EACV1rE,MAAMlC,EAAAA,EAAAA,GAACqR,EAAAA,IAAQ,OAEjBrR,EAAAA,EAAAA,GAACO,EAAAA,GAAW,CACV64E,iBAAe,EACfl6E,MAAO,CACLuB,QAAS,GAAGkC,EAAMgN,QAAQC,QAAQjN,EAAMgN,QAAQc,OAChDf,UAAW/M,EAAMgN,QAAQc,IAE3BjQ,SAAS,SAAQJ,SAEhBwtE,SAGD,EC1DwE,IAAA/rE,GAAA,CAAAH,KAAA,UAAAC,OAAA,uCAE3E,MAAM63E,GAAoCx+E,IAQ1C,IAR2C,gBAChDo6E,EAAe,aACf7hE,EAAY,QACZY,GAKDnZ,EACC,MAAM,MAAE2H,IAAUC,EAAAA,EAAAA,KACZgrE,EAAO,6CAEbr6D,EAAe,0CAA0CA,MAAmB,wTAa5EY,EAAU,iCAAmC,2EAG7C,OACE9T,EAAAA,EAAAA,IAAA,OAAAD,SAAA,EACEJ,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWC,KAAI,CAAAlQ,UACdJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,6FAEfmD,OAAQ,CACNi8D,MAAM5tE,EAAAA,EAAAA,GAAA,QAAAI,SAAM,kCAIlBC,EAAAA,EAAAA,IAAA,OAAKM,IAAGkB,GAAiDzB,SAAA,EACvDJ,EAAAA,EAAAA,GAACoR,EAAAA,EAAU,CACT7O,YAAa,GAAG6yE,gDAChBz0E,KAAGC,EAAAA,EAAAA,IAAE,CAAEo2D,OAAQ,EAAG/2D,SAAU,WAAYu4C,IAAK71C,EAAMgN,QAAQqC,GAAIlR,MAAO6B,EAAMgN,QAAQqC,IAAI,IACxFmnE,WAAW,EACX7nE,SAAUs8D,EACV1rE,MAAMlC,EAAAA,EAAAA,GAACqR,EAAAA,IAAQ,OAEjBrR,EAAAA,EAAAA,GAACO,EAAAA,GAAW,CACV64E,iBAAe,EACfl6E,MAAO,CACLuB,QAAS,GAAGkC,EAAMgN,QAAQC,QAAQjN,EAAMgN,QAAQc,OAChDf,UAAW/M,EAAMgN,QAAQc,IAE3BjQ,SAAS,SAAQJ,SAEhBwtE,SAGD,ECtDG6L,GAAoCz+E,IAQ1C,IAR2C,gBAChDo6E,EAAe,cACfjD,EAAa,QACbh+D,GAKDnZ,EACC,MAAM,MAAE2H,IAAUC,EAAAA,EAAAA,KAEZ2Q,EAAwC,IAAzB4+D,EAAc13E,OAAe03E,EAAc,GAAK,KAErE,OACE9xE,EAAAA,EAAAA,IAAA,OAAKM,KAAGC,EAAAA,EAAAA,IAAE,CAAE2P,YAAa5N,EAAMgN,QAAQc,IAAI,IAACrQ,SAAA,EAC1CJ,EAAAA,EAAAA,GAACwP,EAAAA,IAAM,CACLtU,OACE8E,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,uBAInBkrE,kBAAmB,KAErB15E,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWC,KAAI,CACd3P,KAAGC,EAAAA,EAAAA,IAAE,CACHmD,QAAS,QACT2L,UAAW/M,EAAMgN,QAAQc,GACzBvD,aAAcvK,EAAMgN,QAAQc,IAC7B,IAACrQ,UAEFJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eACE,iTAQFmD,OAAQ,CACNgoE,QAAQn6C,EAAAA,EAAAA,OAAMrrB,GACdqS,EAAIqe,IACF7kC,EAAAA,EAAAA,GAACqQ,EAAAA,EAAW4B,KAAI,CACd1P,YAAa,GAAG6yE,sCAChBlkE,KAAK,yDACLgB,cAAY,EAAA9R,SAEXykC,UAMXxkC,EAAAA,EAAAA,IAACu5E,EAAAA,IAAKnmE,KAAI,CAAClR,YAAa,GAAG6yE,4BAA2CjsD,aAAa,YAAW/oB,SAAA,EAC5FC,EAAAA,EAAAA,IAACu5E,EAAAA,IAAKC,KAAI,CAAAz5E,SAAA,EACRJ,EAAAA,EAAAA,GAAC45E,EAAAA,IAAKh8C,QAAO,CAACxzB,MAAM,YAAWhK,UAC7BJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,6BAInBxO,EAAAA,EAAAA,GAAC45E,EAAAA,IAAKh8C,QAAO,CAACxzB,MAAM,cAAahK,UAC/BJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,kBAInBxO,EAAAA,EAAAA,GAAC45E,EAAAA,IAAKh8C,QAAO,CAACxzB,MAAM,UAAShK,UAC3BJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,eAInBxO,EAAAA,EAAAA,GAAC45E,EAAAA,IAAKh8C,QAAO,CAACxzB,MAAM,SAAQhK,UAC1BJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,cAInBxO,EAAAA,EAAAA,GAAC45E,EAAAA,IAAKh8C,QAAO,CAACxzB,MAAM,SAAQhK,UAC1BJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,iBAKrBxO,EAAAA,EAAAA,GAAC45E,EAAAA,IAAKhmE,QAAO,CAACxJ,MAAM,YAAWhK,UAC7BJ,EAAAA,EAAAA,GAACk5E,EAAoC,CACnC9D,gBAAiBA,EACjB7hE,aAAcA,EACdY,QAASA,OAGbnU,EAAAA,EAAAA,GAAC45E,EAAAA,IAAKhmE,QAAO,CAACxJ,MAAM,cAAahK,UAC/BJ,EAAAA,EAAAA,GAACq5E,EAAqC,CACpCjE,gBAAiBA,EACjB7hE,aAAcA,EACdY,QAASA,OAGbnU,EAAAA,EAAAA,GAAC45E,EAAAA,IAAKhmE,QAAO,CAACxJ,MAAM,UAAShK,UAC3BJ,EAAAA,EAAAA,GAACu5E,GAAkC,CACjCnE,gBAAiBA,EACjB7hE,aAAcA,EACdY,QAASA,OAGbnU,EAAAA,EAAAA,GAAC45E,EAAAA,IAAKhmE,QAAO,CAACxJ,MAAM,SAAQhK,UAC1BJ,EAAAA,EAAAA,GAACw5E,GAAiC,CAChCpE,gBAAiBA,EACjB7hE,aAAcA,EACdY,QAASA,OAGbnU,EAAAA,EAAAA,GAAC45E,EAAAA,IAAKhmE,QAAO,CAACxJ,MAAM,SAAQhK,UAC1BJ,EAAAA,EAAAA,GAACs5E,EAAiC,CAChClE,gBAAiBA,EACjB7hE,aAAcA,EACdY,QAASA,WAIX,EC9FyF,IAAA1S,GAAA,CAAAC,KAAA,SAAAC,OAAA,yCAAAmN,GAAA,CAAApN,KAAA,SAAAC,OAAA,yCAAAqN,GAAA,CAAAtN,KAAA,SAAAC,OAAA,8EA0B5F,MAAMm4E,GAAkB74E,EAAAA,MAC7BjG,IAqB6B,IArB5B,cACCm3E,EAAa,QACbh+D,EAAO,OACPm+D,EAAM,QACN3G,EAAO,MACPqB,EAAK,eACL+M,EAAc,gBACdC,EAAe,YACfrF,EAAW,gBACXC,EAAe,WACfqF,EAAU,eACVC,EAAc,aACdC,EAAY,eACZC,EAAc,QACdhI,EAAO,WACPiI,EAAU,aACVC,EAAY,gBACZC,EAAe,cACfC,EAAgB,GAAE,mBAClBC,EAAkB,gBAClBrF,GACqBp6E,EACrB,MAAM+f,GAAO2D,EAAAA,EAAAA,KAEPuoC,GAAUl6C,EAAAA,EAAAA,UAA2B,KACzC,MAAMk6C,EAA6B,CACjC,CACEtrD,GAAIu8E,EAAAA,GACJ91C,OAAQs2C,EACRgC,gBAAgB,EAChBC,eAAe,EACft0B,KAAMyyB,EACNvW,KAAM,CAAE5gE,OAAQ,CAAE6vB,SAAU,GAAIyY,SAAU,MAE5C,CACE7H,OAAQrnB,EAAKC,cAAc4/D,EAAAA,GAAsCC,EAAAA,GAAiCC,YAClGH,eAAe,EACfD,gBAAgB,EAChB/+E,GAAIk/E,EAAAA,GAAiCC,UACrCz0B,IAAAA,CAAIxkD,GAAyB,IAAtBgM,KAAK,SAAEkoE,IAAYl0E,EACxB,OACE7B,EAAAA,EAAAA,GAACqQ,EAAAA,EAAW4B,KAAI,CACd1P,YAAa,GAAG6yE,iCAChBhgE,UAAQ,EACRzU,IAAGc,GACHQ,QAASA,KACO,OAAd83E,QAAc,IAAdA,GAAAA,EAAiBhE,EAAS,EAC1B31E,SAED21E,EAASjC,YAGhB,EACAvR,KAAM,CAAE5gE,OAAQ,CAAE6vB,SAAU,OAE9B,CACE4Q,OAAQrnB,EAAKC,cAAc4/D,EAAAA,GAAsCC,EAAAA,GAAiCE,YAClGJ,eAAe,EACfD,gBAAgB,EAChB/+E,GAAIk/E,EAAAA,GAAiCE,UACrC10B,IAAAA,CAAI7/C,GAAyB,IAAtBqH,KAAK,SAAEkoE,IAAYvvE,EACxB,OACExG,EAAAA,EAAAA,GAACqQ,EAAAA,EAAW4B,KAAI,CACd1P,YAAa,GAAG6yE,iCAChBhgE,UAAQ,EACRzU,IAAGmO,GACH7M,QAASA,KACO,OAAd83E,QAAc,IAAdA,GAAAA,EAAiBhE,EAAS,EAC1B31E,UAED46E,EAAAA,EAAAA,IAAiBjF,EAAUkF,EAAAA,KAGlC,EACA1Y,KAAM,CAAE5gE,OAAQ,CAAE6vB,SAAU,OAE9B,CACE4Q,OAAQrnB,EAAKC,cACX4/D,EAAAA,GAAsCC,EAAAA,GAAiCK,cAEzEv/E,GAAIk/E,EAAAA,GAAiCK,YACrC90B,WAAa11B,GAASA,EAAK2nD,aAC3BsC,eAAe,EACfD,gBAAgB,EAChBr0B,KAAM+xB,EACN7V,KAAM,CAAE5gE,OAAQ,CAAE6vB,SAAU,IAAKyY,SAAU,OAE7C,CACE7H,OAAQrnB,EAAKC,cAAc4/D,EAAAA,GAAsCC,EAAAA,GAAiCvuE,SAClG3Q,GAAIk/E,EAAAA,GAAiCvuE,OACrCquE,eAAe,EACfD,gBAAgB,EAChBr0B,KAAMyvB,EACNvT,KAAM,CAAE5gE,OAAQ,CAAE6vB,SAAU,IAAKyY,SAAU,OAE7C,CACE7H,OAAQrnB,EAAKC,cAAc4/D,EAAAA,GAAsCC,EAAAA,GAAiCM,SAClGx/E,GAAIk/E,EAAAA,GAAiCM,OACrCR,eAAe,EACfD,gBAAgB,EAChBr0B,KAAMkxB,EACNhV,KAAM,CAAEja,WAAW,IAErB,CACElmB,OAAQrnB,EAAKC,cAAc4/D,EAAAA,GAAsCC,EAAAA,GAAiCO,UAClGT,eAAe,EACfD,gBAAgB,EAChB/+E,GAAIk/E,EAAAA,GAAiCO,QACrC/0B,KAAMoxB,EACNlV,KAAM,CAAEja,WAAW,IAErB,CACElmB,OAAQrnB,EAAKC,cAAc4/D,EAAAA,GAAsCC,EAAAA,GAAiCxmE,UAClGsmE,eAAe,EACfD,gBAAgB,EAChB/+E,GAAIk/E,EAAAA,GAAiCxmE,QACrCgyC,IAAAA,CAAIt3C,GAAyB,IAAtBlB,KAAK,SAAEkoE,IAAYhnE,EACxB,MAAMyL,GAAQu5D,EAAAA,EAAAA,GAAkBgC,GAChC,IAAKv7D,IAAUu7D,EAASsF,cACtB,OAAO,KAET,MAAM79D,EAAQu4D,EAAS1hE,SAAWmG,EAClC,OACExa,EAAAA,EAAAA,GAACiS,EAAAA,GAAI,CACHtR,IAAGqO,GAMHgF,GAAIC,EAAAA,EAAOC,gBAAgB6hE,EAASsF,cAAe7gE,GAAOpa,SAEzDod,GAGP,GAEF,CACE4kB,OAAQrnB,EAAKC,cAAc4/D,EAAAA,GAAsCC,EAAAA,GAAiCzoE,SAClGuoE,eAAe,EACfD,gBAAgB,EAChB/+E,GAAIk/E,EAAAA,GAAiCzoE,OACrCi0C,KAAMsxB,EACNpV,KAAM,CAAE5gE,OAAQ,CAAE6vB,SAAU,QA+ChC,OA3CKipD,GACHxzB,EAAQxsC,KAAK,CACX2nB,OAAQrnB,EAAKC,cACX4/D,EAAAA,GAAsCC,EAAAA,GAAiCS,cAEzEX,eAAe,EACfD,gBAAgB,EAChB/+E,GAAIk/E,EAAAA,GAAiCS,YACrCl1B,WAAa11B,IAAS6qD,EAAAA,EAAAA,IAAwB7qD,GAC9C6xC,KAAM,CAAE5gE,OAAQ,CAAE6vB,SAAU,GAAIyY,SAAU,OAG9Cgd,EAAQxsC,KACN,CACE2nB,OAAQrnB,EAAKC,cAAc4/D,EAAAA,GAAsCC,EAAAA,GAAiCW,UAClGb,eAAe,EACfD,gBAAgB,EAChB/+E,GAAIk/E,EAAAA,GAAiCW,QACrCp1B,WAAa11B,IACP8O,EAAAA,EAAAA,OAAM9O,EAAK+qD,qBAAuBC,SAAShrD,EAAK+qD,mBAC3C,KAEF3lE,EAAAA,EAAM6lE,eAAejrD,EAAK+qD,mBAEnClZ,KAAM,CAAE5gE,OAAQ,CAAEtG,MAAO,OAE3B,CACE+mC,OAAQrnB,EAAKC,cAAc4/D,EAAAA,GAAsCC,EAAAA,GAAiC9nE,OAClG4nE,eAAe,EACfD,gBAAgB,EAChB/+E,GAAIk/E,EAAAA,GAAiC9nE,KACrCszC,IAAAA,CAAIp3C,GAAyB,IAAtBpB,KAAK,SAAEkoE,IAAY9mE,EACxB,OACEjP,EAAAA,EAAAA,GAACk1E,EAAsB,CACrBniE,KAAMgjE,EAAShjE,MAAQ,GACvBoiE,cAAeA,IAAqB,OAAf6E,QAAe,IAAfA,OAAe,EAAfA,EAAkBjE,GACvCX,gBAAiBA,GAGvB,IAIGnuB,EAAQt5C,QAAQi6C,GAAWA,EAAOjsD,KAAO6+E,EAAcvsE,SAAS25C,EAAOjsD,KAAI,GACjF,CAACof,EAAMg/D,EAAgBC,EAAiBS,EAAoBD,EAAepF,IAExEruB,GAAQC,EAAAA,EAAAA,IAAyC,CACrDC,UACAv2B,KAAM4hD,EACNn8D,MAAO,CAAEi8D,UAASkI,gBAClBlzB,iBAAiBA,EAAAA,EAAAA,MACjBw0B,SAAUA,CAAC/tE,EAAK8K,IAAU9K,EAAIimE,YAAcn7D,EAAMvB,WAClDykE,mBAAmBA,EAAAA,EAAAA,MACnBC,gBAAiBzB,EACjB0B,qBAAsBxB,EACtBrzB,sBAAsB,EACtB80B,oBAAoB,EACpB70B,iBAAkB,aA4Dd80B,EAAiBl1B,EAAMm1B,WAAWC,iBAClCC,EAAiBn7E,EAAAA,SAAc,KACnC,MAAM0mD,EAAUZ,EAAMs1B,iBAChBC,EAAsC,CAAC,EAK7C,OAJA30B,EAAQ1vC,SAASmqB,IACfk6C,EAAS1E,EAAuBx1C,EAAOzmC,KAAOymC,EAAOylB,UACrDy0B,EAASzE,EAAuBz1C,EAAOwlB,OAAOjsD,KAAOymC,EAAOwlB,OAAOC,SAAS,IAEvEy0B,CAAQ,GAGd,CAACL,EAAgBh1B,EAASF,IAE7B,OACE1mD,EAAAA,EAAAA,IAAC6N,EAAAA,IAAK,CACJC,YAAU,EACVouE,MAzEkBC,MACpB,GAAIxP,EAAO,CACT,MAAM2J,EAAe3J,aAAiB4J,EAAAA,EAAe5J,EAAMyP,kBAAoBzP,EAAM1vD,QACrF,OACEtd,EAAAA,EAAAA,GAACyzB,EAAAA,IAAK,CACJE,OAAO3zB,EAAAA,EAAAA,GAAC08E,EAAAA,EAAU,IAClBhpD,YAAaijD,EACbz7E,OACE8E,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,WAMzB,CACA,OAAKm9D,GAA6B,IAAlB2G,EAAO73E,QAAgB0/E,GAEnCn6E,EAAAA,EAAAA,GAACyzB,EAAAA,IAAK,CACJC,aACE1zB,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,mGAEfmD,OAAQ,CACNw2D,OAAStpC,IACP7+B,EAAAA,EAAAA,GAACqQ,EAAAA,EAAW4B,KAAI,CACd1P,YAAY,uFACZN,QAASm4E,EAAeh6E,SAEvBy+B,OAMX3jC,OACE8E,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,sBAOpBm9D,GAA6B,IAAlB2G,EAAO73E,OAShB,MAPHuF,EAAAA,EAAAA,GAACy5E,GAAiC,CAChCrE,gBAAiBA,EACjBjD,cAAeA,EACfh+D,QAASA,GAIJ,EAoBFqoE,GACPt9E,MAAOk9E,EACPtwB,YACE9rD,EAAAA,EAAAA,GAAC28E,EAAAA,IAAgB,CACfp6E,YAAa,GAAG6yE,4BAChBT,YAAaA,EACbC,gBAAiBA,EACjBqF,WAAYA,EACZC,eAAgBA,IAEnB95E,SAAA,EAEDJ,EAAAA,EAAAA,GAACoO,EAAAA,IAAQ,CAACC,UAAQ,EAAAjO,SACf2mD,EAAM61B,iBAAiBhuE,KAAKwzB,IAAY,IAAD41C,EACtC,OACEh4E,EAAAA,EAAAA,GAACsO,EAAAA,IAAW,CACV/L,YAAY,uFAEZ5B,IAAsD,QAAnDq3E,EAAG51C,EAAOwlB,OAAOO,UAA8Boa,YAAI,IAAAyV,OAAA,EAAjDA,EAAmDr2E,OACxDk7E,SAAUz6C,EAAOwlB,OAAOk1B,aACxBC,cAAe36C,EAAOwlB,OAAOo1B,eAAiB,OAC9CC,aAAc76C,EAAOwlB,OAAOs1B,0BAC5Bp1B,UAAW1lB,EAAOwlB,OAAOG,eACzBC,cAAe5lB,EAAO6lB,mBACtBk1B,WAAY/6C,EAAOwlB,OAAOw1B,gBAC1Bl+E,MAAO,CACLs9B,KAAM,YAAYo7C,EAAuBx1C,EAAOzmC,eAChDyE,UAED8nD,EAAAA,EAAAA,IAAW9lB,EAAOwlB,OAAOO,UAAU/lB,OAAQA,EAAOgmB,eAZ9ChmB,EAAOzmC,GAaA,MAInBgwE,IAAW3rE,EAAAA,EAAAA,GAACq9E,EAAAA,IAAiB,CAACt2B,MAAOA,KACpC4kB,IACCqB,GACDjmB,EACGO,cACAC,KAAK34C,KAAKf,IACT7N,EAAAA,EAAAA,GAAC83E,EAAkB,CAAcjqE,IAAKA,EAAKo5C,QAASA,EAASkxB,SAAUmC,EAAazsE,EAAIlS,KAA/DkS,EAAIlS,QAE7B,I,gCC1XP,MAAM2hF,GAAkCtiF,IAQxC,IARyC,WAC9CuiF,EAAU,OACVjiF,EAAS,IAAG,iBACZkiF,GAAmB,GAKpBxiF,EACC,MAAMyiF,GAAY14E,EAAAA,EAAAA,QAA0B,OACrCknB,EAAWyxD,GAAgBz8E,EAAAA,UAAe,GAsCjD,OApCA2G,EAAAA,EAAAA,YAAU,KACR,MAAM+1E,EAAiBv6E,IAAkE,IAADw6E,EAEtF,MAAMC,EAAgC,QAApBD,EAAGH,EAAUz4E,eAAO,IAAA44E,OAAA,EAAjBA,EAAmBE,cACxC,GAAKD,GAAgBz6E,EAAMgP,SAAWyrE,GAI9Bz6E,EAAMstB,KAAKjuB,OACZs7E,GAAoCC,MACvCN,GAAa,EAKjB,EAIF,OADAl0E,OAAO3B,iBAAiB,UAAW81E,GAC5B,KACLn0E,OAAO+uC,oBAAoB,UAAWolC,EAAc,CACrD,GACA,CAACJ,KAEJ31E,EAAAA,EAAAA,YAAU,KAAO,IAADq2E,EACd,MAAMJ,EAAgC,QAApBI,EAAGR,EAAUz4E,eAAO,IAAAi5E,OAAA,EAAjBA,EAAmBH,cACnCD,IAAgB5xD,GAIrB4xD,EAAaK,YAAY,CACvBz7E,KAAM07E,GAAoCC,YAC1CC,UAAWd,GACX,GACD,CAACA,EAAYtxD,KAGd5rB,EAAAA,EAAAA,IAAA,OAAKM,KAAGC,EAAAA,EAAAA,IAAE,CAAEtF,UAAQ,IAAC8E,SAAA,CAClB6rB,IACC5rB,EAAAA,EAAAA,IAAA,OACEM,KAAGC,EAAAA,EAAAA,IAAE,CACHX,SAAU,WACV5E,MAAO,OACPC,UACD,IAAC8E,SAAA,EAEFJ,EAAAA,EAAAA,GAACs+E,EAAAA,IAAa,KACdt+E,EAAAA,EAAAA,GAACu+E,EAAAA,IAAa,CAACC,MAAO,QAG1Bx+E,EAAAA,EAAAA,GAAA,UACE9E,MAAM,uBAGNiyD,IAAK,+DAA+DsxB,GAAAA,KACpE/iF,IAAK+hF,EACL98E,KAAGC,EAAAA,EAAAA,IAAE,CACHkD,OAAQ,OACRzI,MAAO,OACPC,UACD,QAEC,EClFH,IA2HKyiF,GAAmC,SAAnCA,GAAmC,OAAnCA,EAAmC,cAAnCA,CAAmC,MAQnCI,GAAmC,SAAnCA,GAAmC,OAAnCA,EAAmC,2BAAnCA,CAAmC,MC9HxC,MCcMO,GAAkB1jF,IAUxB,IAVyB,UAC9B8/E,EAAS,UACT6D,EAAS,iBACTC,EAAgB,QAChBrlE,GAMDve,EACC,MAAM,UACJqjF,EACA1S,QAASkT,EAAgB,MACzB7R,GC9BkC,SAAC6G,GAAoC,IAAlB3G,EAAI1yE,UAAAC,OAAA,QAAA0M,IAAA3M,UAAA,IAAAA,UAAA,GAC3D,MAAO6jF,EAAWS,IAAgBj4E,EAAAA,EAAAA,eAAqCM,IAChEwkE,EAAS6G,IAAc3rE,EAAAA,EAAAA,WAAkB,IACzCmmE,EAAOyF,IAAY5rE,EAAAA,EAAAA,eAA4BM,GAEhD43E,GAAiBj/D,EAAAA,EAAAA,cAAYtH,UACjCg6D,GAAW,GACX,IACE,MAAMgB,QAAiBC,EAAAA,EAAc+C,uBAAuB3C,GAExDloD,MAAM89B,QAAQ+pB,EAASwL,OACzBF,EAAatL,GAGb19D,EAAAA,EAAMuB,sBAAsB,gCAAkClW,KAAKK,UAAkB,OAARgyE,QAAQ,IAARA,OAAQ,EAARA,EAAUp8D,YAE3F,CAAE,MAAO7c,GACPk4E,EAASl4E,EACX,CACAi4E,GAAW,EAAM,GAChB,IAQH,OANA5qE,EAAAA,EAAAA,YAAU,KACJisE,IAAY3G,GACd6R,EAAelL,EACjB,GACC,CAACkL,EAAgBlL,EAAS3G,IAEtB,CAAEmR,YAAW1S,UAASqB,QAC/B,CDEMiS,CACFnE,EAEsB,iBAAb,OAAT6D,QAAS,IAATA,OAAS,EAATA,EAAWryE,UAEP,MAAE3J,IAAUC,EAAAA,EAAAA,KAKZs8E,GAAwBN,IAAqBD,GAE3CA,UAAWQ,EAAmBxT,QAASyT,GDzCX,SAACtE,GAAuC,IAApBpjE,IAAOld,UAAAC,OAAA,QAAA0M,IAAA3M,UAAA,KAAAA,UAAA,GAC/D,MAAOmkF,EAAWU,IAAoBx4E,EAAAA,EAAAA,eAAqCM,IACpEwkE,EAAS6G,IAAc3rE,EAAAA,EAAAA,UAAkB6Q,IACzCs1D,EAAOyF,IAAY5rE,EAAAA,EAAAA,eAA4BM,GAEhDm4E,GAAiBx/D,EAAAA,EAAAA,cAAYtH,UACjC,GAAKd,EAAL,CAGA+6D,OAAStrE,GAET,IACE,MAAMqsE,QAAiBC,EAAAA,EAAc8L,uBAAuBzE,GAE5D,IAAKtH,EAASgM,WAEZ,YADAH,OAAiBl4E,GAInBk4E,EAAiB7L,EAASgM,WAC5B,CAAE,MAAOjlF,GACPk4E,EAASl4E,EACX,CAAC,QACCi4E,GAAW,EACb,CAhBA,CAgBA,GACC,CAAC96D,EAASojE,IAMb,OAJAlzE,EAAAA,EAAAA,YAAU,KACR03E,GAAgB,GACf,CAACA,IAEG,CACLX,YACAhT,UACAqB,QAEJ,CCKgFyS,CAC5E3E,EACAoE,GAGIQ,EAAiBf,GAAaQ,EAE9BjkF,GAAQ6R,EAAAA,EAAAA,UAAQ,IAChB6xE,GAAoBQ,GACfp/E,EAAAA,EAAAA,GAACs+E,EAAAA,IAAa,IAEnBoB,GACKC,EAAAA,EAAAA,IAAoBD,GAEtB5E,GACN,CAAC8D,EAAkBQ,EAA4BM,EAAgB5E,IAG5D8E,GAAqB7yE,EAAAA,EAAAA,UACzB,IACEsxE,EACI,CAGEmB,WAAYE,GAAkB,CAAC,EAC/BpL,KAAMoL,GAAkB,CAAC,EACzBG,WAAYxB,EACZ3tD,KAAM2tD,QAERl3E,GACN,CAACk3E,EAAWqB,IAGRI,IAA0B,OAATzB,QAAS,IAATA,OAAS,EAATA,EAAWW,QAAS,IAAIvkF,OAAS,EAyFxD,OACEuF,EAAAA,EAAAA,GAACwT,EAAAA,GAAOC,KAAI,CACVkqB,OAAK,EACLjqB,MAAI,EACJC,aAAeD,IACRA,GACH6F,GACF,EACAnZ,UAEFJ,EAAAA,EAAAA,GAACwT,EAAAA,GAAOI,QAAO,CACbrR,YAAY,uFACZlH,MAAM,OACNH,MAAOA,EACP6kF,2BAAyB,EAAA3/E,SApGzBy+E,GAAoBD,GAAoBQ,GAExC/+E,EAAAA,EAAAA,IAAAC,EAAAA,GAAA,CAAAF,SAAA,EACEJ,EAAAA,EAAAA,GAACs+E,EAAAA,IAAa,KACdt+E,EAAAA,EAAAA,GAACu+E,EAAAA,IAAa,CAACC,MAAO,OAIF,iBAAb,OAATG,QAAS,IAATA,OAAS,EAATA,EAAWryE,SAEXjM,EAAAA,EAAAA,IAAAC,EAAAA,GAAA,CAAAF,SAAA,EACEJ,EAAAA,EAAAA,GAACuU,GAAAA,EAAM,CAACC,KAAK,QACbxU,EAAAA,EAAAA,GAACyzB,EAAAA,IAAK,CACJE,OAAO3zB,EAAAA,EAAAA,GAACggF,EAAAA,EAAW,IACnBtsD,aACE1zB,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,+FAInBtT,OACE8E,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,kCAQvBw+D,GAEA3sE,EAAAA,EAAAA,IAAAC,EAAAA,GAAA,CAAAF,SAAA,EACEJ,EAAAA,EAAAA,GAACuU,GAAAA,EAAM,CAACC,KAAK,QACbxU,EAAAA,EAAAA,GAACyzB,EAAAA,IAAK,CACJE,OAAO3zB,EAAAA,EAAAA,GAAC08E,EAAAA,EAAU,IAClBhpD,aACE1zB,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,qGAInBtT,OACE8E,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,eAQtBsxE,EAgBDF,GAEA5/E,EAAAA,EAAAA,GAAA,OACEW,KAAGC,EAAAA,EAAAA,IAAE,CACHtF,OAAQ,eAAeqH,EAAMgN,QAAQC,QACrCW,YAAa5N,EAAMgN,QAAQa,GAC3BuD,aAAcpR,EAAMgN,QAAQa,GAC5BtD,cAAevK,EAAMgN,QAAQa,IAC9B,IACD/B,QAAUlU,GAAMA,EAAEmU,kBAAkBtO,UAEpCJ,EAAAA,EAAAA,GAACs9E,GAA+B,CAACC,WAAYqC,EAAkCtkF,OAAO,WAIrF,MA7BH+E,EAAAA,EAAAA,IAAAC,EAAAA,GAAA,CAAAF,SAAA,EACEJ,EAAAA,EAAAA,GAACuU,GAAAA,EAAM,CAACC,KAAK,QACbxU,EAAAA,EAAAA,GAACyzB,EAAAA,IAAK,CACJC,YAAa,KACbx4B,OACE8E,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,mCA4Cb,E,gBEhLX,MCLMyxE,GAA6BjlF,IAcnC,IAdoC,cACzCm3E,EAAa,QACbt4D,EAAO,aACPygE,EAAY,gBACZC,EAAe,YACf2F,EAAW,cACXC,GAQDnlF,EACC,MAAM+f,GAAO2D,EAAAA,EAAAA,MACNi4D,EAAcyJ,IAAmBv5E,EAAAA,EAAAA,UAAiB,KAClDolB,EAAWyxD,IAAgB72E,EAAAA,EAAAA,WAAS,GACrCw5E,GAAiBvuD,EAAAA,EAAAA,OAAKwuD,EAAAA,EAAAA,QAAOhG,GAAelwE,GAAUA,KA6B5D,OACE/J,EAAAA,EAAAA,IAACuZ,GAAAA,EAAK,CACJrX,YAAY,iGACZrH,OACE8E,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,4DAEfmD,OAAQ,CAAE8oC,MAAO4lC,EAAe5lF,UAGpCof,QAASA,EACTK,SAAUgmE,EACVnmE,QACE/Z,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,6DAEfmD,OAAQ,CAAE8oC,MAAO4lC,EAAe5lF,UAGpCqf,KAxBaymE,KAtBU/nE,WACzB,IAAK,IAADgoE,QAII/M,EAAAA,EAAcgN,aAA6B,QAAjBD,EAACrO,EAAc,UAAE,IAAAqO,EAAAA,EAAI,GAAIH,GAGzD9F,EAAgB,CAAC,GACjB4F,IACAD,GACF,CAAE,MAAO3lF,GACP6lF,EACErlE,EAAKC,cAAc,CAAArf,GAAA,SACjB6S,eAAe,+FAIrB,CACAkvE,GAAa,EAAM,EAInBgD,GACAhD,GAAa,EAAK,EAuBhBjoD,cAAe,CAAEk2C,QAAS1/C,EAAW00D,QAAQ,GAAOvgF,SAAA,CAEnDu2E,IAAgB32E,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWs2C,UAAS,CAACviD,MAAM,QAAOhE,SAAEu2E,KACtD32E,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWs2C,UAAS,CAAAvmD,UACnBJ,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWC,KAAI,CAACqY,MAAI,EAAAvoB,UACnBJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,uEAEfmD,OAAQ,CACN8oC,MAAO4lC,EAAe5lF,eAK9BuF,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWs2C,UAAS,CAAAvmD,UACnBJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,6EAIb,ECzFCoyE,GAA4B5lF,IAYlC,IAZmC,cACxCm3E,EAAa,aACbmI,EAAY,gBACZC,EAAe,cACf4F,EAAa,gBACb/K,GAODp6E,EACC,MAAO6lF,EAAaC,IAAkBj6E,EAAAA,EAAAA,WAAS,IACzC,MAAElE,IAAUC,EAAAA,EAAAA,KAEZm+E,GAAYjhE,EAAAA,EAAAA,cAAY,KAC5BghE,GAAe,EAAK,GACnB,CAACA,IAEEE,GAAalhE,EAAAA,EAAAA,cAAY,KAC7BghE,GAAe,EAAM,GACpB,CAACA,IAEJ,OACEzgF,EAAAA,EAAAA,IAAA,OACEM,KAAGC,EAAAA,EAAAA,IAAE,CACHmD,QAAS,OACT2Q,cAAe,MACf1Q,WAAY,SACZsE,IAAK3F,EAAMgN,QAAQC,IACpB,IAACxP,SAAA,EAEFJ,EAAAA,EAAAA,GAACiD,EAAAA,EAAM,CAACV,YAAa,GAAG6yE,+BAA8CnzE,QAAS8+E,EAAWJ,QAAM,EAAAvgF,UAC9FJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,cAInBxO,EAAAA,EAAAA,GAACigF,GAA0B,CACzB9N,cAAeA,EACft4D,QAASgnE,EACTvG,aAAcA,EACd4F,YAAac,EACbb,cAAeA,EACf5F,gBAAiBA,MAEf,EC7BV,MAAM0G,GAAejmF,IAAuD,IAAtD,gBAAEo6E,GAA8Cp6E,EACpE,MAAM,MAAE2H,IAAUC,EAAAA,EAAAA,KAElB,OACEvC,EAAAA,EAAAA,IAAC6gF,EAAAA,GAAQztE,KAAI,CACXlR,YAAY,yFACZo7B,OAAO,EAAMv9B,SAAA,EAEbJ,EAAAA,EAAAA,GAACkhF,EAAAA,GAAQtjD,QAAO,CAACC,SAAO,EAAAz9B,UACtBJ,EAAAA,EAAAA,GAACiD,EAAAA,EAAM,CACLuR,KAAK,QACL/R,KAAK,OACLP,MACElC,EAAAA,EAAAA,GAACgpB,GAAAA,EAAQ,CACProB,KAAGC,EAAAA,EAAAA,IAAE,CACHwoB,IAAK,CAAE/tB,MAAO,GAAIC,OAAQ,GAAI8I,MAAOzB,EAAMuB,OAAOI,gBACnD,MAGL/B,YAAa,GAAG6yE,qCAGpB/0E,EAAAA,EAAAA,IAAC6gF,EAAAA,GAAQttE,QAAO,CAAAxT,SAAA,EACdJ,EAAAA,EAAAA,GAACkhF,EAAAA,GAAQC,MAAK,KACdnhF,EAAAA,EAAAA,GAACqQ,EAAAA,EAAWs2C,UAAS,CAAAvmD,UACnBJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,0EAEfmD,OAAQ,CAAEyvE,WAAWphF,EAAAA,EAAAA,GAAA,KAAAI,SAAG,gBAG5BJ,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SAAC6S,eAAe,eACjCxO,EAAAA,EAAAA,GAAA,MAAAI,UACEJ,EAAAA,EAAAA,GAAA,MAAAI,UACEJ,EAAAA,EAAAA,GAAA,QAAAI,SAAM,mCAIC,EAEjB,IAAA0O,GAAA,CAAApN,KAAA,UAAAC,OAAA,mBAAAoN,GAAA,CAAArN,KAAA,SAAAC,OAAA,eAAAqN,GAAA,CAAAtN,KAAA,UAAAC,OAAA,2CAEK,MAAM0/E,GAAqBx/E,IAsB3B,IAtB4B,cACjCswE,EAAa,OACbxkE,EAAM,eACN2zE,EAAc,cACd9G,EAAgB,GAAE,gBAClB+G,EAAkB,GAAE,mBACpBC,EAAkB,aAClBlH,EAAY,gBACZC,EAAe,cACf4F,EAAa,gBACb/K,GAYDvzE,EACC,MAAMkZ,GAAO2D,EAAAA,EAAAA,MAGN+iE,EAAaC,IAAkB76E,EAAAA,EAAAA,UAA6B8G,QAAUxG,GAEvEw6E,GAAiB50E,EAAAA,EAAAA,UAAQ,KACtBk3C,EAAAA,EAAAA,SAAQ22B,EAAAA,IACZhsE,KAAInN,IAAA,IAAEgE,EAAK+X,GAAM/b,EAAA,MAAM,CACtBgE,MACA+X,MAAOzC,EAAKC,cAAcwC,GAC3B,IACA7P,QAAOnH,IAAA,IAAC,IAAEf,GAAKe,EAAA,OAAM+6E,EAAgBtzE,SAASxI,EAAI,KACpD,CAACsV,EAAMwmE,IAEJK,EAAkC,OAAXH,QAAW,IAAXA,EAAAA,EAAe9zE,EAI5C,OAF0BxT,OAAOwX,OAAO2oE,GAAc3sE,OAAOpH,SAAS9L,OAAS,GAG7EuF,EAAAA,EAAAA,GAAC4gF,GAAyB,CACxBzO,cAAeA,EACfmI,aAAcA,EACdC,gBAAiBA,EACjB4F,cAAeA,EACf/K,gBAAiBA,KAGnB/0E,EAAAA,EAAAA,IAACwhF,EAAAA,IAAiB,CAAClhF,IAAGmO,GAAsB1O,SAAA,EAC1CJ,EAAAA,EAAAA,GAACyd,EAAAA,EAAK,CACJlb,YAAa,GAAG6yE,+BAChBrlE,YAAagL,EAAKC,cAAc,CAAArf,GAAA,SAC9B6S,eAAe,kBAGjBpE,MAAOw3E,EAEPjhF,IAAGoO,GACHzB,SAAW/S,GAAMmnF,EAAennF,EAAEuQ,OAAOV,OACzCuxB,QAAQ37B,EAAAA,EAAAA,GAAC87B,EAAAA,IAAU,IACnBgmD,QAAQ9hF,EAAAA,EAAAA,GAACihF,GAAY,CAAC7L,gBAAiBA,IACvCr5C,YAAU,EACV/rB,QAASA,KACPsxE,EAAe,IACfI,OAAev6E,EAAU,EAE3B8qD,UAAY13D,IACI,UAAVA,EAAEkL,MACJ67E,EAAeM,GACfF,OAAev6E,GACjB,KAGJ9G,EAAAA,EAAAA,IAAC+wB,EAAAA,IAAc,CACb7uB,YAAa,GAAG6yE,iCAChB53D,OACEnd,EAAAA,EAAAA,IAAA,OAAKM,IAAGqO,GAAoD5O,SAAA,EAC1DJ,EAAAA,EAAAA,GAAC+hF,EAAAA,IAAW,KACZ/hF,EAAAA,EAAAA,GAACuO,EAAAA,EAAgB,CAAA5S,GAAA,SACf6S,eAAe,eAIpBpO,SAAA,EAEDJ,EAAAA,EAAAA,GAACsxB,EAAAA,IAAqB,CACpB,aAAYvW,EAAKC,cAAc,CAAArf,GAAA,SAC7B6S,eAAe,eAInBxO,EAAAA,EAAAA,GAACyxB,EAAAA,IAAqB,CAAArxB,UACpBJ,EAAAA,EAAAA,GAAC0xB,EAAAA,IAAwB,CAAAtxB,UACvBJ,EAAAA,EAAAA,GAACgiF,EAAAA,IAA8B,CAAA5hF,SAC5BuhF,EAAe/yE,KAAIK,IAAA,IAAC,IAAExJ,EAAG,MAAE+X,GAAOvO,EAAA,OACjCjP,EAAAA,EAAAA,GAAC4xB,EAAAA,IAAoC,CAEnCxnB,MAAO3E,EACP4iB,SAAUmyD,EAAcvsE,SAASxI,GACjC6H,SAAUA,IAAMk0E,EAAmB/7E,GAAKrF,SAEvCod,GALI/X,EAMgC,eAOpD,E,gBCrKH,MAAMw8E,GAAkE,CACtEzH,cAAe,CAACK,EAAAA,GAAiCE,UAAWF,EAAAA,GAAiCzoE,SAgBlF8vE,GAAkC/P,IAC7C,MAAMgQ,GAAap1E,EAAAA,EAAAA,UAAQ,KACzB,MAAMq1E,EAAwBjhF,KAAKK,UAAU2wE,EAAcr6D,QAAQwd,QACnE,OAAOzsB,GAAAA,EAAkBC,qBAAqB,uBAAwBs5E,EAAsB,GAC3F,CAACjQ,KAEGkQ,EAAShsE,IAAcxP,EAAAA,EAAAA,WAAsC,IAnB7Bs7E,KACvC,IACE,MAAMG,EAAaH,EAAWr8E,QAAQ,WAChCu8E,EAAUlhF,KAAKC,MAAMkhF,GAC3B,OAAKhhF,EAAAA,EAAAA,UAAS+gF,GAGPA,EAFEJ,EAGX,CAAE,MAAO1nF,GACP,OAAO0nF,EACT,GAUEM,CAAgCJ,KAG5BX,GAAqB1hE,EAAAA,EAAAA,cAAa0iE,IACtCnsE,GAAYosE,IACV,MAAMjI,EAAgBiI,EAAYjI,eAAiB,GACnD,MAAO,CACLA,cAAeA,EAAcvsE,SAASu0E,GAClChI,EAAc7sE,QAAQhS,GAAOA,IAAO6mF,IACpC,IAAIhI,EAAegI,GACxB,GACD,GACD,IAMH,OAJA56E,EAAAA,EAAAA,YAAU,KACRu6E,EAAWj4E,QAAQ,UAAW/I,KAAKK,UAAU6gF,GAAS,GACrD,CAACF,EAAYE,IAET,CAAEA,UAASb,qBAAoB,EClDlCkB,GAAkB,kBCclBC,GAA+B,CAAC,CAAEhnF,GAAIk/E,EAAAA,GAAiCK,YAAarI,MAAM,IAEnF+P,GAAa5nF,IAoBnB,IAAD6nF,EAAA,IApBqB,cACzB1Q,EAAa,QACbh+D,EAAO,cACPk+D,EAAa,gBACbkP,GAgBDvmF,EACC,MAAM8nF,GAAa/9E,EAAAA,EAAAA,aAA2BoC,IACvCwG,EAAQ4B,IAAa1I,EAAAA,EAAAA,UAAiB,KACtCurE,EAASiI,IAAcxzE,EAAAA,EAAAA,UAAuB87E,KAC9CrI,EAAcC,IAAmB1zE,EAAAA,EAAAA,UAAoC,CAAC,IAEtEk8E,EAAiBC,GDpCcC,MAAO,IAADC,EAE5C,MAAOC,EAAcC,IAAmBC,EAAAA,EAAAA,MAElCN,EAAmD,QAApCG,EAAGC,EAAa3uB,IAAIkuB,WAAgB,IAAAQ,EAAAA,OAAI/7E,EAEvD67E,GAAqBljE,EAAAA,EAAAA,cACxBijE,IACCK,GAAiB3sE,QACStP,IAApB47E,GACFtsE,EAAOo+C,OAAO6tB,IACPjsE,IAETA,EAAOi+C,IAAIguB,GAAiBK,GACrBtsE,IACP,GAEJ,CAAC2sE,IAGH,MAAO,CAACL,EAAiBC,EAAmB,ECgBEC,IAExC,OAAE3Q,EAAM,QAAE3G,EAAO,MAAEqB,EAAK,YAAE2H,EAAW,gBAAEC,EAAe,cAAEE,EAAa,cAAEE,EAAa,mBAAEC,GAC1F/C,EAAoB,CAClBC,gBACAC,UACAzkE,SACAwG,UACAk+D,kBAGE0H,GAAiBj6D,EAAAA,EAAAA,cACrBje,IAAA,IAAC,WAAEiyE,GAA4BjyE,EAAA,OAAKmhF,EAAmBlP,EAAW,GAClE,CAACkP,IAOG/I,GAAan6D,EAAAA,EAAAA,cAAY,KAC7Bg1D,IACAyF,EAAgB,CAAC,EAAE,GAClB,CAACzF,IAEEoF,GAAiBp6D,EAAAA,EAAAA,cAAY,KACjCk1D,IACAuF,EAAgB,CAAC,EAAE,GAClB,CAACvF,IAEEI,EAAkBjhE,EAAU,oBAAsB,iCAGxDvM,EAAAA,EAAAA,YAAU,KAER4B,OAAOqP,aAAaiqE,EAAW99E,SAE/B,MAAM4T,EAAkBJ,UAGlBmzD,GAAWiJ,UAETK,GAAmB,GAEzBzrE,OAAOqP,aAAaiqE,EAAW99E,SAC/B89E,EAAW99E,QAAUwE,OAAOsP,WAAWF,EA3EF,KA2E+C,EAItF,OADAkqE,EAAW99E,QAAUwE,OAAOsP,WAAWF,EA9EA,KA+EhC,IAAMpP,OAAOqP,aAAaiqE,EAAW99E,QAAQ,GACnD,CAACiwE,EAAoBtJ,EAASiJ,IAEjC,MAAM,MAAEjyE,IAAUC,EAAAA,EAAAA,KAGZ0gF,GAAoBv2E,EAAAA,EAAAA,UAAQ,KAChC,GAAKg2E,EACL,OAAOzQ,EAAOt/D,MAAMu0B,GAAUA,EAAMusC,aAAeiP,GAAgB,GAClE,CAACA,EAAiBzQ,KAEf,QAEJ+P,EAAO,mBACPb,GACEU,GAA+B/P,GAE7BoR,GAAkBx2E,EAAAA,EAAAA,UACtB,KAAMsnC,EAAAA,EAAAA,OAAK/1B,EAAAA,EAAAA,SAAQg0D,EAAO3nD,SAAS4c,IAAK,IAAAi8C,EAAA,OAAe,QAAfA,EAAKj8C,EAAMx0B,YAAI,IAAAywE,OAAA,EAAVA,EAAY50E,KAAKqE,GAAQA,EAAIxN,KAAI,OAC9E,CAAC6sE,KAGG,0BAAEmR,EAAyB,cAAEC,GNxGK1oF,KAMnC,IANoC,UACzCogB,EAAS,gBACTmoE,EAAkB,IAInBvoF,EACC,MAAM,kBAAE2oF,EAAiB,cAAED,IAAkBE,EAAAA,GAAAA,GAA2C,CACtFC,gBAAiBrrE,MAAOsrE,EAAcC,EAAcC,KAClD,IAAKF,EAAaG,eAChB,OAEF,MAAMnJ,EAAYgJ,EAAaG,eAEzBC,EAAsBF,EAAQr2E,QAClC9L,IAAA,IAAG4D,IAAK0+E,EAAW/5E,MAAOg6E,GAAaviF,EAAA,OACpCkiF,EAAax5D,MACZ9oB,IAAA,IAAGgE,IAAK4+E,EAAgBj6E,MAAOk6E,GAAkB7iF,EAAA,OAC/C4iF,IAAmBF,GAAaC,IAAgBE,CAAgB,GACnE,IAICC,EAAcR,EAAap2E,QAC/BnH,IAAA,IAAGf,IAAK4+E,GAAgB79E,EAAA,OAAMw9E,EAAQz5D,MAAKzb,IAAA,IAAGrJ,IAAK0+E,GAAWr1E,EAAA,OAAKu1E,IAAmBF,CAAS,GAAC,IAI5FK,EAAiB7pE,QAAQC,IAAI,IAC9BspE,EAAoBt1E,KAAIG,IAAA,IAAC,IAAEtJ,EAAG,MAAE2E,GAAO2E,EAAA,OAAK0kE,EAAAA,EAAcgR,sBAAsB3J,EAAWr1E,EAAK2E,EAAM,OACtGm6E,EAAY31E,KAAII,IAAA,IAAC,IAAEvJ,GAAKuJ,EAAA,OAAKykE,EAAAA,EAAciR,yBAAyB5J,EAAWr1E,EAAI,MAGxF,OAAO++E,CAAc,EAEvBG,eAAe,EACfC,iBAAkBrB,EAAgB51E,QAAQk3E,GAAWA,IAAWA,EAAO39D,WAAWouD,EAAAA,MAClFl6D,UAAWA,IAiBb,MAAO,CACLqoE,2BAfgC3jE,EAAAA,EAAAA,cAC/BynB,IAA2B,IAADi8C,EACzB,IAAKj8C,EAAMusC,WACT,OAEF,MAAMgR,GAAwB,QAAVtB,EAAAj8C,EAAMx0B,YAAI,IAAAywE,OAAA,EAAVA,EAAY71E,QAAOsB,IAAA,IAAC,IAAExJ,GAAKwJ,EAAA,OAAKxJ,IAAQA,EAAIyhB,WAAWouD,EAAAA,GAAuB,MAAK,GACvGqO,EAAkB,CAChBM,eAAgB18C,EAAMusC,WACtB/gE,KAAM+xE,GAAe,IACrB,GAEJ,CAACnB,IAKDD,gBACD,EM+CoDqB,CAA2B,CAC9E3pE,UAAWA,IAAM65D,GAAmB,GACpCsO,oBAGIpJ,EAA0B,KAAXxsE,EAEfq3E,EAA6B1S,EAAO/nD,MAAMgd,KAAW/H,EAAAA,EAAAA,QAAM+7C,EAAAA,EAAAA,IAAwBh0C,MAGnF09C,GAAsBl4E,EAAAA,EAAAA,UAC1B,IAAQi4E,EAA8E,GAAjD,CAACnK,EAAAA,GAAiCS,cACvE,CAAC0J,IAIGE,GAAqBn4E,EAAAA,EAAAA,UACzB,IAAM,IAAoB,OAAfw0E,QAAe,IAAfA,EAAAA,EAAmB,MAAQ0D,IACtC,CAAC1D,EAAiB0D,IAGdE,GAAmBp4E,EAAAA,EAAAA,UACvB,SAAAq4E,EAAA,MAAM,IAA0B,QAAzBA,EAAI/C,EAAQ7H,qBAAa,IAAA4K,EAAAA,EAAI,MAAQF,EAAmB,GAC/D,CAAC7C,EAAS6C,IAGZ,OACE7kF,EAAAA,EAAAA,IAAA,OACEM,KAAGC,EAAAA,EAAAA,IAAE,CACHmD,QAAS,OACT2Q,cAAe,SACfpM,IAAK3F,EAAMgN,QAAQC,GACnBtU,OAAQ,OACR6E,SAAU,UACX,IAACC,SAAA,EAEFJ,EAAAA,EAAAA,GAACqhF,GAAkB,CACjBlP,cAAeA,EACfxkE,OAAQA,EACR2zE,eAAgB/xE,EAChBirE,cAAoC,QAAvBqI,EAAER,EAAQ7H,qBAAa,IAAAqI,EAAAA,EAAI,GACxCtB,gBAAiB2D,EACjB1D,mBAAoBA,EACpBlH,aAAcA,EACdC,gBAAiBA,EACjB4F,cAAelL,EACfG,gBAAiBA,KAEnBp1E,EAAAA,EAAAA,GAAC85E,GAAe,CACd3H,cAAeA,EACfh+D,QAASA,EACTm+D,OAAQA,EACR3G,QAASA,EACTqB,MAAOA,EACP+M,eAAgBA,EAChBC,gBAAiByJ,EACjB9O,YAAaA,EACbC,gBAAiBA,EACjBsF,eAAgBA,EAChBD,WAAYA,EACZoL,cAAepQ,EACfkF,aAAcA,EACdC,eAAgBA,IAAM7qE,EAAU,IAChCirE,cAAe2K,EACf1K,oBAAqBuK,EACrB3K,WAAaiL,IAGX,IAAIC,EAAAA,EAAAA,YAAWD,GACb,OAAOjL,GAAYmL,IACjB,MAAMC,EAAWH,EAAcE,GACzBE,EAAgBF,EAAa,GACnC,OAAMC,GAAgC,IAApBA,EAAShrF,SAAiBirF,EAGrCD,EAFE,CAAC,CAAE9pF,GAAI+pF,EAAc/pF,GAAIk3E,MAAO6S,EAAc7S,MAExC,GAEnB,EAEFT,QAASA,EACTkI,aAAcA,EACdC,gBAAiBA,EACjBnF,gBAAiBA,IAElB2N,IACC/iF,EAAAA,EAAAA,GAAC0+E,GAAe,CACdC,UAAW2E,EACX1E,iBAAkBjT,EAClBmP,UAAWiI,EACXxpE,QAASA,IAAMypE,OAAmB77E,KAGrCu8E,IACG,C,6XC7MV,MAIazI,EAA4B,mBAMnC0K,EAAwBA,CAAChH,EAA2B1nD,KAAmB,IAAD2uD,EAAAC,EAC1E,OAAiC,QAAjCD,EAAOjH,EAAUmH,wBAAgB,IAAAF,GAAkC,QAAlCC,EAA1BD,EAA4B5yE,MAAKhY,IAAA,IAAC,IAAEyK,GAAKzK,EAAA,OAAKyK,IAAQwxB,CAAK,WAAC,IAAA4uD,OAAlC,EAA1BA,EAA8Dz7E,KAAK,EAG/D6sE,EAAoC8O,GACxCA,EAActrF,QAP2B,IAUrCs5E,EAAqB4K,GAChCgH,EAAsBhH,EAnBY,oBAqBvBpD,EAA2BoD,GACtCgH,EAAsBhH,EArBkB,gBAuB7BnH,EAAsBmH,IACjC,MAAMxD,EAASwK,EAAsBhH,EAvBH,sBAwBlC,KAAIn/C,EAAAA,EAAAA,OAAM27C,GAGV,IACE,OAAOh6E,KAAKK,UAAUL,KAAKC,MAAM+5E,GACnC,CAAE,MAAO5gF,GACP,OAAO4gF,CACT,GAGWzD,EAAuBiH,IAClC,MAAMvD,EAAUuK,EAAsBhH,EAlCH,uBAmCnC,KAAIn/C,EAAAA,EAAAA,OAAM47C,GAGV,IACE,OAAOj6E,KAAKK,UAAUL,KAAKC,MAAMg6E,GACnC,CAAE,MAAO7gF,GACP,OAAO6gF,CACT,GAGWJ,EAAmBA,CAAC2D,EAA2BqH,KAAqB,IAADC,EAAAC,EAC9E,OAAqB,QAArBD,EAAOtH,EAAU5rE,YAAI,IAAAkzE,GAAoC,QAApCC,EAAdD,EAAgBjzE,MAAKnR,IAAA,IAAC,IAAE4D,GAAK5D,EAAA,OAAK4D,IAAQugF,CAAO,WAAC,IAAAE,OAApC,EAAdA,EAAoD97E,KAAK,EAGrDu1E,EAAuBhB,GAC3B3D,EAAiB2D,EAAW1D,IAA8B0D,EAAU7K,WAGhElB,EAAqC,CAAC,gBAItCsF,EAAiC,SAEvC,IAAK2C,EAAgC,SAAhCA,GAAgC,OAAhCA,EAAgC,uBAAhCA,EAAgC,sBAAhCA,EAAgC,2BAAhCA,EAAgC,gBAAhCA,EAAgC,kBAAhCA,EAAgC,kBAAhCA,EAAgC,2BAAhCA,EAAgC,gBAAhCA,EAAgC,kBAAhCA,EAAgC,YAAhCA,EAAgC,gBAAhCA,CAAgC,MAcrC,MAAMD,EAAqG,CAChH,CAACC,EAAiCC,YAAYqL,EAAAA,EAAAA,IAAc,CAAAxqF,GAAA,SAC1D6S,eAAe,eAGjB,CAACqsE,EAAiCE,YAAYoL,EAAAA,EAAAA,IAAc,CAAAxqF,GAAA,SAC1D6S,eAAe,eAGjB,CAACqsE,EAAiCK,cAAciL,EAAAA,EAAAA,IAAc,CAAAxqF,GAAA,SAC5D6S,eAAe,iBAGjB,CAACqsE,EAAiCvuE,SAAS65E,EAAAA,EAAAA,IAAc,CAAAxqF,GAAA,SACvD6S,eAAe,WAGjB,CAACqsE,EAAiCM,SAASgL,EAAAA,EAAAA,IAAc,CAAAxqF,GAAA,SACvD6S,eAAe,YAGjB,CAACqsE,EAAiCO,UAAU+K,EAAAA,EAAAA,IAAc,CAAAxqF,GAAA,SACxD6S,eAAe,aAGjB,CAACqsE,EAAiCxmE,UAAU8xE,EAAAA,EAAAA,IAAc,CAAAxqF,GAAA,SACxD6S,eAAe,aAGjB,CAACqsE,EAAiCS,cAAc6K,EAAAA,EAAAA,IAAc,CAAAxqF,GAAA,SAC5D6S,eAAe,WAGjB,CAACqsE,EAAiCzoE,SAAS+zE,EAAAA,EAAAA,IAAc,CAAAxqF,GAAA,SACvD6S,eAAe,WAGjB,CAACqsE,EAAiCW,UAAU2K,EAAAA,EAAAA,IAAc,CAAAxqF,GAAA,SACxD6S,eAAe,mBAGjB,CAACqsE,EAAiC9nE,OAAOozE,EAAAA,EAAAA,IAAc,CAAAxqF,GAAA,SACrD6S,eAAe,UAKNynE,EAAmC,CAC9CmQ,MAAO,KACPC,aAAaF,EAAAA,EAAAA,IAAc,CAAAxqF,GAAA,SACzB6S,eAAe,gBAGjB83E,IAAIH,EAAAA,EAAAA,IAAc,CAAAxqF,GAAA,SAChB6S,eAAe,OAGjB+3E,OAAOJ,EAAAA,EAAAA,IAAc,CAAAxqF,GAAA,SACnB6S,eAAe,U,2GCxIZ,MAAMg4E,EAAwBA,CAACC,EAA0BC,IAC9DD,EAASn0E,SAAWo0E,EAASp0E,QAAUm0E,EAAS/kF,OAASglF,EAAShlF,MAAQ+kF,EAASE,UAAYD,EAASC,QAE7F31E,EAAuB3B,IAClC,MAAM,QAAEC,GAAYD,EACdjE,EAAakE,EAAQlE,WAC3B,IACE,GAAIA,IAAewF,EAAAA,GAAmBC,KAAM,CAC1C,MAAM,IAAEE,GAAQ5P,KAAKC,MAAMkO,EAAQ8C,QACnC,OAAOrB,CACT,CACA,GAAI3F,IAAewF,EAAAA,GAAmBO,GAAI,CACxC,MAAM,IAAEgB,GAAQhR,KAAKC,MAAMkO,EAAQ8C,QACnC,OAAOD,CACT,CACA,GAAI/G,IAAewF,EAAAA,GAAmBE,aAAc,CAClD,MAAM,KAAE81E,GAASzlF,KAAKC,MAAMkO,EAAQ8C,QACpC,MAAO,mCAAmCw0E,GAC5C,CACF,CAAE,MACA,OAAO,IACT,CACA,OAAO,IAAI,C,yJCVb,MAAMC,EAAQ,CACZC,YAAY9mF,EAAAA,EAAAA,GAAC+mF,EAAAA,IAAQ,IACrBC,aAAahnF,EAAAA,EAAAA,GAACinF,EAAAA,IAAQ,IACtBC,QAAQlnF,EAAAA,EAAAA,GAACmnF,EAAAA,IAAU,IACnBC,SAASpnF,EAAAA,EAAAA,GAACqnF,EAAAA,IAAW,IACrBC,OAAOtnF,EAAAA,EAAAA,GAAC0hB,EAAAA,EAAS,IACjB3gB,MAAMf,EAAAA,EAAAA,GAACunF,EAAAA,IAAa,IACpBzmF,OAAOd,EAAAA,EAAAA,GAACwnF,EAAAA,IAAc,KAGXx6B,EAAoBhyD,IAQ1B,IAR2B,SAChCoF,EAAQ,QACRyZ,EAAO,gBACPozC,GAKDjyD,EACC,MAAM,kBAAEysF,IAAsB5vD,EAAAA,EAAAA,YAAW6vD,EAAAA,GAEzC,OACE1nF,EAAAA,EAAAA,GAAC2nF,EAAAA,EAAQC,aAAY,CACnBf,MAAOA,EACPz5B,QAAS,CACPvzC,QAASA,EACTguE,aAAcJ,EACdx6B,gBAAkB66B,GAAM76B,EAAgB66B,IACxC1nF,SAEDA,GACoB,C,+FCDpB,SAAS63D,EAAc8vB,GAO5B,OAhDF,SAA8BC,GAC5B,OAAOC,EAAAA,EAAAA,sBACLhnF,EAAAA,aACGmzD,IACC4zB,EAAUngF,iBAAiB,SAAUusD,GAC9B,KACL4zB,EAAUzvC,oBAAoB,SAAU6b,EAAS,IAGrD,CAAC4zB,KAEH,IAAMA,EAAU5nB,SAEpB,CAmCS8nB,CADWjnF,EAAAA,SAAc,IAAMuI,OAAO2+E,WAAWJ,IAAQ,CAACA,IAEnE,C,2GC8KA,MA7NmC,CACjC,2BAA4B,CAC1BzQ,WACE,8NACFlnE,SAAU,OACVzM,WAAY,QACZ+mD,UAAW,MACXtI,UAAW,OACXvwC,WAAY,MACZu2E,YAAa,SACb/Q,UAAW,SACXgR,WAAY,IACZC,SAAU,IACVC,QAAS,IACTC,cAAe,OACfC,WAAY,OACZC,UAAW,OACXC,QAAS,OACT3nF,WAAY,UACZoD,MAAO,WAET,0BAA2B,CACzBkzE,WACE,8NACFlnE,SAAU,OACVzM,WAAY,QACZ+mD,UAAW,MACXtI,UAAW,OACXvwC,WAAY,MACZu2E,YAAa,SACb/Q,UAAW,SACXgR,WAAY,IACZC,SAAU,IACVC,QAAS,IACTC,cAAe,OACfC,WAAY,OACZC,UAAW,OACXC,QAAS,OACT3nF,WAAY,UACZoD,MAAO,UACP3D,QAAS,MACT4xB,OAAQ,SACRlyB,SAAU,QAEZ,iCAAkC,CAChCiQ,SAAU,OAEZ,0CAA2C,CACzCw4E,WAAY,OACZ5nF,WAAY,WAEd,2CAA4C,CAC1C4nF,WAAY,OACZ5nF,WAAY,WAEd,2CAA4C,CAC1C4nF,WAAY,OACZ5nF,WAAY,WAEd,4CAA6C,CAC3C4nF,WAAY,OACZ5nF,WAAY,WAEd,qCAAsC,CACpC4nF,WAAY,OACZ5nF,WAAY,WAEd,sCAAuC,CACrC4nF,WAAY,OACZ5nF,WAAY,WAEd,sCAAuC,CACrC4nF,WAAY,OACZ5nF,WAAY,WAEd,uCAAwC,CACtC4nF,WAAY,OACZ5nF,WAAY,WAEd,uCAAwC,CACtCP,QAAS,OACT+C,aAAc,QAEhBqlF,QAAS,CACPzkF,MAAO,WAET0kF,OAAQ,CACN1kF,MAAO,WAET2kF,QAAS,CACP3kF,MAAO,WAET4kF,MAAO,CACL5kF,MAAO,WAET6kF,YAAa,CACX7kF,MAAO,WAET8kF,UAAW,CACTC,QAAS,MAEXl2E,IAAK,CACH7O,MAAO,WAETglF,SAAU,CACRhlF,MAAO,WAETiX,OAAQ,CACNjX,MAAO,WAETilF,SAAU,CACRjlF,MAAO,WAETklF,SAAU,CACRllF,MAAO,WAET,SAAU,CACRA,MAAO,WAETmlF,SAAU,CACRnlF,MAAO,WAET,YAAa,CACXA,MAAO,WAET,2BAA4B,CAC1BA,MAAO,WAET,YAAa,CACXA,MAAO,WAET,oBAAqB,CACnBA,MAAO,WAET,qBAAsB,CACpBA,MAAO,WAETolF,QAAS,CACPplF,MAAO,WAETqlF,OAAQ,CACNrlF,MAAO,WAETslF,OAAQ,CACNtlF,MAAO,UACPf,OAAQ,QAEV0N,IAAK,CACH3M,MAAO,WAET,8BAA+B,CAC7BA,MAAO,WAET,+BAAgC,CAC9BA,MAAO,WAET,uBAAwB,CACtBA,MAAO,WAET,aAAc,CACZA,MAAO,WAETulF,QAAS,CACPvlF,MAAO,WAETwlF,QAAS,CACPxlF,MAAO,WAETylF,UAAW,CACTzlF,MAAO,WAET0lF,KAAM,CACJ1lF,MAAO,WAET2lF,UAAW,CACT3lF,MAAO,WAET4lF,MAAO,CACL5lF,MAAO,WAET6lF,OAAQ,CACN7lF,MAAO,WAET2L,YAAa,CACX3L,MAAO,WAETonB,SAAU,CACRpnB,MAAO,WAETw2B,QAAS,CACPsvD,eAAgB,gBAElBC,SAAU,CACRv0D,aAAc,qBACds0D,eAAgB,QAElBE,OAAQ,CACNC,UAAW,UAEbC,UAAW,CACTxwC,WAAY,OACZ11C,MAAO,WAETukB,KAAM,CACJmxB,WAAY,QAEd,uBAAwB,CACtBywC,QAAS,qBACTC,cAAe,QAEjB,gDAAiD,CAC/CC,iBAAkB,WAEpB,iDAAkD,CAChDrmF,MAAO,WAET,iCAAkC,CAChCpD,WAAY,kFCXhB,MA5M6B,CAC3B,2BAA4B,CAC1BohD,UAAW,OACXvwC,WAAY,MACZu2E,YAAa,SACb/Q,UAAW,SACXqT,SAAU,SACVtmF,MAAO,kBACPpD,WAAY,UACZs2E,WAAY,mEACZlnE,SAAU,OACVzM,WAAY,QACZ0kF,WAAY,IACZC,SAAU,IACVC,QAAS,IACTC,cAAe,OACfC,WAAY,OACZC,UAAW,OACXC,QAAS,QAEX,0BAA2B,CACzBvmC,UAAW,OACXvwC,WAAY,MACZu2E,YAAa,SACb/Q,UAAW,SACXqT,SAAU,SACVtmF,MAAO,kBACPpD,WAAY,UACZs2E,WAAY,mEACZlnE,SAAU,OACVzM,WAAY,QACZ0kF,WAAY,IACZC,SAAU,IACVC,QAAS,IACTC,cAAe,OACfC,WAAY,OACZC,UAAW,OACXC,QAAS,OACTxoF,SAAU,OACVF,SAAU,WACVoyB,OAAQ,UACR5xB,QAAS,cAEX,2CAA4C,CAC1CO,WAAY,UACZoD,MAAO,WAET,0CAA2C,CACzCpD,WAAY,UACZoD,MAAO,WAET,4CAA6C,CAC3CpD,WAAY,UACZoD,MAAO,WAET,2CAA4C,CAC1CpD,WAAY,UACZoD,MAAO,WAET,sCAAuC,CACrCpD,WAAY,UACZoD,MAAO,WAET,qCAAsC,CACpCpD,WAAY,UACZoD,MAAO,WAET,uCAAwC,CACtCpD,WAAY,UACZoD,MAAO,WAET,sCAAuC,CACrCpD,WAAY,UACZoD,MAAO,WAET,uCAAwC,CACtCyN,WAAY,SACZrO,aAAc,QACd/C,QAAS,SAEX,uBAAwB,CACtB2D,MAAO,WAET,wBAAyB,CACvBA,MAAO,WAET,wBAAyB,CACvBA,MAAO,WAET,kCAAmC,CACjC+kF,QAAS,OAEXc,OAAQ,CACN7lF,MAAO,WAET,YAAa,CACXA,MAAO,WAET,aAAc,CACZA,MAAO,WAETkrE,UAAW,CACTlrE,MAAO,WAETolF,QAAS,CACPplF,MAAO,WAETumF,QAAS,CACPvmF,MAAO,WAET4kF,MAAO,CACL5kF,MAAO,WAETi7D,KAAM,CACJj7D,MAAO,WAETwmF,MAAO,CACLxmF,MAAO,WAET,aAAc,CACZA,MAAO,WAETykF,QAAS,CACPzkF,MAAO,WAETymF,SAAU,CACRzmF,MAAO,WAETw2B,QAAS,CACPx2B,MAAO,WAET2kF,QAAS,CACP3kF,MAAO,WAETslF,OAAQ,CACNtlF,MAAO,WAETklF,SAAU,CACRllF,MAAO,WAET0mF,QAAS,CACP1mF,MAAO,WAETzI,GAAI,CACFyI,MAAO,UACP01C,WAAY,QAEdwwC,UAAW,CACTlmF,MAAO,UACP01C,WAAY,QAEdqwC,SAAU,CACR/lF,MAAO,WAETulF,QAAS,CACPvlF,MAAO,WAETiX,OAAQ,CACNjX,MAAO,WAETglF,SAAU,CACRhlF,MAAO,WAET0kF,OAAQ,CACN1kF,MAAO,WAETilF,SAAU,CACRjlF,MAAO,WAET,eAAgB,CACdA,MAAO,WAET,iBAAkB,CAChBA,MAAO,WAET6kF,YAAa,CACX7kF,MAAO,mBAET4lF,MAAO,CACL5lF,MAAO,WAETmlF,SAAU,CACRnlF,MAAO,WAETqlF,OAAQ,CACNrlF,MAAO,WAET2mF,OAAQ,CACN3mF,MAAO,WAET6O,IAAK,CACH7O,MAAO,WAET0lF,KAAM,CACJ1lF,MAAO,WAET2M,IAAK,CACH3M,MAAO,WAETonB,SAAU,CACRpnB,MAAO,Y,qBC3MX4mF,EAAAA,EAAkBC,iBAAiB,SAAUC,EAAAA,GAC7CF,EAAAA,EAAkBC,iBAAiB,OAAQxrF,EAAAA,GASpC,MAKM0rF,EAAiB,OAExBC,EAA8C,CAClDC,MAAOC,EACPC,YAAaC,GA4CR,SAASjrF,EAAWvF,GASL,IATM,MAC1B2H,EAAQ,QAAO,SACfnC,EAAQ,QACRirF,EAAO,MACPvsF,EAAK,SACLkB,EAAQ,gBACRg5E,EAAe,gBACfsS,EAAe,cACf5pF,GACiB9G,EACjB,MAAM2wF,EAAc,CAClB7nF,OAAQ,OACRN,aAAc,EACd6uB,OAAQ,EACR5xB,QAAS0qF,KACNjsF,GAGL,OACEc,EAAAA,EAAAA,GAACgrF,EAAAA,EAAiB,CAChB5R,gBAAiBA,EACjBsS,gBAAiBA,EACjBlrF,SAAUA,EACVtB,MAAOksF,EAAazoF,GACpBgpF,YAAaA,EACbC,aAAc,CACZ1sF,OAAO8/C,EAAAA,EAAAA,MAAK9/C,EAAO,oBAErB4C,cAAeA,EAAc1B,SAE5BA,GAGP,C","sources":["common/static/chart-bar.svg","common/static/chart-contour.svg","common/static/chart-difference.svg","common/static/chart-image.svg","common/static/chart-line.svg","common/static/chart-parallel.svg","common/static/chart-scatter.svg","common/static/registered-model-grey-ok.svg","common/components/JsonFormatting.tsx","common/components/ToggleIconButton.tsx","common/hooks/useDragAndDropElement.tsx","common/hooks/useIsTabActive.tsx","common/utils/CssGrid.utils.ts","common/utils/LocalStorageUtils.ts","common/utils/useElementHeight.ts","experiment-tracking/components/ExperimentSourceTypeIcon.tsx","experiment-tracking/components/RunStatusIcon.tsx","experiment-tracking/components/experiment-page/components/RunColorPill.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewDatasetSchemaTable.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewDatasetSchema.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewDatasetLink.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewDatasetSourceType.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewDatasetSourceURL.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewDatasetDigest.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewDatasetDrawer.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewDatasetWithContext.tsx","experiment-tracking/components/experiment-page/components/runs/cells/SourceCellRenderer.tsx","experiment-tracking/components/experiment-page/contexts/ExperimentPageUIStateContext.tsx","experiment-tracking/components/experiment-page/hooks/useExperimentIds.ts","experiment-tracking/components/experiment-page/hooks/usePopulateImagesByRunUuid.tsx","experiment-tracking/components/modals/ConfirmModal.tsx","experiment-tracking/components/modals/DeleteRunModal.tsx","experiment-tracking/components/modals/GenericInputModal.tsx","experiment-tracking/components/modals/RenameForm.tsx","experiment-tracking/components/modals/RenameRunModal.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigure.common.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureBarChart.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureParallelChart.tsx","experiment-tracking/components/runs-charts/components/RunsChartsYAxisMetricAndExpressionSelector.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureLineChart.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureLineChart.preview.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureParallelChart.preview.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureContourChart.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureScatterChart.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureDifferenceChart.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureImageChart.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureImageChart.preview.tsx","experiment-tracking/components/runs-charts/components/RunsChartsConfigureModal.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureBarChart.preview.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureContourChart.preview.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureScatterChart.preview.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureDifferenceChart.preview.tsx","experiment-tracking/components/runs-charts/components/RunsChartsDraggableCardsGridContext.tsx","experiment-tracking/components/runs-charts/components/RunsChartsFilterInput.tsx","experiment-tracking/components/runs-charts/components/RunsChartsFullScreenModal.tsx","experiment-tracking/components/runs-charts/components/RunsChartsGlobalChartSettingsDropdown.tsx","experiment-tracking/components/runs-charts/components/RunsChartsNoDataFoundIndicator.tsx","experiment-tracking/components/runs-charts/components/RunsChartsTooltipBody.tsx","experiment-tracking/components/runs-charts/components/RunsContourPlot.tsx","experiment-tracking/components/runs-charts/components/RunsMetricsBarPlot.tsx","experiment-tracking/components/runs-charts/components/RunsMetricsLegend.tsx","experiment-tracking/components/runs-charts/components/RunsMetricsLegendWrapper.tsx","experiment-tracking/components/runs-charts/hooks/useRunsChartsMultipleTracesTooltip.tsx","experiment-tracking/components/runs-charts/utils/expressionCharts.utils.ts","experiment-tracking/components/runs-charts/components/RunsMetricsLinePlot.tsx","experiment-tracking/components/runs-charts/components/RunsMultipleTracesTooltipBody.tsx","experiment-tracking/components/runs-charts/components/RunsScatterPlot.tsx","experiment-tracking/components/runs-charts/components/cards/ChartCard.common.tsx","experiment-tracking/components/runs-charts/components/cards/RunsChartsBarChartCard.tsx","experiment-tracking/components/runs-charts/components/cards/RunsChartsLineChartCard.tsx","experiment-tracking/components/runs-charts/hooks/useCompareRunChartSelectedRange.tsx","experiment-tracking/components/runs-charts/components/cards/RunsChartsScatterChartCard.tsx","experiment-tracking/components/runs-charts/components/cards/RunsChartsContourChartCard.tsx","common/static/parallel-chart-placeholder.svg","experiment-tracking/components/runs-charts/components/cards/RunsChartsParallelChartCard.tsx","experiment-tracking/components/runs-charts/components/cards/RunsChartsDifferenceChartCard.tsx","experiment-tracking/components/runs-charts/components/cards/RunsChartsImageChartCard.tsx","experiment-tracking/components/runs-charts/components/cards/RunsChartsCard.tsx","experiment-tracking/components/runs-charts/components/charts/DifferenceViewPlot.tsx","experiment-tracking/components/runs-charts/components/charts/DifferenceViewPlotV2.tsx","experiment-tracking/components/runs-charts/components/charts/ImageGridPlot.common.tsx","experiment-tracking/components/runs-charts/components/charts/ImageGridSingleKeyPlot.tsx","experiment-tracking/components/runs-charts/components/charts/ImageGridMultipleKeyPlot.tsx","experiment-tracking/components/runs-charts/components/charts/ImageGridPlot.tsx","experiment-tracking/components/runs-charts/components/charts/LazyParallelCoordinatesPlot.tsx","experiment-tracking/components/runs-charts/components/hooks/useLineChartGlobalConfig.tsx","experiment-tracking/components/MetricChartsAccordion.tsx","experiment-tracking/components/runs-charts/components/RunsChartsAddChartMenu.tsx","experiment-tracking/components/runs-charts/components/sections/RunsChartsSectionHeader.tsx","experiment-tracking/components/runs-charts/components/RunsCharts.tsx","experiment-tracking/components/runs-charts/hooks/useIsInViewportV2.tsx","experiment-tracking/components/runs-charts/components/RunsChartsDraggableCard.tsx","experiment-tracking/components/runs-charts/components/RunsChartsDraggablePreview.tsx","experiment-tracking/components/runs-charts/components/RunsChartsDraggableCardsGridSection.tsx","experiment-tracking/components/runs-charts/components/sections/RunsChartsSection.tsx","experiment-tracking/components/runs-charts/components/sections/RunsChartsSectionAccordion.tsx","experiment-tracking/components/runs-charts/hooks/useChartExpressionParser.tsx","experiment-tracking/components/runs-charts/hooks/useChartImageDownloadHandler.tsx","experiment-tracking/components/runs-charts/hooks/useImageSliderStepMarks.tsx","experiment-tracking/components/runs-charts/hooks/useIsInViewport.tsx","experiment-tracking/components/runs-charts/hooks/useMutableHoverCallback.tsx","experiment-tracking/components/runs-charts/hooks/useRunsChartTraceHighlight.ts","experiment-tracking/components/runs-charts/hooks/useRunsChartsTooltip.tsx","experiment-tracking/components/runs-charts/hooks/useRunsChartsUIConfiguration.tsx","experiment-tracking/components/runs-charts/hooks/useSampledMetricHistoryGraphQL.tsx","experiment-tracking/components/runs-charts/hooks/useSampledMetricHistory.tsx","experiment-tracking/components/runs-charts/utils/differenceView.ts","experiment-tracking/components/runs-charts/utils/findChartStepsByTimestamp.ts","experiment-tracking/components/runs-charts/utils/runsCharts.const.ts","experiment-tracking/components/runs-compare/hooks/useGroupedChartRunData.tsx","experiment-tracking/components/traces/hooks/useExperimentTraces.tsx","experiment-tracking/components/traces/TracesViewTableTagCell.tsx","experiment-tracking/components/traces/TracesViewTableStatusCell.tsx","experiment-tracking/components/traces/TracesViewTablePreviewCell.tsx","experiment-tracking/components/traces/TracesViewTableSourceCell.tsx","experiment-tracking/components/traces/TracesViewTable.utils.ts","experiment-tracking/components/traces/TracesViewTableRow.tsx","experiment-tracking/components/traces/TracesViewTableTimestampCell.tsx","experiment-tracking/components/traces/TracesViewTableHeaderCheckbox.tsx","experiment-tracking/components/traces/TracesViewTableCellCheckbox.tsx","experiment-tracking/components/traces/quickstart/TraceTableLangchainQuickstartContent.tsx","experiment-tracking/components/traces/quickstart/TraceTableLlamaIndexQuickstartContent.tsx","experiment-tracking/components/traces/quickstart/TraceTableCustomQuickstartContent.tsx","experiment-tracking/components/traces/quickstart/TraceTableAutogenQuickstartContent.tsx","experiment-tracking/components/traces/quickstart/TraceTableOpenAIQuickstartContent.tsx","experiment-tracking/components/traces/quickstart/TracesViewTableNoTracesQuickstart.tsx","experiment-tracking/components/traces/TracesViewTable.tsx","shared/web-shared/model-trace-explorer/ModelTraceExplorerFrameRenderer.tsx","shared/web-shared/model-trace-explorer/index.ts","experiment-tracking/components/traces/hooks/useExperimentTraceInfo.tsx","experiment-tracking/components/traces/TraceDataDrawer.tsx","experiment-tracking/components/traces/hooks/useExperimentTraceData.tsx","experiment-tracking/components/traces/hooks/useEditExperimentTraceTags.tsx","experiment-tracking/components/traces/TracesViewDeleteTraceModal.tsx","experiment-tracking/components/traces/TracesViewControlsActions.tsx","experiment-tracking/components/traces/TracesViewControls.tsx","experiment-tracking/components/traces/hooks/useExperimentViewTracesUIState.tsx","experiment-tracking/components/traces/hooks/useActiveExperimentTrace.tsx","experiment-tracking/components/traces/TracesView.tsx","experiment-tracking/components/traces/TracesView.utils.ts","experiment-tracking/utils/DatasetUtils.ts","shared/building_blocks/Image.tsx","shared/web-shared/hooks/useMediaQuery.ts","shared/web-shared/snippet/theme/databricks-duotone-dark.ts","shared/web-shared/snippet/theme/databricks-light.ts","shared/web-shared/snippet/index.tsx"],"sourcesContent":["var _path, _rect, _rect2, _rect3, _rect4;\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nimport * as React from \"react\";\nfunction SvgChartBar(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 18,\n    height: 16,\n    viewBox: \"0 0 18 16\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1 0.813599V15.1865H17\",\n    stroke: \"#A3AEB8\",\n    strokeLinecap: \"round\"\n  })), _rect || (_rect = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 3.16943,\n    y: 10.5763,\n    width: 2.16949,\n    height: 3.25424,\n    fill: \"#338ECC\"\n  })), _rect2 || (_rect2 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 6.42371,\n    y: 5.15259,\n    width: 2.16949,\n    height: 8.67797,\n    fill: \"#338ECC\"\n  })), _rect3 || (_rect3 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 9.67798,\n    y: 8.40686,\n    width: 2.16949,\n    height: 5.42373,\n    fill: \"#338ECC\"\n  })), _rect4 || (_rect4 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 12.9323,\n    y: 1.89832,\n    width: 2.16949,\n    height: 11.9322,\n    fill: \"#338ECC\"\n  })));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgChartBar);\nexport default __webpack_public_path__ + \"static/media/chart-bar.0fd4a63680fba840a7b69fbf07969f79.svg\";\nexport { ForwardRef as ReactComponent };","var _path, _path2, _path3;\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nimport * as React from \"react\";\nfunction SvgChartContour(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 18,\n    height: 18,\n    viewBox: \"0 0 18 18\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1 1V17H17\",\n    stroke: \"#A3AEB8\",\n    strokeLinecap: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M12.9749 4.94148C12.9188 4.71702 12.221 4.73284 12.0618 4.71515C11.1779 4.61693 10.2817 4.66052 9.39271 4.66052C8.11919 4.66052 7.15648 4.97961 6.24753 5.90922C5.86197 6.30355 5.5235 6.77684 5.23295 7.24378C4.99434 7.62726 4.65544 7.93479 4.40569 8.31299C3.93777 9.02154 3.56281 9.80723 3.56281 10.6699C3.56281 11.1806 3.37479 11.598 3.76962 12.0669C4.19449 12.5714 4.6863 12.9507 5.27978 13.2649C5.88594 13.5858 6.42202 13.8619 7.13723 13.8619C7.74338 13.8619 8.34952 13.8619 8.95567 13.8619C9.45735 13.8619 9.96042 13.8731 10.4619 13.8619C11.1412 13.8468 11.9484 13.1895 12.413 12.7381C13.581 11.6035 14.2393 9.88016 14.2393 8.24665C14.2393 7.69923 14.3797 7.17063 14.3797 6.62723C14.3797 6.40084 14.4779 5.87696 14.2744 5.71411C13.9268 5.43606 13.5785 5.13789 13.1857 4.94148\",\n    stroke: \"#338ECC\",\n    strokeLinecap: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M11.9213 6.83789C11.2761 6.83789 10.6309 6.83789 9.98577 6.83789C9.19776 6.83789 8.80182 7.44144 8.2844 7.97734C7.58163 8.70521 7.28544 9.67306 7.28544 10.666C7.28544 10.9641 7.22004 11.177 7.46104 11.3645C7.6831 11.5372 8.10719 11.6142 8.37806 11.6142C9.07316 11.6142 9.91042 11.5583 10.4462 11.0523C10.9277 10.5975 11.473 10.3701 11.8159 9.75284C12.045 9.34042 12.2022 8.86324 12.2022 8.38317C12.2022 8.14903 12.2022 7.9149 12.2022 7.68077C12.2022 7.4241 12.0208 7.38817 11.9213 7.18909\",\n    stroke: \"#338ECC\",\n    strokeLinecap: \"round\"\n  })));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgChartContour);\nexport default __webpack_public_path__ + \"static/media/chart-contour.0d4b306f2669f3ad25375568935e3ce3.svg\";\nexport { ForwardRef as ReactComponent };","var _rect, _rect2, _rect3, _rect4, _rect5, _rect6, _rect7, _rect8, _rect9, _rect10, _rect11, _rect12, _rect13, _rect14, _rect15, _rect16, _rect17, _rect18;\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nimport * as React from \"react\";\nfunction SvgChartDifference(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 16,\n    height: 16,\n    viewBox: \"0 0 16 16\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _rect || (_rect = /*#__PURE__*/React.createElement(\"rect\", {\n    y: 2,\n    width: 4,\n    height: 1,\n    fill: \"#338ECC\"\n  })), _rect2 || (_rect2 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 5,\n    y: 2,\n    width: 4,\n    height: 1,\n    fill: \"#338ECC\"\n  })), _rect3 || (_rect3 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 10,\n    y: 2,\n    width: 4,\n    height: 1,\n    fill: \"#338ECC\"\n  })), _rect4 || (_rect4 = /*#__PURE__*/React.createElement(\"rect\", {\n    y: 4,\n    width: 4,\n    height: 1,\n    fill: \"#338ECC\"\n  })), _rect5 || (_rect5 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 5,\n    y: 4,\n    width: 4,\n    height: 1,\n    fill: \"#338ECC\"\n  })), _rect6 || (_rect6 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 10,\n    y: 4,\n    width: 4,\n    height: 1,\n    fill: \"#338ECC\"\n  })), _rect7 || (_rect7 = /*#__PURE__*/React.createElement(\"rect\", {\n    y: 6,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect8 || (_rect8 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 5,\n    y: 6,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect9 || (_rect9 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 10,\n    y: 6,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect10 || (_rect10 = /*#__PURE__*/React.createElement(\"rect\", {\n    y: 8,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect11 || (_rect11 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 5,\n    y: 8,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect12 || (_rect12 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 10,\n    y: 8,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect13 || (_rect13 = /*#__PURE__*/React.createElement(\"rect\", {\n    y: 10,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect14 || (_rect14 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 5,\n    y: 10,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect15 || (_rect15 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 10,\n    y: 10,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect16 || (_rect16 = /*#__PURE__*/React.createElement(\"rect\", {\n    y: 12,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect17 || (_rect17 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 5,\n    y: 12,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect18 || (_rect18 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 10,\n    y: 12,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgChartDifference);\nexport default __webpack_public_path__ + \"static/media/chart-difference.16174216d6f3b7c24f40e3541fe0ca2c.svg\";\nexport { ForwardRef as ReactComponent };","var _rect, _line, _line2, _line3;\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nimport * as React from \"react\";\nfunction SvgChartImage(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 16,\n    height: 16,\n    viewBox: \"0 0 16 16\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _rect || (_rect = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 0.5,\n    y: 0.5,\n    width: 15,\n    height: 15,\n    stroke: \"#C4C4C4\"\n  })), _line || (_line = /*#__PURE__*/React.createElement(\"line\", {\n    x1: 8.5,\n    y1: 0.800049,\n    x2: 8.5,\n    y2: 16,\n    stroke: \"#C4C4C4\"\n  })), _line2 || (_line2 = /*#__PURE__*/React.createElement(\"line\", {\n    x1: 16,\n    y1: 5.69995,\n    x2: -2.63656e-8,\n    y2: 5.69995,\n    stroke: \"#C4C4C4\"\n  })), _line3 || (_line3 = /*#__PURE__*/React.createElement(\"line\", {\n    x1: 16,\n    y1: 10.9,\n    x2: -2.63656e-8,\n    y2: 10.9,\n    stroke: \"#C4C4C4\"\n  })));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgChartImage);\nexport default __webpack_public_path__ + \"static/media/chart-image.cc434c4dc50780966344e2385a15f8fe.svg\";\nexport { ForwardRef as ReactComponent };","var _path, _path2;\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nimport * as React from \"react\";\nfunction SvgChartLine(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 22,\n    height: 22,\n    viewBox: \"0 0 22 22\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.38977 15.717L8.79655 10.8113L12.5254 14.9622L19.644 7.03772\",\n    stroke: \"#338ECC\",\n    strokeWidth: 2,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1 1V21H21\",\n    stroke: \"#A3AEB8\",\n    strokeLinecap: \"round\"\n  })));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgChartLine);\nexport default __webpack_public_path__ + \"static/media/chart-line.0adaa2036bb4eb5956db6d0c7e925a3d.svg\";\nexport { ForwardRef as ReactComponent };","var _path, _path2, _path3, _path4, _path5;\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nimport * as React from \"react\";\nfunction SvgChartParallel(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 18,\n    height: 18,\n    viewBox: \"0 0 18 18\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1 1V17H17\",\n    stroke: \"#A3AEB8\",\n    strokeLinecap: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.21875 3.58289C4.55663 3.58289 4.88067 3.68935 5.21469 3.73008C5.6474 3.78285 6.02137 3.96513 6.37191 4.21552C6.76902 4.49917 7.0271 4.74589 7.24101 5.18954C7.44337 5.60925 7.59378 6.06989 7.72958 6.51432C7.86002 6.94121 8.09708 7.33726 8.19153 7.77803C8.25347 8.0671 8.34514 8.32427 8.44678 8.60015C8.58028 8.96252 8.80086 9.27915 8.96667 9.62583C9.15145 10.0122 9.216 10.4461 9.34876 10.8551C9.57831 11.5623 9.91132 12.4763 10.7205 12.6731C11.4284 12.8453 12.1459 12.8845 12.8705 12.8845C13.0981 12.8845 13.3979 12.898 13.5831 12.7499C13.6402 12.7042 13.7451 12.6907 13.8164 12.6591C13.8752 12.6329 14.0919 12.5871 14.1123 12.5463\",\n    stroke: \"#CCE3F2\",\n    strokeLinecap: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.16162 12.9805C4.32512 12.9805 4.4895 12.9859 4.65284 12.9805C4.84076 12.9742 5.0468 12.7952 5.2099 12.707C5.62236 12.4841 5.99426 12.0648 6.24299 11.6739C6.49491 11.2781 6.8776 10.9871 7.0887 10.5649C7.27767 10.187 7.50992 9.80749 7.73691 9.45078C7.93911 9.13304 8.10211 8.77722 8.28637 8.44554C8.43088 8.18544 8.45 7.88672 8.60542 7.62768C8.94898 7.05509 9.16215 6.418 9.45873 5.82484C9.72614 5.29001 9.96898 4.82426 10.4159 4.42207C10.5753 4.27853 10.8984 4.21824 11.0995 4.14861C11.3303 4.06873 11.579 4.02714 11.8136 3.93592C12.0394 3.84807 12.2521 3.84383 12.4795 3.77386C12.6993 3.70623 12.9319 3.63713 13.1632 3.63713C13.5192 3.63713 13.9089 3.59155 14.2798 3.59155\",\n    stroke: \"#CCE3F2\",\n    strokeLinecap: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M3.79248 2.74207V13.8225\",\n    stroke: \"#338ECC\",\n    strokeLinecap: \"round\"\n  })), _path5 || (_path5 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M14.873 3.04419V13.7217\",\n    stroke: \"#338ECC\",\n    strokeLinecap: \"round\"\n  })));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgChartParallel);\nexport default __webpack_public_path__ + \"static/media/chart-parallel.da7dedf539b2af4b654d377c679173e4.svg\";\nexport { ForwardRef as ReactComponent };","var _path, _circle, _ellipse, _circle2, _circle3, _ellipse2, _ellipse3;\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nimport * as React from \"react\";\nfunction SvgChartScatter(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 18,\n    height: 16,\n    viewBox: \"0 0 18 16\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1 0.813599V15.1865H17\",\n    stroke: \"#A3AEB8\",\n    strokeLinecap: \"round\"\n  })), _circle || (_circle = /*#__PURE__*/React.createElement(\"circle\", {\n    cx: 3.98301,\n    cy: 12.4746,\n    r: 1.35593,\n    fill: \"#338ECC\"\n  })), _ellipse || (_ellipse = /*#__PURE__*/React.createElement(\"ellipse\", {\n    cx: 9.40684,\n    cy: 10.8475,\n    rx: 1.35593,\n    ry: 1.35593,\n    fill: \"#338ECC\"\n  })), _circle2 || (_circle2 = /*#__PURE__*/React.createElement(\"circle\", {\n    cx: 5.6102,\n    cy: 8.1356,\n    r: 1.35593,\n    fill: \"#338ECC\",\n    fillOpacity: 0.25\n  })), _circle3 || (_circle3 = /*#__PURE__*/React.createElement(\"circle\", {\n    cx: 9.40684,\n    cy: 6.50852,\n    r: 1.35593,\n    fill: \"#338ECC\"\n  })), _ellipse2 || (_ellipse2 = /*#__PURE__*/React.createElement(\"ellipse\", {\n    cx: 13.7457,\n    cy: 5.96616,\n    rx: 1.35593,\n    ry: 1.35593,\n    fill: \"#338ECC\",\n    fillOpacity: 0.25\n  })), _ellipse3 || (_ellipse3 = /*#__PURE__*/React.createElement(\"ellipse\", {\n    cx: 16.4576,\n    cy: 2.46128,\n    rx: 1.35593,\n    ry: 1.35593,\n    fill: \"#338ECC\"\n  })));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgChartScatter);\nexport default __webpack_public_path__ + \"static/media/chart-scatter.69118d0023a6ff3973f7fa913834ac47.svg\";\nexport { ForwardRef as ReactComponent };","var _path, _g, _path2, _path3, _defs;\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nimport * as React from \"react\";\nfunction SvgRegisteredModelGreyOk(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 19,\n    height: 16,\n    viewBox: \"0 0 19 16\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"g\", {\n    clipPath: \"url(#clip0_0_3)\"\n  }, /*#__PURE__*/React.createElement(\"mask\", {\n    id: \"mask0_0_3\",\n    style: {\n      maskType: \"luminance\"\n    },\n    maskUnits: \"userSpaceOnUse\",\n    x: 0,\n    y: 0,\n    width: 16,\n    height: 16\n  }, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16 0H0V16H16V0Z\",\n    fill: \"white\"\n  }))), _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    mask: \"url(#mask0_0_3)\"\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    clipRule: \"evenodd\",\n    d: \"M2.75 3.49999C2.05964 3.49999 1.5 4.05963 1.5 4.74999C1.5 5.44034 2.05964 5.99999 2.75 5.99999C3.44036 5.99999 4 5.44034 4 4.74999C4 4.05963 3.44036 3.49999 2.75 3.49999ZM0 4.74999C0 3.2312 1.23122 1.99999 2.75 1.99999C3.77682 1.99999 4.6722 2.56276 5.14452 3.39669L9.51655 2.44626C9.66772 1.0704 10.8338 0 12.25 0C13.7688 0 15 1.23122 15 2.75C15 3.87686 14.3222 4.84541 13.3521 5.27025L13.6341 7.52661C14.9711 7.71349 16 8.86158 16 10.25C16 11.7688 14.7687 13 13.25 13C12.3895 13 11.6214 12.6048 11.1172 11.9861L8.49749 13.1322C8.49913 13.1713 8.49997 13.2105 8.49997 13.25C8.49996 14.7688 7.26875 16 5.74997 16C4.23118 16 2.99997 14.7688 2.99996 13.25C2.99997 12.3569 3.42568 11.5633 4.08524 11.0609L3.01322 7.48755C2.92659 7.49578 2.83878 7.49999 2.75 7.49999C1.23122 7.49999 0 6.26877 0 4.74999ZM5.46534 5.18782C5.48277 5.07884 5.4938 4.96773 5.49804 4.85488L9.76409 3.92748C10.1528 4.74671 10.9346 5.34321 11.8658 5.47338L12.1478 7.72974C11.7709 7.89483 11.438 8.14204 11.1719 8.44873L5.46534 5.18782ZM4.82802 6.55126C4.70399 6.69422 4.56546 6.82424 4.41471 6.93906L5.48674 10.5124C5.57337 10.5042 5.66118 10.5 5.74997 10.5C6.69483 10.5 7.52839 10.9765 8.02345 11.7023L10.5231 10.6087C10.5079 10.4913 10.5 10.3716 10.5 10.25C10.5 10.101 10.5118 9.95475 10.5346 9.81218L4.82802 6.55126ZM12 10.25C12 9.55963 12.5596 8.99999 13.25 8.99999C13.9403 8.99999 14.5 9.55963 14.5 10.25C14.5 10.9403 13.9403 11.5 13.25 11.5C12.5596 11.5 12 10.9403 12 10.25ZM5.74997 12C5.05961 12 4.49997 12.5596 4.49997 13.25C4.49997 13.9403 5.05961 14.5 5.74997 14.5C6.44032 14.5 6.99997 13.9403 6.99997 13.25C6.99997 12.5596 6.44032 12 5.74997 12ZM11 2.75C11 2.05964 11.5596 1.5 12.25 1.5C12.9403 1.5 13.5 2.05964 13.5 2.75C13.5 3.44036 12.9403 4 12.25 4C11.5596 4 11 3.44036 11 2.75Z\",\n    fill: \"currentColor\"\n  }))), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M13.5 14C15.433 14 17 12.433 17 10.5C17 8.567 15.433 7 13.5 7C11.567 7 10 8.567 10 10.5C10 12.433 11.567 14 13.5 14Z\",\n    fill: \"white\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    clipRule: \"evenodd\",\n    d: \"M11.125 11C11.125 9.41218 12.4122 8.125 14 8.125C15.5878 8.125 16.875 9.41218 16.875 11C16.875 12.5878 15.5878 13.875 14 13.875C12.4122 13.875 11.125 12.5878 11.125 11ZM14 6.625C11.5838 6.625 9.625 8.58375 9.625 11C9.625 13.4162 11.5838 15.375 14 15.375C16.4162 15.375 18.375 13.4162 18.375 11C18.375 8.58375 16.4162 6.625 14 6.625ZM14.0303 12.5303L16.0303 10.5303L14.9697 9.46967L13.5 10.9393L13.0303 10.4697L11.9697 11.5303L12.9697 12.5303L13.5 13.0607L14.0303 12.5303Z\",\n    fill: \"#3CAA60\"\n  }))), _defs || (_defs = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"clipPath\", {\n    id: \"clip0_0_3\"\n  }, /*#__PURE__*/React.createElement(\"rect\", {\n    width: 19,\n    height: 16,\n    fill: \"white\"\n  })))));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgRegisteredModelGreyOk);\nexport default __webpack_public_path__ + \"static/media/registered-model-grey-ok.8274b58d39504c8d1b8c358aa1c9aa35.svg\";\nexport { ForwardRef as ReactComponent };","import React from 'react';\nimport { CodeSnippet } from '@databricks/web-shared/snippet';\nimport { isObject } from 'lodash';\n\ninterface JsonPreviewProps {\n  json: string;\n  wrapperStyle?: React.CSSProperties;\n  overlayStyle?: React.CSSProperties;\n  codeSnippetStyle?: React.CSSProperties;\n}\n\nexport const JsonPreview: React.FC<JsonPreviewProps> = ({ json, wrapperStyle, overlayStyle, codeSnippetStyle }) => {\n  const { formattedJson, isJsonContent } = useFormattedJson(json);\n\n  const defaultWrapperStyle: React.CSSProperties = {\n    position: 'relative',\n    maxHeight: 'calc(1.5em * 9)',\n    overflow: 'hidden',\n  };\n\n  const defaultOverlayStyle: React.CSSProperties = {\n    position: 'absolute',\n    bottom: 0,\n    right: 0,\n    left: 6,\n    height: '2em',\n    background: 'linear-gradient(transparent, white)',\n  };\n\n  const defaultCodeSnippetStyle: React.CSSProperties = {\n    padding: '5px',\n    overflowX: 'hidden',\n  };\n\n  return (\n    <div style={{ ...defaultWrapperStyle, ...wrapperStyle }}>\n      {isJsonContent ? (\n        <>\n          <CodeSnippet language=\"json\" style={{ ...defaultCodeSnippetStyle, ...codeSnippetStyle }}>\n            {formattedJson}\n          </CodeSnippet>\n          <div css={{ ...defaultOverlayStyle, ...overlayStyle }}></div>\n        </>\n      ) : (\n        <>{json}</>\n      )}\n    </div>\n  );\n};\n\nexport function useFormattedJson(json: string) {\n  return React.useMemo(() => {\n    try {\n      const parsed = JSON.parse(json);\n      const isJson = isObject(parsed) && typeof parsed !== 'function' && !(parsed instanceof Date);\n      return {\n        formattedJson: isJson ? JSON.stringify(parsed, null, 2) : json,\n        isJsonContent: isJson,\n      };\n    } catch (e) {\n      return {\n        formattedJson: json,\n        isJsonContent: false,\n      };\n    }\n  }, [json]);\n}\n\nexport const FormattedJsonDisplay: React.FC<{ json: string }> = ({ json }) => {\n  const { formattedJson, isJsonContent } = useFormattedJson(json);\n\n  return (\n    <div css={{ whiteSpace: 'pre-wrap' }}>\n      {isJsonContent ? (\n        <CodeSnippet language=\"json\" wrapLongLines>\n          {formattedJson}\n        </CodeSnippet>\n      ) : (\n        <span>{json}</span>\n      )}\n    </div>\n  );\n};\n","import React from 'react';\n\nimport type { ButtonProps } from '@databricks/design-system';\nimport {\n  DesignSystemEventProviderAnalyticsEventTypes,\n  DesignSystemEventProviderComponentTypes,\n  useDesignSystemEventComponentCallbacks,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\n\nexport interface ToggleIconButtonProps extends ButtonProps {\n  pressed?: boolean;\n}\n\n/**\n * WARNING: Temporary component!\n *\n * This component recreates \"Toggle button with icon\" pattern which is not\n * available in the design system yet.\n *\n * TODO: replace this component with the one from DuBois design system when available.\n */\nconst ToggleIconButton = React.forwardRef<HTMLButtonElement, ToggleIconButtonProps>(\n  (props: ToggleIconButtonProps, ref) => {\n    const {\n      pressed,\n      onClick,\n      icon,\n      onBlur,\n      onFocus,\n      onMouseEnter,\n      onMouseLeave,\n      componentId,\n      analyticsEvents,\n      type,\n      ...remainingProps\n    } = props;\n    const { theme } = useDesignSystemTheme();\n\n    const eventContext = useDesignSystemEventComponentCallbacks({\n      componentType: DesignSystemEventProviderComponentTypes.Button,\n      componentId,\n      analyticsEvents: analyticsEvents ?? [DesignSystemEventProviderAnalyticsEventTypes.OnClick],\n    });\n\n    return (\n      <button\n        onClick={(event) => {\n          eventContext.onClick(event);\n          onClick?.(event);\n        }}\n        css={{\n          cursor: 'pointer',\n          width: theme.general.heightSm,\n          height: theme.general.heightSm,\n          borderRadius: theme.legacyBorders.borderRadiusMd,\n          lineHeight: theme.typography.lineHeightBase,\n          padding: 0,\n          border: 0,\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          background: pressed ? theme.colors.actionDefaultBackgroundPress : 'transparent',\n          color: pressed ? theme.colors.actionDefaultTextPress : theme.colors.textSecondary,\n          '&:hover': {\n            background: theme.colors.actionDefaultBackgroundHover,\n            color: theme.colors.actionDefaultTextHover,\n          },\n        }}\n        ref={ref}\n        onBlur={onBlur}\n        onFocus={onFocus}\n        onMouseEnter={onMouseEnter}\n        onMouseLeave={onMouseLeave}\n        {...remainingProps}\n      >\n        {icon}\n      </button>\n    );\n  },\n);\n\nexport { ToggleIconButton };\n","// eslint-disable-next-line import/no-extraneous-dependencies\nimport { type DragDropManager, createDragDropManager } from 'dnd-core';\nimport { useLayoutEffect, useRef, useState } from 'react';\nimport { useDrag, useDrop, DndProvider } from 'react-dnd';\nimport { HTML5Backend } from 'react-dnd-html5-backend';\n\nexport interface useDragAndDropElementProps {\n  /**\n   * Unique drag element identifier, used in drop events\n   */\n  dragKey: string;\n  /**\n   * Group key - items are droppable only within a single group\n   */\n  dragGroupKey: string;\n  /**\n   * Callback function, conveys both dragged and target element key\n   */\n  onDrop: (draggedKey: string, targetDropKey: string) => void;\n\n  /**\n   * If true, drag and drop will be disabled\n   */\n  disabled?: boolean;\n}\n\ninterface DraggedItem {\n  key: string;\n  groupKey: string;\n}\n\n/**\n * A hook enabling drag-and-drop capabilities for any component.\n * Used component will serve as both DnD source and target.\n */\nexport const useDragAndDropElement = ({\n  dragGroupKey,\n  dragKey,\n  onDrop,\n  disabled = false,\n}: useDragAndDropElementProps) => {\n  const dropListener = useRef(onDrop);\n\n  dropListener.current = onDrop;\n\n  const [{ isOver, draggedItem }, dropTargetRef] = useDrop<\n    DraggedItem,\n    never,\n    { isOver: boolean; draggedItem: DraggedItem }\n  >(\n    {\n      canDrop: () => !disabled,\n      accept: `dnd-${dragGroupKey}`,\n      drop: ({ key: sourceKey }: { key: string }, monitor) => {\n        if (sourceKey === dragKey || monitor.didDrop()) {\n          return;\n        }\n        dropListener.current(sourceKey, dragKey);\n      },\n      collect: (monitor) => ({ isOver: monitor.isOver({ shallow: true }), draggedItem: monitor.getItem() }),\n    },\n    [disabled, dragGroupKey, dragKey],\n  );\n\n  const [{ isDragging }, dragHandleRef, dragPreviewRef] = useDrag(\n    {\n      canDrag: () => !disabled,\n      type: `dnd-${dragGroupKey}`,\n      item: { key: dragKey, groupKey: dragGroupKey },\n      collect: (monitor) => ({\n        isDragging: monitor.isDragging(),\n      }),\n    },\n    [disabled, dragGroupKey, dragKey],\n  );\n\n  const isDraggingOtherGroup = Boolean(draggedItem && draggedItem.groupKey !== dragGroupKey);\n\n  return { dropTargetRef, dragHandleRef, dragPreviewRef, isDragging, isOver, isDraggingOtherGroup };\n};\n\n/**\n * Create a scoped DndProvider that will limit its functionality to a single root element.\n * It should prevent HTML5Backend collisions, see:\n * https://github.com/react-dnd/react-dnd/blob/7c88c37489a53b5ac98699c46a506a8e085f1c03/packages/backend-html5/src/HTML5BackendImpl.ts#L107-L109\n */\nexport const DragAndDropProvider: React.FC = ({ children }) => {\n  const rootElementRef = useRef<HTMLDivElement>(null);\n  const [manager, setManager] = useState<DragDropManager | null>(null);\n\n  useLayoutEffect(() => {\n    const rootElement = rootElementRef.current;\n    const dragDropManager = createDragDropManager(HTML5Backend, undefined, { rootElement });\n    setManager(dragDropManager);\n    return () => {\n      dragDropManager.getBackend().teardown();\n    };\n  }, []);\n\n  return (\n    <div css={{ display: 'contents' }} ref={rootElementRef}>\n      {manager && <DndProvider manager={manager}>{children}</DndProvider>}\n    </div>\n  );\n};\n","import { useEffect, useState } from 'react';\n\n/**\n * Hook that returns whether the browser tab is active or not.\n * @returns true if the tab is active, false otherwise\n */\nexport const useIsTabActive = () => {\n  const [isTabActive, setIsTabActive] = useState(document.visibilityState === 'visible');\n  useEffect(() => {\n    document.addEventListener('visibilitychange', (x) => {\n      setIsTabActive(document.visibilityState === 'visible');\n    });\n  }, []);\n  return isTabActive;\n};\n","const DEFAULT_MIN_COLUMNS = 1;\nconst DEFAULT_MAX_COLUMNS = 3;\nconst DEFAULT_MIN_COLUMN_WIDTH = 330;\nconst DEFAULT_GAP = 16;\n\n/**\n * Creates a CSS grid column setup with min/max number of columns.\n * See: https://stackoverflow.com/a/69154193\n */\nexport const getGridColumnSetup = ({\n  minColumns = DEFAULT_MIN_COLUMNS,\n  maxColumns = DEFAULT_MAX_COLUMNS,\n  minColumnWidth = DEFAULT_MIN_COLUMN_WIDTH,\n  gap = DEFAULT_GAP,\n  additionalBreakpoints = [],\n}: {\n  /**\n   * Minimum number of columns to display\n   */\n  minColumns?: number;\n  /**\n   * Maximum number of columns to display\n   */\n  maxColumns?: number;\n  /**\n   * Minimum column width\n   */\n  minColumnWidth?: number;\n  /**\n   * Gap between columns, in pixels\n   */\n  gap?: number;\n  /**\n   * Additional breakpoints to add to the grid. Defines the min breakpoint width and the minimum column width for that breakpoint.\n   * Does not use minimum and maximum use of columns.\n   */\n  additionalBreakpoints?: { breakpointWidth: number; minColumnWidthForBreakpoint?: number }[];\n}) => ({\n  display: 'grid',\n  gridTemplateColumns: `repeat(\n      auto-fit,\n      minmax(\n        min(\n          calc(\n            100%/${minColumns} - ${gap}px\n          ),\n          max(\n            ${minColumnWidth}px,\n            calc(100%/${maxColumns} - ${gap}px)\n          )\n        ),\n        1fr\n      )\n    )`,\n  gap,\n  ...additionalBreakpoints.reduce(\n    (acc, { breakpointWidth, minColumnWidthForBreakpoint }) => ({\n      ...acc,\n      [`@media (min-width: ${breakpointWidth}px)`]: {\n        gridTemplateColumns: `repeat(\n        auto-fit,\n        minmax(\n          ${minColumnWidthForBreakpoint}px,\n          1fr\n        )\n      )`,\n      },\n    }),\n    {},\n  ),\n});\n","/**\n * NOTE: this code file was automatically migrated to TypeScript using ts-migrate and\n * may contain multiple `any` type annotations and `@ts-expect-error` directives.\n * If possible, please improve types while making changes to this file. If the type\n * annotations are already looking good, please remove this comment.\n */\n\n/**\n * Utils for working with local storage.\n */\nexport default class LocalStorageUtils {\n  /**\n   * Protocol version of MLflow's local storage. Should be incremented on any breaking change in how\n   * data persisted in local storage is used, to prevent old (invalid) cached data from being loaded\n   * and breaking the application.\n   */\n  static version = '1.1';\n\n  /**\n   * Return a LocalStorageStore corresponding to the specified component and ID, where the ID\n   * can be used to disambiguate between multiple instances of cached data for the same component\n   * (e.g. cached data for multiple experiments).\n   */\n  static getStoreForComponent(componentName: any, id: any) {\n    return new LocalStorageStore([componentName, id].join('-'), 'localStorage');\n  }\n\n  static getSessionScopedStoreForComponent(componentName: any, id: any) {\n    return new LocalStorageStore([componentName, id].join('-'), 'sessionStorage');\n  }\n}\n\n/**\n * Interface to browser local storage that allows for setting key-value pairs under the specified\n * \"scope\".\n */\nclass LocalStorageStore {\n  constructor(scope: any, type: any) {\n    this.scope = scope;\n    if (type === 'localStorage') {\n      this.storageObj = window.localStorage;\n    } else {\n      this.storageObj = window.sessionStorage;\n    }\n  }\n  static reactComponentStateKey = 'ReactComponentState';\n\n  scope: any;\n  storageObj: any;\n\n  /**\n   * Loads React component state cached in local storage into a vanilla JS object.\n   */\n  loadComponentState() {\n    const storedVal = this.getItem(LocalStorageStore.reactComponentStateKey);\n    if (storedVal) {\n      return JSON.parse(storedVal);\n    }\n    return {};\n  }\n\n  /**\n   * Save React component state in local storage.\n   * @param stateRecord: Immutable.Record instance or plain object containing component state.\n   */\n  saveComponentState(stateRecord: any) {\n    const targetValue = typeof stateRecord.toJSON === 'function' ? stateRecord.toJSON() : stateRecord;\n    this.setItem(LocalStorageStore.reactComponentStateKey, JSON.stringify(targetValue));\n  }\n\n  /**\n   * Helper method for constructing a scoped key to use for setting/getting values in\n   * local storage.\n   */\n  withScopePrefix(key: any) {\n    return ['MLflowLocalStorage', LocalStorageUtils.version, this.scope, key].join('-');\n  }\n\n  /** Save the specified key-value pair in local storage. */\n  setItem(key: any, value: any) {\n    this.storageObj.setItem(this.withScopePrefix(key), value);\n  }\n\n  /** Fetch the value corresponding to the passed-in key from local storage. */\n  getItem(key: any) {\n    return this.storageObj.getItem(this.withScopePrefix(key));\n  }\n}\n","import { useEffect, useState } from 'react';\n\n/**\n * Hook that returns dynamically updated changing element height. Usage example:\n * ```ts\n * const { elementHeight, observeHeight } = useElementHeight();\n * // ...\n * return <div ref={observeHeight}>Element height: {elementHeight}px</div>\n * ```\n */\nexport const useElementHeight = (resizeCallback?: (entry: ResizeObserverEntry) => void) => {\n  const [hideableElementsContainer, setHideableElementsContainer] = useState<HTMLElement | null>(null);\n\n  const [elementHeight, setElementHeight] = useState<number | undefined>(undefined);\n\n  useEffect(() => {\n    if (!hideableElementsContainer || !window.ResizeObserver) {\n      return undefined;\n    }\n    const resizeObserver = new ResizeObserver(([entry]) => {\n      resizeCallback?.(entry);\n      if (entry.target.scrollHeight) {\n        setElementHeight(entry.target.scrollHeight);\n      }\n    });\n    resizeObserver.observe(hideableElementsContainer);\n    return () => resizeObserver.disconnect();\n  }, [hideableElementsContainer, resizeCallback]);\n\n  return { elementHeight, observeHeight: setHideableElementsContainer };\n};\n","import { FolderBranchIcon, HomeIcon, NotebookIcon, WorkflowsIcon } from '@databricks/design-system';\nimport { SourceType } from '../sdk/MlflowEnums';\n\n/**\n * Displays an icon corresponding to the source type of an experiment run.\n */\nexport const ExperimentSourceTypeIcon = ({\n  sourceType,\n  className,\n}: {\n  sourceType: SourceType | string;\n  className?: string;\n}) => {\n  if (sourceType === SourceType.NOTEBOOK) {\n    return <NotebookIcon className={className} />;\n  } else if (sourceType === SourceType.LOCAL) {\n    return <HomeIcon className={className} />;\n  } else if (sourceType === SourceType.PROJECT) {\n    return <FolderBranchIcon className={className} />;\n  } else if (sourceType === SourceType.JOB) {\n    return <WorkflowsIcon className={className} />;\n  }\n  return null;\n};\n","import { CheckCircleIcon, ClockIcon, XCircleIcon, useDesignSystemTheme } from '@databricks/design-system';\n\nconst ErrorIcon = () => {\n  const { theme } = useDesignSystemTheme();\n  return <XCircleIcon css={{ color: theme.colors.textValidationDanger }} />;\n};\n\nconst FinishedIcon = () => {\n  const { theme } = useDesignSystemTheme();\n  return <CheckCircleIcon css={{ color: theme.colors.textValidationSuccess }} />;\n};\n\nexport const RunStatusIcon = ({ status }: { status: string }) => {\n  switch (status) {\n    case 'FAILED':\n    case 'KILLED':\n      return <ErrorIcon />;\n    case 'FINISHED':\n      return <FinishedIcon />;\n    case 'SCHEDULED':\n    case 'RUNNING':\n      return <ClockIcon />; // This one is the same color as the link\n    default:\n      return null;\n  }\n};\n","// This media query applies to screens with a pixel density of 2 or higher\n\nimport { debounce } from 'lodash';\nimport { useMemo, useState } from 'react';\nimport { COLORS_PALETTE_DATALIST_ID } from '../../../../common/components/ColorsPaletteDatalist';\nimport { visuallyHidden } from '@databricks/design-system';\n\n// and higher resolution values (e.g. Retina displays). 192 dpi is double the \"default\" historical 96 dpi.\nconst HIGH_RESOLUTION_MEDIA_QUERY = '@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi)';\n\nconst stripedHiddenBackgroundStyle = `repeating-linear-gradient(\n  135deg,\n  #959595 0,\n  #e7e7e7 1px,\n  #e7e7e7 2px,\n  #959595 3px,\n  #e7e7e7 4px,\n  #e7e7e7 5px,\n  #959595 6px,\n  #e7e7e7 7px,\n  #e7e7e7 8px,\n  #959595 9px,\n  #e7e7e7 10px,\n  #e7e7e7 11px,\n  #959595 12px,\n  #e7e7e7 13px,\n  #e7e7e7 14px\n)`;\n\n/**\n * Renders a colored rounded pill for a run.\n */\nexport const RunColorPill = ({\n  color,\n  hidden,\n  onChangeColor,\n  ...props\n}: {\n  color?: string;\n  hidden?: boolean;\n  onChangeColor?: (colorValue: string) => void;\n}) => {\n  const [colorValue, setColorValue] = useState<string | undefined>(undefined);\n\n  const onChangeColorDebounced = useMemo(() => {\n    // Implementations of <input type=\"color\"> vary from browser to browser, some browser\n    // fire an event on every color change so we debounce the event to avoid multiple\n    // calls to the onChangeColor handler.\n    if (onChangeColor) {\n      return debounce(onChangeColor, 300);\n    }\n    return () => {};\n  }, [onChangeColor]);\n\n  return (\n    <label\n      css={{\n        width: 12,\n        height: 12,\n        borderRadius: 6,\n        flexShrink: 0,\n        // Add a border to make the pill visible when using very light color\n        border: `1px solid ${hidden ? 'transparent' : 'rgba(0,0,0,0.1)'}`,\n        // Straighten it up on high-res screens\n        [HIGH_RESOLUTION_MEDIA_QUERY]: {\n          marginBottom: 1,\n        },\n        background: hidden ? stripedHiddenBackgroundStyle : undefined,\n        cursor: onChangeColor ? 'pointer' : 'default',\n        position: 'relative',\n        '&:hover': {\n          opacity: onChangeColor ? 0.8 : 1,\n        },\n      }}\n      style={{ backgroundColor: colorValue ?? color ?? 'transparent' }}\n      {...props}\n    >\n      <span\n        css={[\n          visuallyHidden,\n          {\n            userSelect: 'none',\n          },\n        ]}\n      >\n        {color}\n      </span>\n      {onChangeColor && (\n        <input\n          disabled={hidden}\n          type=\"color\"\n          value={colorValue ?? color}\n          onChange={({ target }) => {\n            setColorValue(target.value);\n            onChangeColorDebounced(target.value);\n          }}\n          list={COLORS_PALETTE_DATALIST_ID}\n          css={{\n            appearance: 'none',\n            width: 0,\n            height: 0,\n            border: 0,\n            padding: 0,\n            position: 'absolute',\n            bottom: 0,\n            visibility: 'hidden',\n          }}\n        />\n      )}\n    </label>\n  );\n};\n","import { Table, TableCell, TableHeader, TableRow } from '@databricks/design-system';\nimport { FormattedMessage } from 'react-intl';\n\nexport interface ExperimentViewDatasetSchemaTableProps {\n  schema: any[];\n  filter: string;\n}\n\nexport const ExperimentViewDatasetSchemaTable = ({\n  schema,\n  filter,\n}: ExperimentViewDatasetSchemaTableProps): JSX.Element => {\n  const hasFilter = (name?: string, type?: string) => {\n    return (\n      filter === '' ||\n      name?.toLowerCase().includes(filter.toLowerCase()) ||\n      type?.toLowerCase().includes(filter.toLowerCase())\n    );\n  };\n\n  const filteredSchema = schema.filter((row: { name: string; type: string }, _: number) =>\n    hasFilter(row.name, row.type),\n  );\n\n  const getNameHeader = () => {\n    return (\n      <FormattedMessage\n        defaultMessage=\"Name\"\n        description={'Header for \"name\" column in the experiment run dataset schema'}\n      />\n    );\n  };\n\n  const getTypeHeader = () => {\n    return <FormattedMessage defaultMessage=\"Type\" description={'Header for \"type\" column in the UC table schema'} />;\n  };\n\n  return (\n    <Table scrollable css={{ width: '100%' }}>\n      <TableRow isHeader>\n        <TableHeader componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewdatasetschematable.tsx_57\">\n          {getNameHeader()}\n        </TableHeader>\n        <TableHeader componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewdatasetschematable.tsx_58\">\n          {getTypeHeader()}\n        </TableHeader>\n      </TableRow>\n      <div onWheel={(e) => e.stopPropagation()}>\n        {filteredSchema.length === 0 ? (\n          <TableRow>\n            <TableCell>\n              <FormattedMessage\n                defaultMessage=\"No results match this search.\"\n                description=\"No results message in datasets drawer table\"\n              />\n            </TableCell>\n          </TableRow>\n        ) : (\n          filteredSchema.map((row: { name: string; type: string }, idx: number) => (\n            <TableRow key={`table-body-row-${idx}`}>\n              <TableCell>{row.name}</TableCell>\n              <TableCell>{row.type}</TableCell>\n            </TableRow>\n          ))\n        )}\n      </div>\n    </Table>\n  );\n};\n","import {\n  Header,\n  TableIcon,\n  useDesignSystemTheme,\n  Table,\n  TableCell,\n  TableHeader,\n  TableRow,\n  TableFilterInput,\n  Spacer,\n  Typography,\n} from '@databricks/design-system';\nimport { ExperimentViewDatasetSchemaTable } from './ExperimentViewDatasetSchemaTable';\nimport { DatasetSourceTypes, RunDatasetWithTags } from '../../../../types';\nimport { useEffect, useMemo, useState } from 'react';\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nexport interface DatasetsCellRendererProps {\n  datasetWithTags: RunDatasetWithTags;\n}\n\nexport const ExperimentViewDatasetSchema = ({ datasetWithTags }: DatasetsCellRendererProps): JSX.Element => {\n  const { theme } = useDesignSystemTheme();\n  const { dataset } = datasetWithTags;\n  const [filter, setFilter] = useState('');\n\n  if (dataset.schema === null || dataset.schema === '') {\n    return (\n      <div\n        css={{\n          display: 'flex',\n          flexDirection: 'column',\n          height: '100vh',\n        }}\n      >\n        <div\n          css={{\n            height: '100%',\n            display: 'flex',\n            flexDirection: 'column',\n            justifyContent: 'flex-start',\n            alignContent: 'center',\n          }}\n        >\n          <Header title={<div css={{ color: theme.colors.grey600 }}>No schema available</div>} />\n        </div>\n      </div>\n    );\n  }\n  try {\n    const schema = JSON.parse(dataset.schema);\n    if ('mlflow_colspec' in schema) {\n      // if the dataset schema is colspec\n      return (\n        <div\n          css={{\n            display: 'flex',\n            flexDirection: 'column',\n            overflow: 'hidden',\n            height: '100vh',\n          }}\n        >\n          <div\n            css={{\n              marginTop: theme.spacing.sm,\n              form: { width: '100%' },\n            }}\n          >\n            <TableFilterInput\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewdatasetschema.tsx_92\"\n              value={filter}\n              placeholder=\"Search fields\"\n              onChange={(e) => setFilter(e.target.value)}\n              onClear={() => {\n                setFilter('');\n              }}\n              css={{ width: '100%' }}\n              containerProps={{ style: { width: 'auto' } }}\n            />\n          </div>\n          <div\n            css={{\n              marginTop: theme.spacing.sm,\n              overflow: 'hidden',\n            }}\n          >\n            <ExperimentViewDatasetSchemaTable schema={schema.mlflow_colspec} filter={filter} />\n          </div>\n        </div>\n      );\n    } else if ('mlflow_tensorspec' in schema) {\n      // if the dataset schema is tensorspec\n      return (\n        <div css={{ height: '100vh' }}>\n          <div\n            css={{\n              display: 'flex',\n              flexDirection: 'column',\n              alignItems: 'center',\n              justifyContent: 'center',\n              height: '100%',\n            }}\n          >\n            <TableIcon css={{ fontSize: '56px', color: theme.colors.grey600 }} />\n            <Header title={<div css={{ color: theme.colors.grey600 }}>Array Datasource</div>} />\n            <Typography.Text color={theme.colors.grey600} css={{ textAlign: 'center' }}>\n              <FormattedMessage\n                defaultMessage=\"The dataset is an array. To see a preview of the dataset, view the dataset in the training notebook.\"\n                description=\"Notification when the dataset is an array data source in the experiment run dataset schema\"\n              />\n            </Typography.Text>\n          </div>\n        </div>\n      );\n    } else {\n      // if the dataset schema is not colspec or tensorspec\n      return (\n        <div css={{ marginLeft: theme.spacing.lg, marginTop: theme.spacing.md, width: '100%' }}>\n          <div css={{ display: 'flex', flexDirection: 'column', justifyContent: 'flex-start' }}>\n            <Header title={<div css={{ color: theme.colors.grey600 }}>Unrecognized Schema Format</div>} />\n            <Typography.Text color={theme.colors.grey600}>\n              <FormattedMessage\n                defaultMessage=\"Raw Schema JSON: \"\n                description=\"Label for the raw schema JSON in the experiment run dataset schema\"\n              />\n              {JSON.stringify(schema)}\n            </Typography.Text>\n          </div>\n        </div>\n      );\n    }\n  } catch {\n    return (\n      <div css={{ marginLeft: theme.spacing.lg, marginTop: theme.spacing.md, width: '100%' }}>\n        <div css={{ display: 'flex', flexDirection: 'column', justifyContent: 'flex-start' }}>\n          <Header title={<div css={{ color: theme.colors.grey600 }}>No schema available</div>} />\n        </div>\n      </div>\n    );\n  }\n};\n","import { Button, CopyIcon, NewWindowIcon, Typography } from '@databricks/design-system';\nimport { DatasetSourceTypes, RunDatasetWithTags } from '../../../../types';\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { getDatasetSourceUrl } from '../../../../utils/DatasetUtils';\nimport { CopyButton } from '../../../../../shared/building_blocks/CopyButton';\n\nexport interface DatasetLinkProps {\n  datasetWithTags: RunDatasetWithTags;\n  runTags: Record<string, { key: string; value: string }>;\n}\n\nexport const ExperimentViewDatasetLink = ({ datasetWithTags, runTags }: DatasetLinkProps) => {\n  const { dataset } = datasetWithTags;\n  if (dataset.sourceType === DatasetSourceTypes.HTTP || dataset.sourceType === DatasetSourceTypes.HUGGING_FACE) {\n    const url = getDatasetSourceUrl(datasetWithTags);\n    if (url) {\n      return (\n        <Button\n          type=\"primary\"\n          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewdatasetlink.tsx_19_1\"\n          icon={<NewWindowIcon />}\n          href={url}\n          target=\"_blank\"\n        >\n          <FormattedMessage\n            defaultMessage=\"Open dataset\"\n            description=\"Text for the HTTP/HF location link in the experiment run dataset drawer\"\n          />\n        </Button>\n      );\n    }\n  }\n  if (dataset.sourceType === DatasetSourceTypes.S3) {\n    const url = getDatasetSourceUrl(datasetWithTags);\n    if (url) {\n      return (\n        <CopyButton\n          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewdatasetlink.tsx_19_2\"\n          icon={<CopyIcon />}\n          copyText={url}\n        >\n          <FormattedMessage\n            defaultMessage=\"Copy S3 URI to clipboard\"\n            description=\"Text for the HTTP/HF location link in the experiment run dataset drawer\"\n          />\n        </CopyButton>\n      );\n    }\n  }\n  if (dataset.sourceType === DatasetSourceTypes.EXTERNAL) {\n    return (\n      <Button\n        componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewdatasetlink.tsx_19_3\"\n        icon={<NewWindowIcon />}\n      >\n        <FormattedMessage\n          defaultMessage=\"Go to external location\"\n          description=\"Text for the external location link in the experiment run dataset drawer\"\n        />\n      </Button>\n    );\n  }\n  return null;\n};\n","import { Typography } from '@databricks/design-system';\nimport { DatasetSourceTypes, RunDatasetWithTags } from '../../../../types';\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nexport interface ExperimentViewDatasetSourceTypeProps {\n  datasetWithTags: RunDatasetWithTags;\n}\n\nexport const ExperimentViewDatasetSourceType = ({ datasetWithTags }: ExperimentViewDatasetSourceTypeProps) => {\n  const { dataset } = datasetWithTags;\n\n  const sourceType = dataset.sourceType;\n\n  const getSourceTypeLabel = () => {\n    if (sourceType === DatasetSourceTypes.HTTP || sourceType === DatasetSourceTypes.EXTERNAL) {\n      return (\n        <FormattedMessage\n          defaultMessage=\"HTTP\"\n          description=\"Experiment dataset drawer > source type > HTTP source type label\"\n        />\n      );\n    }\n    if (sourceType === DatasetSourceTypes.S3) {\n      return (\n        <FormattedMessage\n          defaultMessage=\"S3\"\n          description=\"Experiment dataset drawer > source type > S3 source type label\"\n        />\n      );\n    }\n    if (sourceType === DatasetSourceTypes.HUGGING_FACE) {\n      return (\n        <FormattedMessage\n          defaultMessage=\"Hugging Face\"\n          description=\"Experiment dataset drawer > source type > Hugging Face source type label\"\n        />\n      );\n    }\n    return null;\n  };\n\n  const typeLabel = getSourceTypeLabel();\n\n  if (typeLabel) {\n    return (\n      <Typography.Hint>\n        <FormattedMessage\n          defaultMessage=\"Source type: {typeLabel}\"\n          description=\"Experiment dataset drawer > source type > label\"\n          values={{ typeLabel }}\n        />\n      </Typography.Hint>\n    );\n  }\n\n  return null;\n};\n","import { Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { DatasetSourceTypes, RunDatasetWithTags } from '../../../../types';\nimport { getDatasetSourceUrl } from '../../../../utils/DatasetUtils';\n\nexport interface ExperimentViewDatasetSourceProps {\n  datasetWithTags: RunDatasetWithTags;\n}\n\nexport const ExperimentViewDatasetSourceURL = ({ datasetWithTags }: ExperimentViewDatasetSourceProps) => {\n  const { dataset } = datasetWithTags;\n  const { theme } = useDesignSystemTheme();\n\n  const sourceType = dataset.sourceType;\n\n  if (\n    sourceType === DatasetSourceTypes.HTTP ||\n    sourceType === DatasetSourceTypes.EXTERNAL ||\n    sourceType === DatasetSourceTypes.HUGGING_FACE\n  ) {\n    const url = getDatasetSourceUrl(datasetWithTags);\n    if (url) {\n      return (\n        <div\n          css={{\n            whiteSpace: 'nowrap',\n            display: 'flex',\n            fontSize: theme.typography.fontSizeSm,\n            color: theme.colors.textSecondary,\n            columnGap: theme.spacing.xs,\n          }}\n          title={url}\n        >\n          URL:{' '}\n          <Typography.Link\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewdatasetsourceurl.tsx_34\"\n            openInNewTab\n            href={url}\n            css={{ display: 'flex', overflow: 'hidden' }}\n          >\n            <span css={{ overflow: 'hidden', textOverflow: 'ellipsis' }}>{url}</span>\n          </Typography.Link>\n        </div>\n      );\n    }\n  }\n  if (sourceType === DatasetSourceTypes.S3) {\n    try {\n      const { uri } = JSON.parse(dataset.source);\n      if (uri) {\n        return (\n          <Typography.Hint\n            title={uri}\n            css={{\n              whiteSpace: 'nowrap',\n              overflow: 'hidden',\n              textOverflow: 'ellipsis',\n            }}\n          >\n            S3 URI: {uri}\n          </Typography.Hint>\n        );\n      }\n    } catch {\n      return null;\n    }\n  }\n  return null;\n};\n","import { Typography } from '@databricks/design-system';\nimport { RunDatasetWithTags } from '../../../../types';\nimport { FormattedMessage } from 'react-intl';\n\nexport const ExperimentViewDatasetDigest = ({ datasetWithTags }: { datasetWithTags: RunDatasetWithTags }) => {\n  const { dataset } = datasetWithTags;\n  return (\n    <Typography.Hint>\n      <FormattedMessage\n        defaultMessage=\"Digest: {digest}\"\n        description=\"Experiment dataset drawer > digest > label and value\"\n        values={{ digest: <code>{dataset.digest}</code> }}\n      />\n    </Typography.Hint>\n  );\n};\n","import React from 'react';\nimport { useState } from 'react';\nimport {\n  Button,\n  Drawer,\n  Header,\n  Spacer,\n  TableIcon,\n  Tag,\n  LegacyTooltip,\n  Typography,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport type { RunDatasetWithTags } from '../../../../types';\nimport { MLFLOW_RUN_DATASET_CONTEXT_TAG } from '../../../../constants';\nimport { Divider } from 'antd';\nimport { ExperimentViewDatasetSchema } from './ExperimentViewDatasetSchema';\nimport { ExperimentViewDatasetLink } from './ExperimentViewDatasetLink';\nimport { Link } from '../../../../../common/utils/RoutingUtils';\nimport Routes from '../../../../routes';\nimport { FormattedMessage } from 'react-intl';\nimport { ExperimentViewDatasetWithContext } from './ExperimentViewDatasetWithContext';\nimport { RunColorPill } from '../RunColorPill';\nimport { ExperimentViewDatasetSourceType } from './ExperimentViewDatasetSourceType';\nimport { ExperimentViewDatasetSourceURL } from './ExperimentViewDatasetSourceURL';\nimport { ExperimentViewDatasetDigest } from './ExperimentViewDatasetDigest';\nimport { useSelector } from 'react-redux';\nimport { ReduxState } from '../../../../../redux-types';\nimport { useGetExperimentRunColor } from '../../hooks/useExperimentRunColor';\n\nexport type DatasetWithRunType = {\n  datasetWithTags: RunDatasetWithTags;\n  runData: {\n    experimentId?: string;\n    tags?: Record<string, { key: string; value: string }>;\n    runUuid: string;\n    runName?: string;\n    datasets: RunDatasetWithTags[];\n  };\n};\n\nexport interface DatasetsCellRendererProps {\n  isOpen: boolean;\n  setIsOpen: (open: boolean) => void;\n  selectedDatasetWithRun: DatasetWithRunType;\n  setSelectedDatasetWithRun: (datasetWithRun: DatasetWithRunType) => void;\n}\n\nconst DRAWER_WITDH = '800px';\nconst MAX_PROFILE_LENGTH = 80;\n\nexport const ExperimentViewDatasetDrawerImpl = ({\n  isOpen,\n  setIsOpen,\n  selectedDatasetWithRun,\n  setSelectedDatasetWithRun,\n}: DatasetsCellRendererProps): JSX.Element => {\n  const { theme } = useDesignSystemTheme();\n  const { datasetWithTags, runData } = selectedDatasetWithRun;\n  const contextTag = selectedDatasetWithRun\n    ? datasetWithTags?.tags?.find((tag) => tag.key === MLFLOW_RUN_DATASET_CONTEXT_TAG)\n    : undefined;\n  const fullProfile =\n    datasetWithTags.dataset.profile && datasetWithTags.dataset.profile !== 'null'\n      ? datasetWithTags.dataset.profile\n      : undefined;\n\n  const getRunColor = useGetExperimentRunColor();\n  const { experimentId = '', tags = {} } = runData;\n\n  return (\n    <Drawer.Root\n      open={isOpen}\n      onOpenChange={(open) => {\n        if (!open) {\n          setIsOpen(false);\n        }\n      }}\n    >\n      <Drawer.Content\n        componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewdatasetdrawer.tsx_81\"\n        title={\n          <div css={{ display: 'flex', alignItems: 'center', height: '100%' }}>\n            <Typography.Title level={4} css={{ marginRight: theme.spacing.sm, marginBottom: 0 }}>\n              <FormattedMessage\n                defaultMessage=\"Data details for \"\n                description=\"Text for data details for the experiment run in the dataset drawer\"\n              />\n            </Typography.Title>\n            <Link to={Routes.getRunPageRoute(experimentId, runData.runUuid)} css={styles.runLink}>\n              <RunColorPill color={getRunColor(runData.runUuid)} />\n              <span css={styles.runName}>{runData.runName}</span>\n            </Link>\n          </div>\n        }\n        width={DRAWER_WITDH}\n        footer={<Spacer size=\"xs\" />}\n      >\n        <div\n          css={{\n            display: 'flex',\n            borderTop: `1px solid ${theme.colors.border}`,\n            height: '100%',\n            marginLeft: -theme.spacing.sm,\n          }}\n        >\n          {/* column for dataset selection */}\n          <div\n            css={{\n              display: 'flex',\n              flexDirection: 'column',\n              width: '300px',\n              borderRight: `1px solid ${theme.colors.border}`,\n              height: '100%',\n            }}\n          >\n            <Typography.Text\n              color=\"secondary\"\n              css={{\n                marginBottom: theme.spacing.sm,\n                marginTop: theme.spacing.sm,\n                paddingLeft: theme.spacing.sm,\n              }}\n            >\n              {runData.datasets.length}{' '}\n              <FormattedMessage\n                defaultMessage=\"datasets used\"\n                description=\"Text for dataset count in the experiment run dataset drawer\"\n              />\n            </Typography.Text>\n            <div\n              css={{\n                display: 'flex',\n                flexDirection: 'column',\n                height: '100%',\n                overflow: 'auto',\n              }}\n              onWheel={(e) => e.stopPropagation()}\n            >\n              {runData.datasets.map((dataset) => (\n                <div\n                  key={`${dataset.dataset.name}-${dataset.dataset.digest}`}\n                  css={{\n                    display: 'flex',\n                    flexDirection: 'column',\n                    justifyContent: 'center',\n                    backgroundColor:\n                      dataset.dataset.name === datasetWithTags.dataset.name &&\n                      dataset.dataset.digest === datasetWithTags.dataset.digest\n                        ? theme.colors.backgroundSecondary\n                        : 'transparent',\n                    borderTop: `1px solid ${theme.colors.border}`,\n                    paddingBottom: theme.spacing.sm,\n                    paddingTop: theme.spacing.sm,\n                    paddingLeft: theme.spacing.sm,\n                  }}\n                >\n                  <Button\n                    componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewdatasetdrawer.tsx_151\"\n                    type=\"link\"\n                    css={{\n                      textAlign: 'left',\n                      overflowX: 'auto',\n                      overflowY: 'hidden',\n                    }}\n                    onClick={() => {\n                      setSelectedDatasetWithRun({ datasetWithTags: dataset, runData: runData });\n                      setIsOpen(true);\n                    }}\n                  >\n                    <ExperimentViewDatasetWithContext datasetWithTags={dataset} displayTextAsLink={false} />\n                  </Button>\n                </div>\n              ))}\n            </div>\n          </div>\n          {/* column for dataset details */}\n          <div\n            css={{\n              overflow: 'hidden',\n              paddingLeft: theme.spacing.md,\n              paddingTop: theme.spacing.md,\n              display: 'flex',\n              flexDirection: 'column',\n              width: '100%',\n            }}\n          >\n            {/* dataset metadata */}\n            <div\n              css={{\n                display: 'flex',\n                gap: theme.spacing.sm,\n              }}\n            >\n              <div css={{ flex: '1' }}>\n                <Header\n                  title={\n                    <div css={{ display: 'flex', flexDirection: 'row', alignItems: 'center' }}>\n                      <TableIcon css={{ marginRight: theme.spacing.xs }} />\n                      <LegacyTooltip title={datasetWithTags.dataset.name}>\n                        <Typography.Title ellipsis level={3} css={{ marginBottom: 0, maxWidth: 200 }}>\n                          {datasetWithTags.dataset.name}\n                        </Typography.Title>\n                      </LegacyTooltip>\n                      {contextTag && (\n                        <Tag\n                          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewdatasetdrawer.tsx_206\"\n                          css={{\n                            textTransform: 'capitalize',\n                            marginLeft: theme.spacing.xs,\n                            marginRight: theme.spacing.xs,\n                          }}\n                        >\n                          {contextTag.value}\n                        </Tag>\n                      )}\n                    </div>\n                  }\n                />\n                <Typography.Title\n                  level={4}\n                  color=\"secondary\"\n                  css={{ marginBottom: theme.spacing.xs, marginTop: theme.spacing.xs }}\n                  title={fullProfile}\n                >\n                  {datasetWithTags.dataset.profile && datasetWithTags.dataset.profile !== 'null' ? (\n                    datasetWithTags.dataset.profile.length > MAX_PROFILE_LENGTH ? (\n                      `${datasetWithTags.dataset.profile.substring(0, MAX_PROFILE_LENGTH)} ...`\n                    ) : (\n                      datasetWithTags.dataset.profile\n                    )\n                  ) : (\n                    <FormattedMessage\n                      defaultMessage=\"No profile available\"\n                      description=\"Text for no profile available in the experiment run dataset drawer\"\n                    />\n                  )}\n                </Typography.Title>\n              </div>\n              <ExperimentViewDatasetLink datasetWithTags={datasetWithTags} runTags={tags} />\n            </div>\n            <div css={{ flexShrink: 0, display: 'flex', flexDirection: 'column', gap: theme.spacing.xs }}>\n              <ExperimentViewDatasetDigest datasetWithTags={datasetWithTags} />\n              <ExperimentViewDatasetSourceType datasetWithTags={datasetWithTags} />\n              <ExperimentViewDatasetSourceURL datasetWithTags={datasetWithTags} />\n            </div>\n            {/* dataset schema */}\n            <Divider css={{ marginTop: theme.spacing.sm, marginBottom: theme.spacing.xs }} />\n            <ExperimentViewDatasetSchema datasetWithTags={datasetWithTags} />\n          </div>\n        </div>\n      </Drawer.Content>\n    </Drawer.Root>\n  );\n};\n\n// Memoize the component so it rerenders only when props change directly, preventing\n// rerenders caused e.g. by the overarching context provider.\nexport const ExperimentViewDatasetDrawer = React.memo(ExperimentViewDatasetDrawerImpl);\n\nconst styles = {\n  runLink: {\n    overflow: 'hidden',\n    display: 'flex',\n    gap: 8,\n    alignItems: 'center',\n  },\n  runName: {\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n    fontSize: '13px',\n  },\n};\n","import { TableIcon, Tag, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport type { RunDatasetWithTags } from '../../../../types';\nimport React from 'react';\nimport { MLFLOW_RUN_DATASET_CONTEXT_TAG } from '../../../../constants';\n\nexport interface DatasetWithContextProps {\n  datasetWithTags: RunDatasetWithTags;\n  displayTextAsLink: boolean;\n  className?: string;\n}\n\nexport const ExperimentViewDatasetWithContext = ({\n  datasetWithTags,\n  displayTextAsLink,\n  className,\n}: DatasetWithContextProps) => {\n  const { dataset, tags } = datasetWithTags;\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        flexDirection: 'row',\n        alignItems: 'center',\n        marginTop: theme.spacing.xs,\n        marginBottom: theme.spacing.xs,\n      }}\n      className={className}\n    >\n      <TableIcon css={{ marginRight: theme.spacing.xs, color: theme.colors.textSecondary }} />\n      {displayTextAsLink ? (\n        <div>\n          {dataset.name} ({dataset.digest})\n        </div>\n      ) : (\n        <Typography.Text size=\"md\" css={{ marginBottom: 0 }}>\n          {dataset.name} ({dataset.digest})\n        </Typography.Text>\n      )}\n      <Tag\n        componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewdatasetwithcontext.tsx_41\"\n        css={{\n          textTransform: 'capitalize',\n          marginLeft: theme.spacing.xs,\n          marginRight: theme.spacing.xs,\n        }}\n      >\n        {tags && tags.find(({ key }) => key === MLFLOW_RUN_DATASET_CONTEXT_TAG)?.value}\n      </Tag>\n    </div>\n  );\n};\n","import React from 'react';\nimport Utils from '../../../../../../common/utils/Utils';\nimport { RunRowType } from '../../../utils/experimentPage.row-types';\nimport { useDesignSystemTheme } from '@databricks/design-system';\nimport { ExperimentSourceTypeIcon } from '../../../../ExperimentSourceTypeIcon';\n\nexport const SourceCellRenderer = React.memo(({ value: tags }: { value: RunRowType['tags'] }) => {\n  const { theme } = useDesignSystemTheme();\n  if (!tags) {\n    return <>-</>;\n  }\n  const sourceType = tags[Utils.sourceTypeTag]?.value || '';\n\n  const sourceLink = Utils.renderSource(tags || {}, undefined, undefined);\n  return sourceLink ? (\n    <div css={{ display: 'flex', gap: theme.spacing.xs, alignItems: 'center' }}>\n      <ExperimentSourceTypeIcon sourceType={sourceType} css={{ color: theme.colors.textSecondary }} />\n      <span css={{ overflow: 'hidden', textOverflow: 'ellipsis' }}>{sourceLink}</span>\n    </div>\n  ) : (\n    <>-</>\n  );\n});\n","import React, { ReactNode, useMemo } from 'react';\nimport { ExperimentPageUIState, createExperimentPageUIState } from '../models/ExperimentPageUIState';\n\nconst ExperimentPageUISetStateContext = React.createContext<\n  React.Dispatch<React.SetStateAction<ExperimentPageUIState>>\n>((state) => state);\n\n// Creates contexts for setting current UI state\nexport const ExperimentPageUIStateContextProvider = ({\n  children,\n  setUIState,\n}: {\n  children: ReactNode;\n  setUIState: React.Dispatch<React.SetStateAction<ExperimentPageUIState>>;\n}) => (\n  <ExperimentPageUISetStateContext.Provider value={setUIState}>{children}</ExperimentPageUISetStateContext.Provider>\n);\n\nexport const useUpdateExperimentViewUIState = () => React.useContext(ExperimentPageUISetStateContext);\n","import qs from 'qs';\nimport { useMemo } from 'react';\nimport { useParams, useLocation } from '../../../../common/utils/RoutingUtils';\nimport Utils from '../../../../common/utils/Utils';\n\nexport type UseExperimentIdsResult = string[];\n\n/**\n * Hook that returns requested experiment IDs basing on the URL.\n * It extracts ids basing on either route match (in case of a single experiment)\n * or query params (in case of comparing experiments.).\n *\n * @returns array of strings with experiment IDs\n */\n\nexport const useExperimentIds = (): UseExperimentIdsResult => {\n  const params = useParams<{ experimentId?: string }>();\n  const location = useLocation();\n\n  const normalizedLocationSearch = useMemo(() => decodeURIComponent(location.search), [location.search]);\n\n  /**\n   * Memoized string containing experiment IDs for comparison (\"?experiments=...\")\n   */\n  const compareExperimentIdsQueryParam = useMemo(() => {\n    const queryParams = qs.parse(normalizedLocationSearch.substring(1));\n    if (queryParams['experiments']) {\n      const experimentIdsRaw = queryParams['experiments'];\n      return experimentIdsRaw?.toString() || '';\n    }\n\n    return '';\n  }, [normalizedLocationSearch]);\n\n  return useMemo(() => {\n    // Case #1: single experiment\n    if (params?.experimentId) {\n      return [params?.experimentId];\n    }\n\n    // Case #2: multiple (compare) experiments\n    if (compareExperimentIdsQueryParam) {\n      try {\n        return JSON.parse(compareExperimentIdsQueryParam);\n      } catch {\n        // Apparently URL is malformed\n        Utils.logErrorAndNotifyUser(`Could not parse experiment query parameter ${compareExperimentIdsQueryParam}`);\n        return '';\n      }\n    }\n\n    return [];\n  }, [compareExperimentIdsQueryParam, params?.experimentId]);\n};\n","import Utils from '@mlflow/mlflow/src/common/utils/Utils';\nimport { listImagesApi } from '@mlflow/mlflow/src/experiment-tracking/actions';\nimport { EXPERIMENT_RUNS_IMAGE_AUTO_REFRESH_INTERVAL } from '@mlflow/mlflow/src/experiment-tracking/constants';\nimport { useEffect, useRef } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { ThunkDispatch } from '@mlflow/mlflow/src/redux-types';\nimport { NUM_RUNS_TO_SUPPORT_FOR_LOG_IMAGE } from '@mlflow/mlflow/src/experiment-tracking/constants';\n\nexport const usePopulateImagesByRunUuid = ({\n  runUuids,\n  runUuidsIsActive,\n  autoRefreshEnabled,\n  enabled,\n}: {\n  runUuids: string[];\n  runUuidsIsActive: boolean[];\n  autoRefreshEnabled?: boolean;\n  enabled?: boolean;\n}) => {\n  // Retrieve image keys for each run. This should only re-render when the runUuids change.\n  // This populates the imagesByRunUuid with imageKeys, which will be used elsewhere to fetch metadata.\n  const dispatch = useDispatch<ThunkDispatch>();\n\n  /**\n   * The criteria to populate images for a run is\n   * 1. The run is not hidden\n   * 2. The run includes the mlflow.loggedImage tag\n   * 3. The run's image is not already populated\n   */\n  // We need to use a serialized version of runUuids to avoid re-triggering the effect when using an array.\n  const runUuidsSerialized = runUuids.slice(0, NUM_RUNS_TO_SUPPORT_FOR_LOG_IMAGE).join(',');\n  useEffect(() => {\n    // Regular single fetch event with no auto-refresh capabilities. Used if auto-refresh is disabled.\n    if (!enabled || autoRefreshEnabled) {\n      return;\n    }\n    runUuidsSerialized.split(',').forEach((runUuid) => {\n      if (runUuid) {\n        dispatch(listImagesApi(runUuid));\n      }\n    });\n  }, [runUuidsSerialized, dispatch, autoRefreshEnabled, enabled]);\n\n  const refreshTimeoutRef = useRef<number | undefined>(undefined);\n  const autoRefreshEnabledRef = useRef(autoRefreshEnabled && enabled);\n  autoRefreshEnabledRef.current = autoRefreshEnabled;\n\n  const runUuidsIsActiveSerialized = runUuidsIsActive.slice(0, NUM_RUNS_TO_SUPPORT_FOR_LOG_IMAGE).join(',');\n  // A fetch effect with auto-refresh capabilities. Used only if auto-refresh is enabled.\n  useEffect(() => {\n    let hookUnmounted = false;\n\n    if (!enabled || !autoRefreshEnabled) {\n      return;\n    }\n\n    const fetchImagesFn = async (autoRefresh: boolean) => {\n      const runUuids = runUuidsSerialized.split(',');\n\n      const activeRunUuids = runUuidsIsActiveSerialized.split(',');\n      // If auto-refresh is enabled, only fetch images for runs that are currently active\n      const filteredRunUuids = autoRefresh ? runUuids.filter((_, index) => activeRunUuids[index] === 'true') : runUuids;\n\n      filteredRunUuids.forEach((runUuid) => {\n        if (runUuid) {\n          dispatch(listImagesApi(runUuid, autoRefresh));\n        }\n      });\n    };\n\n    const scheduleRefresh = async () => {\n      // Initial check to confirm that auto-refresh is still enabled and the hook is still mounted\n      if (!autoRefreshEnabledRef.current || hookUnmounted) {\n        return;\n      }\n      try {\n        await fetchImagesFn(true);\n      } catch (e) {\n        // In case of error during auto-refresh, log the error but do break the auto-refresh loop\n        Utils.logErrorAndNotifyUser(e);\n      }\n      clearTimeout(refreshTimeoutRef.current);\n\n      // After loading the data, schedule the next refresh if the hook is still enabled and mounted\n      if (!autoRefreshEnabledRef.current || hookUnmounted) {\n        return;\n      }\n\n      refreshTimeoutRef.current = window.setTimeout(scheduleRefresh, EXPERIMENT_RUNS_IMAGE_AUTO_REFRESH_INTERVAL);\n    };\n\n    fetchImagesFn(false).then(scheduleRefresh);\n\n    return () => {\n      fetchImagesFn(true);\n      // Mark the hook as unmounted to prevent scheduling new auto-refreshes with current data\n      hookUnmounted = true;\n      // Clear the timeout\n      clearTimeout(refreshTimeoutRef.current);\n    };\n  }, [dispatch, runUuidsSerialized, runUuidsIsActiveSerialized, autoRefreshEnabled, enabled]);\n};\n","/**\n * NOTE: this code file was automatically migrated to TypeScript using ts-migrate and\n * may contain multiple `any` type annotations and `@ts-expect-error` directives.\n * If possible, please improve types while making changes to this file. If the type\n * annotations are already looking good, please remove this comment.\n */\n\nimport React, { Component } from 'react';\nimport { Modal } from '@databricks/design-system';\n\ntype Props = {\n  isOpen: boolean;\n  handleSubmit: (...args: any[]) => any;\n  onClose: (...args: any[]) => any;\n  title: React.ReactNode;\n  helpText: React.ReactNode;\n  confirmButtonText: React.ReactNode;\n};\n\ntype State = any;\n\nexport class ConfirmModal extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.onRequestCloseHandler = this.onRequestCloseHandler.bind(this);\n    this.handleSubmitWrapper = this.handleSubmitWrapper.bind(this);\n  }\n\n  state = {\n    isSubmitting: false,\n  };\n\n  onRequestCloseHandler() {\n    if (!this.state.isSubmitting) {\n      this.props.onClose();\n    }\n  }\n\n  handleSubmitWrapper() {\n    this.setState({ isSubmitting: true });\n    return this.props.handleSubmit().finally(() => {\n      this.props.onClose();\n      this.setState({ isSubmitting: false });\n    });\n  }\n\n  render() {\n    return (\n      <Modal\n        data-testid=\"confirm-modal\"\n        title={this.props.title}\n        visible={this.props.isOpen}\n        onOk={this.handleSubmitWrapper}\n        okText={this.props.confirmButtonText}\n        confirmLoading={this.state.isSubmitting}\n        onCancel={this.onRequestCloseHandler}\n        // @ts-expect-error TS(2322): Type '{ children: Element; \"data-testid\": string; ... Remove this comment to see the full error message\n        centered\n      >\n        <div className=\"modal-explanatory-text\">{this.props.helpText}</div>\n      </Modal>\n    );\n  }\n}\n","/**\n * NOTE: this code file was automatically migrated to TypeScript using ts-migrate and\n * may contain multiple `any` type annotations and `@ts-expect-error` directives.\n * If possible, please improve types while making changes to this file. If the type\n * annotations are already looking good, please remove this comment.\n */\n\nimport React, { Component } from 'react';\nimport { ConfirmModal } from './ConfirmModal';\nimport { deleteRunApi, openErrorModal } from '../../actions';\nimport { connect } from 'react-redux';\nimport Utils from '../../../common/utils/Utils';\nimport { IntlShape, injectIntl } from 'react-intl';\n\ntype Props = {\n  isOpen: boolean;\n  onClose: (...args: any[]) => any;\n  selectedRunIds: string[];\n  openErrorModal: (...args: any[]) => any;\n  deleteRunApi: (...args: any[]) => any;\n  onSuccess?: () => void;\n  intl: IntlShape;\n};\n\nexport class DeleteRunModalImpl extends Component<Props> {\n  constructor(props: Props) {\n    super(props);\n    this.handleSubmit = this.handleSubmit.bind(this);\n  }\n\n  handleSubmit() {\n    const deletePromises: any = [];\n    this.props.selectedRunIds.forEach((runId) => {\n      deletePromises.push(this.props.deleteRunApi(runId));\n    });\n    return Promise.all(deletePromises)\n      .catch(() => {\n        const errorModalContent = `${this.props.intl.formatMessage({\n          defaultMessage: 'While deleting an experiment run, an error occurred.',\n          description: 'Experiment tracking > delete run modal > error message',\n        })}`;\n        this.props.openErrorModal(errorModalContent);\n      })\n      .then(() => {\n        this.props.onSuccess?.();\n      });\n  }\n\n  render() {\n    const number = this.props.selectedRunIds.length;\n    return (\n      <ConfirmModal\n        isOpen={this.props.isOpen}\n        onClose={this.props.onClose}\n        handleSubmit={this.handleSubmit}\n        title={`Delete Experiment ${Utils.pluralize('Run', number)}`}\n        helpText={\n          <div>\n            <p>\n              <b>\n                {number} experiment {Utils.pluralize('run', number)} will be deleted.\n              </b>\n            </p>\n            {/* @ts-expect-error TS(4111): Property 'MLFLOW_SHOW_GDPR_PURGING_MESSAGES' comes from a... Remove this comment to see the full error message */}\n            {process.env.MLFLOW_SHOW_GDPR_PURGING_MESSAGES === 'true' ? (\n              <p>\n                Deleted runs are restorable for 30 days, after which they are purged along with associated metrics,\n                params, tags, and artifacts.\n              </p>\n            ) : (\n              ''\n            )}\n          </div>\n        }\n        confirmButtonText=\"Delete\"\n      />\n    );\n  }\n}\n\nconst mapDispatchToProps = {\n  deleteRunApi,\n  openErrorModal,\n};\n\nexport default connect(null, mapDispatchToProps)(injectIntl(DeleteRunModalImpl));\n","/**\n * NOTE: this code file was automatically migrated to TypeScript using ts-migrate and\n * may contain multiple `any` type annotations and `@ts-expect-error` directives.\n * If possible, please improve types while making changes to this file. If the type\n * annotations are already looking good, please remove this comment.\n */\n\nimport React, { Component } from 'react';\nimport { Modal } from '@databricks/design-system';\n\nimport Utils from '../../../common/utils/Utils';\n\ntype Props = {\n  okText?: string;\n  cancelText?: string;\n  isOpen?: boolean;\n  onClose: (...args: any[]) => any;\n  onCancel?: (...args: any[]) => any;\n  className?: string;\n  footer?: React.ReactNode;\n  handleSubmit: (...args: any[]) => any;\n  title: React.ReactNode;\n};\n\ntype State = any;\n\n/**\n * Generic modal that has a title and an input field with a save/submit button.\n * As of now, it is used to display the 'Rename Run' and 'Rename Experiment' modals.\n */\nexport class GenericInputModal extends Component<Props, State> {\n  state = {\n    isSubmitting: false,\n  };\n\n  formRef = React.createRef();\n\n  onSubmit = async () => {\n    this.setState({ isSubmitting: true });\n    try {\n      const values = await (this as any).formRef.current.validateFields();\n\n      // call handleSubmit from parent component, pass form values\n      // handleSubmit is expected to return a promise\n      return await this.props\n        .handleSubmit(values)\n        .then(this.resetAndClearModalForm)\n        .catch(this.handleSubmitFailure)\n        .finally(this.onRequestCloseHandler);\n    } catch (e) {\n      this.setState({ isSubmitting: false });\n      return Promise.reject(e);\n    }\n  };\n\n  resetAndClearModalForm = () => {\n    this.setState({ isSubmitting: false });\n    (this as any).formRef.current.resetFields();\n  };\n\n  handleSubmitFailure = (e: any) => {\n    this.setState({ isSubmitting: false });\n    Utils.logErrorAndNotifyUser(e);\n  };\n\n  onRequestCloseHandler = () => {\n    if (!this.state.isSubmitting) {\n      this.resetAndClearModalForm();\n      this.props.onClose();\n    }\n  };\n\n  handleCancel = () => {\n    this.onRequestCloseHandler();\n    // Check for optional `onCancel` method prop.\n    if (this.props.onCancel !== undefined) {\n      this.props.onCancel();\n    }\n  };\n\n  render() {\n    const { isSubmitting } = this.state;\n    const { okText, cancelText, isOpen, footer, children } = this.props;\n\n    // add props (ref) to passed component\n    const displayForm = React.Children.map(children, (child) => {\n      // Checking isValidElement is the safe way and avoids a typescript\n      // error too.\n      if (React.isValidElement(child)) {\n        // @ts-expect-error TODO: fix this\n        return React.cloneElement(child, { innerRef: this.formRef });\n      }\n      return child;\n    });\n\n    return (\n      <Modal\n        data-testid=\"mlflow-input-modal\"\n        className={this.props.className}\n        title={this.props.title}\n        // @ts-expect-error TS(2322): Type '{ children: {}[] | null | undefined; \"data-t... Remove this comment to see the full error message\n        width={540}\n        visible={isOpen}\n        onOk={this.onSubmit}\n        okText={okText}\n        cancelText={cancelText}\n        confirmLoading={isSubmitting}\n        onCancel={this.handleCancel}\n        footer={footer}\n        centered\n      >\n        {displayForm}\n      </Modal>\n    );\n  }\n}\n","/**\n * NOTE: this code file was automatically migrated to TypeScript using ts-migrate and\n * may contain multiple `any` type annotations and `@ts-expect-error` directives.\n * If possible, please improve types while making changes to this file. If the type\n * annotations are already looking good, please remove this comment.\n */\n\nimport React, { Component } from 'react';\n\nimport { LegacyForm, Input } from '@databricks/design-system';\n\nexport const NEW_NAME_FIELD = 'newName';\n\ntype Props = {\n  type: string;\n  name: string;\n  visible: boolean;\n  validator?: (...args: any[]) => any;\n  innerRef: any;\n};\n\n/**\n * Component that renders a form for updating a run's or experiment's name.\n */\nclass RenameFormComponent extends Component<Props> {\n  inputToAutoFocus: any;\n\n  componentDidUpdate(prevProps: Props) {\n    this.autoFocus(prevProps);\n    this.resetFields(prevProps);\n  }\n\n  autoFocusInputRef = (inputToAutoFocus: any) => {\n    this.inputToAutoFocus = inputToAutoFocus;\n    inputToAutoFocus && inputToAutoFocus.focus();\n    inputToAutoFocus && inputToAutoFocus.select();\n  };\n\n  autoFocus = (prevProps: any) => {\n    if (prevProps.visible === false && this.props.visible === true) {\n      // focus on input field\n      this.inputToAutoFocus && this.inputToAutoFocus.focus();\n      // select text\n      this.inputToAutoFocus && this.inputToAutoFocus.select();\n    }\n  };\n\n  resetFields = (prevProps: any) => {\n    const formRef = this.props.innerRef;\n    if (prevProps.name !== this.props.name) {\n      // reset input field to reset displayed initialValue\n      formRef.current.resetFields([NEW_NAME_FIELD]);\n    }\n  };\n\n  render() {\n    return (\n      // @ts-expect-error TS(2322): Type '{ children: Element; ref: any; layout: \"vert... Remove this comment to see the full error message\n      <LegacyForm ref={this.props.innerRef} layout=\"vertical\">\n        <LegacyForm.Item\n          name={NEW_NAME_FIELD}\n          initialValue={this.props.name}\n          rules={[\n            { required: true, message: `Please input a new name for the ${this.props.type}.` },\n            { validator: this.props.validator },\n          ]}\n          label={`New ${this.props.type} name`}\n        >\n          <Input\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_modals_renameform.tsx_69\"\n            placeholder={`Input a ${this.props.type} name`}\n            ref={this.autoFocusInputRef}\n            data-testid=\"rename-modal-input\"\n          />\n        </LegacyForm.Item>\n      </LegacyForm>\n    );\n  }\n}\n\nexport const RenameForm = RenameFormComponent;\n","/**\n * NOTE: this code file was automatically migrated to TypeScript using ts-migrate and\n * may contain multiple `any` type annotations and `@ts-expect-error` directives.\n * If possible, please improve types while making changes to this file. If the type\n * annotations are already looking good, please remove this comment.\n */\n\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { IntlShape, injectIntl } from 'react-intl';\n\nimport { GenericInputModal } from './GenericInputModal';\nimport { RenameForm, NEW_NAME_FIELD } from './RenameForm';\n\nimport { updateRunApi } from '../../actions';\nimport { getUUID } from '../../../common/utils/ActionUtils';\n\ntype Props = {\n  isOpen?: boolean;\n  runUuid: string;\n  runName: string;\n  onClose: (...args: any[]) => any;\n  updateRunApi: (...args: any[]) => any;\n  intl: IntlShape;\n  onSuccess?: (...args: any[]) => any;\n};\n\nexport class RenameRunModalImpl extends Component<Props> {\n  handleRenameRun = (values: any) => {\n    // get value of input field\n    const newRunName = values[NEW_NAME_FIELD];\n\n    const updateRunRequestId = getUUID();\n\n    return this.props\n      .updateRunApi(this.props.runUuid, newRunName, updateRunRequestId)\n      .then(() => this.props.onSuccess?.());\n  };\n\n  render() {\n    const { isOpen, runName } = this.props;\n    return (\n      <GenericInputModal\n        title={this.props.intl.formatMessage({\n          defaultMessage: 'Rename Run',\n          description: 'Modal title to rename the experiment run name',\n        })}\n        okText={this.props.intl.formatMessage({\n          defaultMessage: 'Save',\n          description: 'Modal button text to save the changes to rename the experiment run name',\n        })}\n        isOpen={isOpen}\n        handleSubmit={this.handleRenameRun}\n        onClose={this.props.onClose}\n      >\n        <RenameForm\n          type=\"run\"\n          name={runName}\n          // @ts-expect-error TS(2769): No overload matches this call.\n          visible={isOpen}\n          validator={async (_, value) => {\n            if (typeof value === 'string' && value.length && !value.trim()) {\n              throw new Error(\n                this.props.intl.formatMessage({\n                  defaultMessage: 'Run name cannot consist only of whitespace!',\n                  description: \"An error shown when user sets the run's name to whitespace characters only\",\n                }),\n              );\n            }\n            return true;\n          }}\n        />\n      </GenericInputModal>\n    );\n  }\n}\n\nconst mapDispatchToProps = {\n  updateRunApi,\n};\n\nexport const RenameRunModalWithIntl = injectIntl(RenameRunModalImpl);\nexport const RenameRunModal = connect(undefined, mapDispatchToProps)(RenameRunModalWithIntl);\n","import { LegacySelect, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport React, { ComponentProps, PropsWithChildren } from 'react';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { makeCanonicalSortKey } from '../../../experiment-page/utils/experimentPage.common-utils';\nimport { shouldUseNewRunRowsVisibilityModel } from '../../../../../common/utils/FeatureUtils';\n\n/**\n * Represents a field in the compare run charts configuration modal.\n * Displays a title and content with proper margins.\n */\nexport const RunsChartsConfigureField = ({\n  title,\n  compact = false,\n  children,\n}: PropsWithChildren<{\n  title: React.ReactNode;\n  compact?: boolean;\n}>) => {\n  const { theme } = useDesignSystemTheme();\n  return (\n    <div\n      css={{ marginBottom: compact ? theme.spacing.sm : theme.spacing.md * 2 }}\n      data-testid=\"experiment-view-compare-runs-config-field\"\n    >\n      <Typography.Title level={4}>{title}</Typography.Title>\n      {children}\n    </div>\n  );\n};\n\n/**\n * A searchable select for selecting metric or param from a categorized list.\n */\nexport const RunsChartsMetricParamSelect = ({\n  value,\n  onChange,\n  metricKeyList,\n  paramKeyList,\n}: {\n  value: string;\n  onChange: ComponentProps<typeof LegacySelect>['onChange'];\n  metricKeyList?: string[];\n  paramKeyList?: string[];\n}) => {\n  const { formatMessage } = useIntl();\n\n  const isEmpty = !paramKeyList?.length && !metricKeyList?.length;\n\n  return (\n    <LegacySelect\n      css={styles.selectFull}\n      value={\n        isEmpty\n          ? formatMessage({\n              description:\n                'Message displayed when no metrics or params are available in the compare runs chart configure modal',\n              defaultMessage: 'No metrics or parameters available',\n            })\n          : value\n      }\n      disabled={isEmpty}\n      onChange={onChange}\n      dangerouslySetAntdProps={{ showSearch: true }}\n    >\n      {metricKeyList?.length ? (\n        <LegacySelect.OptGroup\n          label={formatMessage({\n            defaultMessage: 'Metrics',\n            description: \"Label for 'metrics' option group in the compare runs chart configure modal\",\n          })}\n        >\n          {metricKeyList.map((metric) => (\n            <LegacySelect.Option\n              key={makeCanonicalSortKey('METRIC', metric)}\n              value={makeCanonicalSortKey('METRIC', metric)}\n            >\n              {metric}\n            </LegacySelect.Option>\n          ))}\n        </LegacySelect.OptGroup>\n      ) : null}\n      {paramKeyList?.length ? (\n        <LegacySelect.OptGroup\n          label={formatMessage({\n            defaultMessage: 'Params',\n            description: \"Label for 'params' option group in the compare runs chart configure modal\",\n          })}\n        >\n          {paramKeyList.map((param) => (\n            <LegacySelect.Option\n              key={makeCanonicalSortKey('PARAM', param)}\n              value={makeCanonicalSortKey('PARAM', param)}\n            >\n              {param}\n            </LegacySelect.Option>\n          ))}\n        </LegacySelect.OptGroup>\n      ) : null}\n    </LegacySelect>\n  );\n};\n\nexport const RunsChartsRunNumberSelect = ({\n  onChange,\n  value,\n  options,\n}: {\n  value?: number;\n  onChange: ComponentProps<typeof LegacySelect<number>>['onChange'];\n  options: (number | { value: number; label: React.ReactNode })[];\n}) => {\n  const { formatMessage } = useIntl();\n\n  // After moving to the new run rows visibility model, we don't configure run count per chart\n  if (shouldUseNewRunRowsVisibilityModel()) {\n    return null;\n  }\n  return (\n    <RunsChartsConfigureField\n      title={formatMessage({\n        defaultMessage: 'Max. no of runs shown',\n        description: 'Label for the control allowing selection of number of runs displayed in a compare runs chart',\n      })}\n    >\n      <LegacySelect<number> css={styles.selectFull} value={value} onChange={onChange}>\n        {options.map((countOption) => {\n          const optionValue = typeof countOption === 'number' ? countOption : countOption.value;\n          const label = typeof countOption === 'number' ? countOption : countOption.label;\n          return (\n            <LegacySelect.Option key={optionValue} value={optionValue}>\n              {label}\n            </LegacySelect.Option>\n          );\n        })}\n      </LegacySelect>\n    </RunsChartsConfigureField>\n  );\n};\n\nexport const runsChartsRunCountDefaultOptions: { value: number; label: React.ReactNode }[] = [\n  // We're not using any procedural generation so react-intl extractor can parse it\n  {\n    value: 5,\n    label: (\n      <FormattedMessage\n        defaultMessage=\"5\"\n        description=\"Label for 5 first runs visible in run count selector within runs compare configuration modal\"\n      />\n    ),\n  },\n  {\n    value: 10,\n    label: (\n      <FormattedMessage\n        defaultMessage=\"10\"\n        description=\"Label for 10 first runs visible in run count selector within runs compare configuration modal\"\n      />\n    ),\n  },\n  {\n    value: 20,\n    label: (\n      <FormattedMessage\n        defaultMessage=\"20\"\n        description=\"Label for 20 first runs visible in run count selector within runs compare configuration modal\"\n      />\n    ),\n  },\n];\n\nconst styles = { selectFull: { width: '100%' } };\n","import { LegacySelect } from '@databricks/design-system';\nimport { useCallback, useEffect } from 'react';\nimport type { RunsChartsCardConfig, RunsChartsBarCardConfig } from '../../runs-charts.types';\nimport {\n  RunsChartsConfigureField,\n  runsChartsRunCountDefaultOptions,\n  RunsChartsRunNumberSelect,\n} from './RunsChartsConfigure.common';\n\n/**\n * Form containing configuration controls for runs compare charts.\n */\nexport const RunsChartsConfigureBarChart = ({\n  state,\n  onStateChange,\n  metricKeyList,\n}: {\n  metricKeyList: string[];\n  state: Partial<RunsChartsBarCardConfig>;\n  onStateChange: (setter: (current: RunsChartsCardConfig) => RunsChartsBarCardConfig) => void;\n}) => {\n  /**\n   * Callback for updating metric key\n   */\n  const updateMetric = useCallback(\n    (metricKey: string) => {\n      onStateChange((current) => ({ ...(current as RunsChartsBarCardConfig), metricKey }));\n    },\n    [onStateChange],\n  );\n\n  /**\n   * Callback for updating run count\n   */\n  const updateVisibleRunCount = useCallback(\n    (runsCountToCompare: number) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsBarCardConfig),\n        runsCountToCompare,\n      }));\n    },\n    [onStateChange],\n  );\n\n  /**\n   * If somehow metric key is not predetermined, automatically\n   * select the first one so it's not empty\n   */\n  useEffect(() => {\n    if (!state.metricKey && metricKeyList?.[0]) {\n      updateMetric(metricKeyList[0]);\n    }\n  }, [state.metricKey, updateMetric, metricKeyList]);\n\n  const emptyMetricsList = metricKeyList.length === 0;\n\n  return (\n    <>\n      <RunsChartsConfigureField title=\"Metric\">\n        <LegacySelect\n          css={styles.selectFull}\n          value={emptyMetricsList ? 'No metrics available' : state.metricKey}\n          onChange={updateMetric}\n          disabled={emptyMetricsList}\n          dangerouslySetAntdProps={{ showSearch: true }}\n        >\n          {metricKeyList.map((metric) => (\n            <LegacySelect.Option key={metric} value={metric} data-testid={`metric-${metric}`}>\n              {metric}\n            </LegacySelect.Option>\n          ))}\n        </LegacySelect>\n      </RunsChartsConfigureField>\n      <RunsChartsRunNumberSelect\n        value={state.runsCountToCompare}\n        onChange={updateVisibleRunCount}\n        options={runsChartsRunCountDefaultOptions}\n      />\n    </>\n  );\n};\n\nconst styles = { selectFull: { width: '100%' } };\n","import { LegacySelect } from '@databricks/design-system';\nimport { useCallback } from 'react';\nimport type { RunsChartsCardConfig, RunsChartsParallelCardConfig } from '../../runs-charts.types';\nimport { RunsChartsConfigureField } from './RunsChartsConfigure.common';\n\n/**\n * Form containing configuration controls for runs compare charts.\n */\nexport const RunsChartsConfigureParallelChart = ({\n  state,\n  onStateChange,\n  metricKeyList,\n  paramKeyList,\n}: {\n  metricKeyList: string[];\n  paramKeyList: string[];\n  state: Partial<RunsChartsParallelCardConfig>;\n  onStateChange: (setter: (current: RunsChartsCardConfig) => RunsChartsParallelCardConfig) => void;\n}) => {\n  /**\n   * Callback for updating selected metrics and params\n   */\n\n  const updateSelectedParams = useCallback(\n    (selectedParams: string[]) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsParallelCardConfig),\n        selectedParams,\n      }));\n    },\n    [onStateChange],\n  );\n\n  const updateSelectedMetrics = useCallback(\n    (selectedMetrics: string[]) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsParallelCardConfig),\n        selectedMetrics,\n      }));\n    },\n    [onStateChange],\n  );\n\n  const emptyMetricsList = metricKeyList.length === 0;\n  const emptyParamsList = paramKeyList.length === 0;\n\n  return (\n    <>\n      <RunsChartsConfigureField title=\"Params\">\n        <LegacySelect\n          mode={emptyParamsList ? undefined : 'multiple'}\n          onChange={updateSelectedParams}\n          style={{\n            width: 275,\n          }}\n          value={emptyParamsList ? ('No parameters available' as any) : state.selectedParams}\n          disabled={emptyParamsList}\n        >\n          {paramKeyList.map((param) => (\n            <LegacySelect.Option value={param} key={param}>\n              {param}\n            </LegacySelect.Option>\n          ))}\n        </LegacySelect>\n      </RunsChartsConfigureField>\n      <RunsChartsConfigureField title=\"Metrics\">\n        <LegacySelect\n          mode={emptyMetricsList ? undefined : 'multiple'}\n          onChange={updateSelectedMetrics}\n          style={{\n            width: 275,\n          }}\n          value={emptyMetricsList ? ('No metrics available' as any) : state.selectedMetrics}\n          disabled={emptyMetricsList}\n        >\n          {metricKeyList.map((metric) => (\n            <LegacySelect.Option value={metric} key={metric}>\n              {metric}\n            </LegacySelect.Option>\n          ))}\n        </LegacySelect>\n      </RunsChartsConfigureField>\n    </>\n  );\n};\n","import {\n  Button,\n  CloseIcon,\n  Input,\n  LegacySelect,\n  PlusIcon,\n  Radio,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport {\n  RunsChartsCardConfig,\n  RunsChartsLineCardConfig,\n  RunsChartsLineChartExpression,\n  RunsChartsLineChartYAxisType,\n} from '../runs-charts.types';\nimport { RunsChartsConfigureField } from './config/RunsChartsConfigure.common';\nimport { FormattedMessage } from 'react-intl';\nimport { shouldEnableChartExpressions } from '@mlflow/mlflow/src/common/utils/FeatureUtils';\nimport { useCallback, useEffect, useState } from 'react';\nimport { useChartExpressionParser } from '../hooks/useChartExpressionParser';\nimport { RunsChartsLineChartXAxisType } from './RunsCharts.common';\n\nconst renderMetricSelectorV1 = ({\n  metricKeyList,\n  metricKey,\n  updateMetric,\n}: {\n  metricKeyList: string[];\n  metricKey?: string;\n  updateMetric: (metricKey: string) => void;\n}) => {\n  const emptyMetricsList = metricKeyList.length === 0;\n\n  return (\n    <LegacySelect\n      css={{ width: '100%' }}\n      value={emptyMetricsList ? 'No metrics available' : metricKey}\n      onChange={updateMetric}\n      disabled={emptyMetricsList}\n      dangerouslySetAntdProps={{ showSearch: true }}\n    >\n      {metricKeyList.map((metric) => (\n        <LegacySelect.Option key={metric} value={metric} data-testid={`metric-${metric}`}>\n          {metric}\n        </LegacySelect.Option>\n      ))}\n    </LegacySelect>\n  );\n};\n\nconst renderMetricSelectorV2 = ({\n  metricKeyList,\n  selectedMetricKeys,\n  updateSelectedMetrics,\n}: {\n  metricKeyList: string[];\n  selectedMetricKeys?: string[];\n  updateSelectedMetrics: (metricKeys: string[]) => void;\n}) => {\n  const emptyMetricsList = metricKeyList.length === 0;\n\n  return (\n    <LegacySelect\n      mode=\"multiple\"\n      placeholder={\n        emptyMetricsList ? (\n          <FormattedMessage\n            defaultMessage=\"No metrics available\"\n            description=\"Text shown in a disabled multi-selector when there are no selectable metrics.\"\n          />\n        ) : (\n          <FormattedMessage\n            defaultMessage=\"Select metrics\"\n            description=\"Placeholder text for a metric multi-selector when configuring a line chart\"\n          />\n        )\n      }\n      css={{ width: '100%' }}\n      value={emptyMetricsList ? [] : selectedMetricKeys}\n      onChange={updateSelectedMetrics}\n      disabled={emptyMetricsList}\n      dangerouslySetAntdProps={{ showSearch: true }}\n    >\n      {metricKeyList.map((metric) => (\n        <LegacySelect.Option key={metric} value={metric} data-testid={`metric-${metric}`}>\n          {metric}\n        </LegacySelect.Option>\n      ))}\n    </LegacySelect>\n  );\n};\n\nconst ExpressionInput = ({\n  chartExpression,\n  index,\n  updateYAxisExpression,\n  removeYAxisExpression,\n  metricKeyList,\n}: {\n  chartExpression: RunsChartsLineChartExpression;\n  index: number;\n  updateYAxisExpression: (expression: RunsChartsLineChartExpression, index: number) => void;\n  removeYAxisExpression: (index: number) => void;\n  metricKeyList: string[];\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const { compileExpression } = useChartExpressionParser();\n  const [isValidExpression, setIsValidExpression] = useState(true);\n  const validateAndUpdate = (expression: string) => {\n    const compiledExpression = compileExpression(expression, metricKeyList);\n    if (compiledExpression === undefined) {\n      setIsValidExpression(false);\n      updateYAxisExpression({ rpn: [], variables: [], expression }, index);\n    } else {\n      setIsValidExpression(true);\n      updateYAxisExpression(compiledExpression, index);\n    }\n  };\n\n  return (\n    <span css={{ display: 'flex', width: '100%', gap: theme.spacing.sm }}>\n      <Input\n        componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_runschartsyaxismetricandexpressionselector.tsx_122\"\n        value={chartExpression.expression}\n        onChange={(e) => validateAndUpdate(e.target.value)}\n        validationState={isValidExpression ? undefined : 'error'}\n      />\n      <Button\n        componentId=\"mlflow.charts.line-chart-expressions-remove\"\n        icon={<CloseIcon />}\n        onClick={() => removeYAxisExpression(index)}\n      />\n    </span>\n  );\n};\n\nexport const RunsChartsYAxisMetricAndExpressionSelector = ({\n  state,\n  onStateChange,\n  metricKeyList,\n  updateSelectedMetrics,\n}: {\n  state: Partial<RunsChartsLineCardConfig>;\n  onStateChange: (setter: (current: RunsChartsCardConfig) => RunsChartsLineCardConfig) => void;\n  metricKeyList: string[];\n  updateSelectedMetrics: (metricKeys: string[]) => void;\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const usingChartExpressions =\n    shouldEnableChartExpressions() && state.xAxisKey !== RunsChartsLineChartXAxisType.METRIC;\n\n  const DEBOUNCE_DELAY = 300; // in ms\n\n  const [temporaryChartExpressions, setTemporaryChartExpressions] = useState<RunsChartsLineChartExpression[]>(\n    state.yAxisExpressions || [],\n  );\n\n  const updateYAxisExpressionTemporary = (expression: RunsChartsLineChartExpression, index: number) => {\n    setTemporaryChartExpressions((current) => {\n      const newExpressions = [...current];\n      newExpressions[index] = expression;\n      return newExpressions;\n    });\n  };\n\n  const addNewYAxisExpressionTemporary = () => {\n    setTemporaryChartExpressions((current) => {\n      return [...current, { rpn: [], variables: [], expression: '' } as RunsChartsLineChartExpression];\n    });\n  };\n\n  const removeYAxisExpressionTemporary = (index: number) => {\n    setTemporaryChartExpressions((current) => {\n      const newExpressions = [...current];\n      newExpressions.splice(index, 1);\n      return newExpressions;\n    });\n  };\n\n  useEffect(() => {\n    const updateYAxisExpression = (yAxisExpressions: RunsChartsLineChartExpression[]) => {\n      onStateChange((current) => {\n        const config = current as RunsChartsLineCardConfig;\n        return {\n          ...config,\n          yAxisExpressions,\n        };\n      });\n    };\n    const handler = setTimeout(() => {\n      updateYAxisExpression(temporaryChartExpressions);\n    }, DEBOUNCE_DELAY);\n\n    return () => {\n      clearTimeout(handler);\n    };\n  }, [temporaryChartExpressions, onStateChange]);\n\n  const updateYAxisKey = useCallback(\n    (yAxisKey: RunsChartsLineCardConfig['yAxisKey']) => {\n      onStateChange((current) => {\n        const config = current as RunsChartsLineCardConfig;\n        return {\n          ...config,\n          yAxisKey,\n          range: {\n            ...config.range,\n            yMin: undefined,\n            yMax: undefined,\n          },\n        };\n      });\n    },\n    [onStateChange],\n  );\n\n  return (\n    <>\n      {usingChartExpressions && (\n        <RunsChartsConfigureField title=\"Metric type\" compact>\n          <Radio.Group\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_runschartsyaxismetricandexpressionselector.tsx_221\"\n            name=\"runs-charts-field-group-metric-type-y-axis\"\n            value={state.yAxisKey || RunsChartsLineChartYAxisType.METRIC}\n            onChange={({ target: { value } }) => updateYAxisKey(value)}\n          >\n            <Radio value={RunsChartsLineChartYAxisType.METRIC} key={RunsChartsLineChartYAxisType.METRIC}>\n              <FormattedMessage\n                defaultMessage=\"Logged metrics\"\n                description=\"Experiment tracking > runs charts > line chart configuration > logged metrics label\"\n              />\n            </Radio>\n            <Radio value={RunsChartsLineChartYAxisType.EXPRESSION} key={RunsChartsLineChartYAxisType.EXPRESSION}>\n              <FormattedMessage\n                defaultMessage=\"Custom expression\"\n                description=\"Experiment tracking > runs charts > line chart configuration > custom expression label\"\n              />\n            </Radio>\n          </Radio.Group>\n        </RunsChartsConfigureField>\n      )}\n      {usingChartExpressions && state.yAxisKey === RunsChartsLineChartYAxisType.EXPRESSION ? (\n        <RunsChartsConfigureField title=\"Expression\" compact>\n          <div css={{ display: 'flex', flexDirection: 'column', alignItems: 'flex-start', gap: theme.spacing.sm }}>\n            {temporaryChartExpressions.map((chartExpression, index) => {\n              return (\n                <ExpressionInput\n                  key={index}\n                  chartExpression={chartExpression}\n                  index={index}\n                  updateYAxisExpression={updateYAxisExpressionTemporary}\n                  removeYAxisExpression={removeYAxisExpressionTemporary}\n                  metricKeyList={metricKeyList}\n                />\n              );\n            })}\n            <Button\n              componentId=\"mlflow.charts.line-chart-expressions-add-new\"\n              icon={<PlusIcon />}\n              onClick={addNewYAxisExpressionTemporary}\n            >\n              Add new\n            </Button>\n          </div>\n        </RunsChartsConfigureField>\n      ) : (\n        <RunsChartsConfigureField title=\"Metric\" compact>\n          {renderMetricSelectorV2({\n            metricKeyList,\n            selectedMetricKeys: state.selectedMetricKeys,\n            updateSelectedMetrics,\n          })}\n        </RunsChartsConfigureField>\n      )}\n    </>\n  );\n};\n","import {\n  Radio,\n  LegacySelect,\n  Switch,\n  LegacyTooltip,\n  QuestionMarkIcon,\n  useDesignSystemTheme,\n  ThemeType,\n  SegmentedControlGroup,\n  SegmentedControlButton,\n  InfoIcon,\n  Input,\n  FormUI,\n  Typography,\n  SimpleSelect,\n  SimpleSelectOption,\n  SimpleSelectOptionGroup,\n  Tooltip,\n  PlusIcon,\n  Button,\n  Spacer,\n  CloseIcon,\n} from '@databricks/design-system';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { useCallback, useEffect, useState } from 'react';\nimport {\n  RunsChartsLineChartYAxisType,\n  type ChartRange,\n  type RunsChartsCardConfig,\n  type RunsChartsLineCardConfig,\n} from '../../runs-charts.types';\nimport { RunsChartsConfigureField, RunsChartsRunNumberSelect } from './RunsChartsConfigure.common';\nimport {\n  shouldEnableChartExpressions,\n  shouldEnableDeepLearningUIPhase3,\n  shouldEnableGlobalLineChartConfig,\n  shouldEnableManualRangeControls,\n} from '@mlflow/mlflow/src/common/utils/FeatureUtils';\nimport { RunsChartsLineChartXAxisType } from '@mlflow/mlflow/src/experiment-tracking/components/runs-charts/components/RunsCharts.common';\nimport { LineSmoothSlider } from '@mlflow/mlflow/src/experiment-tracking/components/LineSmoothSlider';\nimport { isUndefined } from 'lodash';\nimport { RunsChartsYAxisMetricAndExpressionSelector } from '../RunsChartsYAxisMetricAndExpressionSelector';\nimport { RunsChartsLineChartExpression } from '../../runs-charts.types';\nimport { useChartExpressionParser } from '../../hooks/useChartExpressionParser';\n\nconst USE_GLOBAL_SETTING_KEY = '_GLOBAL';\n\nconst renderXAxisMetricSelector = ({\n  theme,\n  metricKeyList,\n  selectedXAxisMetricKey,\n  updateSelectedXAxisMetricKey,\n  disabled = false,\n}: {\n  theme: ThemeType;\n  metricKeyList: string[];\n  selectedXAxisMetricKey?: string;\n  updateSelectedXAxisMetricKey: (metricKey: string) => void;\n  disabled?: boolean;\n}) => {\n  const emptyMetricsList = metricKeyList.length === 0;\n\n  return (\n    <Radio value={RunsChartsLineChartXAxisType.METRIC} disabled={disabled}>\n      <FormattedMessage\n        defaultMessage=\"Metric\"\n        description=\"Label for a radio button that configures the x-axis on a line chart. This option makes the X-axis a custom metric that the user selects.\"\n      />\n      <LegacySelect\n        css={{\n          marginTop: theme.spacing.xs,\n          width: '100%',\n        }}\n        value={selectedXAxisMetricKey || undefined}\n        placeholder={\n          emptyMetricsList ? (\n            <FormattedMessage\n              defaultMessage=\"No metrics available\"\n              description=\"Text shown in a disabled metric selector when there are no selectable metrics.\"\n            />\n          ) : (\n            <FormattedMessage\n              defaultMessage=\"Select metric\"\n              description=\"Placeholder text for a metric selector when configuring a line chart\"\n            />\n          )\n        }\n        onClick={(e: React.MouseEvent<HTMLElement>) => {\n          // this is to prevent the radio button\n          // from automatically closing the selector\n          e.preventDefault();\n          e.stopPropagation();\n        }}\n        onChange={updateSelectedXAxisMetricKey}\n        disabled={emptyMetricsList || disabled}\n        dangerouslySetAntdProps={{ showSearch: true }}\n      >\n        {metricKeyList.map((metric) => (\n          <LegacySelect.Option key={metric} value={metric} data-testid={`metric-${metric}`}>\n            {metric}\n          </LegacySelect.Option>\n        ))}\n      </LegacySelect>\n    </Radio>\n  );\n};\n\nconst safeLog = (x: number | undefined) => {\n  if (isUndefined(x)) {\n    return x;\n  }\n  if (x <= 0) {\n    return undefined;\n  }\n  return Math.log10(x);\n};\n\nconst safePow = (x: number | undefined) => {\n  if (isUndefined(x)) {\n    return x;\n  }\n  return Math.pow(10, x);\n};\n\n/**\n * Form containing configuration controls for runs compare charts.\n */\nexport const RunsChartsConfigureLineChart = ({\n  state,\n  onStateChange,\n  metricKeyList,\n}: {\n  metricKeyList: string[];\n  state: Partial<RunsChartsLineCardConfig>;\n  onStateChange: (setter: (current: RunsChartsCardConfig) => RunsChartsLineCardConfig) => void;\n}) => {\n  const usingChartExpressions = shouldEnableChartExpressions();\n  const shouldEnableMetricsOnXAxis = shouldEnableDeepLearningUIPhase3();\n  const usingManualRangeControls = shouldEnableManualRangeControls();\n  const { theme } = useDesignSystemTheme();\n  const intl = useIntl();\n  const runSelectOptions = [5, 10, 20, 50, 100];\n\n  const [localAxisRange, setLocalAxisRange] = useState<ChartRange>({\n    xMin: state.xAxisScaleType === 'log' ? safePow(state.range?.xMin) : state.range?.xMin,\n    xMax: state.xAxisScaleType === 'log' ? safePow(state.range?.xMax) : state.range?.xMax,\n    yMin: state.scaleType === 'log' ? safePow(state.range?.yMin) : state.range?.yMin,\n    yMax: state.scaleType === 'log' ? safePow(state.range?.yMax) : state.range?.yMax,\n  });\n\n  /**\n   * Callback for updating metric key\n   */\n  const updateMetric = useCallback(\n    (metricKey: string) => {\n      onStateChange((current) => ({ ...(current as RunsChartsLineCardConfig), metricKey }));\n    },\n    [onStateChange],\n  );\n\n  const updateSelectedMetrics = useCallback(\n    (metricKeys: string[]) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsLineCardConfig),\n        metricKey: metricKeys[0],\n        selectedMetricKeys: metricKeys,\n      }));\n    },\n    [onStateChange],\n  );\n\n  const updateXAxisKey = useCallback(\n    (xAxisKey: RunsChartsLineCardConfig['xAxisKey'], useGlobal = false) => {\n      onStateChange((current) => {\n        const config = current as RunsChartsLineCardConfig;\n        return {\n          ...config,\n          xAxisKey,\n          selectedXAxisMetricKey: '',\n          range: {\n            ...config.range,\n            xMin: undefined,\n            xMax: undefined,\n          },\n          useGlobalXaxisKey: useGlobal ?? config.useGlobalXaxisKey,\n          selectedYAxisMetricKey: RunsChartsLineChartYAxisType.METRIC,\n        };\n      });\n    },\n    [onStateChange],\n  );\n\n  const isInvalidLogValue = (value: number | undefined) => !isUndefined(value) && value <= 0;\n\n  const updateXAxisScaleType = useCallback(\n    (isLogType: boolean) => {\n      if (usingManualRangeControls) {\n        onStateChange((current) => {\n          const config = current as RunsChartsLineCardConfig;\n\n          let newXMin = isLogType ? safeLog(localAxisRange.xMin) : localAxisRange.xMin;\n          let newXMax = isLogType ? safeLog(localAxisRange.xMax) : localAxisRange.xMax;\n          if (isLogType && isInvalidLogValue(localAxisRange.xMin) && localAxisRange.xMax && localAxisRange.xMax > 1) {\n            // when switching to log type, if only xMin is invalid, set xMin to 1.\n            setLocalAxisRange((prev) => ({\n              ...prev,\n              xMin: 1,\n            }));\n            newXMin = 0;\n          } else if (isLogType && (isInvalidLogValue(localAxisRange.xMin) || isInvalidLogValue(localAxisRange.xMax))) {\n            setLocalAxisRange((prev) => ({\n              ...prev,\n              xMin: undefined,\n              xMax: undefined,\n            }));\n            newXMin = undefined;\n            newXMax = undefined;\n          }\n          return {\n            ...config,\n            xAxisScaleType: isLogType ? 'log' : 'linear',\n            range: {\n              ...config.range,\n              xMin: newXMin,\n              xMax: newXMax,\n            },\n          };\n        });\n      } else {\n        onStateChange((current) => ({\n          ...(current as RunsChartsLineCardConfig),\n          xAxisScaleType: isLogType ? 'log' : 'linear',\n        }));\n      }\n    },\n    [onStateChange, localAxisRange.xMin, localAxisRange.xMax, usingManualRangeControls],\n  );\n\n  const updateSelectedXAxisMetricKey = useCallback(\n    (selectedXAxisMetricKey: string) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsLineCardConfig),\n        selectedXAxisMetricKey,\n        xAxisKey: RunsChartsLineChartXAxisType.METRIC,\n      }));\n    },\n    [onStateChange],\n  );\n\n  const updateYAxisType = useCallback(\n    (isLogType: boolean) => {\n      if (usingManualRangeControls) {\n        onStateChange((current) => {\n          const config = current as RunsChartsLineCardConfig;\n\n          let newYMin = isLogType ? safeLog(localAxisRange.yMin) : localAxisRange.yMin;\n          let newYMax = isLogType ? safeLog(localAxisRange.yMax) : localAxisRange.yMax;\n          if (isLogType && isInvalidLogValue(localAxisRange.yMin) && localAxisRange.yMax && localAxisRange.yMax > 1) {\n            // when switching to log type, if only yMin is invalid, set yMin to 1.\n            setLocalAxisRange((prev) => ({\n              ...prev,\n              yMin: 1,\n            }));\n            newYMin = 0; // This is the logged value of 1.\n          } else if (isLogType && (isInvalidLogValue(localAxisRange.yMin) || isInvalidLogValue(localAxisRange.yMax))) {\n            setLocalAxisRange((prev) => ({\n              ...prev,\n              yMin: undefined,\n              yMax: undefined,\n            }));\n            newYMin = undefined;\n            newYMax = undefined;\n          }\n          return {\n            ...config,\n            scaleType: isLogType ? 'log' : 'linear',\n            range: {\n              ...config.range,\n              yMin: newYMin,\n              yMax: newYMax,\n            },\n          };\n        });\n      } else {\n        onStateChange((current) => ({\n          ...(current as RunsChartsLineCardConfig),\n          scaleType: isLogType ? 'log' : 'linear',\n        }));\n      }\n    },\n    [onStateChange, localAxisRange.yMin, localAxisRange.yMax, usingManualRangeControls],\n  );\n\n  const updateIgnoreOutliers = useCallback(\n    (ignoreOutliers: boolean) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsLineCardConfig),\n        ignoreOutliers,\n      }));\n    },\n    [onStateChange],\n  );\n\n  const updateSmoothing = useCallback(\n    (lineSmoothness: number) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsLineCardConfig),\n        lineSmoothness: lineSmoothness,\n      }));\n    },\n    [onStateChange],\n  );\n\n  /**\n   * Callback for updating run count\n   */\n  const updateVisibleRunCount = useCallback(\n    (runsCountToCompare: number) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsLineCardConfig),\n        runsCountToCompare,\n      }));\n    },\n    [onStateChange],\n  );\n\n  /**\n   * If somehow metric key is not predetermined, automatically\n   * select the first one so it's not empty\n   */\n  useEffect(() => {\n    if (!state.metricKey && metricKeyList?.[0]) {\n      updateMetric(metricKeyList[0]);\n    }\n  }, [state.metricKey, updateMetric, metricKeyList]);\n\n  // for backwards compatibility, if selectedMetricKeys\n  // is not present, set it using metricKey.\n  useEffect(() => {\n    if (isUndefined(state.selectedMetricKeys) && !isUndefined(state.metricKey) && state.metricKey !== '') {\n      updateSelectedMetrics([state.metricKey]);\n    }\n  }, [state.selectedMetricKeys, state.metricKey, updateSelectedMetrics]);\n\n  const updateXAxisWhenConfirmed = (xMin: number | undefined, xMax: number | undefined) => {\n    if (inTransitionState(xMin, xMax)) {\n      return;\n    }\n    onStateChange((current) => {\n      const config = current as RunsChartsLineCardConfig;\n      return {\n        ...config,\n        range: {\n          ...config.range,\n          xMin: config.xAxisScaleType === 'log' ? safeLog(xMin) : xMin,\n          xMax: config.xAxisScaleType === 'log' ? safeLog(xMax) : xMax,\n        },\n      };\n    });\n  };\n\n  const updateYAxisWhenConfirmed = (yMin: number | undefined, yMax: number | undefined) => {\n    if (inTransitionState(yMin, yMax)) {\n      return;\n    }\n    onStateChange((current) => {\n      const config = current as RunsChartsLineCardConfig;\n      return {\n        ...config,\n        range: {\n          ...config.range,\n          yMin: config.scaleType === 'log' ? safeLog(yMin) : yMin,\n          yMax: config.scaleType === 'log' ? safeLog(yMax) : yMax,\n        },\n      };\n    });\n  };\n\n  const updateXAxisScaleMin = (xMin: string) => {\n    const newXMin = xMin ? Number(xMin) : undefined;\n    setLocalAxisRange((prev) => ({ ...prev, xMin: newXMin }));\n    updateXAxisWhenConfirmed(newXMin, localAxisRange.xMax);\n  };\n  const updateXAxisScaleMax = (xMax: string) => {\n    const newXMax = xMax ? Number(xMax) : undefined;\n    setLocalAxisRange((prev) => ({ ...prev, xMax: newXMax }));\n    updateXAxisWhenConfirmed(localAxisRange.xMin, newXMax);\n  };\n  const updateYAxisScaleMin = (yMin: string) => {\n    const newYMin = yMin ? Number(yMin) : undefined;\n    setLocalAxisRange((prev) => ({ ...prev, yMin: newYMin }));\n    updateYAxisWhenConfirmed(newYMin, localAxisRange.yMax);\n  };\n  const updateYAxisScaleMax = (yMax: string) => {\n    const newYMax = yMax ? Number(yMax) : undefined;\n    setLocalAxisRange((prev) => ({ ...prev, yMax: newYMax }));\n    updateYAxisWhenConfirmed(localAxisRange.yMin, newYMax);\n  };\n\n  const inTransitionState = (a: number | undefined, b: number | undefined) => {\n    if (isUndefined(a) && isUndefined(b)) {\n      return false;\n    } else if (!isUndefined(a) && !isUndefined(b)) {\n      return false;\n    } else {\n      return true;\n    }\n  };\n\n  const invalidMessage = (scaleType: 'log' | 'linear' | undefined, value: number | undefined) => {\n    if (scaleType === 'log' && isInvalidLogValue(value)) {\n      return (\n        <FormUI.Message\n          message={\n            <FormattedMessage\n              defaultMessage=\"Invalid log value\"\n              description=\"Experiment tracking > runs charts > line chart configuration > invalid log value message\"\n            />\n          }\n          type=\"warning\"\n        />\n      );\n    }\n    return null;\n  };\n\n  const METRIC_AXIS_PREFIX = 'metric-';\n  return (\n    <>\n      <Typography.Title level={4} color=\"secondary\">\n        X-axis\n      </Typography.Title>\n      <RunsChartsConfigureField title=\"Type\" compact>\n        {usingChartExpressions ? (\n          <SimpleSelect\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_config_runschartsconfigurelinechart.tsx_436\"\n            id=\"x-axis-type\"\n            width=\"100%\"\n            value={state.useGlobalXaxisKey ? USE_GLOBAL_SETTING_KEY : state.xAxisKey}\n            contentProps={{ matchTriggerWidth: true, textOverflowMode: 'ellipsis' }}\n            onChange={({ target: { value } }) => {\n              if (value.startsWith(METRIC_AXIS_PREFIX)) {\n                updateSelectedXAxisMetricKey(value.slice(METRIC_AXIS_PREFIX.length));\n              } else if (value === RunsChartsLineChartXAxisType.STEP) {\n                updateXAxisKey(RunsChartsLineChartXAxisType.STEP);\n              } else if (value === RunsChartsLineChartXAxisType.TIME) {\n                updateXAxisKey(RunsChartsLineChartXAxisType.TIME);\n              } else if (value === RunsChartsLineChartXAxisType.TIME_RELATIVE) {\n                updateXAxisKey(RunsChartsLineChartXAxisType.TIME_RELATIVE);\n              } else if (value === USE_GLOBAL_SETTING_KEY) {\n                updateXAxisKey(RunsChartsLineChartXAxisType.STEP, true);\n              }\n            }}\n          >\n            {shouldEnableGlobalLineChartConfig() && (\n              <SimpleSelectOption value={USE_GLOBAL_SETTING_KEY}>\n                <FormattedMessage\n                  defaultMessage=\"Use workspace settings\"\n                  description=\"Label for a radio button that configures the x-axis on a line chart. This option is for using global workspace settings.\"\n                />\n              </SimpleSelectOption>\n            )}\n            <SimpleSelectOption value={RunsChartsLineChartXAxisType.STEP}>\n              <FormattedMessage\n                defaultMessage=\"Step\"\n                description=\"Label for a radio button that configures the x-axis on a line chart. This option is for the step number that the metrics were logged.\"\n              />\n            </SimpleSelectOption>\n            <SimpleSelectOption value={RunsChartsLineChartXAxisType.TIME}>\n              <FormattedMessage\n                defaultMessage=\"Time (wall)\"\n                description=\"Label for a radio button that configures the x-axis on a line chart. This option is for the absolute time that the metrics were logged.\"\n              />\n              <Tooltip\n                componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_config_runschartsconfigurelinechart.tsx_474\"\n                content={\n                  <FormattedMessage\n                    defaultMessage=\"Absolute date and time\"\n                    description=\"A tooltip line chart configuration for the step function of wall time\"\n                  />\n                }\n                side=\"right\"\n              >\n                <span>\n                  {' '}\n                  <QuestionMarkIcon css={styles.timeStepQuestionMarkIcon} />\n                </span>\n              </Tooltip>\n            </SimpleSelectOption>\n            <SimpleSelectOption value={RunsChartsLineChartXAxisType.TIME_RELATIVE}>\n              <FormattedMessage\n                defaultMessage=\"Time (relative)\"\n                description=\"Label for a radio button that configures the x-axis on a line chart. This option is for relative time since the first metric was logged.\"\n              />\n              <Tooltip\n                componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_config_runschartsconfigurelinechart.tsx_494\"\n                content={\n                  <FormattedMessage\n                    defaultMessage=\"Amount of time that has passed since the first metric value was logged\"\n                    description=\"A tooltip line chart configuration for the step function of relative time\"\n                  />\n                }\n                side=\"right\"\n              >\n                <span>\n                  {' '}\n                  <QuestionMarkIcon css={styles.timeStepQuestionMarkIcon} />\n                </span>\n              </Tooltip>\n            </SimpleSelectOption>\n            {shouldEnableMetricsOnXAxis && metricKeyList.length > 0 && (\n              <SimpleSelectOptionGroup label=\"Metrics\">\n                {metricKeyList.map((metric) => (\n                  <SimpleSelectOption\n                    key={metric}\n                    value={`${METRIC_AXIS_PREFIX}${metric}`}\n                    data-testid={`${METRIC_AXIS_PREFIX}${metric}`}\n                  >\n                    {metric}\n                  </SimpleSelectOption>\n                ))}\n              </SimpleSelectOptionGroup>\n            )}\n          </SimpleSelect>\n        ) : (\n          <Radio.Group\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_config_runschartsconfigurelinechart.tsx_524\"\n            name=\"runs-charts-field-group-x-axis\"\n            value={state.useGlobalXaxisKey ? USE_GLOBAL_SETTING_KEY : state.xAxisKey}\n            onChange={({ target: { value } }) => {\n              if (value === USE_GLOBAL_SETTING_KEY) {\n                updateXAxisKey(RunsChartsLineChartXAxisType.STEP, true);\n              } else {\n                updateXAxisKey(value);\n              }\n            }}\n          >\n            {shouldEnableGlobalLineChartConfig() && (\n              <Radio value={USE_GLOBAL_SETTING_KEY}>\n                <FormattedMessage\n                  defaultMessage=\"Use workspace settings\"\n                  description=\"Label for a radio button that configures the x-axis on a line chart. This option is for using global workspace settings.\"\n                />\n              </Radio>\n            )}\n            <Radio value={RunsChartsLineChartXAxisType.STEP}>\n              <FormattedMessage\n                defaultMessage=\"Step\"\n                description=\"Label for a radio button that configures the x-axis on a line chart. This option is for the step number that the metrics were logged.\"\n              />\n            </Radio>\n            <Radio value={RunsChartsLineChartXAxisType.TIME}>\n              <FormattedMessage\n                defaultMessage=\"Time (wall)\"\n                description=\"Label for a radio button that configures the x-axis on a line chart. This option is for the absolute time that the metrics were logged.\"\n              />\n              <LegacyTooltip\n                title={\n                  <FormattedMessage\n                    defaultMessage=\"Absolute date and time\"\n                    description=\"A tooltip line chart configuration for the step function of wall time\"\n                  />\n                }\n                placement=\"right\"\n              >\n                {' '}\n                <QuestionMarkIcon css={styles.timeStepQuestionMarkIcon} />\n              </LegacyTooltip>\n            </Radio>\n            <Radio value={RunsChartsLineChartXAxisType.TIME_RELATIVE}>\n              <FormattedMessage\n                defaultMessage=\"Time (relative)\"\n                description=\"Label for a radio button that configures the x-axis on a line chart. This option is for relative time since the first metric was logged.\"\n              />\n              <LegacyTooltip\n                title={\n                  <FormattedMessage\n                    defaultMessage=\"Amount of time that has passed since the first metric value was logged\"\n                    description=\"A tooltip line chart configuration for the step function of relative time\"\n                  />\n                }\n                placement=\"right\"\n              >\n                {' '}\n                <QuestionMarkIcon css={styles.timeStepQuestionMarkIcon} />\n              </LegacyTooltip>\n            </Radio>\n            {shouldEnableMetricsOnXAxis &&\n              renderXAxisMetricSelector({\n                theme,\n                metricKeyList,\n                selectedXAxisMetricKey: state.selectedXAxisMetricKey,\n                updateSelectedXAxisMetricKey,\n              })}\n          </Radio.Group>\n        )}\n      </RunsChartsConfigureField>\n      {state.xAxisKey === RunsChartsLineChartXAxisType.STEP && (\n        <>\n          {usingManualRangeControls && (\n            <RunsChartsConfigureField title=\"X-axis scale\" compact>\n              <div css={{ display: 'flex', gap: theme.spacing.sm }}>\n                <div>\n                  <Input\n                    componentId=\"mlflow.charts.line_chart_configure.x_axis_min\"\n                    aria-label=\"x-axis-min\"\n                    name=\"min\"\n                    type=\"number\"\n                    value={localAxisRange.xMin}\n                    onChange={(e) => updateXAxisScaleMin(e.target.value)}\n                    max={localAxisRange.xMax}\n                    placeholder=\"Min\"\n                  />\n                  {invalidMessage(state.xAxisScaleType, localAxisRange.xMin)}\n                </div>\n                <div>\n                  <Input\n                    componentId=\"mlflow.charts.line_chart_configure.x_axis_max\"\n                    aria-label=\"x-axis-max\"\n                    name=\"max\"\n                    type=\"number\"\n                    value={localAxisRange.xMax}\n                    onChange={(e) => updateXAxisScaleMax(e.target.value)}\n                    min={localAxisRange.xMin}\n                    placeholder=\"Max\"\n                  />\n                  {invalidMessage(state.xAxisScaleType, localAxisRange.xMax)}\n                </div>\n              </div>\n              <div style={{ padding: theme.spacing.xs }} />\n              <Switch\n                componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_config_runschartsconfigurelinechart.tsx_628\"\n                aria-label=\"x-axis-log\"\n                checked={state.xAxisScaleType === 'log'}\n                onChange={updateXAxisScaleType}\n                label=\"Log scale\"\n                activeLabel=\"On\"\n                inactiveLabel=\"Off\"\n                disabledLabel=\"Disabled\"\n              />\n            </RunsChartsConfigureField>\n          )}\n        </>\n      )}\n      <Typography.Title level={4} color=\"secondary\" css={{ paddingTop: theme.spacing.lg }}>\n        Y-axis\n      </Typography.Title>\n      <RunsChartsYAxisMetricAndExpressionSelector\n        state={state}\n        onStateChange={onStateChange}\n        metricKeyList={metricKeyList}\n        updateSelectedMetrics={updateSelectedMetrics}\n      />\n      <RunsChartsConfigureField title=\"Y-axis scale\" compact>\n        {usingManualRangeControls && (\n          <div css={{ display: 'flex', gap: theme.spacing.sm }}>\n            <div>\n              <Input\n                componentId=\"mlflow.charts.line_chart_configure.y_axis_min\"\n                aria-label=\"y-axis-min\"\n                name=\"min\"\n                type=\"number\"\n                value={localAxisRange.yMin}\n                onChange={(e) => updateYAxisScaleMin(e.target.value)}\n                max={localAxisRange.yMax}\n                placeholder=\"Min\"\n              />\n              {invalidMessage(state.scaleType, localAxisRange.yMin)}\n            </div>\n            <div>\n              <Input\n                componentId=\"mlflow.charts.line_chart_configure.y_axis_max\"\n                aria-label=\"y-axis-max\"\n                name=\"max\"\n                type=\"number\"\n                value={localAxisRange.yMax}\n                onChange={(e) => updateYAxisScaleMax(e.target.value)}\n                min={localAxisRange.yMin}\n                placeholder=\"Max\"\n              />\n              {invalidMessage(state.scaleType, localAxisRange.yMax)}\n            </div>\n          </div>\n        )}\n        <Spacer size=\"xs\" />\n        <Switch\n          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_config_runschartsconfigurelinechart.tsx_682\"\n          aria-label=\"y-axis-log\"\n          checked={state.scaleType === 'log'}\n          onChange={updateYAxisType}\n          label=\"Log scale\"\n          activeLabel=\"On\"\n          inactiveLabel=\"Off\"\n          disabledLabel=\"Disabled\"\n        />\n        <Spacer size=\"xs\" />\n        <div css={{ display: 'flex', flexDirection: 'row', justifyContent: 'space-between' }}>\n          <div>\n            <Typography.Text bold>\n              <FormattedMessage\n                defaultMessage=\"Ignore outliers\"\n                description=\"Runs charts > line chart > ignore outliers > label\"\n              />\n            </Typography.Text>\n            <Tooltip\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_config_runschartsconfigurelinechart.tsx_703\"\n              delayDuration={0}\n              content={\n                <FormattedMessage\n                  defaultMessage=\"Only display data points between the p5 and p95 of the data. This can help with chart readability in cases where outliers significantly affect the Y-axis range\"\n                  description=\"A tooltip describing the 'Ignore Outliers' configuration option for line charts\"\n                />\n              }\n              side=\"right\"\n            >\n              <span>\n                {' '}\n                <QuestionMarkIcon css={styles.timeStepQuestionMarkIcon} />\n              </span>\n            </Tooltip>\n          </div>\n          <Switch\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_config_runschartsconfigurelinechart.tsx_716\"\n            aria-label=\"y-axis-ignore-outliers\"\n            checked={state.ignoreOutliers}\n            onChange={updateIgnoreOutliers}\n            // Empty label so that the active/inactive labels are actually displayed\n            label=\" \"\n            activeLabel={intl.formatMessage({\n              defaultMessage: 'On',\n              description: 'Runs charts > line chart > ignore outliers > on setting label',\n            })}\n            inactiveLabel={intl.formatMessage({\n              defaultMessage: 'Off',\n              description: 'Runs charts > line chart > ignore outliers > off setting label',\n            })}\n            disabledLabel={intl.formatMessage({\n              defaultMessage: 'Disabled',\n              description: 'Runs charts > line chart > ignore outliers > disabled label',\n            })}\n          />\n        </div>\n      </RunsChartsConfigureField>\n      <Typography.Title level={4} color=\"secondary\" css={{ paddingTop: theme.spacing.lg }}>\n        Advanced\n      </Typography.Title>\n      <RunsChartsConfigureField\n        title={intl.formatMessage({\n          defaultMessage: 'Display points',\n          description: 'Runs charts > line chart > display points > label',\n        })}\n        compact\n      >\n        <SegmentedControlGroup\n          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_config_runschartsconfigurelinechart.tsx_747\"\n          name={intl.formatMessage({\n            defaultMessage: 'Display points',\n            description: 'Runs charts > line chart > display points > label',\n          })}\n          value={state.displayPoints}\n          onChange={({ target }) => {\n            onStateChange((current) => ({\n              ...(current as RunsChartsLineCardConfig),\n              displayPoints: target.value,\n            }));\n          }}\n        >\n          <SegmentedControlButton\n            value={undefined}\n            aria-label={[\n              intl.formatMessage({\n                defaultMessage: 'Display points',\n                description: 'Runs charts > line chart > display points > label',\n              }),\n              intl.formatMessage({\n                defaultMessage: 'Auto',\n                description: 'Runs charts > line chart > display points > auto setting label',\n              }),\n            ].join(': ')}\n          >\n            <FormattedMessage\n              defaultMessage=\"Auto\"\n              description=\"Runs charts > line chart > display points > auto setting label\"\n            />{' '}\n            <LegacyTooltip\n              title={\n                <FormattedMessage\n                  defaultMessage=\"Show points on line charts if there are fewer than 60 data points per trace\"\n                  description=\"Runs charts > line chart > display points > auto tooltip\"\n                />\n              }\n            >\n              <InfoIcon />\n            </LegacyTooltip>\n          </SegmentedControlButton>\n          <SegmentedControlButton\n            value\n            aria-label={[\n              intl.formatMessage({\n                defaultMessage: 'Display points',\n                description: 'Runs charts > line chart > display points > label',\n              }),\n              intl.formatMessage({\n                defaultMessage: 'On',\n                description: 'Runs charts > line chart > display points > on setting label',\n              }),\n            ].join(': ')}\n          >\n            <FormattedMessage\n              defaultMessage=\"On\"\n              description=\"Runs charts > line chart > display points > on setting label\"\n            />\n          </SegmentedControlButton>\n          <SegmentedControlButton\n            value={false}\n            aria-label={[\n              intl.formatMessage({\n                defaultMessage: 'Display points',\n                description: 'Runs charts > line chart > display points > label',\n              }),\n              intl.formatMessage({\n                defaultMessage: 'Off',\n                description: 'Runs charts > line chart > display points > off setting label',\n              }),\n            ].join(': ')}\n          >\n            <FormattedMessage\n              defaultMessage=\"Off\"\n              description=\"Runs charts > line chart > display points > off setting label\"\n            />\n          </SegmentedControlButton>\n        </SegmentedControlGroup>\n      </RunsChartsConfigureField>\n      <RunsChartsConfigureField\n        title={\n          <>\n            <FormattedMessage\n              defaultMessage=\"Line smoothing\"\n              description=\"Runs charts > line chart > configuration > label for line smoothing slider control. The control allows changing data trace line smoothness from 1 to 100, where 1 is the original data trace and 100 is the smoothest trace. Line smoothing helps eliminate noise in the data.\"\n            />\n          </>\n        }\n        compact\n      >\n        {shouldEnableGlobalLineChartConfig() && (\n          <Radio.Group\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_config_runschartsconfigurelinechart.tsx_838\"\n            name=\"use-global-line-smoothness\"\n            value={Boolean(state.useGlobalLineSmoothing)}\n            onChange={({ target }) => {\n              onStateChange((current) => ({\n                ...(current as RunsChartsLineCardConfig),\n                useGlobalLineSmoothing: target.value === true,\n              }));\n            }}\n          >\n            <Radio value>Use workspace settings</Radio>\n            <Radio value={false}>Custom</Radio>\n          </Radio.Group>\n        )}\n\n        <LineSmoothSlider\n          data-testid=\"smoothness-toggle\"\n          min={0}\n          max={100}\n          onChange={updateSmoothing}\n          defaultValue={state.lineSmoothness ? state.lineSmoothness : 0}\n          disabled={shouldEnableGlobalLineChartConfig() && state.useGlobalLineSmoothing}\n        />\n      </RunsChartsConfigureField>\n      <RunsChartsRunNumberSelect\n        value={state.runsCountToCompare}\n        onChange={updateVisibleRunCount}\n        options={runSelectOptions}\n      />\n    </>\n  );\n};\n\nconst styles = {\n  selectFull: { width: '100%' },\n  timeStepQuestionMarkIcon: () => ({\n    svg: { width: 12, height: 12 },\n  }),\n};\n","import { LegacySkeleton } from '@databricks/design-system';\nimport { useCallback, useMemo, useRef } from 'react';\nimport { connect } from 'react-redux';\nimport { ReduxState } from '../../../../../redux-types';\nimport { MetricHistoryByName } from '../../../../types';\nimport {\n  RunsChartsLineChartXAxisType,\n  removeOutliersFromMetricHistory,\n  type RunsChartsRunData,\n} from '../RunsCharts.common';\nimport { RunsMetricsLinePlot } from '../RunsMetricsLinePlot';\nimport { RunsChartsTooltipMode, useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport { RunsChartsLineCardConfig, RunsChartsLineChartYAxisType } from '../../runs-charts.types';\nimport {\n  shouldEnableChartExpressions,\n  shouldEnableDeepLearningUIPhase3,\n  shouldEnableManualRangeControls,\n} from '../../../../../common/utils/FeatureUtils';\nimport { useSampledMetricHistory } from '../../hooks/useSampledMetricHistory';\nimport { compact, isUndefined, uniq } from 'lodash';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\nimport { useGroupedChartRunData } from '../../../runs-compare/hooks/useGroupedChartRunData';\nimport { RunsChartsGlobalLineChartConfig } from '../../../experiment-page/models/ExperimentPageUIState';\nimport { useLineChartGlobalConfig } from '../hooks/useLineChartGlobalConfig';\n\nexport const RunsChartsConfigureLineChartPreviewImpl = ({\n  previewData,\n  cardConfig,\n  metricsByRunUuid,\n  groupBy,\n  globalLineChartConfig,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsLineCardConfig;\n  groupBy: RunsGroupByConfig | null;\n\n  globalLineChartConfig?: RunsChartsGlobalLineChartConfig;\n\n  metricsByRunUuid: Record<string, MetricHistoryByName>;\n}) => {\n  const usingMultipleRunsHoverTooltip = shouldEnableDeepLearningUIPhase3();\n  const usingManualRangeControls = shouldEnableManualRangeControls();\n\n  const { lineSmoothness, selectedXAxisMetricKey, xAxisKey } = useLineChartGlobalConfig(\n    cardConfig,\n    globalLineChartConfig,\n  );\n\n  const isGrouped = useMemo(() => previewData.some((r) => r.groupParentInfo), [previewData]);\n\n  const { aggregateFunction } = groupBy || {};\n\n  const runUuidsToFetch = useMemo(() => {\n    if (isGrouped) {\n      const runsInGroups = compact(previewData.map((r) => r.groupParentInfo)).flatMap((g) => g.runUuids);\n      const ungroupedRuns = compact(\n        previewData.filter((r) => !r.groupParentInfo && !r.belongsToGroup).map((r) => r.runInfo?.runUuid ?? undefined),\n      );\n      return [...runsInGroups, ...ungroupedRuns];\n    }\n    return compact(previewData.map((r) => r.runInfo)).map((g) => g.runUuid ?? '');\n  }, [previewData, isGrouped]);\n\n  const metricKeysToFetch = useMemo(() => {\n    const getYAxisKeys = (cardConfig: RunsChartsLineCardConfig) => {\n      const fallback = [cardConfig.metricKey];\n      if (!shouldEnableChartExpressions() || cardConfig.yAxisKey !== RunsChartsLineChartYAxisType.EXPRESSION) {\n        return cardConfig.selectedMetricKeys ?? fallback;\n      }\n      const yAxisKeys = cardConfig.yAxisExpressions?.reduce((acc, exp) => {\n        exp.variables.forEach((variable) => acc.add(variable));\n        return acc;\n      }, new Set<string>());\n      return yAxisKeys === undefined ? fallback : Array.from(yAxisKeys);\n    };\n    const yAxisKeys = getYAxisKeys(cardConfig);\n    const xAxisKeys = !selectedXAxisMetricKey ? [] : [selectedXAxisMetricKey];\n    return yAxisKeys.concat(xAxisKeys);\n  }, [cardConfig, selectedXAxisMetricKey]);\n\n  const { resultsByRunUuid, isLoading } = useSampledMetricHistory({\n    runUuids: runUuidsToFetch,\n    metricKeys: metricKeysToFetch,\n    enabled: true,\n    maxResults: 320,\n    autoRefreshEnabled: false,\n  });\n\n  const sampledData = useMemo(\n    () =>\n      previewData.map((run) => {\n        const metricsHistory = metricKeysToFetch.reduce((acc: MetricHistoryByName, key) => {\n          const history = resultsByRunUuid[run.uuid]?.[key]?.metricsHistory;\n          if (history) {\n            acc[key] = cardConfig.ignoreOutliers ? removeOutliersFromMetricHistory(history) : history;\n          }\n          return acc;\n        }, {});\n\n        return {\n          ...run,\n          metricsHistory,\n        };\n      }),\n    [metricKeysToFetch, resultsByRunUuid, previewData, cardConfig.ignoreOutliers],\n  );\n\n  const sampledGroupData = useGroupedChartRunData({\n    enabled: isGrouped,\n    ungroupedRunsData: sampledData,\n    metricKeys: metricKeysToFetch,\n    sampledDataResultsByRunUuid: resultsByRunUuid,\n    aggregateFunction,\n    selectedXAxisMetricKey: xAxisKey === RunsChartsLineChartXAxisType.METRIC ? selectedXAxisMetricKey : undefined,\n    ignoreOutliers: cardConfig.ignoreOutliers ?? false,\n  });\n\n  // Use grouped data traces only if enabled and if there are any groups\n  const chartData = isGrouped ? sampledGroupData : sampledData;\n\n  const { setTooltip, resetTooltip } = useRunsChartsTooltip(\n    cardConfig,\n    usingMultipleRunsHoverTooltip ? RunsChartsTooltipMode.MultipleTracesWithScanline : RunsChartsTooltipMode.Simple,\n  );\n\n  if (isLoading) {\n    return <LegacySkeleton />;\n  }\n\n  const checkValidRange = (\n    rangeMin: number | undefined,\n    rangeMax: number | undefined,\n  ): [number, number] | undefined => {\n    if (isUndefined(rangeMin) || isUndefined(rangeMax)) {\n      return undefined;\n    }\n    return [rangeMin, rangeMax];\n  };\n\n  const xRange = checkValidRange(cardConfig.range?.xMin, cardConfig.range?.xMax);\n  const yRange = checkValidRange(cardConfig.range?.yMin, cardConfig.range?.yMax);\n\n  return (\n    <RunsMetricsLinePlot\n      runsData={chartData}\n      metricKey={cardConfig.metricKey}\n      selectedMetricKeys={cardConfig.selectedMetricKeys}\n      scaleType={cardConfig.scaleType}\n      xAxisScaleType={cardConfig.xAxisScaleType}\n      lineSmoothness={lineSmoothness}\n      xAxisKey={xAxisKey}\n      selectedXAxisMetricKey={selectedXAxisMetricKey}\n      displayPoints={cardConfig.displayPoints}\n      yAxisExpressions={cardConfig.yAxisExpressions}\n      yAxisKey={cardConfig.yAxisKey}\n      useDefaultHoverBox={false}\n      onHover={setTooltip}\n      onUnhover={resetTooltip}\n      xRange={usingManualRangeControls ? xRange : undefined}\n      yRange={usingManualRangeControls ? yRange : undefined}\n    />\n  );\n};\n\nconst mapStateToProps = ({ entities: { metricsByRunUuid } }: ReduxState) => ({\n  metricsByRunUuid,\n});\n\n/**\n * Preview of line chart used in compare runs configuration modal\n */\nexport const RunsChartsConfigureLineChartPreview = connect(mapStateToProps, undefined, undefined, {\n  areStatesEqual: (nextState, prevState) => nextState.entities.metricsByRunUuid === prevState.entities.metricsByRunUuid,\n})(RunsChartsConfigureLineChartPreviewImpl);\n","import { RunsChartsRunData } from '../RunsCharts.common';\nimport LazyParallelCoordinatesPlot from '../charts/LazyParallelCoordinatesPlot';\nimport { isParallelChartConfigured, processParallelCoordinateData } from '../../utils/parallelCoordinatesPlot.utils';\nimport { useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport { RunsChartsParallelCardConfig } from '../../runs-charts.types';\nimport { useMemo } from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\nimport { Empty, NoIcon } from '@databricks/design-system';\n\nexport const RunsChartsConfigureParallelChartPreview = ({\n  previewData,\n  cardConfig,\n  groupBy,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsParallelCardConfig;\n  groupBy: RunsGroupByConfig | null;\n}) => {\n  const isConfigured = isParallelChartConfigured(cardConfig);\n\n  const { setTooltip, resetTooltip } = useRunsChartsTooltip(cardConfig);\n\n  const containsStringValues = useMemo(\n    () =>\n      cardConfig.selectedParams?.some(\n        (paramKey) => previewData?.some((dataTrace) => isNaN(Number(dataTrace.params[paramKey]?.value))),\n        [cardConfig.selectedParams, previewData],\n      ),\n    [cardConfig.selectedParams, previewData],\n  );\n\n  if (containsStringValues && groupBy) {\n    return (\n      <div css={{ display: 'flex', justifyContent: 'center', alignItems: 'center', textAlign: 'center' }}>\n        <FormattedMessage\n          defaultMessage=\"Parallel coordinates chart does not support aggregated string values. Use other parameters or disable run grouping to continue.\"\n          description=\"Experiment page > compare runs > parallel coordinates chart configuration modal > unsupported string values warning\"\n        />\n      </div>\n    );\n  }\n\n  const filteredData = isConfigured\n    ? processParallelCoordinateData(previewData, cardConfig.selectedParams, cardConfig.selectedMetrics)\n    : [];\n\n  if (!isConfigured) {\n    return (\n      <div css={{ display: 'flex', justifyContent: 'center', alignItems: 'center' }}>\n        Select at least two metrics and params first\n      </div>\n    );\n  }\n\n  return filteredData.length ? (\n    /* Avoid displaying empty set, otherwise parcoord-es crashes */\n    <LazyParallelCoordinatesPlot\n      selectedMetrics={cardConfig.selectedMetrics}\n      selectedParams={cardConfig.selectedParams}\n      data={filteredData}\n      axesRotateThreshold={6}\n      onHover={setTooltip}\n      onUnhover={resetTooltip}\n    />\n  ) : (\n    <Empty\n      description={\n        <FormattedMessage\n          defaultMessage=\"No matching data found for the available runs.\"\n          description=\"Experiment tracking > runs charts > parallel coordinates chart preview > no data found description\"\n        />\n      }\n      image={<NoIcon />}\n    />\n  );\n};\n","import { useCallback, useEffect } from 'react';\nimport { useIntl } from 'react-intl';\nimport {\n  extractCanonicalSortKey,\n  isCanonicalSortKeyOfType,\n  makeCanonicalSortKey,\n} from '../../../experiment-page/utils/experimentPage.common-utils';\nimport type { RunsChartsCardConfig, RunsChartsContourCardConfig } from '../../runs-charts.types';\nimport {\n  RunsChartsMetricParamSelect,\n  RunsChartsConfigureField,\n  RunsChartsRunNumberSelect,\n} from './RunsChartsConfigure.common';\n\ntype ValidAxis = keyof Pick<RunsChartsContourCardConfig, 'xaxis' | 'yaxis' | 'zaxis'>;\n\n/**\n * Form containing configuration controls for Contour runs compare chart.\n */\nexport const RunsChartsConfigureContourChart = ({\n  state,\n  onStateChange,\n  metricKeyList,\n  paramKeyList,\n}: {\n  metricKeyList: string[];\n  paramKeyList: string[];\n  state: RunsChartsContourCardConfig;\n  onStateChange: (setter: (current: RunsChartsCardConfig) => RunsChartsContourCardConfig) => void;\n}) => {\n  const { formatMessage } = useIntl();\n  const runSelectOptions = [5, 10, 20, 50, 100];\n\n  /**\n   * Callback for updating X or Y axis\n   */\n  const updateAxis = useCallback(\n    (canonicalKey: string, axis: ValidAxis) => {\n      const type = isCanonicalSortKeyOfType(canonicalKey, 'METRIC') ? 'METRIC' : 'PARAM';\n      const key = extractCanonicalSortKey(canonicalKey, type);\n      onStateChange((current) => ({\n        ...(current as RunsChartsContourCardConfig),\n        [axis]: { key, type },\n      }));\n    },\n    [onStateChange],\n  );\n\n  /**\n   * Callback for updating run count\n   */\n  const updateVisibleRunCount = useCallback(\n    (runsCountToCompare: number) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsContourCardConfig),\n        runsCountToCompare,\n      }));\n    },\n    [onStateChange],\n  );\n\n  /**\n   * If somehow axes are not predetermined, automatically\n   * select the first metric/param so it's not empty\n   */\n  useEffect(() => {\n    const firstMetric = metricKeyList?.[0];\n    const firstParam = paramKeyList?.[0];\n    if (!state.xaxis?.key) {\n      if (firstMetric) {\n        updateAxis(makeCanonicalSortKey('METRIC', firstMetric), 'xaxis');\n      } else if (firstParam) {\n        updateAxis(makeCanonicalSortKey('PARAM', firstParam), 'xaxis');\n      }\n    }\n    if (!state.yaxis?.key) {\n      if (firstMetric) {\n        updateAxis(makeCanonicalSortKey('METRIC', firstMetric), 'yaxis');\n      } else if (firstParam) {\n        updateAxis(makeCanonicalSortKey('PARAM', firstParam), 'yaxis');\n      }\n    }\n    if (!state.zaxis?.key) {\n      if (firstMetric) {\n        updateAxis(makeCanonicalSortKey('METRIC', firstMetric), 'zaxis');\n      } else if (firstParam) {\n        updateAxis(makeCanonicalSortKey('PARAM', firstParam), 'zaxis');\n      }\n    }\n  }, [state.xaxis, state.yaxis, state.zaxis, updateAxis, metricKeyList, paramKeyList]);\n\n  return (\n    <>\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'X axis',\n          description: 'Label for X axis in Contour chart configurator in compare runs chart config modal',\n        })}\n      >\n        <RunsChartsMetricParamSelect\n          value={state.xaxis.key ? makeCanonicalSortKey(state.xaxis.type, state.xaxis.key) : ''}\n          onChange={(value) => {\n            updateAxis(value, 'xaxis');\n          }}\n          paramKeyList={paramKeyList}\n          metricKeyList={metricKeyList}\n        />\n      </RunsChartsConfigureField>\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'Y axis',\n          description: 'Label for Y axis in Contour chart configurator in compare runs chart config modal',\n        })}\n      >\n        <RunsChartsMetricParamSelect\n          value={state.yaxis.key ? makeCanonicalSortKey(state.yaxis.type, state.yaxis.key) : ''}\n          onChange={(value) => {\n            updateAxis(value, 'yaxis');\n          }}\n          paramKeyList={paramKeyList}\n          metricKeyList={metricKeyList}\n        />\n      </RunsChartsConfigureField>\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'Z axis',\n          description: 'Label for Z axis in Contour chart configurator in compare runs chart config modal',\n        })}\n      >\n        <RunsChartsMetricParamSelect\n          value={state.zaxis.key ? makeCanonicalSortKey(state.zaxis.type, state.zaxis.key) : ''}\n          onChange={(value) => {\n            updateAxis(value, 'zaxis');\n          }}\n          paramKeyList={paramKeyList}\n          metricKeyList={metricKeyList}\n        />\n      </RunsChartsConfigureField>\n      <RunsChartsRunNumberSelect\n        value={state.runsCountToCompare}\n        onChange={updateVisibleRunCount}\n        options={runSelectOptions}\n      />\n    </>\n  );\n};\n","import { useCallback, useEffect } from 'react';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport {\n  extractCanonicalSortKey,\n  isCanonicalSortKeyOfType,\n  makeCanonicalSortKey,\n} from '../../../experiment-page/utils/experimentPage.common-utils';\nimport type { RunsChartsCardConfig, RunsChartsScatterCardConfig } from '../../runs-charts.types';\nimport {\n  RunsChartsMetricParamSelect,\n  RunsChartsConfigureField,\n  RunsChartsRunNumberSelect,\n  runsChartsRunCountDefaultOptions,\n} from './RunsChartsConfigure.common';\n\ntype ValidAxis = keyof Pick<RunsChartsScatterCardConfig, 'xaxis' | 'yaxis'>;\n\nconst scatterPlotDefaultOptions = runsChartsRunCountDefaultOptions;\nscatterPlotDefaultOptions.push(\n  {\n    value: 100,\n    label: (\n      <FormattedMessage\n        defaultMessage=\"100\"\n        description=\"Label for 100 first runs visible in run count selector within runs compare configuration modal\"\n      />\n    ),\n  },\n  {\n    value: 250,\n    label: (\n      <FormattedMessage\n        defaultMessage=\"250\"\n        description=\"Label for 250 first runs visible in run count selector within runs compare configuration modal\"\n      />\n    ),\n  },\n  {\n    value: 500,\n    label: (\n      <FormattedMessage\n        defaultMessage=\"500\"\n        description=\"Label for 500 first runs visible in run count selector within runs compare configuration modal\"\n      />\n    ),\n  },\n);\n\n/**\n * Form containing configuration controls for scatter runs compare chart.\n */\nexport const RunsChartsConfigureScatterChart = ({\n  state,\n  onStateChange,\n  metricKeyList,\n  paramKeyList,\n}: {\n  metricKeyList: string[];\n  paramKeyList: string[];\n  state: RunsChartsScatterCardConfig;\n  onStateChange: (setter: (current: RunsChartsCardConfig) => RunsChartsScatterCardConfig) => void;\n}) => {\n  const { formatMessage } = useIntl();\n\n  /**\n   * Callback for updating X or Y axis\n   */\n  const updateAxis = useCallback(\n    (canonicalKey: string, axis: ValidAxis) => {\n      const type = isCanonicalSortKeyOfType(canonicalKey, 'METRIC') ? 'METRIC' : 'PARAM';\n      const key = extractCanonicalSortKey(canonicalKey, type);\n      onStateChange((current) => ({\n        ...(current as RunsChartsScatterCardConfig),\n        [axis]: { key, type },\n      }));\n    },\n    [onStateChange],\n  );\n\n  /**\n   * Callback for updating run count\n   */\n  const updateVisibleRunCount = useCallback(\n    (runsCountToCompare: number) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsScatterCardConfig),\n        runsCountToCompare,\n      }));\n    },\n    [onStateChange],\n  );\n\n  /**\n   * If somehow axes are not predetermined, automatically\n   * select the first metric/param so it's not empty\n   */\n  useEffect(() => {\n    const firstMetric = metricKeyList?.[0];\n    const firstParam = paramKeyList?.[0];\n    if (!state.xaxis?.key) {\n      if (firstMetric) {\n        updateAxis(makeCanonicalSortKey('METRIC', firstMetric), 'xaxis');\n      } else if (firstParam) {\n        updateAxis(makeCanonicalSortKey('PARAM', firstParam), 'xaxis');\n      }\n    }\n    if (!state.yaxis?.key) {\n      if (firstMetric) {\n        updateAxis(makeCanonicalSortKey('METRIC', firstMetric), 'yaxis');\n      } else if (firstParam) {\n        updateAxis(makeCanonicalSortKey('PARAM', firstParam), 'yaxis');\n      }\n    }\n  }, [state.xaxis, state.yaxis, updateAxis, metricKeyList, paramKeyList]);\n\n  return (\n    <>\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'X axis',\n          description: 'Label for X axis in scatter chart configurator in compare runs chart config modal',\n        })}\n      >\n        <RunsChartsMetricParamSelect\n          value={state.xaxis.key ? makeCanonicalSortKey(state.xaxis.type, state.xaxis.key) : ''}\n          onChange={(value) => {\n            updateAxis(value, 'xaxis');\n          }}\n          paramKeyList={paramKeyList}\n          metricKeyList={metricKeyList}\n        />\n      </RunsChartsConfigureField>\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'Y axis',\n          description: 'Label for Y axis in scatter chart configurator in compare runs chart config modal',\n        })}\n      >\n        <RunsChartsMetricParamSelect\n          value={state.yaxis.key ? makeCanonicalSortKey(state.yaxis.type, state.yaxis.key) : ''}\n          onChange={(value) => {\n            updateAxis(value, 'yaxis');\n          }}\n          paramKeyList={paramKeyList}\n          metricKeyList={metricKeyList}\n        />\n      </RunsChartsConfigureField>\n      <RunsChartsRunNumberSelect\n        value={state.runsCountToCompare}\n        onChange={updateVisibleRunCount}\n        options={scatterPlotDefaultOptions}\n      />\n    </>\n  );\n};\n","import {\n  Checkbox,\n  Input,\n  Switch,\n  useDesignSystemTheme,\n  LegacyTooltip,\n  InfoIcon,\n  LegacyInfoTooltip,\n} from '@databricks/design-system';\nimport {\n  DISABLED_GROUP_WHEN_GROUPBY,\n  DifferenceCardConfigCompareGroup,\n  RunsChartsCardConfig,\n  RunsChartsDifferenceCardConfig,\n} from '../../runs-charts.types';\nimport { RunsChartsConfigureField } from './RunsChartsConfigure.common';\nimport { useCallback } from 'react';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\n\n/**\n * Form containing configuration controls for runs compare difference view chart.\n */\nexport const RunsChartsConfigureDifferenceChart = ({\n  state,\n  onStateChange,\n  metricKeyList,\n  paramKeyList,\n  groupBy,\n}: {\n  metricKeyList: string[];\n  paramKeyList: string[];\n  state: Partial<RunsChartsDifferenceCardConfig>;\n  onStateChange: (setter: (current: RunsChartsCardConfig) => RunsChartsDifferenceCardConfig) => void;\n  groupBy: RunsGroupByConfig | null;\n}) => {\n  /**\n   * Callback for updating compare groups\n   */\n  const updateCompareGroups = useCallback(\n    (compareGroup: DifferenceCardConfigCompareGroup) => {\n      onStateChange((current) => {\n        const currentConfig = current as RunsChartsDifferenceCardConfig;\n        const compareGroups = currentConfig.compareGroups;\n        if (compareGroups.includes(compareGroup)) {\n          return {\n            ...(current as RunsChartsDifferenceCardConfig),\n            compareGroups: compareGroups.filter((group) => group !== compareGroup),\n          };\n        } else {\n          return { ...(current as RunsChartsDifferenceCardConfig), compareGroups: [...compareGroups, compareGroup] };\n        }\n      });\n    },\n    [onStateChange],\n  );\n\n  const updateChartName = useCallback(\n    (e) => onStateChange((current) => ({ ...(current as RunsChartsDifferenceCardConfig), chartName: e.target.value })),\n    [onStateChange],\n  );\n\n  const updateShowChangeFromBaseline = useCallback(\n    (showChangeFromBaseline: boolean) =>\n      onStateChange((current) => ({\n        ...(current as RunsChartsDifferenceCardConfig),\n        showChangeFromBaseline,\n      })),\n    [onStateChange],\n  );\n\n  const updateShowDifferencesOnly = useCallback(\n    (showDifferencesOnly: boolean) =>\n      onStateChange((current) => ({\n        ...(current as RunsChartsDifferenceCardConfig),\n        showDifferencesOnly,\n      })),\n    [onStateChange],\n  );\n\n  const { theme } = useDesignSystemTheme();\n  const { formatMessage } = useIntl();\n\n  return (\n    <>\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'Compare',\n          description:\n            'Runs charts > components > config > RunsChartsConfigureDifferenceChart > Compare config section',\n        })}\n      >\n        <Checkbox.Group id=\"checkbox-group\" defaultValue={state.compareGroups}>\n          {Object.values(DifferenceCardConfigCompareGroup).map((group) => {\n            const groupedCondition = groupBy ? DISABLED_GROUP_WHEN_GROUPBY.includes(group) : false;\n            return (\n              <div css={{ display: 'inline-flex', alignItems: 'center' }} key={group}>\n                <Checkbox\n                  componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_config_runschartsconfiguredifferencechart.tsx_98\"\n                  key={group}\n                  value={group}\n                  isChecked={state.compareGroups?.includes(group)}\n                  onChange={() => updateCompareGroups(group)}\n                  disabled={groupedCondition}\n                >\n                  {group}\n                </Checkbox>\n                {groupedCondition && (\n                  <LegacyInfoTooltip\n                    title={\n                      <FormattedMessage\n                        defaultMessage=\"Disable grouped runs to compare\"\n                        description=\"Experiment tracking > components > runs-charts > RunsChartsConfigureDifferenceCharts > disable grouped runs info message\"\n                      />\n                    }\n                  />\n                )}\n              </div>\n            );\n          })}\n        </Checkbox.Group>\n        <div\n          css={{\n            display: 'flex',\n            flexDirection: 'column',\n            padding: `${theme.spacing.md}px 0px`,\n            gap: theme.spacing.sm,\n          }}\n        >\n          <Switch\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_config_runschartsconfiguredifferencechart.tsx_129\"\n            checked={state.showChangeFromBaseline}\n            onChange={updateShowChangeFromBaseline}\n            label={formatMessage({\n              defaultMessage: 'Show change from baseline',\n              description:\n                'Runs charts > components > config > RunsChartsConfigureDifferenceChart > Show change from baseline toggle',\n            })}\n          />\n          <Switch\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_config_runschartsconfiguredifferencechart.tsx_138\"\n            checked={state.showDifferencesOnly}\n            onChange={updateShowDifferencesOnly}\n            label={formatMessage({\n              defaultMessage: 'Show differences only',\n              description:\n                'Runs charts > components > config > RunsChartsConfigureDifferenceChart > Show differences only toggle',\n            })}\n          />\n        </div>\n      </RunsChartsConfigureField>\n\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'Chart name',\n          description:\n            'Runs charts > components > config > RunsChartsConfigureDifferenceChart > Chart name config section',\n        })}\n      >\n        <Input\n          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_config_runschartsconfiguredifferencechart.tsx_157\"\n          value={state.chartName}\n          onChange={updateChartName}\n        />\n      </RunsChartsConfigureField>\n    </>\n  );\n};\n","import { useCallback } from 'react';\nimport { RunsChartsCardConfig, RunsChartsImageCardConfig } from '../../runs-charts.types';\nimport { Input } from '@databricks/design-system';\nimport { useIntl } from 'react-intl';\nimport { RunsChartsConfigureField } from './RunsChartsConfigure.common';\nimport { DialogCombobox } from '@databricks/design-system';\nimport { DialogComboboxContent } from '@databricks/design-system';\nimport { DialogComboboxTrigger } from '@databricks/design-system';\nimport { DialogComboboxOptionListCheckboxItem } from '@databricks/design-system';\nimport { DialogComboboxOptionList } from '@databricks/design-system';\nimport { useImageSliderStepMarks } from '../../hooks/useImageSliderStepMarks';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { Slider } from 'antd';\nimport { useDesignSystemTheme } from '@databricks/design-system';\nimport { LineSmoothSlider } from '@mlflow/mlflow/src/experiment-tracking/components/LineSmoothSlider';\n\nexport const RunsChartsConfigureImageChart = ({\n  previewData,\n  state,\n  onStateChange,\n  imageKeyList,\n}: {\n  previewData: RunsChartsRunData[];\n  imageKeyList: string[];\n  state: Partial<RunsChartsImageCardConfig>;\n  onStateChange: (setter: (current: RunsChartsCardConfig) => RunsChartsImageCardConfig) => void;\n}) => {\n  const IMAGE_CONFIG_WIDTH = 275;\n\n  const { stepMarks, maxMark, minMark } = useImageSliderStepMarks({\n    data: previewData,\n    selectedImageKeys: state.imageKeys || [],\n  });\n\n  const updateImageKeys = useCallback(\n    (imageKeys: string[]) => {\n      onStateChange((current) => {\n        return { ...(current as RunsChartsImageCardConfig), imageKeys };\n      });\n    },\n    [onStateChange],\n  );\n\n  const updateStep = useCallback(\n    (step: number) => {\n      onStateChange((current) => {\n        return { ...(current as RunsChartsImageCardConfig), step };\n      });\n    },\n    [onStateChange],\n  );\n\n  const { formatMessage } = useIntl();\n\n  const handleUpdate = (imageKey: string) => {\n    onStateChange((current) => {\n      const currentConfig = current as RunsChartsImageCardConfig;\n      if (currentConfig.imageKeys?.includes(imageKey)) {\n        return {\n          ...currentConfig,\n          imageKeys: currentConfig.imageKeys?.filter((key) => key !== imageKey),\n        };\n      } else {\n        return { ...currentConfig, imageKeys: [...(currentConfig.imageKeys || []), imageKey] };\n      }\n    });\n  };\n\n  const handleClear = () => {\n    onStateChange((current) => {\n      return { ...(current as RunsChartsImageCardConfig), imageKeys: [] };\n    });\n  };\n\n  return (\n    <>\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'Images',\n          description: 'Runs charts > components > config > RunsChartsConfigureImageGrid > Images section',\n        })}\n      >\n        <DialogCombobox\n          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_config_runschartsconfigureimagechart.tsx_84\"\n          value={state.imageKeys}\n          label=\"Images\"\n          multiSelect\n        >\n          <DialogComboboxTrigger onClear={handleClear} minWidth={IMAGE_CONFIG_WIDTH} />\n          <DialogComboboxContent matchTriggerWidth>\n            <DialogComboboxOptionList>\n              {imageKeyList.map((imageKey) => {\n                return (\n                  <DialogComboboxOptionListCheckboxItem\n                    key={imageKey}\n                    value={imageKey}\n                    onChange={handleUpdate}\n                    checked={state.imageKeys?.includes(imageKey)}\n                  />\n                );\n              })}\n            </DialogComboboxOptionList>\n          </DialogComboboxContent>\n        </DialogCombobox>\n      </RunsChartsConfigureField>\n      <RunsChartsConfigureField title=\"Step\">\n        <LineSmoothSlider\n          max={maxMark}\n          min={minMark}\n          marks={stepMarks}\n          defaultValue={state.step}\n          disabled={Object.keys(stepMarks).length <= 1}\n          onChange={updateStep}\n          step={null}\n        />\n      </RunsChartsConfigureField>\n    </>\n  );\n};\n","import { RunsGroupByConfig } from '@mlflow/mlflow/src/experiment-tracking/components/experiment-page/utils/experimentPage.group-row-utils';\nimport { RunsChartsCardConfig, RunsChartsImageCardConfig } from '../../runs-charts.types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { ImageGridPlot } from '../charts/ImageGridPlot';\n\nexport const RunsChartsConfigureImageChartPreview = ({\n  previewData,\n  cardConfig,\n  setCardConfig,\n  groupBy,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsImageCardConfig;\n  setCardConfig: (setter: (current: RunsChartsCardConfig) => RunsChartsImageCardConfig) => void;\n  groupBy: RunsGroupByConfig | null;\n}) => {\n  return (\n    <div css={{ width: '100%', overflow: 'auto hidden' }}>\n      <ImageGridPlot\n        previewData={previewData}\n        cardConfig={cardConfig}\n        setCardConfig={setCardConfig}\n        containerWidth={500}\n        groupBy={groupBy}\n      />\n    </div>\n  );\n};\n","/**\n * TODO: implement actual UI for this modal, it's a crude placeholder with minimal logic for now\n */\nimport { Modal, useDesignSystemTheme, SimpleSelect, SimpleSelectOption } from '@databricks/design-system';\nimport { Interpolation, Theme } from '@emotion/react';\nimport React, { useCallback, useMemo, useState } from 'react';\nimport { useIntl, FormattedMessage } from 'react-intl';\nimport {\n  RunsChartsBarCardConfig,\n  RunsChartsCardConfig,\n  RunsChartType,\n  RunsChartsLineCardConfig,\n  RunsChartsContourCardConfig,\n  RunsChartsScatterCardConfig,\n  RunsChartsParallelCardConfig,\n  RunsChartsDifferenceCardConfig,\n  RunsChartsImageCardConfig,\n} from '../runs-charts.types';\n\nimport { ReactComponent as ChartBarIcon } from '../../../../common/static/chart-bar.svg';\nimport { ReactComponent as ChartContourIcon } from '../../../../common/static/chart-contour.svg';\nimport { ReactComponent as ChartLineIcon } from '../../../../common/static/chart-line.svg';\nimport { ReactComponent as ChartParallelIcon } from '../../../../common/static/chart-parallel.svg';\nimport { ReactComponent as ChartScatterIcon } from '../../../../common/static/chart-scatter.svg';\nimport { ReactComponent as ChartDifferenceIcon } from '../../../../common/static/chart-difference.svg';\nimport { ReactComponent as ChartImageIcon } from '../../../../common/static/chart-image.svg';\nimport { RunsChartsConfigureBarChart } from './config/RunsChartsConfigureBarChart';\nimport { RunsChartsConfigureParallelChart } from './config/RunsChartsConfigureParallelChart';\nimport type { RunsChartsRunData } from './RunsCharts.common';\nimport { RunsChartsConfigureField } from './config/RunsChartsConfigure.common';\nimport { RunsChartsConfigureLineChart } from './config/RunsChartsConfigureLineChart';\nimport { RunsChartsConfigureLineChartPreview } from './config/RunsChartsConfigureLineChart.preview';\nimport { RunsChartsConfigureBarChartPreview } from './config/RunsChartsConfigureBarChart.preview';\nimport { RunsChartsConfigureContourChartPreview } from './config/RunsChartsConfigureContourChart.preview';\nimport { RunsChartsConfigureScatterChartPreview } from './config/RunsChartsConfigureScatterChart.preview';\nimport { RunsChartsConfigureParallelChartPreview } from './config/RunsChartsConfigureParallelChart.preview';\nimport { RunsChartsConfigureContourChart } from './config/RunsChartsConfigureContourChart';\nimport { RunsChartsConfigureScatterChart } from './config/RunsChartsConfigureScatterChart';\nimport { RunsChartsTooltipBody } from './RunsChartsTooltipBody';\nimport { RunsChartsTooltipWrapper } from '../hooks/useRunsChartsTooltip';\nimport {\n  shouldEnableDifferenceViewCharts,\n  shouldEnableImageGridCharts,\n  shouldUseNewRunRowsVisibilityModel,\n} from '@mlflow/mlflow/src/common/utils/FeatureUtils';\nimport { RunsChartsConfigureDifferenceChartPreview } from './config/RunsChartsConfigureDifferenceChart.preview';\nimport { RunsChartsConfigureDifferenceChart } from './config/RunsChartsConfigureDifferenceChart';\nimport type { RunsGroupByConfig } from '../../experiment-page/utils/experimentPage.group-row-utils';\nimport { RunsChartsConfigureImageChart } from './config/RunsChartsConfigureImageChart';\nimport { RunsChartsConfigureImageChartPreview } from './config/RunsChartsConfigureImageChart.preview';\nimport type { RunsChartsGlobalLineChartConfig } from '../../experiment-page/models/ExperimentPageUIState';\n\nconst previewComponentsMap: Record<\n  RunsChartType,\n  React.FC<{\n    previewData: RunsChartsRunData[];\n    cardConfig: any;\n    groupBy: RunsGroupByConfig | null;\n    globalLineChartConfig?: RunsChartsGlobalLineChartConfig;\n    setCardConfig: (\n      setter: (\n        current: RunsChartsCardConfig,\n      ) => RunsChartsDifferenceCardConfig | RunsChartsImageCardConfig | RunsChartsLineCardConfig,\n    ) => void;\n  }>\n> = {\n  [RunsChartType.BAR]: RunsChartsConfigureBarChartPreview,\n  [RunsChartType.CONTOUR]: RunsChartsConfigureContourChartPreview,\n  [RunsChartType.LINE]: RunsChartsConfigureLineChartPreview,\n  [RunsChartType.PARALLEL]: RunsChartsConfigureParallelChartPreview,\n  [RunsChartType.SCATTER]: RunsChartsConfigureScatterChartPreview,\n  [RunsChartType.DIFFERENCE]: RunsChartsConfigureDifferenceChartPreview,\n  [RunsChartType.IMAGE]: RunsChartsConfigureImageChartPreview,\n};\n\nexport const RunsChartsConfigureModal = ({\n  onCancel,\n  onSubmit,\n  config,\n  chartRunData,\n  metricKeyList,\n  paramKeyList,\n  groupBy,\n  supportedChartTypes,\n  globalLineChartConfig,\n}: {\n  metricKeyList: string[];\n  paramKeyList: string[];\n  config: RunsChartsCardConfig;\n  chartRunData: RunsChartsRunData[];\n  onCancel: () => void;\n  groupBy: RunsGroupByConfig | null;\n  onSubmit: (formData: Partial<RunsChartsCardConfig>) => void;\n  supportedChartTypes?: RunsChartType[] | undefined;\n  globalLineChartConfig?: RunsChartsGlobalLineChartConfig;\n}) => {\n  const isChartTypeSupported = (type: RunsChartType) => !supportedChartTypes || supportedChartTypes.includes(type);\n  const { theme } = useDesignSystemTheme();\n  const borderStyle = `1px solid ${theme.colors.actionDefaultBorderDefault}`;\n  const [currentFormState, setCurrentFormState] = useState<RunsChartsCardConfig>(config);\n\n  const isEditing = Boolean(currentFormState.uuid);\n\n  const updateChartType = useCallback((type?: RunsChartType) => {\n    if (!type) {\n      return;\n    }\n    const emptyChartCard = RunsChartsCardConfig.getEmptyChartCardByType(type, true);\n    if (emptyChartCard) {\n      setCurrentFormState(emptyChartCard);\n    }\n  }, []);\n\n  const previewData = useMemo(() => {\n    if (shouldUseNewRunRowsVisibilityModel()) {\n      return chartRunData.filter(({ hidden }) => !hidden).reverse();\n    }\n    return chartRunData.slice(0, currentFormState.runsCountToCompare).reverse();\n  }, [chartRunData, currentFormState.runsCountToCompare]);\n\n  const imageKeyList = useMemo(() => {\n    const imageKeys = new Set<string>();\n    previewData.forEach((run) => {\n      Object.keys(run.images).forEach((imageKey) => {\n        imageKeys.add(imageKey);\n      });\n    });\n    return Array.from(imageKeys).sort();\n  }, [previewData]);\n\n  const renderConfigOptionsforChartType = (type?: RunsChartType) => {\n    if (type === RunsChartType.BAR) {\n      return (\n        <RunsChartsConfigureBarChart\n          metricKeyList={metricKeyList}\n          state={currentFormState as RunsChartsBarCardConfig}\n          onStateChange={setCurrentFormState}\n        />\n      );\n    }\n    if (type === RunsChartType.CONTOUR) {\n      return (\n        <RunsChartsConfigureContourChart\n          metricKeyList={metricKeyList}\n          paramKeyList={paramKeyList}\n          state={currentFormState as RunsChartsContourCardConfig}\n          onStateChange={setCurrentFormState}\n        />\n      );\n    }\n    if (type === RunsChartType.LINE) {\n      return (\n        <RunsChartsConfigureLineChart\n          metricKeyList={metricKeyList}\n          state={currentFormState as RunsChartsLineCardConfig}\n          onStateChange={setCurrentFormState}\n        />\n      );\n    }\n    if (type === RunsChartType.PARALLEL) {\n      return (\n        <RunsChartsConfigureParallelChart\n          metricKeyList={metricKeyList}\n          paramKeyList={paramKeyList}\n          state={currentFormState as RunsChartsParallelCardConfig}\n          onStateChange={setCurrentFormState}\n        />\n      );\n    }\n    if (type === RunsChartType.SCATTER) {\n      return (\n        <RunsChartsConfigureScatterChart\n          metricKeyList={metricKeyList}\n          paramKeyList={paramKeyList}\n          state={currentFormState as RunsChartsScatterCardConfig}\n          onStateChange={setCurrentFormState}\n        />\n      );\n    }\n    if (shouldEnableDifferenceViewCharts() && type === RunsChartType.DIFFERENCE) {\n      return (\n        <RunsChartsConfigureDifferenceChart\n          metricKeyList={metricKeyList}\n          paramKeyList={paramKeyList}\n          state={currentFormState as RunsChartsDifferenceCardConfig}\n          onStateChange={setCurrentFormState}\n          groupBy={groupBy}\n        />\n      );\n    }\n    if (shouldEnableImageGridCharts() && type === RunsChartType.IMAGE) {\n      return (\n        <RunsChartsConfigureImageChart\n          previewData={previewData}\n          imageKeyList={imageKeyList}\n          state={currentFormState as RunsChartsImageCardConfig}\n          onStateChange={setCurrentFormState}\n        />\n      );\n    }\n    return null;\n  };\n\n  const renderPreviewChartType = (type?: RunsChartType) => {\n    if (!type) {\n      return null;\n    }\n    const PreviewComponent = previewComponentsMap[type];\n    if (!PreviewComponent) {\n      return null;\n    }\n    return (\n      <PreviewComponent\n        previewData={previewData}\n        cardConfig={currentFormState}\n        groupBy={groupBy}\n        setCardConfig={setCurrentFormState}\n        globalLineChartConfig={globalLineChartConfig}\n      />\n    );\n  };\n\n  const { formatMessage } = useIntl();\n\n  let disableSaveButton = false;\n  if (currentFormState.type === RunsChartType.LINE) {\n    const lineCardConfig = currentFormState as RunsChartsLineCardConfig;\n    disableSaveButton = (lineCardConfig.selectedMetricKeys ?? []).length === 0;\n  }\n\n  return (\n    <Modal\n      componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_runschartsconfiguremodal.tsx_232\"\n      visible\n      onCancel={onCancel}\n      onOk={() => onSubmit(currentFormState)}\n      title={\n        isEditing\n          ? formatMessage({\n              defaultMessage: 'Edit chart',\n              description: 'Title of the modal when editing a runs comparison chart',\n            })\n          : formatMessage({\n              defaultMessage: 'Add new chart',\n              description: 'Title of the modal when adding a new runs comparison chart',\n            })\n      }\n      okButtonProps={{\n        'data-testid': 'experiment-view-compare-runs-chart-modal-confirm',\n        disabled: disableSaveButton,\n      }}\n      cancelText={formatMessage({\n        defaultMessage: 'Cancel',\n        description: 'Cancel button label within a modal for adding/editing a new runs comparison chart',\n      })}\n      okText={\n        isEditing\n          ? formatMessage({\n              defaultMessage: 'Save changes',\n              description: 'Confirm button label within a modal when editing a runs comparison chart',\n            })\n          : formatMessage({\n              defaultMessage: 'Add chart',\n              description: 'Confirm button label within a modal when adding a new runs comparison chart',\n            })\n      }\n      size=\"wide\"\n      css={{ width: 1280 }}\n      dangerouslySetAntdProps={{\n        bodyStyle: {\n          overflowY: 'hidden',\n          display: 'flex',\n        },\n      }}\n    >\n      <div\n        css={{\n          // TODO: wait for modal dimensions decision\n          display: 'flex',\n          width: '100%',\n          gridTemplateColumns: '300px 1fr',\n          gap: theme.spacing.md,\n          borderTop: borderStyle,\n          borderBottom: borderStyle,\n        }}\n      >\n        <div\n          css={{\n            overflowY: 'auto',\n            borderRight: borderStyle,\n            padding: `${theme.spacing.md}px ${theme.spacing.md}px ${theme.spacing.md}px 0px`,\n            width: '300px',\n          }}\n        >\n          {!isEditing && (\n            <RunsChartsConfigureField title=\"Chart type\">\n              <SimpleSelect\n                componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_runschartsconfiguremodal.tsx_296\"\n                id=\"chart-type-select\"\n                css={{ width: '100%' }}\n                value={currentFormState.type}\n                onChange={({ target }) => {\n                  const chartType = target.value as RunsChartType;\n                  Object.values(RunsChartType).includes(chartType) && updateChartType(chartType);\n                }}\n              >\n                {isChartTypeSupported(RunsChartType.BAR) && (\n                  <SimpleSelectOption value={RunsChartType.BAR}>\n                    <div css={styles.chartTypeOption(theme)}>\n                      <ChartBarIcon />\n                      <FormattedMessage\n                        defaultMessage=\"Bar chart\"\n                        description=\"Experiment tracking > runs charts > add chart menu > bar chart\"\n                      />\n                    </div>\n                  </SimpleSelectOption>\n                )}\n                {isChartTypeSupported(RunsChartType.SCATTER) && (\n                  <SimpleSelectOption value={RunsChartType.SCATTER}>\n                    <div css={styles.chartTypeOption(theme)}>\n                      <ChartScatterIcon />\n                      <FormattedMessage\n                        defaultMessage=\"Scatter chart\"\n                        description=\"Experiment tracking > runs charts > add chart menu > scatter plot\"\n                      />\n                    </div>\n                  </SimpleSelectOption>\n                )}\n                {isChartTypeSupported(RunsChartType.LINE) && (\n                  <SimpleSelectOption value={RunsChartType.LINE}>\n                    <div css={styles.chartTypeOption(theme)}>\n                      <ChartLineIcon />\n                      <FormattedMessage\n                        defaultMessage=\"Line chart\"\n                        description=\"Experiment tracking > runs charts > add chart menu > line chart\"\n                      />\n                    </div>\n                  </SimpleSelectOption>\n                )}\n                {isChartTypeSupported(RunsChartType.PARALLEL) && (\n                  <SimpleSelectOption value={RunsChartType.PARALLEL}>\n                    <div css={styles.chartTypeOption(theme)}>\n                      <ChartParallelIcon />\n                      <FormattedMessage\n                        defaultMessage=\"Parallel coordinates\"\n                        description=\"Experiment tracking > runs charts > add chart menu > parallel coordinates\"\n                      />\n                    </div>\n                  </SimpleSelectOption>\n                )}\n                {isChartTypeSupported(RunsChartType.CONTOUR) && (\n                  <SimpleSelectOption value={RunsChartType.CONTOUR}>\n                    <div css={styles.chartTypeOption(theme)}>\n                      <ChartContourIcon />\n                      <FormattedMessage\n                        defaultMessage=\"Contour chart\"\n                        description=\"Experiment tracking > runs charts > add chart menu > contour chart\"\n                      />\n                    </div>\n                  </SimpleSelectOption>\n                )}\n                {shouldEnableDifferenceViewCharts() && isChartTypeSupported(RunsChartType.DIFFERENCE) && (\n                  <SimpleSelectOption value={RunsChartType.DIFFERENCE}>\n                    <div css={styles.chartTypeOption(theme)}>\n                      <ChartDifferenceIcon />\n                      <FormattedMessage\n                        defaultMessage=\"Difference view\"\n                        description=\"Experiment tracking > runs charts > add chart menu > difference view\"\n                      />\n                    </div>\n                  </SimpleSelectOption>\n                )}\n                {shouldEnableImageGridCharts() && isChartTypeSupported(RunsChartType.IMAGE) && (\n                  <SimpleSelectOption value={RunsChartType.IMAGE}>\n                    <div css={styles.chartTypeOption(theme)}>\n                      <ChartImageIcon />\n                      <FormattedMessage\n                        defaultMessage=\"Image grid\"\n                        description=\"Experiment tracking > runs charts > add chart menu > image grid\"\n                      />\n                    </div>\n                  </SimpleSelectOption>\n                )}\n              </SimpleSelect>\n            </RunsChartsConfigureField>\n          )}\n          {renderConfigOptionsforChartType(currentFormState.type)}\n        </div>\n        <div css={{ overflow: 'auto', flexGrow: 1 }}>\n          <RunsChartsTooltipWrapper contextData={{ runs: chartRunData }} component={RunsChartsTooltipBody} hoverOnly>\n            <div\n              css={{\n                minHeight: 500,\n                height: '100%',\n                width: 500,\n                padding: '32px 0px',\n              }}\n            >\n              {renderPreviewChartType(currentFormState.type)}\n            </div>\n          </RunsChartsTooltipWrapper>\n        </div>\n      </div>\n    </Modal>\n  );\n};\n\nconst styles = {\n  chartTypeOption: (theme: Theme) =>\n    ({\n      display: 'grid',\n      gridTemplateColumns: `${theme.general.iconSize + theme.spacing.xs}px 1fr`,\n      gap: theme.spacing.xs,\n      alignItems: 'center',\n    } as Interpolation<Theme>),\n  field: {\n    // TODO: wait for modal dimensions decision\n    display: 'grid',\n    gridTemplateColumns: '80px 1fr',\n    marginBottom: 16,\n  } as Interpolation<Theme>,\n};\n","import { barChartCardDefaultMargin } from '../cards/RunsChartsBarChartCard';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { RunsMetricsBarPlot } from '../RunsMetricsBarPlot';\nimport { useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport { RunsChartsBarCardConfig } from '../../runs-charts.types';\n\nexport const RunsChartsConfigureBarChartPreview = ({\n  previewData,\n  cardConfig,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsBarCardConfig;\n}) => {\n  const { resetTooltip, setTooltip } = useRunsChartsTooltip(cardConfig);\n\n  return (\n    <RunsMetricsBarPlot\n      useDefaultHoverBox={false}\n      displayRunNames={false}\n      displayMetricKey={false}\n      metricKey={cardConfig.metricKey}\n      runsData={previewData}\n      margin={barChartCardDefaultMargin}\n      onHover={setTooltip}\n      onUnhover={resetTooltip}\n    />\n  );\n};\n","import { useMemo } from 'react';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { RunsContourPlot } from '../RunsContourPlot';\nimport { useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport { RunsChartsContourCardConfig } from '../../runs-charts.types';\n\nexport const RunsChartsConfigureContourChartPreview = ({\n  previewData,\n  cardConfig,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsContourCardConfig;\n}) => {\n  const { resetTooltip, setTooltip } = useRunsChartsTooltip(cardConfig);\n\n  // We need to re-render the chart when any axis config changes.\n  // Plotly tries to determine axis format based on values and is not capable\n  // of dynamic switching between different axis types, so we need to make sure\n  // that we re-mount the chart when config changes.\n  const key = useMemo(() => {\n    const { xaxis, yaxis, zaxis } = cardConfig;\n    return JSON.stringify({ xaxis, yaxis, zaxis });\n  }, [cardConfig]);\n\n  return (\n    <RunsContourPlot\n      xAxis={cardConfig.xaxis}\n      yAxis={cardConfig.yaxis}\n      zAxis={cardConfig.zaxis}\n      runsData={previewData}\n      onHover={setTooltip}\n      onUnhover={resetTooltip}\n      useDefaultHoverBox={false}\n      key={key}\n    />\n  );\n};\n","import { useMemo } from 'react';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { RunsScatterPlot } from '../RunsScatterPlot';\nimport { useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport { RunsChartsScatterCardConfig } from '../../runs-charts.types';\n\nexport const RunsChartsConfigureScatterChartPreview = ({\n  previewData,\n  cardConfig,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsScatterCardConfig;\n}) => {\n  const { resetTooltip, setTooltip } = useRunsChartsTooltip(cardConfig);\n\n  // We need to re-render the chart when the x or y axis changes.\n  // Plotly tries to determine axis format based on values and is not capable\n  // of dynamic switching between different axis types, so we need to make sure\n  // that we re-mount the chart when config changes.\n  const key = useMemo(() => {\n    const { xaxis, yaxis } = cardConfig;\n    return JSON.stringify({ xaxis, yaxis });\n  }, [cardConfig]);\n\n  return (\n    <RunsScatterPlot\n      xAxis={cardConfig.xaxis}\n      yAxis={cardConfig.yaxis}\n      runsData={previewData}\n      onHover={setTooltip}\n      onUnhover={resetTooltip}\n      useDefaultHoverBox={false}\n      key={key}\n    />\n  );\n};\n","import { FormattedMessage } from 'react-intl';\nimport {\n  DifferenceCardConfigCompareGroup,\n  RunsChartsCardConfig,\n  RunsChartsDifferenceCardConfig,\n} from '../../runs-charts.types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { DifferenceViewPlot } from '../charts/DifferenceViewPlot';\nimport { DifferenceViewPlotV2 } from '../charts/DifferenceViewPlotV2';\n\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\nimport { shouldEnableNewDifferenceViewCharts } from '@mlflow/mlflow/src/common/utils/FeatureUtils';\n\nexport const RunsChartsConfigureDifferenceChartPreview = ({\n  previewData,\n  groupBy,\n  cardConfig,\n  setCardConfig,\n}: {\n  previewData: RunsChartsRunData[];\n  groupBy: RunsGroupByConfig | null;\n  cardConfig: RunsChartsDifferenceCardConfig;\n  setCardConfig: (setter: (current: RunsChartsCardConfig) => RunsChartsDifferenceCardConfig) => void;\n}) => {\n  if (shouldEnableNewDifferenceViewCharts()) {\n    return (\n      <DifferenceViewPlotV2\n        previewData={previewData}\n        groupBy={groupBy}\n        cardConfig={cardConfig}\n        setCardConfig={setCardConfig}\n      />\n    );\n  }\n  return (\n    <DifferenceViewPlot\n      previewData={previewData}\n      groupBy={groupBy}\n      cardConfig={cardConfig}\n      setCardConfig={setCardConfig}\n    />\n  );\n};\n","/* eslint-disable react-hooks/rules-of-hooks */\nimport { createContext, useCallback, useContext, useMemo, useRef, useState } from 'react';\nimport { RunsChartsCardConfig } from '../runs-charts.types';\nimport { DragAndDropProvider } from '../../../../common/hooks/useDragAndDropElement';\nimport { useUpdateRunsChartsUIConfiguration } from '../hooks/useRunsChartsUIConfiguration';\nimport { indexOf, sortBy } from 'lodash';\nimport { shouldEnableDraggableChartsGridLayout } from '../../../../common/utils/FeatureUtils';\n\nconst RunsChartsDraggableGridStateContext = createContext<{\n  draggedCardUuid: string | null;\n  targetSection: string | null;\n  isDragging: () => boolean;\n}>({\n  draggedCardUuid: '',\n  targetSection: '',\n  isDragging: () => false,\n});\n\nconst RunsChartsDraggableGridActionsContext = createContext<{\n  setDraggedCardUuid: (cardUuid: string | null) => void;\n  setTargetSection: (targetSectionUuid: string | null) => void;\n  setTargetPosition: (pos: number) => void;\n  onDropChartCard: () => void;\n  onSwapCards: (sourceUuid: string, targetUuid: string) => void;\n}>({\n  setDraggedCardUuid: () => {},\n  setTargetSection: () => {},\n  setTargetPosition: () => {},\n  onDropChartCard: () => {},\n  onSwapCards: () => {},\n});\n\nexport const useRunsChartsDraggableGridStateContext = () => useContext(RunsChartsDraggableGridStateContext);\nexport const useRunsChartsDraggableGridActionsContext = () => useContext(RunsChartsDraggableGridActionsContext);\n\nexport const RunsChartsDraggableCardsGridContextProvider = ({\n  children,\n  visibleChartCards = [],\n}: {\n  children?: React.ReactNode;\n  visibleChartCards?: RunsChartsCardConfig[];\n}) => {\n  // If the feature flag is off, return the children wrapped with legacy react-dnd based provider\n  if (!shouldEnableDraggableChartsGridLayout()) {\n    return <DragAndDropProvider>{children}</DragAndDropProvider>;\n  }\n\n  // Stateful values: dragged card ID and target section ID\n  const [draggedCardUuid, setDraggedCardUuid] = useState<string | null>(null);\n  const [targetSectionUuid, setTargetSectionUuid] = useState<string | null>(null);\n\n  // Use refs for direct access to the values\n  const immediateDraggedCardUuid = useRef<string | null>(null);\n  const immediateTargetSectionId = useRef<string | null>(null);\n  immediateDraggedCardUuid.current = draggedCardUuid;\n  immediateTargetSectionId.current = targetSectionUuid;\n\n  // Mutable field: target position (index) in the target section\n  const targetLocalPosition = useRef<number | null>(null);\n\n  const setTargetPosition = useCallback((pos: number) => {\n    targetLocalPosition.current = pos;\n  }, []);\n\n  const isDragging = useCallback(() => immediateDraggedCardUuid.current !== null, []);\n\n  const updateChartsUIState = useUpdateRunsChartsUIConfiguration();\n\n  // Callback for simple card swapping (Move up/move down functionality)\n  const onSwapCards = useCallback(\n    (sourceChartUuid: string, targetChartUuid: string) => {\n      updateChartsUIState((current) => {\n        const newChartsOrder = current.compareRunCharts?.slice();\n\n        if (!newChartsOrder) {\n          return current;\n        }\n\n        const indexSource = newChartsOrder.findIndex((c) => c.uuid === sourceChartUuid);\n        const indexTarget = newChartsOrder.findIndex((c) => c.uuid === targetChartUuid);\n\n        // If one of the charts is not found, do nothing\n        if (indexSource < 0 || indexTarget < 0) {\n          return current;\n        }\n\n        const sourceChart = newChartsOrder[indexSource];\n\n        // Remove the chart and insert it at the target position\n        newChartsOrder.splice(indexSource, 1);\n        newChartsOrder.splice(indexTarget, 0, sourceChart);\n\n        return { ...current, compareRunCharts: newChartsOrder };\n      });\n    },\n    [updateChartsUIState],\n  );\n\n  // Callback invoked when a card is dropped\n  const onDropChartCard = useCallback(() => {\n    const draggedChartUuid = immediateDraggedCardUuid.current;\n    const targetSectionId = immediateTargetSectionId.current;\n    const targetPosition = targetLocalPosition.current;\n\n    if (draggedChartUuid === null || targetSectionId === null || targetPosition === null) {\n      return;\n    }\n\n    setDraggedCardUuid(null);\n\n    updateChartsUIState((current) => {\n      // Find the source card and section in the current state\n      const sourceCard = current.compareRunCharts?.find((chart) => chart.uuid === draggedChartUuid);\n      if (!sourceCard) {\n        return current;\n      }\n\n      const sourceSection = current.compareRunSections?.find((section) => section.uuid === sourceCard?.metricSectionId);\n\n      // Find the target section in the current state\n      const targetSection = current.compareRunSections?.find((section) => section.uuid === targetSectionId);\n\n      // Get all the cards in the source section\n      const sourceSectionCards = current.compareRunCharts?.filter(\n        (chartCard) => chartCard.metricSectionId === sourceSection?.uuid,\n      );\n\n      // If we're moving the card within the same section\n      if (sourceSection === targetSection) {\n        // Copy the resulting chart list\n        const resultChartsList = current.compareRunCharts?.slice();\n\n        // Get all the currently visible cards (excluding hidden and deleted cards)\n        const visibleSectionCards = sourceSectionCards?.filter((chartCard) => visibleChartCards.includes(chartCard));\n\n        if (!resultChartsList || !visibleSectionCards) {\n          return current;\n        }\n\n        // Find the original position\n        const originalIndex = resultChartsList.findIndex((chartCard) => chartCard.uuid === draggedChartUuid);\n\n        // Clamp the target position index to the visible section cards\n        const clampedLocalPosition = Math.min(targetPosition, visibleSectionCards.length - 1);\n\n        // Map from the index in the section to a global index\n        const targetIndex = indexOf(resultChartsList, visibleSectionCards?.[clampedLocalPosition]);\n\n        // If we found the original index and the target index\n        if (resultChartsList && originalIndex !== -1 && targetIndex !== -1) {\n          // Remove the card from the original position\n          resultChartsList.splice(originalIndex, 1);\n          // Insert the card at the target position\n          resultChartsList.splice(targetIndex, 0, sourceCard);\n        }\n\n        return {\n          ...current,\n          compareRunCharts: resultChartsList,\n        };\n      } else {\n        // If we're moving card to a new section\n        const targetSectionCards = current.compareRunCharts?.filter(\n          (chart) => chart.metricSectionId === targetSectionId && !chart.deleted,\n        );\n\n        // Calculate the target position in the target section\n        if (targetSectionCards) {\n          targetSectionCards.splice(targetPosition, 0, sourceCard);\n        }\n\n        return {\n          ...current,\n          // Use the target position in the sorting function to determine the new position\n          compareRunCharts: sortBy(current.compareRunCharts, (a) => targetSectionCards?.indexOf(a) ?? -1).map(\n            (chart) => {\n              // Also, update the metricSectionId of the dragged card\n              if (chart.uuid === sourceCard.uuid) {\n                return {\n                  ...chart,\n                  metricSectionId: targetSectionId,\n                };\n              }\n              return chart;\n            },\n          ),\n        };\n      }\n    });\n  }, [updateChartsUIState, visibleChartCards]);\n\n  // For performance purposes, expose two different contexts:\n  // one for state (changing but rarely consumed) and one for actions (static but consumed often)\n  const stateContextValue = useMemo(\n    () => ({\n      draggedCardUuid,\n      targetSection: targetSectionUuid,\n      isDragging,\n    }),\n    [draggedCardUuid, targetSectionUuid, isDragging],\n  );\n\n  const actionsContextValue = useMemo(\n    () => ({\n      setDraggedCardUuid,\n      setTargetSection: setTargetSectionUuid,\n      setTargetPosition,\n      onDropChartCard,\n      onSwapCards,\n    }),\n    [onDropChartCard, onSwapCards, setTargetPosition],\n  );\n\n  return (\n    <DragAndDropProvider>\n      <RunsChartsDraggableGridStateContext.Provider value={stateContextValue}>\n        <RunsChartsDraggableGridActionsContext.Provider value={actionsContextValue}>\n          {children}\n        </RunsChartsDraggableGridActionsContext.Provider>\n      </RunsChartsDraggableGridStateContext.Provider>\n    </DragAndDropProvider>\n  );\n};\n","import { useCallback, useState } from 'react';\nimport { useUpdateRunsChartsUIConfiguration } from '../hooks/useRunsChartsUIConfiguration';\nimport { useIntl } from 'react-intl';\nimport { Input, SearchIcon, Spinner, useDesignSystemTheme } from '@databricks/design-system';\nimport { useDebouncedCallback } from 'use-debounce';\n\nexport const RunsChartsFilterInput = ({ chartsSearchFilter }: { chartsSearchFilter?: string }) => {\n  const updateChartsUIState = useUpdateRunsChartsUIConfiguration();\n  const { theme } = useDesignSystemTheme();\n\n  const [inputValue, setInputValue] = useState(() => chartsSearchFilter ?? '');\n  const [searching, setSearching] = useState(false);\n\n  const { formatMessage } = useIntl();\n\n  const updateChartFilter = useCallback(\n    (value: string) => {\n      updateChartsUIState((current) => ({\n        ...current,\n        chartsSearchFilter: value,\n      }));\n      setSearching(false);\n    },\n    [updateChartsUIState],\n  );\n\n  const updateChartFilterDebounced = useDebouncedCallback(updateChartFilter, 150);\n\n  return (\n    <Input\n      componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_runschartsfilterinput.tsx_30\"\n      role=\"searchbox\"\n      prefix={\n        <div css={{ width: theme.general.iconFontSize, lineHeight: 0 }}>\n          {searching ? <Spinner size=\"small\" /> : <SearchIcon />}\n        </div>\n      }\n      value={inputValue}\n      allowClear\n      onChange={(e) => {\n        setInputValue(e.target.value);\n        setSearching(true);\n        updateChartFilterDebounced(e.target.value);\n      }}\n      placeholder={formatMessage({\n        defaultMessage: 'Search metric charts',\n        description: 'Run page > Charts tab > Filter metric charts input > placeholder',\n      })}\n    />\n  );\n};\n","import { ReactNode } from 'react';\nimport { RunsChartsCardConfig } from '../runs-charts.types';\nimport { RunsChartsRunData } from './RunsCharts.common';\nimport { Modal, useDesignSystemTheme } from '@databricks/design-system';\nimport { RunsChartsTooltipBodyProps, RunsChartsTooltipWrapper } from '../hooks/useRunsChartsTooltip';\nimport { RunsChartsCard } from './cards/RunsChartsCard';\nimport type { RunsGroupByConfig } from '../../experiment-page/utils/experimentPage.group-row-utils';\nimport type { RunsChartsGlobalLineChartConfig } from '../../experiment-page/models/ExperimentPageUIState';\n\nexport const RunsChartsFullScreenModal = <TContext,>({\n  chartData,\n  isMetricHistoryLoading = false,\n  groupBy,\n  fullScreenChart,\n  onCancel,\n  tooltipContextValue,\n  tooltipComponent,\n  autoRefreshEnabled,\n  globalLineChartConfig,\n}: {\n  chartData: RunsChartsRunData[];\n  isMetricHistoryLoading?: boolean;\n  groupBy: RunsGroupByConfig | null;\n  autoRefreshEnabled?: boolean;\n  fullScreenChart: { config: RunsChartsCardConfig; title: string; subtitle: ReactNode } | undefined;\n  onCancel: () => void;\n  tooltipContextValue: TContext;\n  tooltipComponent: React.ComponentType<RunsChartsTooltipBodyProps<TContext>>;\n  globalLineChartConfig?: RunsChartsGlobalLineChartConfig;\n}) => {\n  const { theme, getPrefixedClassName } = useDesignSystemTheme();\n\n  const emptyReorderProps = {\n    canMoveDown: false,\n    canMoveUp: false,\n    onMoveDown: () => {},\n    onMoveUp: () => {},\n    onReorderWith: () => {},\n  };\n\n  const emptyConfigureProps = {\n    onRemoveChart: () => {},\n    onReorderCharts: () => {},\n    onStartEditChart: () => {},\n    setFullScreenChart: () => {},\n  };\n\n  if (!fullScreenChart) {\n    return null;\n  }\n\n  return (\n    <Modal\n      componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_runschartsfullscreenmodal.tsx_53\"\n      visible\n      onCancel={onCancel}\n      title={\n        <div css={{ display: 'flex', flexDirection: 'column' }}>\n          {fullScreenChart.title}\n          <span\n            css={{\n              color: theme.colors.textSecondary,\n              fontSize: theme.typography.fontSizeSm,\n              marginRight: theme.spacing.xs,\n            }}\n          >\n            {fullScreenChart.subtitle}\n          </span>\n        </div>\n      }\n      footer={null}\n      verticalSizing=\"maxed_out\"\n      dangerouslySetAntdProps={{ width: '95%' }}\n      css={{\n        [`.${getPrefixedClassName('modal-body')}`]: {\n          flex: 1,\n        },\n      }}\n    >\n      <RunsChartsTooltipWrapper contextData={tooltipContextValue} component={tooltipComponent}>\n        <RunsChartsCard\n          cardConfig={fullScreenChart.config}\n          chartRunData={chartData}\n          groupBy={groupBy}\n          index={0}\n          sectionIndex={0}\n          fullScreen\n          autoRefreshEnabled={autoRefreshEnabled}\n          globalLineChartConfig={globalLineChartConfig}\n          {...emptyConfigureProps}\n          {...emptyReorderProps}\n        />\n      </RunsChartsTooltipWrapper>\n    </Modal>\n  );\n};\n","import { Button, CheckIcon, DropdownMenu, GearIcon, Tooltip, useDesignSystemTheme } from '@databricks/design-system';\nimport { RunsChartsGlobalLineChartConfig } from '../../experiment-page/models/ExperimentPageUIState';\nimport { isUndefined } from 'lodash';\nimport { RunsChartsLineChartXAxisType } from './RunsCharts.common';\nimport { useCallback } from 'react';\nimport { LineSmoothSlider } from '../../LineSmoothSlider';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { RunsChartsUIConfigurationSetter } from '../hooks/useRunsChartsUIConfiguration';\n\nexport const RunsChartsGlobalChartSettingsDropdown = ({\n  globalLineChartConfig,\n  metricKeyList,\n  updateUIState,\n}: {\n  metricKeyList: string[];\n  globalLineChartConfig?: RunsChartsGlobalLineChartConfig;\n  updateUIState: (stateSetter: RunsChartsUIConfigurationSetter) => void;\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const intl = useIntl();\n  const { lineSmoothness, selectedXAxisMetricKey, xAxisKey } = globalLineChartConfig || {};\n\n  const updateGlobalLineChartSettings = useCallback(\n    (newSettings: Partial<RunsChartsGlobalLineChartConfig>) =>\n      updateUIState((state) => ({\n        ...state,\n        globalLineChartConfig: {\n          ...state.globalLineChartConfig,\n          ...newSettings,\n        },\n      })),\n    [updateUIState],\n  );\n\n  const isUsingGlobalMetricXaxis = xAxisKey === RunsChartsLineChartXAxisType.METRIC;\n\n  const label = intl.formatMessage({\n    defaultMessage: 'Configure charts',\n    description: 'Experiment page > view controls > global settings for line chart view > dropdown button label',\n  });\n\n  return (\n    <DropdownMenu.Root modal={false}>\n      <Tooltip\n        componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_runschartsglobalchartsettingsdropdown.tsx_44\"\n        content={label}\n      >\n        <DropdownMenu.Trigger asChild>\n          <Button\n            componentId=\"mlflow.charts.controls.global_chart_setup_dropdown\"\n            icon={<GearIcon />}\n            aria-label={label}\n          />\n        </DropdownMenu.Trigger>\n      </Tooltip>\n      <DropdownMenu.Content align=\"end\" css={{ minWidth: 300 }}>\n        <DropdownMenu.Group\n          role=\"region\"\n          aria-label={intl.formatMessage({\n            defaultMessage: 'X-axis',\n            description:\n              'Experiment page > view controls > global settings for line chart view > settings for x-axis section label',\n          })}\n        >\n          <DropdownMenu.Label css={{ display: 'flex', gap: 8 }}>\n            <FormattedMessage\n              defaultMessage=\"X-axis\"\n              description=\"Experiment page > view controls > global settings for line chart view > settings for x-axis section label\"\n            />\n          </DropdownMenu.Label>\n          <DropdownMenu.CheckboxItem\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_runschartsglobalchartsettingsdropdown.tsx_68\"\n            checked={xAxisKey === RunsChartsLineChartXAxisType.STEP}\n            onClick={() => updateGlobalLineChartSettings({ xAxisKey: RunsChartsLineChartXAxisType.STEP })}\n          >\n            <DropdownMenu.ItemIndicator />\n            <FormattedMessage\n              defaultMessage=\"Step\"\n              description=\"Experiment page > view controls > global settings for line chart view > settings for x-axis > label for setting to use step axis in all charts\"\n            />\n          </DropdownMenu.CheckboxItem>\n          <DropdownMenu.CheckboxItem\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_runschartsglobalchartsettingsdropdown.tsx_78\"\n            checked={xAxisKey === RunsChartsLineChartXAxisType.TIME}\n            onClick={() => updateGlobalLineChartSettings({ xAxisKey: RunsChartsLineChartXAxisType.TIME })}\n          >\n            <DropdownMenu.ItemIndicator />\n            <FormattedMessage\n              defaultMessage=\"Time (wall)\"\n              description=\"Experiment page > view controls > global settings for line chart view > settings for x-axis > label for setting to use wall time axis in all charts\"\n            />\n          </DropdownMenu.CheckboxItem>\n          <DropdownMenu.CheckboxItem\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_runschartsglobalchartsettingsdropdown.tsx_88\"\n            checked={xAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE}\n            onClick={() => updateGlobalLineChartSettings({ xAxisKey: RunsChartsLineChartXAxisType.TIME_RELATIVE })}\n          >\n            <DropdownMenu.ItemIndicator />\n            <FormattedMessage\n              defaultMessage=\"Time (relative)\"\n              description=\"Experiment page > view controls > global settings for line chart view > settings for x-axis > label for setting to use relative time axis in all charts\"\n            />\n          </DropdownMenu.CheckboxItem>\n          <DropdownMenu.Sub>\n            <DropdownMenu.SubTrigger\n              css={{\n                paddingLeft: theme.spacing.xs + theme.spacing.sm,\n              }}\n            >\n              <DropdownMenu.IconWrapper>\n                <CheckIcon\n                  css={{\n                    visibility: isUsingGlobalMetricXaxis ? 'visible' : 'hidden',\n                  }}\n                />\n              </DropdownMenu.IconWrapper>\n              <FormattedMessage\n                defaultMessage=\"Metric\"\n                description=\"Experiment page > view controls > global settings for line chart view > settings for x-axis > label for setting to use metric axis in all charts\"\n              />\n            </DropdownMenu.SubTrigger>\n            <DropdownMenu.SubContent css={{ maxHeight: 300, overflow: 'auto' }}>\n              {metricKeyList.map((metricKey) => (\n                <DropdownMenu.CheckboxItem\n                  componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_runschartsglobalchartsettingsdropdown.tsx_118\"\n                  key={metricKey}\n                  checked={selectedXAxisMetricKey === metricKey && isUsingGlobalMetricXaxis}\n                  onClick={() =>\n                    updateGlobalLineChartSettings({\n                      xAxisKey: RunsChartsLineChartXAxisType.METRIC,\n                      selectedXAxisMetricKey: metricKey,\n                    })\n                  }\n                >\n                  <DropdownMenu.ItemIndicator />\n                  {metricKey}\n                </DropdownMenu.CheckboxItem>\n              ))}\n            </DropdownMenu.SubContent>\n          </DropdownMenu.Sub>\n        </DropdownMenu.Group>\n        <DropdownMenu.Group\n          role=\"region\"\n          aria-label={intl.formatMessage({\n            defaultMessage: 'Line smoothing',\n            description:\n              'Runs charts > line chart > configuration > label for line smoothing slider control. The control allows changing data trace line smoothness from 1 to 100, where 1 is the original data trace and 100 is the smoothest trace. Line smoothing helps eliminate noise in the data.',\n          })}\n        >\n          <DropdownMenu.Label>\n            <FormattedMessage\n              defaultMessage=\"Line smoothing\"\n              description=\"Runs charts > line chart > configuration > label for line smoothing slider control. The control allows changing data trace line smoothness from 1 to 100, where 1 is the original data trace and 100 is the smoothest trace. Line smoothing helps eliminate noise in the data.\"\n            />\n          </DropdownMenu.Label>\n\n          <div css={{ padding: theme.spacing.sm }}>\n            <LineSmoothSlider\n              min={0}\n              max={100}\n              onChange={(lineSmoothness) => updateGlobalLineChartSettings({ lineSmoothness })}\n              defaultValue={lineSmoothness ? lineSmoothness : 0}\n            />\n          </div>\n        </DropdownMenu.Group>\n      </DropdownMenu.Content>\n    </DropdownMenu.Root>\n  );\n};\n","import { Empty, NoIcon, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { useUpdateExperimentViewUIState } from '../../experiment-page/contexts/ExperimentPageUIStateContext';\nimport { useCallback } from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nexport const RunsChartsNoDataFoundIndicator = () => {\n  const updateUIState = useUpdateExperimentViewUIState();\n  const { theme } = useDesignSystemTheme();\n\n  const hideEmptyCharts = useCallback(() => {\n    updateUIState((state) => ({ ...state, hideEmptyCharts: true }));\n  }, [updateUIState]);\n\n  return (\n    <div\n      css={{\n        flex: 1,\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        paddingLeft: theme.spacing.lg,\n        paddingRight: theme.spacing.lg,\n      }}\n    >\n      <Empty\n        description={\n          <FormattedMessage\n            defaultMessage=\"No chart data available for the currently visible runs. Select other runs or <link>hide empty charts.</link>\"\n            description=\"Experiment tracking > runs charts > indication displayed when no corresponding data is found to be used in chart-based run comparison\"\n            values={{\n              link: (chunks) => (\n                <Typography.Link\n                  componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_runschartsnodatafoundindicator.tsx_31\"\n                  onClick={hideEmptyCharts}\n                >\n                  {chunks}\n                </Typography.Link>\n              ),\n            }}\n          />\n        }\n        image={<NoIcon />}\n      />\n    </div>\n  );\n};\n","import { isNil } from 'lodash';\nimport {\n  Button,\n  CloseIcon,\n  PinIcon,\n  PinFillIcon,\n  LegacyTooltip,\n  VisibleIcon,\n  Typography,\n} from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\nimport { FormattedMessage } from 'react-intl';\nimport { Link } from '../../../../common/utils/RoutingUtils';\nimport Routes from '../../../routes';\nimport { useExperimentIds } from '../../experiment-page/hooks/useExperimentIds';\nimport { RunsChartsRunData, RunsChartsLineChartXAxisType } from './RunsCharts.common';\nimport {\n  RunsChartsTooltipBodyProps,\n  RunsChartsTooltipMode,\n  containsMultipleRunsTooltipData,\n} from '../hooks/useRunsChartsTooltip';\nimport {\n  RunsChartsBarCardConfig,\n  RunsChartsCardConfig,\n  RunsChartType,\n  RunsChartsScatterCardConfig,\n  RunsChartsContourCardConfig,\n  RunsChartsLineCardConfig,\n  RunsChartsParallelCardConfig,\n} from '../runs-charts.types';\nimport {\n  type RunsCompareMultipleTracesTooltipData,\n  type RunsMetricsSingleTraceTooltipData,\n} from './RunsMetricsLinePlot';\nimport { RunsMultipleTracesTooltipBody } from './RunsMultipleTracesTooltipBody';\nimport { shouldEnableRelativeTimeDateAxis } from '@mlflow/mlflow/src/common/utils/FeatureUtils';\nimport { customMetricBehaviorDefs } from '../../experiment-page/utils/customMetricBehaviorUtils';\n\ninterface RunsChartsContextMenuContentDataType {\n  runs: RunsChartsRunData[];\n  onTogglePin?: (runUuid: string) => void;\n  onHideRun?: (runUuid: string) => void;\n}\n\ntype RunsChartContextMenuHoverDataType = RunsChartsCardConfig;\n\nconst createBarChartValuesBox = (cardConfig: RunsChartsBarCardConfig, activeRun: RunsChartsRunData) => {\n  const { metricKey } = cardConfig;\n  const metric = activeRun?.metrics[metricKey];\n\n  if (!metric) {\n    return null;\n  }\n\n  const customMetricBehaviorDef = customMetricBehaviorDefs[metric.key];\n  const displayName = customMetricBehaviorDef?.displayName ?? metric.key;\n  const displayValue = customMetricBehaviorDef?.valueFormatter({ value: metric.value }) ?? metric.value;\n\n  return (\n    <div css={styles.value}>\n      <strong>{displayName}:</strong> {displayValue}\n    </div>\n  );\n};\n\nconst createScatterChartValuesBox = (cardConfig: RunsChartsScatterCardConfig, activeRun: RunsChartsRunData) => {\n  const { xaxis, yaxis } = cardConfig;\n  const xKey = xaxis.key;\n  const yKey = yaxis.key;\n\n  const xValue = xaxis.type === 'METRIC' ? activeRun.metrics[xKey]?.value : activeRun.params[xKey]?.value;\n\n  const yValue = yaxis.type === 'METRIC' ? activeRun.metrics[yKey]?.value : activeRun.params[yKey]?.value;\n\n  return (\n    <>\n      {xValue && (\n        <div css={styles.value}>\n          <strong>X ({xKey}):</strong> {xValue}\n        </div>\n      )}\n      {yValue && (\n        <div css={styles.value}>\n          <strong>Y ({yKey}):</strong> {yValue}\n        </div>\n      )}\n    </>\n  );\n};\n\nconst createContourChartValuesBox = (cardConfig: RunsChartsContourCardConfig, activeRun: RunsChartsRunData) => {\n  const { xaxis, yaxis, zaxis } = cardConfig;\n  const xKey = xaxis.key;\n  const yKey = yaxis.key;\n  const zKey = zaxis.key;\n\n  const xValue = xaxis.type === 'METRIC' ? activeRun.metrics[xKey]?.value : activeRun.params[xKey]?.value;\n\n  const yValue = yaxis.type === 'METRIC' ? activeRun.metrics[yKey]?.value : activeRun.params[yKey]?.value;\n\n  const zValue = zaxis.type === 'METRIC' ? activeRun.metrics[zKey]?.value : activeRun.params[zKey]?.value;\n\n  return (\n    <>\n      {xValue && (\n        <div css={styles.value}>\n          <strong>X ({xKey}):</strong> {xValue}\n        </div>\n      )}\n      {yValue && (\n        <div css={styles.value}>\n          <strong>Y ({yKey}):</strong> {yValue}\n        </div>\n      )}\n      {zValue && (\n        <div css={styles.value}>\n          <strong>Z ({zKey}):</strong> {zValue}\n        </div>\n      )}\n    </>\n  );\n};\n\nconst normalizeRelativeTimeChartTooltipValue = (value: string | number) => {\n  if (typeof value === 'number') {\n    return value;\n  }\n  return value.split(' ')[1] || '00:00:00';\n};\n\nconst getTooltipXValue = (\n  hoverData: RunsMetricsSingleTraceTooltipData | undefined,\n  xAxisKey: RunsChartsLineChartXAxisType,\n) => {\n  if (xAxisKey === RunsChartsLineChartXAxisType.METRIC) {\n    return hoverData?.xValue ?? '';\n  }\n\n  if (shouldEnableRelativeTimeDateAxis() && xAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE) {\n    return normalizeRelativeTimeChartTooltipValue(hoverData?.xValue ?? '');\n  }\n\n  // Default return for other cases\n  return hoverData?.xValue;\n};\n\nconst createLineChartValuesBox = (\n  cardConfig: RunsChartsLineCardConfig,\n  activeRun: RunsChartsRunData,\n  hoverData?: RunsMetricsSingleTraceTooltipData,\n) => {\n  const { metricKey: metricKeyFromConfig, xAxisKey } = cardConfig;\n  const metricKey = hoverData?.metricEntity?.key || metricKeyFromConfig;\n\n  // If there's available value from x axis (step or time), extract entry from\n  // metric history instead of latest metric.\n  const metricValue = hoverData?.yValue ?? activeRun?.metrics[metricKey].value;\n\n  if (isNil(metricValue)) {\n    return null;\n  }\n\n  const xValue = getTooltipXValue(hoverData, xAxisKey);\n  return (\n    <>\n      {hoverData && (\n        <div css={styles.value}>\n          <strong>{hoverData.label}:</strong> {xValue}\n        </div>\n      )}\n      <div css={styles.value}>\n        <strong>{metricKey}:</strong> {metricValue}\n      </div>\n    </>\n  );\n};\n\nconst createParallelChartValuesBox = (\n  cardConfig: RunsChartsParallelCardConfig,\n  activeRun: RunsChartsRunData,\n  isHovering?: boolean,\n) => {\n  const { selectedParams, selectedMetrics } = cardConfig as RunsChartsParallelCardConfig;\n  const paramsList = selectedParams.map((paramKey) => {\n    const param = activeRun?.params[paramKey];\n    if (param) {\n      return (\n        <div key={paramKey}>\n          <strong>{param.key}:</strong> {param.value}\n        </div>\n      );\n    }\n    return true;\n  });\n  const metricsList = selectedMetrics.map((metricKey) => {\n    const metric = activeRun?.metrics[metricKey];\n    if (metric) {\n      return (\n        <div key={metricKey}>\n          <strong>{metric.key}:</strong> {metric.value}\n        </div>\n      );\n    }\n    return true;\n  });\n\n  // show only first 3 params and primary metric if hovering, else show all\n  if (isHovering) {\n    return (\n      <>\n        {paramsList.slice(0, 3)}\n        {(paramsList.length > 3 || metricsList.length > 1) && <div>...</div>}\n        {metricsList[metricsList.length - 1]}\n      </>\n    );\n  } else {\n    return (\n      <>\n        {paramsList}\n        {metricsList}\n      </>\n    );\n  }\n};\n\n/**\n * Internal component that displays metrics/params - its final design\n * is a subject to change\n */\nconst ValuesBox = ({\n  activeRun,\n  cardConfig,\n  isHovering,\n  hoverData,\n}: {\n  activeRun: RunsChartsRunData;\n  cardConfig: RunsChartsCardConfig;\n  isHovering?: boolean;\n  hoverData?: RunsMetricsSingleTraceTooltipData;\n}) => {\n  if (cardConfig.type === RunsChartType.BAR) {\n    return createBarChartValuesBox(cardConfig as RunsChartsBarCardConfig, activeRun);\n  }\n\n  if (cardConfig.type === RunsChartType.SCATTER) {\n    return createScatterChartValuesBox(cardConfig as RunsChartsScatterCardConfig, activeRun);\n  }\n\n  if (cardConfig.type === RunsChartType.CONTOUR) {\n    return createContourChartValuesBox(cardConfig as RunsChartsContourCardConfig, activeRun);\n  }\n\n  if (cardConfig.type === RunsChartType.LINE) {\n    return createLineChartValuesBox(cardConfig as RunsChartsLineCardConfig, activeRun, hoverData);\n  }\n\n  if (cardConfig.type === RunsChartType.PARALLEL) {\n    return createParallelChartValuesBox(cardConfig as RunsChartsParallelCardConfig, activeRun, isHovering);\n  }\n\n  return null;\n};\n\nexport const RunsChartsTooltipBody = ({\n  closeContextMenu,\n  contextData,\n  hoverData,\n  chartData,\n  runUuid,\n  isHovering,\n  mode,\n}: RunsChartsTooltipBodyProps<\n  RunsChartsContextMenuContentDataType,\n  RunsChartContextMenuHoverDataType,\n  RunsMetricsSingleTraceTooltipData | RunsCompareMultipleTracesTooltipData\n>) => {\n  const { runs, onTogglePin, onHideRun } = contextData;\n  const [experimentId] = useExperimentIds();\n  const activeRun = runs?.find((run) => run.uuid === runUuid);\n\n  if (\n    containsMultipleRunsTooltipData(hoverData) &&\n    mode === RunsChartsTooltipMode.MultipleTracesWithScanline &&\n    isHovering\n  ) {\n    return <RunsMultipleTracesTooltipBody hoverData={hoverData} />;\n  }\n\n  const singleTraceHoverData = containsMultipleRunsTooltipData(hoverData) ? hoverData.hoveredDataPoint : hoverData;\n\n  if (!activeRun) {\n    return null;\n  }\n\n  const runName = activeRun.displayName || activeRun.uuid;\n  const metricSuffix = singleTraceHoverData?.metricEntity ? ` (${singleTraceHoverData.metricEntity.key})` : '';\n\n  return (\n    <div>\n      <div css={styles.contentWrapper}>\n        <div css={styles.header}>\n          <div css={styles.colorPill} style={{ backgroundColor: activeRun.color }} />\n          {activeRun.groupParentInfo ? (\n            <Typography.Text>{runName + metricSuffix}</Typography.Text>\n          ) : (\n            <Link\n              to={Routes.getRunPageRoute(experimentId, runUuid)}\n              target=\"_blank\"\n              css={styles.runLink}\n              onClick={closeContextMenu}\n            >\n              {runName + metricSuffix}\n            </Link>\n          )}\n        </div>\n        {!isHovering && (\n          <Button\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_runscomparetooltipbody.tsx_259\"\n            size=\"small\"\n            onClick={closeContextMenu}\n            icon={<CloseIcon />}\n          />\n        )}\n      </div>\n\n      <ValuesBox\n        isHovering={isHovering}\n        activeRun={activeRun}\n        cardConfig={chartData}\n        hoverData={singleTraceHoverData}\n      />\n\n      <div css={styles.actionsWrapper}>\n        {activeRun.pinnable && onTogglePin && (\n          <LegacyTooltip\n            title={\n              activeRun.pinned ? (\n                <FormattedMessage\n                  defaultMessage=\"Unpin run\"\n                  description=\"A tooltip for the pin icon button in the runs table next to the pinned run\"\n                />\n              ) : (\n                <FormattedMessage\n                  defaultMessage=\"Click to pin the run\"\n                  description=\"A tooltip for the pin icon button in the runs chart tooltip next to the not pinned run\"\n                />\n              )\n            }\n            placement=\"bottom\"\n          >\n            <Button\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_runscomparetooltipbody.tsx_282\"\n              size=\"small\"\n              onClick={() => {\n                onTogglePin(runUuid);\n                closeContextMenu();\n              }}\n              icon={activeRun.pinned ? <PinFillIcon /> : <PinIcon />}\n            />\n          </LegacyTooltip>\n        )}\n        {onHideRun && (\n          <LegacyTooltip\n            title={\n              <FormattedMessage\n                defaultMessage=\"Click to hide the run\"\n                description='A tooltip for the \"hide\" icon button in the runs chart tooltip'\n              />\n            }\n            placement=\"bottom\"\n          >\n            <Button\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_runscomparetooltipbody.tsx_302\"\n              data-testid=\"experiment-view-compare-runs-tooltip-visibility-button\"\n              size=\"small\"\n              onClick={() => {\n                onHideRun(runUuid);\n                closeContextMenu();\n              }}\n              icon={<VisibleIcon />}\n            />\n          </LegacyTooltip>\n        )}\n      </div>\n    </div>\n  );\n};\n\nconst styles = {\n  runLink: (theme: Theme) => ({\n    color: theme.colors.primary,\n    '&:hover': {},\n  }),\n  actionsWrapper: {\n    marginTop: 8,\n    display: 'flex',\n    gap: 8,\n    alignItems: 'center',\n  },\n  header: {\n    display: 'flex',\n    gap: 8,\n    alignItems: 'center',\n  },\n  value: {\n    whiteSpace: 'nowrap' as const,\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n  },\n  contentWrapper: {\n    display: 'flex',\n    gap: 8,\n    alignItems: 'center',\n    marginBottom: 12,\n    justifyContent: 'space-between',\n    height: 24,\n  },\n  colorPill: { width: 12, height: 12, borderRadius: '100%' },\n};\n","import { useDesignSystemTheme } from '@databricks/design-system';\nimport { Data, Datum, Layout, PlotMouseEvent } from 'plotly.js';\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { LazyPlot } from '../../LazyPlot';\nimport { useMutableChartHoverCallback } from '../hooks/useMutableHoverCallback';\nimport { highlightScatterTraces, useRenderRunsChartTraceHighlight } from '../hooks/useRunsChartTraceHighlight';\nimport {\n  commonRunsChartStyles,\n  RunsChartsRunData,\n  RunsChartAxisDef,\n  runsChartDefaultContourMargin,\n  runsChartHoverlabel,\n  RunsPlotsCommonProps,\n  createThemedPlotlyLayout,\n  useDynamicPlotSize,\n  getLegendDataFromRuns,\n} from './RunsCharts.common';\nimport RunsMetricsLegendWrapper from './RunsMetricsLegendWrapper';\nimport { createChartImageDownloadHandler } from '../hooks/useChartImageDownloadHandler';\n\nexport interface RunsContourPlotProps extends RunsPlotsCommonProps {\n  /**\n   * Horizontal axis with a metric or a param\n   */\n  xAxis: RunsChartAxisDef;\n\n  /**\n   * Vertical axis with a metric or a param\n   */\n  yAxis: RunsChartAxisDef;\n\n  /**\n   * Depth dimension with a metric or a param\n   */\n  zAxis: RunsChartAxisDef;\n\n  /**\n   * Array of runs data with corresponding values\n   */\n  runsData: RunsChartsRunData[];\n\n  /**\n   * Sets the color scale in [[0.35, 'rgb(40,60,190)'],[0.5, 'rgb(70,100,245)'],...] format.\n   * Leave unset to use the defualt scale.\n   */\n  colorScale?: [number, string][];\n\n  /**\n   * Set to `true` in order to reverse the color scale.\n   */\n  reverseScale?: boolean;\n}\n\nconst PLOT_CONFIG = {\n  displaylogo: false,\n  scrollZoom: false,\n  modeBarButtonsToRemove: ['toImage'],\n};\n\nconst DEFAULT_COLOR_SCALE: [number, string][] = [\n  [0, 'rgb(5,10,172)'],\n  [0.35, 'rgb(40,60,190)'],\n  [0.5, 'rgb(70,100,245)'],\n  [0.6, 'rgb(90,120,245)'],\n  [0.7, 'rgb(106,137,247)'],\n  [1, 'rgb(220,220,220)'],\n];\n\nexport const createTooltipTemplate = (zAxisTitle: string) =>\n  '<b>%{customdata[1]}:</b><br>' +\n  '<b>%{xaxis.title.text}:</b> %{x:.2f}<br>' +\n  '<b>%{yaxis.title.text}:</b> %{y:.2f}<br>' +\n  `<b>${zAxisTitle}:</b> %{customdata[2]:.2f}` +\n  '<extra></extra>';\n\n/**\n * Implementation of plotly.js chart displaying\n * contour plot comparing values for a given\n * set of experiments runs\n */\nexport const RunsContourPlot = React.memo(\n  ({\n    runsData,\n    xAxis,\n    yAxis,\n    zAxis,\n    markerSize = 10,\n    className,\n    reverseScale,\n    margin = runsChartDefaultContourMargin,\n    colorScale = DEFAULT_COLOR_SCALE,\n    onUpdate,\n    onHover,\n    onUnhover,\n    width,\n    height,\n    useDefaultHoverBox = true,\n    selectedRunUuid,\n    onSetDownloadHandler,\n  }: RunsContourPlotProps) => {\n    const { theme } = useDesignSystemTheme();\n\n    const { layoutHeight, layoutWidth, setContainerDiv, containerDiv, isDynamicSizeSupported } = useDynamicPlotSize();\n\n    const plotData = useMemo(() => {\n      // Prepare empty values\n      const xValues: (number | string)[] = [];\n      const yValues: (number | string)[] = [];\n      const zValues: (number | string)[] = [];\n      const colors: (number | string)[] = [];\n      const tooltipData: Datum[] = [];\n\n      // Iterate through all the runs and aggregate selected metrics/params\n      for (const runData of runsData) {\n        const { metrics, params, color, uuid, displayName } = runData;\n        const xAxisData = xAxis.type === 'METRIC' ? metrics : params;\n        const yAxisData = yAxis.type === 'METRIC' ? metrics : params;\n        const zAxisData = zAxis.type === 'METRIC' ? metrics : params;\n\n        const x = xAxisData?.[xAxis.key]?.value || undefined;\n        const y = yAxisData?.[yAxis.key]?.value || undefined;\n        const z = zAxisData?.[zAxis.key]?.value || undefined;\n\n        if (x && y && z) {\n          xValues.push(x);\n          yValues.push(y);\n          zValues.push(z);\n          colors.push(color || theme.colors.primary);\n          tooltipData.push([uuid, displayName || uuid, z] as any);\n        }\n      }\n\n      // Let's compile chart layers\n      const layers = [\n        // The top layer with the scatter plot (dots)\n        {\n          x: xValues,\n          y: yValues,\n          customdata: tooltipData,\n          text: runsData.map(({ displayName }) => displayName),\n          hovertemplate: useDefaultHoverBox ? createTooltipTemplate(zAxis.key) : undefined,\n          hoverinfo: useDefaultHoverBox ? undefined : 'none',\n          hoverlabel: useDefaultHoverBox ? runsChartHoverlabel : undefined,\n          type: 'scatter',\n          mode: 'markers',\n          textposition: 'bottom center',\n          marker: {\n            size: markerSize,\n            color: colors,\n            line: {\n              color: 'black',\n              width: 1,\n            },\n          },\n        },\n      ] as Data[];\n\n      // If there are at least two runs, add a contour chart layer\n      if (runsData.length > 1) {\n        layers.unshift({\n          x: xValues,\n          y: yValues,\n          z: zValues,\n          type: 'contour',\n          connectgaps: true,\n          hoverinfo: 'none',\n          contours: {\n            coloring: 'heatmap',\n          },\n          colorscale: colorScale,\n          reversescale: reverseScale,\n          colorbar: {\n            tickfont: { size: 11, color: theme.colors.textSecondary, family: '' },\n          },\n        } as Data);\n      }\n      return layers;\n    }, [\n      colorScale,\n      reverseScale,\n      markerSize,\n      runsData,\n      xAxis.type,\n      xAxis.key,\n      yAxis.type,\n      yAxis.key,\n      zAxis.type,\n      zAxis.key,\n      theme.colors.primary,\n      theme.colors.textSecondary,\n      useDefaultHoverBox,\n    ]);\n\n    const plotlyThemedLayout = useMemo(() => createThemedPlotlyLayout(theme), [theme]);\n\n    const [layout, setLayout] = useState<Partial<Layout>>({\n      width: width || layoutWidth,\n      height: height || layoutHeight,\n      margin,\n      xaxis: { title: xAxis.key, tickfont: { size: 11, color: theme.colors.textSecondary } },\n      yaxis: {\n        ticks: 'inside',\n        title: { standoff: 32, text: yAxis.key },\n        tickfont: { size: 11, color: theme.colors.textSecondary },\n      },\n      template: { layout: plotlyThemedLayout },\n    });\n\n    useEffect(() => {\n      setLayout((current) => {\n        const newLayout = {\n          ...current,\n          width: width || layoutWidth,\n          height: height || layoutHeight,\n          margin,\n        };\n\n        if (newLayout.xaxis) {\n          newLayout.xaxis.title = xAxis.key;\n        }\n\n        if (newLayout.yaxis) {\n          newLayout.yaxis.title = { standoff: 32, text: yAxis.key };\n        }\n\n        return newLayout;\n      });\n    }, [layoutWidth, layoutHeight, margin, xAxis.key, yAxis.key, width, height]);\n\n    const { setHoveredPointIndex } = useRenderRunsChartTraceHighlight(\n      containerDiv,\n      selectedRunUuid,\n      runsData,\n      highlightScatterTraces,\n    );\n\n    const hoverCallback = useCallback(\n      ({ points }: PlotMouseEvent) => {\n        // Find hover event corresponding to the second curve (scatter plot) only\n        const scatterPoints = points.find(({ curveNumber }) => curveNumber === 1);\n\n        setHoveredPointIndex(scatterPoints?.pointIndex ?? -1);\n\n        if (!scatterPoints) {\n          return;\n        }\n\n        // Find the corresponding run UUID by basing on \"customdata\" field set in the trace data.\n        // Plotly TS typings don't support custom fields so we need to cast to \"any\" first\n        const pointCustomDataRunUuid = (scatterPoints as any)?.customdata?.[0];\n        if (pointCustomDataRunUuid) {\n          onHover?.(pointCustomDataRunUuid);\n        }\n      },\n      [onHover, setHoveredPointIndex],\n    );\n\n    const unhoverCallback = useCallback(() => {\n      onUnhover?.();\n      setHoveredPointIndex(-1);\n    }, [onUnhover, setHoveredPointIndex]);\n\n    /**\n     * Unfortunately plotly.js memorizes first onHover callback given on initial render,\n     * so in order to achieve updated behavior we need to wrap its most recent implementation\n     * in the immutable callback.\n     */\n    const mutableHoverCallback = useMutableChartHoverCallback(hoverCallback);\n\n    const legendLabelData = useMemo(() => getLegendDataFromRuns(runsData), [runsData]);\n\n    useEffect(() => {\n      const dataToExport: Data[] = plotData.map((trace: Data) => ({\n        ...trace,\n        mode: 'text+markers',\n      }));\n      onSetDownloadHandler?.(createChartImageDownloadHandler(dataToExport, layout));\n    }, [layout, onSetDownloadHandler, plotData]);\n\n    const chart = (\n      <div\n        css={[commonRunsChartStyles.chartWrapper(theme), commonRunsChartStyles.scatterChartHighlightStyles]}\n        className={className}\n        ref={setContainerDiv}\n      >\n        <LazyPlot\n          data={plotData}\n          useResizeHandler={!isDynamicSizeSupported}\n          css={commonRunsChartStyles.chart(theme)}\n          onUpdate={onUpdate}\n          layout={layout}\n          config={PLOT_CONFIG}\n          onHover={mutableHoverCallback}\n          onUnhover={unhoverCallback}\n        />\n      </div>\n    );\n\n    return <RunsMetricsLegendWrapper labelData={legendLabelData}>{chart}</RunsMetricsLegendWrapper>;\n  },\n);\n","import { useDesignSystemTheme } from '@databricks/design-system';\nimport { Config, Data, Layout } from 'plotly.js';\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { useIntl } from 'react-intl';\nimport { LazyPlot } from '../../LazyPlot';\nimport { useMutableChartHoverCallback } from '../hooks/useMutableHoverCallback';\nimport { highlightBarTraces, useRenderRunsChartTraceHighlight } from '../hooks/useRunsChartTraceHighlight';\nimport {\n  commonRunsChartStyles,\n  RunsChartsRunData,\n  runsChartDefaultMargin,\n  runsChartHoverlabel,\n  RunsPlotsCommonProps,\n  createThemedPlotlyLayout,\n  normalizeChartValue,\n  useDynamicPlotSize,\n  getLegendDataFromRuns,\n} from './RunsCharts.common';\nimport type { MetricEntity } from '../../../types';\nimport RunsMetricsLegendWrapper from './RunsMetricsLegendWrapper';\nimport { createChartImageDownloadHandler } from '../hooks/useChartImageDownloadHandler';\nimport { customMetricBehaviorDefs } from '../../experiment-page/utils/customMetricBehaviorUtils';\n\n// We're not using params in bar plot\nexport type BarPlotRunData = Omit<RunsChartsRunData, 'params' | 'tags' | 'images'>;\n\nexport interface RunsMetricsBarPlotHoverData {\n  xValue: string;\n  yValue: number;\n  index: number;\n  metricEntity?: MetricEntity;\n}\n\nexport interface RunsMetricsBarPlotProps extends RunsPlotsCommonProps {\n  /**\n   * Determines which metric are we comparing by\n   */\n  metricKey: string;\n\n  /**\n   * Array of runs data with corresponding values\n   */\n  runsData: BarPlotRunData[];\n\n  /**\n   * Relative width of the plot bar\n   */\n  barWidth?: number;\n\n  /**\n   * Display run names on the Y axis\n   */\n  displayRunNames?: boolean;\n\n  /**\n   * Display metric key on the X axis\n   */\n  displayMetricKey?: boolean;\n}\n\nconst PLOT_CONFIG: Partial<Config> = {\n  displaylogo: false,\n  scrollZoom: false,\n  doubleClick: 'autosize',\n  showTips: false,\n  modeBarButtonsToRemove: ['toImage'],\n};\n\nexport const Y_AXIS_PARAMS = {\n  ticklabelposition: 'inside',\n  tickfont: { size: 11 },\n  fixedrange: true,\n};\n\nconst getFixedPointValue = (val: string | number, places = 2) => (typeof val === 'number' ? val.toFixed(places) : val);\n\n/**\n * Implementation of plotly.js chart displaying\n * bar plot comparing metrics for a given\n * set of experiments runs\n */\nexport const RunsMetricsBarPlot = React.memo(\n  ({\n    runsData,\n    metricKey,\n    className,\n    margin = runsChartDefaultMargin,\n    onUpdate,\n    onHover,\n    onUnhover,\n    barWidth = 3 / 4,\n    width,\n    height,\n    displayRunNames = true,\n    useDefaultHoverBox = true,\n    displayMetricKey = true,\n    selectedRunUuid,\n    onSetDownloadHandler,\n  }: RunsMetricsBarPlotProps) => {\n    const plotData = useMemo(() => {\n      // Run uuids\n      const ids = runsData.map((d) => d.uuid);\n\n      // Trace names\n      const names = runsData.map(({ displayName }) => displayName);\n\n      // Actual metric values\n      const values = runsData.map((d) => normalizeChartValue(d.metrics[metricKey]?.value));\n\n      // Displayed metric values\n      const textValues = runsData.map((d) => {\n        const customMetricBehaviorDef = customMetricBehaviorDefs[metricKey];\n        if (customMetricBehaviorDef) {\n          return customMetricBehaviorDef.valueFormatter({ value: d.metrics[metricKey]?.value });\n        }\n\n        return getFixedPointValue(d.metrics[metricKey]?.value);\n      });\n\n      // Colors corresponding to each run\n      const colors = runsData.map((d) => d.color);\n\n      return [\n        {\n          y: ids,\n          x: values,\n          names,\n          text: textValues,\n          textposition: values.map((value) => (value === 0 ? 'outside' : 'auto')),\n          textfont: {\n            size: 11,\n          },\n          metrics: runsData.map((d) => d.metrics[metricKey]),\n          // Display run name on hover. \"<extra></extra>\" removes plotly's \"extra\" tooltip that\n          // is unnecessary here.\n          type: 'bar' as any,\n          hovertemplate: useDefaultHoverBox ? '%{label}<extra></extra>' : undefined,\n          hoverinfo: useDefaultHoverBox ? 'y' : 'none',\n          hoverlabel: useDefaultHoverBox ? runsChartHoverlabel : undefined,\n          width: barWidth,\n\n          orientation: 'h',\n          marker: {\n            color: colors,\n          },\n        } as Data & { names: string[] },\n      ];\n    }, [runsData, metricKey, barWidth, useDefaultHoverBox]);\n\n    const { layoutHeight, layoutWidth, setContainerDiv, containerDiv, isDynamicSizeSupported } = useDynamicPlotSize();\n\n    const { formatMessage } = useIntl();\n    const { theme } = useDesignSystemTheme();\n    const plotlyThemedLayout = useMemo(() => createThemedPlotlyLayout(theme), [theme]);\n\n    const [layout, setLayout] = useState<Partial<Layout>>({\n      width: width || layoutWidth,\n      height: height || layoutHeight,\n      hovermode: 'y',\n      margin,\n      xaxis: {\n        title: displayMetricKey ? metricKey : undefined,\n        tickfont: { size: 11, color: theme.colors.textSecondary },\n        tickformat: customMetricBehaviorDefs[metricKey]?.chartAxisTickFormat ?? undefined,\n      },\n      yaxis: {\n        showticklabels: displayRunNames,\n        title: displayRunNames\n          ? formatMessage({\n              defaultMessage: 'Run name',\n              description: 'Label for Y axis in bar chart when comparing metrics between runs',\n            })\n          : undefined,\n        tickfont: { size: 11, color: theme.colors.textSecondary },\n        fixedrange: true,\n      },\n      template: { layout: plotlyThemedLayout },\n    });\n\n    useEffect(() => {\n      setLayout((current) => ({\n        ...current,\n        width: width || layoutWidth,\n        height: height || layoutHeight,\n        margin,\n        xaxis: {\n          ...current.xaxis,\n          title: displayMetricKey ? metricKey : undefined,\n        },\n      }));\n    }, [layoutWidth, layoutHeight, margin, metricKey, width, height, displayMetricKey]);\n\n    const { setHoveredPointIndex } = useRenderRunsChartTraceHighlight(\n      containerDiv,\n      selectedRunUuid,\n      runsData,\n      highlightBarTraces,\n    );\n\n    const hoverCallback = useCallback(\n      ({ points, event }) => {\n        const metricEntity = points[0].data?.metrics[points[0].pointIndex];\n        setHoveredPointIndex(points[0]?.pointIndex ?? -1);\n\n        const hoverData: RunsMetricsBarPlotHoverData = {\n          xValue: points[0].x,\n          yValue: points[0].value,\n          // The index of the X datum\n          index: points[0].pointIndex,\n          metricEntity,\n        };\n\n        const runUuid = points[0]?.label;\n        if (runUuid) {\n          onHover?.(runUuid, event, hoverData);\n        }\n      },\n      [onHover, setHoveredPointIndex],\n    );\n\n    const unhoverCallback = useCallback(() => {\n      onUnhover?.();\n      setHoveredPointIndex(-1);\n    }, [onUnhover, setHoveredPointIndex]);\n\n    /**\n     * Unfortunately plotly.js memorizes first onHover callback given on initial render,\n     * so in order to achieve updated behavior we need to wrap its most recent implementation\n     * in the immutable callback.\n     */\n    const mutableHoverCallback = useMutableChartHoverCallback(hoverCallback);\n\n    const legendLabelData = useMemo(() => getLegendDataFromRuns(runsData), [runsData]);\n\n    useEffect(() => {\n      // Prepare layout and data traces to export\n      const layoutToExport = {\n        ...layout,\n        yaxis: {\n          ...layout.yaxis,\n          showticklabels: true,\n          automargin: true,\n        },\n      };\n\n      const dataToExport = plotData.map((trace) => ({\n        ...trace,\n        // In exported image, use names for Y axes\n        y: trace.names,\n      }));\n      onSetDownloadHandler?.(createChartImageDownloadHandler(dataToExport, layoutToExport));\n    }, [layout, onSetDownloadHandler, plotData]);\n\n    const chart = (\n      <div\n        css={[commonRunsChartStyles.chartWrapper(theme), styles.highlightStyles]}\n        className={className}\n        ref={setContainerDiv}\n      >\n        <LazyPlot\n          data={plotData}\n          useResizeHandler={!isDynamicSizeSupported}\n          css={commonRunsChartStyles.chart(theme)}\n          onUpdate={onUpdate}\n          layout={layout}\n          config={PLOT_CONFIG}\n          onHover={mutableHoverCallback}\n          onUnhover={unhoverCallback}\n        />\n      </div>\n    );\n\n    return <RunsMetricsLegendWrapper labelData={legendLabelData}>{chart}</RunsMetricsLegendWrapper>;\n  },\n);\n\nconst styles = {\n  highlightStyles: {\n    '.trace.bars g.point path': {\n      transition: 'var(--trace-transition)',\n    },\n    '.trace.bars.is-highlight g.point path': {\n      opacity: 'var(--trace-opacity-dimmed-high) !important',\n    },\n    '.trace.bars g.point.is-hover-highlight path': {\n      opacity: 'var(--trace-opacity-highlighted) !important',\n    },\n    '.trace.bars g.point.is-selection-highlight path': {\n      opacity: 'var(--trace-opacity-highlighted) !important',\n      stroke: 'var(--trace-stroke-color)',\n      strokeWidth: 'var(--trace-stroke-width) !important',\n    },\n  },\n};\n","import { Typography, useDesignSystemTheme } from '@databricks/design-system';\n\nimport React from 'react';\nimport { Dash } from 'plotly.js';\n\nconst STROKE_WIDTH = 3;\n\n/**\n * Replicating plotly.js's dasharrays for each dash type, with smaller spaces\n * https://github.com/plotly/plotly.js/blob/master/src/components/drawing/index.js#L162\n */\nconst getDashArray = (dashType: Dash) => {\n  switch (dashType) {\n    case 'dot':\n      return `${STROKE_WIDTH}`;\n    case 'dash':\n      return `${2 * STROKE_WIDTH}, ${STROKE_WIDTH}`;\n    case 'longdash':\n      return `${3 * STROKE_WIDTH}, ${STROKE_WIDTH}`;\n    case 'dashdot':\n      return `${2 * STROKE_WIDTH}, ${STROKE_WIDTH}, ${STROKE_WIDTH}, ${STROKE_WIDTH}`;\n    case 'longdashdot':\n      return `${3 * STROKE_WIDTH}, ${STROKE_WIDTH}, ${STROKE_WIDTH}, ${STROKE_WIDTH}`;\n    default:\n      return '';\n  }\n};\n\nexport type LegendLabelData = {\n  label: string;\n  color: string;\n  dashStyle?: Dash;\n  uuid?: string;\n  metricKey?: string;\n};\n\nconst TraceLabel: React.FC<LegendLabelData> = ({ label, color, dashStyle }) => {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        alignItems: 'center',\n        textOverflow: 'ellipsis',\n        flexShrink: 0,\n        marginRight: theme.spacing.md,\n        maxWidth: '100%',\n      }}\n    >\n      <TraceLabelColorIndicator color={color} dashStyle={dashStyle} />\n      <Typography.Text\n        color=\"secondary\"\n        size=\"sm\"\n        css={{ whiteSpace: 'nowrap', textOverflow: 'ellipsis', overflow: 'hidden' }}\n      >\n        {label}\n      </Typography.Text>\n    </div>\n  );\n};\n\nexport const TraceLabelColorIndicator: React.FC<Pick<LegendLabelData, 'color' | 'dashStyle'>> = ({\n  color,\n  dashStyle,\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const strokeDasharray = dashStyle ? getDashArray(dashStyle) : undefined;\n  const pathYOffset = theme.typography.fontSizeSm / 2;\n\n  return (\n    <svg\n      css={{\n        height: theme.typography.fontSizeSm,\n        width: STROKE_WIDTH * 8,\n        marginRight: theme.spacing.xs,\n        flexShrink: 0,\n      }}\n    >\n      <path\n        d={`M0,${pathYOffset}h${STROKE_WIDTH * 8}`}\n        style={{\n          strokeWidth: STROKE_WIDTH,\n          stroke: color,\n          strokeDasharray,\n        }}\n      />\n    </svg>\n  );\n};\ntype RunsMetricsLegendProps = {\n  labelData: LegendLabelData[];\n  height: number;\n  fullScreen?: boolean;\n};\n\nconst RunsMetricsLegend: React.FC<RunsMetricsLegendProps> = ({ labelData, height, fullScreen }) => {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        flexWrap: 'wrap',\n        height,\n        alignContent: fullScreen ? 'flex-start' : 'normal',\n        gap: fullScreen ? theme.spacing.sm : 0,\n        overflowY: 'auto',\n        overflowX: 'hidden',\n        marginTop: fullScreen ? theme.spacing.lg : theme.spacing.sm,\n      }}\n    >\n      {labelData.map((labelDatum) => (\n        <TraceLabel key={labelDatum.label} {...labelDatum} />\n      ))}\n    </div>\n  );\n};\n\nexport default RunsMetricsLegend;\n","import React from 'react';\n\nimport RunsMetricsLegend, { LegendLabelData } from './RunsMetricsLegend';\nimport { useDesignSystemTheme } from '@databricks/design-system';\n\nconst RunsMetricsLegendWrapper = ({\n  labelData,\n  fullScreen,\n  children,\n}: React.PropsWithChildren<{\n  labelData: LegendLabelData[];\n  fullScreen?: boolean;\n}>) => {\n  const { theme } = useDesignSystemTheme();\n\n  const FULL_SCREEN_LEGEND_HEIGHT = 100;\n  const LEGEND_HEIGHT = 32;\n\n  const height = fullScreen ? FULL_SCREEN_LEGEND_HEIGHT : LEGEND_HEIGHT;\n  const heightBuffer = fullScreen ? theme.spacing.lg : theme.spacing.md;\n\n  return (\n    <>\n      <div css={{ height: `calc(100% - ${height + heightBuffer}px)` }}>{children}</div>\n      <RunsMetricsLegend labelData={labelData} height={height} fullScreen={fullScreen} />\n    </>\n  );\n};\n\nexport default RunsMetricsLegendWrapper;\n","import { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport type { Figure } from 'react-plotly.js';\nimport type {\n  LineChartTraceData,\n  RunsCompareMultipleTracesTooltipData,\n  RunsMetricsLinePlotProps,\n  RunsMetricsSingleTraceTooltipData,\n} from '../components/RunsMetricsLinePlot';\nimport { compact, isNumber, isString, isUndefined, orderBy, throttle, uniq } from 'lodash';\nimport type { LegendLabelData } from '../components/RunsMetricsLegend';\nimport { RunsChartsLineChartXAxisType } from '../components/RunsCharts.common';\n\n// Plotly-specific selectors for finding particular elements of interest in the plot DOM structure\nconst PLOTLY_SVG_SELECTOR = '.main-svg';\nconst PLOTLY_DRAGLAYER_SELECTOR = '.main-svg .draglayer .nsewdrag';\n\n// Interval for throttling the tooltip data update handler\nconst TOOLTIP_DATA_UPDATE_INTERVAL = 50;\n\n/**\n * Utility function, parses the microseconds from the plotly's axis boundary string\n * which are not supported by JavaScript's Date object and have to be added manually.\n *\n * E.g. transforms 2024-02-02 14:35:37.5747 into 0.7\n */\nconst parseMicroseconds = (plotlyAxisBoundary: string) => {\n  const microsecondsString =\n    isString(plotlyAxisBoundary) && plotlyAxisBoundary.match(/[0-9]{2}:[0-9]{2}:[0-9]{2}\\.([0-9]+)/)?.[1];\n  if (!microsecondsString) {\n    return 0;\n  }\n\n  // We turn the microseconds into a fraction of a millisecond, e.g. 0.5743 -> 574.3 -> 0.3\n  return (Number(`0.${microsecondsString}`) * 1000) % 1;\n};\n\nexport const useRunsMultipleTracesTooltipData = ({\n  onUnhover,\n  onHover,\n  runsData,\n  plotData,\n  legendLabelData,\n  containsMultipleMetricKeys,\n  xAxisKeyLabel,\n  xAxisKey,\n  disabled,\n  setHoveredPointIndex,\n  xAxisScaleType = 'linear',\n  positionInSection = 0,\n}: Pick<RunsMetricsLinePlotProps, 'runsData' | 'onHover' | 'onUnhover'> & {\n  plotData: LineChartTraceData[];\n  legendLabelData: LegendLabelData[];\n  containsMultipleMetricKeys?: boolean;\n  xAxisKeyLabel: string;\n  disabled: boolean;\n  xAxisKey: RunsChartsLineChartXAxisType;\n  setHoveredPointIndex: (value: number) => void;\n  xAxisScaleType?: 'linear' | 'log';\n  positionInSection?: number;\n}) => {\n  // Save current boundaries/dimensions of the plot in the mutable ref object\n  const chartBoundaries = useRef<{\n    containerLeftPixels: number;\n    plotWidthPixels: number;\n    plotOffsetPixels: number;\n    lowerBoundValue: number;\n    valueRange: number;\n    mainContainer: SVGElement | null;\n    dragLayer: SVGElement | null;\n    initialized: boolean;\n  }>({\n    containerLeftPixels: 0,\n    plotWidthPixels: 0,\n    plotOffsetPixels: 0,\n    lowerBoundValue: 0,\n    valueRange: 0,\n    mainContainer: null,\n    dragLayer: null,\n    initialized: false,\n  });\n\n  // Keep the reference to the scanline element\n  const scanlineElementRef = useRef<HTMLDivElement>(null);\n\n  // Keep the reference to the current hovered trace data\n  const currentHoveredDataPoint = useRef<RunsMetricsSingleTraceTooltipData | undefined>(undefined);\n\n  // Calculate all visible X values each time the plot data changes\n  const visibleXValues = useMemo(() => uniq(plotData.map(({ x }) => x).flat()) as number[], [plotData]);\n\n  // Store the reference to the initialized plotly's figure object, helps keep track when the plot is initialized\n  const [initializedFigure, setInitializedFigure] = useState<{\n    figure: Readonly<Figure>;\n    graphDiv: Readonly<HTMLElement>;\n  } | null>(null);\n\n  // We are calculating the tooltip data outside of React to avoid unnecessary re-renders,\n  // so we're copying all the input data to the mutable ref objects\n  const immediateHoverData = useRef<RunsCompareMultipleTracesTooltipData | undefined>(undefined);\n  const immediateLegendLabelData = useRef(legendLabelData);\n  const immediateRunsData = useRef(runsData);\n  const immediatePlotData = useRef(plotData);\n  const immediateXValuesData = useRef(visibleXValues);\n  const immediateFigure = useRef(initializedFigure);\n\n  // Update the mutable ref objects when the input data changes\n  immediateLegendLabelData.current = legendLabelData;\n  immediateRunsData.current = runsData;\n  immediatePlotData.current = plotData;\n  immediateXValuesData.current = visibleXValues;\n  immediateFigure.current = initializedFigure;\n\n  // Setup the boundaries of the plot\n  const setupBoundaries = useCallback((figure: Readonly<Figure>) => {\n    const lowerAxisValue = figure.layout.xaxis?.range?.[0];\n    const upperAxisValue = figure.layout.xaxis?.range?.[1];\n\n    // If the axis values are numbers, use them as is, otherwise convert them to timestamps\n    let lowerBoundary = isNumber(lowerAxisValue) ? lowerAxisValue : new Date(lowerAxisValue ?? 0).getTime();\n    let upperBoundary = isNumber(upperAxisValue) ? upperAxisValue : new Date(upperAxisValue ?? 0).getTime();\n\n    lowerBoundary += parseMicroseconds(lowerAxisValue);\n    upperBoundary += parseMicroseconds(upperAxisValue);\n\n    // Save the boundaries to the mutable ref object\n    chartBoundaries.current.lowerBoundValue = lowerBoundary ?? 0;\n    chartBoundaries.current.valueRange = (upperBoundary ?? 0) - chartBoundaries.current.lowerBoundValue;\n  }, []);\n\n  const updateContainerPosition = useCallback(() => {\n    const { mainContainer, dragLayer } = chartBoundaries.current;\n\n    if (mainContainer && dragLayer) {\n      const containerRect = mainContainer.getBoundingClientRect();\n      const dragLayerRect = dragLayer.getBoundingClientRect();\n\n      // Save the boundaries to the mutable ref object\n      chartBoundaries.current.containerLeftPixels = containerRect.x;\n      chartBoundaries.current.plotWidthPixels = dragLayerRect.width;\n      chartBoundaries.current.plotOffsetPixels = dragLayerRect.x - containerRect.x;\n      chartBoundaries.current.initialized = dragLayerRect.width > 0;\n    }\n  }, []);\n\n  // This is a handler of plotly's onUpdate callback.\n  // It is called when the plot is initialized and when the plot is updated.\n  const onUpdatePlotHandler = useCallback(\n    (figure: Readonly<Figure>, graphDiv: Readonly<HTMLElement>) => {\n      setupBoundaries(figure);\n\n      const mainContainer: SVGElement | null = graphDiv.querySelector(PLOTLY_SVG_SELECTOR);\n      const dragLayer: SVGElement | null = graphDiv.querySelector(PLOTLY_DRAGLAYER_SELECTOR);\n\n      chartBoundaries.current.mainContainer = mainContainer;\n      chartBoundaries.current.dragLayer = dragLayer;\n      updateContainerPosition();\n    },\n    [setupBoundaries, updateContainerPosition],\n  );\n\n  // This is a handler of plotly's onInit callback.\n  const onInitPlotHandler = useCallback(\n    (figure: Readonly<Figure>, graphDiv: Readonly<HTMLElement>) => {\n      setInitializedFigure({ figure, graphDiv });\n      onUpdatePlotHandler(figure, graphDiv);\n    },\n    [onUpdatePlotHandler],\n  );\n\n  useEffect(() => {\n    // Recalculate positions after chart has been moved\n    requestAnimationFrame(() => {\n      if (!immediateFigure.current) {\n        return;\n      }\n      onUpdatePlotHandler(immediateFigure.current.figure, immediateFigure.current.graphDiv);\n    });\n  }, [positionInSection, onUpdatePlotHandler]);\n\n  // Hides the scanline when the mouse leaves the plot\n  const pointerLeavePlotCallback = useCallback(\n    (e: PointerEvent) => {\n      // Noop if the mouse is moving to plotly's dragcover element\n      if (e.relatedTarget instanceof Element && e.relatedTarget.classList.contains('dragcover')) {\n        return;\n      }\n      onUnhover?.();\n      if (scanlineElementRef.current) {\n        scanlineElementRef.current.style.display = 'none';\n      }\n    },\n    [onUnhover],\n  );\n\n  // This is a handler of plotly's onHover callback.\n  const onPointHoverCallback = useCallback(\n    ({ points }) => {\n      const hoveredPoint = points[0];\n      const hoveredPointData = hoveredPoint?.data;\n\n      setHoveredPointIndex(hoveredPoint?.curveNumber ?? -1);\n\n      if (!hoveredPointData) {\n        return;\n      }\n\n      // Extract metric entity\n      const metricEntity = hoveredPointData.metricHistory?.[hoveredPoint.pointIndex];\n\n      const singleTraceData: RunsMetricsSingleTraceTooltipData = {\n        // Value of the \"x\" axis (time, step)\n        xValue: hoveredPoint.x,\n        // Value of the \"y\" axis\n        yValue: hoveredPoint.y,\n        // Metric entity value\n        metricEntity,\n        // The index of the X datum\n        index: hoveredPoint.pointIndex,\n        // Current label (\"Step\", \"Time\" etc.)\n        label: xAxisKeyLabel,\n        // Run/group UUID\n        traceUuid: hoveredPointData.uuid,\n      };\n\n      // Save the hovered point/trace data to the mutable ref object\n      currentHoveredDataPoint.current = singleTraceData;\n    },\n    [xAxisKeyLabel, setHoveredPointIndex],\n  );\n\n  // This is a handler of plotly's onUnhover callback.\n  const onPointUnhoverCallback = useCallback(() => {\n    currentHoveredDataPoint.current = undefined;\n    setHoveredPointIndex(-1);\n  }, [setHoveredPointIndex]);\n\n  const getClosestXValue = useCallback(\n    (pointerClientX: number) => {\n      const boundaries = chartBoundaries.current;\n      // Calculate the X value of the hovered point\n      const resultX =\n        (pointerClientX - boundaries.plotOffsetPixels - boundaries.containerLeftPixels) / boundaries.plotWidthPixels;\n\n      // Calculate the current step based on the X value and precalculated boundaries\n      let currentStep = boundaries.lowerBoundValue + boundaries.valueRange * resultX;\n      if (xAxisScaleType === 'log') {\n        currentStep = 10 ** currentStep;\n      }\n      // Find the closest existing X value to the currently hovered value\n      const closestXValue = immediateXValuesData.current.reduce((acc, x) => {\n        if (Math.abs(x - currentStep) < Math.abs(acc - currentStep)) {\n          return x;\n        }\n        return acc;\n      }, immediateXValuesData.current[0]);\n      return closestXValue;\n    },\n    [xAxisScaleType],\n  );\n\n  useEffect(() => {\n    // Return early if this tooltip is disabled\n    if (disabled) {\n      return;\n    }\n    // Return early if the figure is not initialized yet\n    if (!initializedFigure) {\n      return;\n    }\n\n    // Setup the boundaries of the plot at the beginning\n    setupBoundaries(initializedFigure.figure);\n\n    // Get the drag layer element - this is the event-sensitive layer of rendered plotly chart\n    const dragLayer: SVGElement | null = initializedFigure.graphDiv.querySelector(PLOTLY_DRAGLAYER_SELECTOR);\n\n    // This is a throttled handler of the pointermove event, it contains some heavier logic so it's throttled for 50ms\n    const tooltipDataUpdateHandler = throttle(\n      (e: PointerEvent) => {\n        // If for some reason the chart sizing is not initialized yet, do it now\n        if (!chartBoundaries.current.initialized) {\n          updateContainerPosition();\n        }\n        const closestXValue = getClosestXValue(e.clientX);\n\n        // Calculate the tooltip data - based on existing legend, plot and runs data\n        const data = immediateLegendLabelData.current.map((legendEntry) => {\n          // First, find the corresponding data entry (from chart components's input data) and trace (from data prepared for plotly)\n          const correspondingDataEntry = immediateRunsData.current.find(({ uuid }) => uuid === legendEntry.uuid);\n          const correspondingDataTrace = immediatePlotData.current.find(\n            ({ uuid, metricKey }) => uuid === legendEntry.uuid && legendEntry.metricKey === metricKey,\n          );\n\n          if (!correspondingDataTrace) {\n            return undefined;\n          }\n\n          // Determine the display name of the metric - if there are multiple metrics, use the legend label,\n          // otherwise use the display name of the corresponding data entry.\n          const displayName = containsMultipleMetricKeys ? legendEntry.label : correspondingDataEntry?.displayName;\n\n          // Find the value of the corresponding data trace at the closest X value\n          const xIndex = correspondingDataTrace.x?.indexOf(closestXValue);\n          if (isUndefined(xIndex) || xIndex === -1) {\n            return undefined;\n          }\n          const value = correspondingDataTrace.y?.[xIndex];\n\n          // Construct the tooltip legend entry\n          return {\n            displayName: displayName || '',\n            value: isNumber(value) ? value : undefined,\n            color: legendEntry?.color,\n            dashStyle: legendEntry?.dashStyle,\n            uuid: `${legendEntry.uuid}.${legendEntry.metricKey}`,\n          };\n        });\n\n        // Save the tooltip data to the mutable ref object\n        immediateHoverData.current = {\n          tooltipLegendItems: orderBy(compact(data), 'value', 'desc'),\n          hoveredDataPoint: currentHoveredDataPoint?.current,\n          xValue: closestXValue,\n          xAxisKey,\n          xAxisKeyLabel,\n        };\n      },\n      TOOLTIP_DATA_UPDATE_INTERVAL,\n      { leading: true },\n    );\n\n    const windowResizeHandler = throttle(updateContainerPosition, TOOLTIP_DATA_UPDATE_INTERVAL);\n\n    // This is a handler of the pointermove event.\n    // It's not throttled: it just updates the scanline and tooltip position and pass precalculated tooltip data\n    const hoverHandler = (e: PointerEvent) => {\n      if (!immediateHoverData.current) {\n        return;\n      }\n\n      const boundaries = chartBoundaries.current;\n      const closestXValue = getClosestXValue(e.clientX);\n      const closestXValueLeftX =\n        ((xAxisScaleType === 'log' ? Math.log10(closestXValue) : closestXValue) - boundaries.lowerBoundValue) /\n        boundaries.valueRange;\n      const closestXValueLeftInPixels = closestXValueLeftX * boundaries.plotWidthPixels;\n\n      // Enable and reposition the scanline\n      if (scanlineElementRef.current) {\n        scanlineElementRef.current.style.display = 'block';\n        scanlineElementRef.current.style.left = `${boundaries.plotOffsetPixels + closestXValueLeftInPixels}px`;\n      }\n\n      onHover?.(\n        immediateHoverData.current?.hoveredDataPoint?.traceUuid || '',\n        {\n          x: boundaries.containerLeftPixels + boundaries.plotOffsetPixels + closestXValueLeftInPixels,\n          y: e.clientY,\n          originalEvent: e,\n        },\n        immediateHoverData.current,\n      );\n    };\n\n    if (dragLayer) {\n      // Assign two separate handlers for move: one for updating the tooltip data, one for updating the scanline and tooltip position\n      dragLayer.addEventListener('pointermove', tooltipDataUpdateHandler);\n      dragLayer.addEventListener('pointermove', hoverHandler);\n      window.addEventListener('resize', windowResizeHandler);\n\n      // Assign a handler that hides the scanline and tooltip\n      dragLayer.addEventListener('pointerleave', pointerLeavePlotCallback);\n      return () => {\n        dragLayer.removeEventListener('pointermove', tooltipDataUpdateHandler);\n        dragLayer.removeEventListener('pointermove', hoverHandler);\n        dragLayer.removeEventListener('pointerleave', pointerLeavePlotCallback);\n        window.removeEventListener('resize', windowResizeHandler);\n      };\n    }\n\n    return () => {};\n  }, [\n    pointerLeavePlotCallback,\n    initializedFigure,\n    setupBoundaries,\n    onHover,\n    containsMultipleMetricKeys,\n    currentHoveredDataPoint,\n    disabled,\n    xAxisKey,\n    xAxisKeyLabel,\n    xAxisScaleType,\n    getClosestXValue,\n    updateContainerPosition,\n  ]);\n\n  const scanlineElement = disabled ? null : (\n    <div\n      css={{\n        top: 0,\n        width: 0,\n        borderLeft: `1px dashed rgba(0,0,0,0.5)`,\n        height: '100%',\n        position: 'absolute',\n        pointerEvents: 'none',\n      }}\n      ref={scanlineElementRef}\n      style={{ display: 'none' }}\n    />\n  );\n\n  return {\n    updateHandler: onUpdatePlotHandler,\n    initHandler: onInitPlotHandler,\n    scanlineElement,\n    onPointHover: onPointHoverCallback,\n    onPointUnhover: onPointUnhoverCallback,\n  };\n};\n","import { intersection } from 'lodash';\nimport { MetricEntity } from '../../../types';\nimport { RunsChartsLineChartXAxisType, RunsChartsRunData } from '../components/RunsCharts.common';\nimport { RunsMetricsLinePlotProps } from '../components/RunsMetricsLinePlot';\nimport { RunsChartsLineChartExpression } from '../runs-charts.types';\n\nconst getCompareValue = (element: MetricEntity, xAxisKey: RunsMetricsLinePlotProps['xAxisKey']) => {\n  if (xAxisKey === RunsChartsLineChartXAxisType.STEP) {\n    // If xAxisKey is steps, we match along step\n    return element.step;\n  } else if (\n    xAxisKey === RunsChartsLineChartXAxisType.TIME ||\n    xAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE\n  ) {\n    // If xAxisKey is time, we match along timestamp\n    return element.timestamp;\n  }\n  return null;\n};\n\nexport const getExpressionChartsSortedMetricHistory = ({\n  expression,\n  runEntry,\n  evaluateExpression,\n  xAxisKey,\n}: {\n  expression: RunsChartsLineChartExpression;\n  runEntry: Omit<RunsChartsRunData, 'metrics' | 'params' | 'tags' | 'images'>;\n  evaluateExpression: (\n    expression: RunsChartsLineChartExpression,\n    variables: Record<string, number>,\n  ) => number | undefined;\n  xAxisKey: RunsMetricsLinePlotProps['xAxisKey'];\n}) => {\n  const xDataPointsPerVariable = expression.variables.map((variable) => {\n    const elements = runEntry.metricsHistory?.[variable];\n    if (elements !== undefined) {\n      return elements.flatMap((element) => {\n        const compareValue = getCompareValue(element, xAxisKey);\n        if (compareValue !== null) {\n          return [compareValue];\n        }\n        return [];\n      });\n    }\n    return [];\n  });\n  const xDataPoints = intersection(...xDataPointsPerVariable);\n  xDataPoints.sort((a, b) => a - b); // ascending\n\n  // For each xDataPoint, extract variables and evaluate expression\n  return xDataPoints.flatMap((xDataPoint) => {\n    const variables = expression.variables.reduce((obj, variable) => {\n      const elements = runEntry.metricsHistory?.[variable];\n      const value = elements?.find((element) => getCompareValue(element, xAxisKey) === xDataPoint)?.value;\n      if (value !== undefined) {\n        obj[variable] = value;\n      }\n      return obj;\n    }, {} as Record<string, number>);\n\n    const expressionValue = evaluateExpression(expression, variables);\n    if (expressionValue !== undefined) {\n      return [\n        {\n          value: expressionValue,\n          key: expression.expression,\n          ...(xAxisKey === RunsChartsLineChartXAxisType.STEP || xAxisKey === RunsChartsLineChartXAxisType.METRIC\n            ? { step: xDataPoint, timestamp: 0 }\n            : { timestamp: xDataPoint, step: 0 }),\n        },\n      ];\n    }\n    return [];\n  });\n};\n","import { useDesignSystemTheme } from '@databricks/design-system';\nimport { compact, isEmpty, isEqual, isNumber, maxBy, minBy } from 'lodash';\nimport { Config, Dash, Data as PlotlyData, Datum, Layout, LayoutAxis, TypedArray } from 'plotly.js';\nimport { Figure } from 'react-plotly.js';\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { useIntl } from 'react-intl';\nimport { MetricEntity } from '../../../types';\nimport { LazyPlot } from '../../LazyPlot';\nimport { useMutableChartHoverCallback } from '../hooks/useMutableHoverCallback';\nimport { highlightLineTraces, useRenderRunsChartTraceHighlight } from '../hooks/useRunsChartTraceHighlight';\nimport {\n  commonRunsChartStyles,\n  RunsChartsRunData,\n  runsChartDefaultMargin,\n  runsChartHoverlabel,\n  RunsPlotsCommonProps,\n  createThemedPlotlyLayout,\n  normalizeChartValue,\n  useDynamicPlotSize,\n  getLineChartLegendData,\n  lineDashStyles,\n  containsDuplicateXValues,\n  createFadedTraceColor,\n  getChartAxisLabelDescriptor,\n  RunsChartsLineChartXAxisType,\n} from './RunsCharts.common';\nimport { EMA } from '../../MetricsPlotView';\nimport RunsMetricsLegendWrapper from './RunsMetricsLegendWrapper';\nimport {\n  shouldEnableDeepLearningUIPhase3,\n  shouldEnableManualRangeControls,\n  shouldEnableChartsOriginalLinesWhenSmoothing,\n  shouldEnableRelativeTimeDateAxis,\n  shouldEnableChartExpressions,\n} from '@mlflow/mlflow/src/common/utils/FeatureUtils';\nimport { useRunsMultipleTracesTooltipData } from '../hooks/useRunsChartsMultipleTracesTooltip';\nimport { createChartImageDownloadHandler } from '../hooks/useChartImageDownloadHandler';\nimport {\n  EPOCH_RELATIVE_TIME,\n  HOUR_IN_MILLISECONDS,\n  LINE_CHART_RELATIVE_TIME_THRESHOLD,\n} from '@mlflow/mlflow/src/experiment-tracking/constants';\nimport { type RunsChartsLineChartExpression, RunsChartsLineChartYAxisType } from '../runs-charts.types';\nimport { useChartExpressionParser } from '../hooks/useChartExpressionParser';\nimport { getExpressionChartsSortedMetricHistory } from '../utils/expressionCharts.utils';\n\nexport type LineChartTraceData = PlotlyData & {\n  x?: number[] | undefined;\n  y?: number[];\n  uuid?: string;\n  metricKey?: string;\n};\n\n// Display markers only if there are less than 60 points in the single data trace\nconst MARKER_DISPLAY_THRESHOLD = 60;\n\nconst getDataTraceForRun = ({\n  runEntry,\n  metricKey,\n  xAxisKey,\n  selectedXAxisMetricKey,\n  useDefaultHoverBox,\n  lineSmoothness,\n  lineShape,\n  lineDash,\n  displayPoints,\n  displayOriginalLine: originalLine,\n  xAxisScaleType,\n  expression,\n  evaluateExpression,\n}: {\n  runEntry: Omit<RunsChartsRunData, 'metrics' | 'params' | 'tags' | 'images'>;\n  metricKey?: RunsMetricsLinePlotProps['metricKey'];\n  xAxisKey: RunsMetricsLinePlotProps['xAxisKey'];\n  selectedXAxisMetricKey: RunsMetricsLinePlotProps['selectedXAxisMetricKey'];\n  useDefaultHoverBox: RunsMetricsLinePlotProps['useDefaultHoverBox'];\n  lineSmoothness: RunsMetricsLinePlotProps['lineSmoothness'];\n  lineShape: RunsMetricsLinePlotProps['lineShape'];\n  lineDash?: Dash;\n  displayPoints?: boolean;\n  displayOriginalLine?: boolean;\n  xAxisScaleType?: 'linear' | 'log';\n  expression?: RunsChartsLineChartExpression;\n  evaluateExpression?: (\n    expression: RunsChartsLineChartExpression,\n    variables: Record<string, number>,\n  ) => number | undefined;\n}): LineChartTraceData => {\n  if (!runEntry.metricsHistory) {\n    return {};\n  }\n\n  let sortedMetricsHistory: MetricEntity[] = [];\n  if (expression && evaluateExpression) {\n    sortedMetricsHistory = getExpressionChartsSortedMetricHistory({\n      expression,\n      runEntry,\n      evaluateExpression,\n      xAxisKey,\n    });\n  } else if (metricKey !== undefined) {\n    sortedMetricsHistory = runEntry.metricsHistory[metricKey]?.sort((a, b) =>\n      xAxisKey === RunsChartsLineChartXAxisType.STEP ? a.step - b.step : a.timestamp - b.timestamp,\n    );\n  } else {\n    return {};\n  }\n\n  let xValues;\n  let yValues;\n  if (xAxisKey === RunsChartsLineChartXAxisType.METRIC) {\n    const ySteps = new Set((sortedMetricsHistory ?? []).map(({ step }) => step));\n    const xValuesWithSteps = prepareXAxisDataForMetricType(ySteps, runEntry.metricsHistory[selectedXAxisMetricKey]);\n    const stepOrder = xValuesWithSteps.map(({ step }) => step);\n    const xSteps = new Set(stepOrder);\n    const yValueHistory = orderBySteps(sortedMetricsHistory ?? [], stepOrder).filter(({ step }) => xSteps.has(step));\n\n    xValues = xValuesWithSteps.map(({ value }) => value);\n    yValues = yValueHistory.map(({ value }) => normalizeChartValue(value));\n  } else {\n    xValues = prepareMetricHistoryByAxisType(sortedMetricsHistory, xAxisKey);\n    yValues = sortedMetricsHistory?.map(({ value }) => normalizeChartValue(value));\n\n    if (xAxisScaleType === 'log') {\n      // If the log scale is used, we want to remove all <=0 values from X axis (and their corresponding Y values).\n      const firstNonZeroXIndex = xValues.findIndex((x) => x > 0);\n      if (firstNonZeroXIndex !== -1) {\n        xValues = xValues.slice(firstNonZeroXIndex);\n        yValues = yValues.slice(firstNonZeroXIndex);\n      }\n    }\n  }\n\n  // If there are any duplicate X values, use linear line shape\n  // to avoid bending splines in the wrong direction\n  const optimizedLineShape = containsDuplicateXValues(xValues) ? 'linear' : lineShape;\n\n  // Use chart card's configuration or if its unset, use the automatic behavior by checking the number of points\n  const shouldDisplayMarkers = !originalLine && (displayPoints ?? xValues.length < MARKER_DISPLAY_THRESHOLD);\n\n  const containsSingleValue = yValues?.length === 1;\n\n  const hoverinfo = (() => {\n    if (originalLine) {\n      return 'skip';\n    }\n    if (useDefaultHoverBox) {\n      return undefined;\n    }\n    return 'none';\n  })();\n\n  return {\n    // Let's add UUID to each run so it can be distinguished later (e.g. on hover)\n    uuid: runEntry.uuid,\n    name: runEntry.runInfo?.runName || '',\n    x: xValues,\n    // The actual value is on Y axis\n    y: EMA(yValues ?? [], originalLine ? 0 : lineSmoothness),\n    // Save the metric history\n    metricHistory: sortedMetricsHistory,\n    metricKey: metricKey || expression?.expression,\n    hovertext: runEntry.runInfo?.runName || '',\n    text: 'x',\n    textposition: 'outside',\n    textfont: {\n      size: 11,\n    },\n    mode: containsSingleValue || shouldDisplayMarkers ? 'lines+markers' : 'lines',\n    hovertemplate: useDefaultHoverBox ? createTooltipTemplate(runEntry.runInfo?.runName || '') : undefined,\n    hoverinfo,\n    hoverlabel: useDefaultHoverBox ? runsChartHoverlabel : undefined,\n    type: 'scatter',\n    line: { dash: lineDash, shape: optimizedLineShape },\n    marker: {\n      color: originalLine ? createFadedTraceColor(runEntry.color, 0.15) : runEntry.color,\n    },\n  } as LineChartTraceData;\n};\n\nconst getBandTraceForRun = ({\n  runEntry,\n  metricKey,\n  lineShape,\n  xAxisKey,\n  selectedXAxisMetricKey,\n  xAxisScaleType,\n}: {\n  runEntry: Omit<RunsChartsRunData, 'metrics' | 'params' | 'tags' | 'images'>;\n  metricKey: RunsMetricsLinePlotProps['metricKey'];\n  lineShape: RunsMetricsLinePlotProps['lineShape'];\n  xAxisKey: RunsChartsLineChartXAxisType;\n  selectedXAxisMetricKey: RunsMetricsLinePlotProps['selectedXAxisMetricKey'];\n  xAxisScaleType?: 'linear' | 'log';\n}): LineChartTraceData => {\n  if (!runEntry.aggregatedMetricsHistory) {\n    return {};\n  }\n\n  // Get upper and lower boundaries to draw a band\n  const { max, min } = runEntry.aggregatedMetricsHistory[metricKey];\n\n  let xMins, xMaxes, yMins, yMaxes;\n  if (xAxisKey === RunsChartsLineChartXAxisType.METRIC) {\n    if (!runEntry.metricsHistory) {\n      return {};\n    }\n    const ySteps = new Set(max.map(({ step }) => step));\n    const xValuesWithSteps = prepareXAxisDataForMetricType(ySteps, runEntry.metricsHistory[selectedXAxisMetricKey]);\n    const stepOrder = xValuesWithSteps.map((e) => e.step);\n    const xSteps = new Set(stepOrder);\n    const xValues = xValuesWithSteps.map((e) => e.value);\n\n    yMins = orderBySteps(min, stepOrder)\n      .filter(({ step }) => xSteps.has(step))\n      .map(({ value }) => normalizeChartValue(value))\n      .reverse();\n    yMaxes = orderBySteps(max, stepOrder)\n      .filter(({ step }) => xSteps.has(step))\n      .map(({ value }) => normalizeChartValue(value));\n    xMins = xValues.slice().reverse();\n    xMaxes = xValues;\n  } else {\n    // Reverse one of the arrays so that the band is drawn correctly\n    const minReversed = min.slice().reverse();\n    xMins = prepareMetricHistoryByAxisType(minReversed, xAxisKey);\n    xMaxes = prepareMetricHistoryByAxisType(max, xAxisKey);\n    yMins = minReversed.map(({ value }) => normalizeChartValue(value));\n    yMaxes = max.map(({ value }) => normalizeChartValue(value));\n\n    if (xAxisScaleType === 'log') {\n      // If the log scale is used, we want to remove all <=0 values from X axis (and their corresponding Y values).\n      const firstNonZeroXIndex = xMaxes.findIndex((x) => isNumber(x) && x > 0);\n      const lastNonZeroXIndex = xMins.length - xMins.findIndex((x) => isNumber(x) && x > 0);\n      if (firstNonZeroXIndex !== -1 && lastNonZeroXIndex !== -1) {\n        xMaxes = xMaxes.slice(firstNonZeroXIndex);\n        yMaxes = yMaxes.slice(firstNonZeroXIndex);\n        xMins = xMins.slice(0, lastNonZeroXIndex - 1);\n        yMins = yMins.slice(0, lastNonZeroXIndex - 1);\n      }\n    }\n  }\n\n  // Place a null value in the middle to create a gap, otherwise Plotly will\n  // connect the lines and the fill will be drawn incorrectly\n  const xValues = [...xMins, null, ...xMaxes];\n  const bandValues = [...yMins, null, ...yMaxes];\n\n  return {\n    name: runEntry.runInfo?.runName || '',\n    x: xValues,\n    y: bandValues,\n    fillcolor: createFadedTraceColor(runEntry.color, 0.2),\n    hovertemplate: undefined,\n    hoverlabel: undefined,\n    hoverinfo: 'skip',\n    line: { color: 'transparent', shape: lineShape },\n    fill: 'tozeroy',\n    type: 'scatter',\n  } as LineChartTraceData;\n};\n\n/**\n * This function takes a list of metric entities and returns a copy ordered by\n * the step order provided. This is used in metric-type X axes, where the Y values\n * need to be ordered by the X values.\n *\n * For example:\n * dataPoints = [{step: 0, value: 1}, {step: 1, value: 2}, {step: 2, value: 3}]\n * stepOrder = [2, 0, 1]\n * return = [{step: 2, value: 3}, {step: 0, value: 1}, {step: 1, value: 2}]\n */\nconst orderBySteps = (dataPoints: MetricEntity[], stepOrder: number[]) => {\n  const stepIndexes = stepOrder.reduce((acc, step, idx) => {\n    acc[step] = idx;\n    return acc;\n  }, {} as Record<number, number>);\n\n  // if there's a step mismatch, send all non-existing values to the end\n  return dataPoints.slice().sort((a, b) => (stepIndexes[a.step] ?? Infinity) - (stepIndexes[b.step] ?? Infinity));\n};\n\nexport interface RunsMetricsSingleTraceTooltipData {\n  xValue: string | number;\n  yValue: number;\n  index: number;\n  label: string;\n  traceUuid?: string;\n  metricEntity?: MetricEntity;\n}\n\nexport interface RunsCompareMultipleTracesTooltipData {\n  tooltipLegendItems: {\n    uuid: string;\n    color?: string;\n    dashStyle?: Dash;\n    displayName: string;\n    value?: string | number;\n  }[];\n  xValue: string | number;\n  xAxisKey: RunsChartsLineChartXAxisType;\n  xAxisKeyLabel: string;\n  hoveredDataPoint?: RunsMetricsSingleTraceTooltipData;\n}\n\nexport interface RunsMetricsLinePlotProps extends RunsPlotsCommonProps {\n  /**\n   * Determines which metric are we comparing by\n   * NOTE: used only as a fallback in V2 charts\n   */\n  metricKey: string;\n\n  /**\n   * Determines which metric keys to display in V2 charts\n   * NOTE: this prop may not be present in V1 chart configs\n   */\n  selectedMetricKeys?: string[];\n\n  /**\n   * Smoothing factor for EMA\n   */\n  lineSmoothness?: number;\n\n  /**\n   * X axis mode\n   */\n  xAxisScaleType?: 'linear' | 'log';\n\n  /**\n   * Y axis mode\n   */\n  scaleType?: 'linear' | 'log';\n\n  /**\n   * Use spline or polyline. Spline is default mode.\n   */\n  lineShape?: 'linear' | 'spline';\n\n  /**\n   * Choose X axis mode - numeric step or absolute time\n   */\n  xAxisKey?: RunsChartsLineChartXAxisType;\n\n  /**\n   * Choose Y axis mode - metric or expressions\n   */\n  yAxisKey?: RunsChartsLineChartYAxisType;\n\n  /**\n   * Array of expressions to evaluate\n   */\n  yAxisExpressions?: RunsChartsLineChartExpression[];\n\n  /**\n   * Name of the metric to use for the X axis. Used when xAxisKey is set to 'metric'\n   */\n  selectedXAxisMetricKey: string;\n\n  /**\n   * Array of runs data with corresponding values\n   */\n  runsData: Omit<RunsChartsRunData, 'metrics' | 'params' | 'tags' | 'images'>[];\n\n  /**\n   * Currently visible range on x-axis.\n   */\n  xRange?: [number | string, number | string];\n\n  /**\n   * Currently visible range on y-axis\n   */\n  yRange?: [number | string, number | string];\n\n  /**\n   * If set to true, only x-axis can be zoomed by dragging\n   */\n  lockXAxisZoom?: boolean;\n\n  /**\n   * Display points on the line chart. Undefined means \"auto\" mode, i.e. display points only when\n   * there are fewer than 60 datapoints on the chart.\n   */\n  displayPoints?: boolean;\n\n  /**\n   * Current ordering of the chart in the list.\n   * Helps to recalculate tooltip legend repositioning in case of reordering.\n   */\n  positionInSection?: number;\n}\n\nconst PLOT_CONFIG: Partial<Config> = {\n  displaylogo: false,\n  doubleClick: 'autosize',\n  scrollZoom: false,\n  modeBarButtonsToRemove: ['toImage'],\n};\n\nexport const createTooltipTemplate = (runName: string) =>\n  `<b>${runName}</b>:<br>` +\n  '<b>%{xaxis.title.text}:</b> %{x}<br>' +\n  '<b>%{yaxis.title.text}:</b> %{y:.2f}<br>' +\n  '<extra></extra>';\n\n/**\n * Prepares dataset's X axis according to selected visualization type: step, time-wall and time-relative\n *\n * NOTE: metric-type X axes are handled by `prepareXAxisDataForMetricType()`, since we need to retain\n *       step information in order to format the Y axis data correctly.\n */\nconst prepareMetricHistoryByAxisType = (\n  metricHistory?: MetricEntity[],\n  axisType?: RunsMetricsLinePlotProps['xAxisKey'],\n) => {\n  if (!metricHistory) {\n    return [];\n  }\n  if (axisType === RunsChartsLineChartXAxisType.TIME_RELATIVE) {\n    const { timestamp: minTimestamp } = minBy(metricHistory, 'timestamp') || {};\n    if (minTimestamp) {\n      if (shouldEnableRelativeTimeDateAxis()) {\n        return metricHistory.map(({ timestamp }) => timestamp - minTimestamp + EPOCH_RELATIVE_TIME);\n      }\n      return metricHistory.map(({ timestamp }) => (timestamp - minTimestamp) / 1000); // Milliseconds -> seconds\n    }\n    return metricHistory.map(({ step }) => step);\n  } else if (shouldEnableRelativeTimeDateAxis() && axisType === RunsChartsLineChartXAxisType.TIME_RELATIVE_HOURS) {\n    const { timestamp: minTimestamp } = minBy(metricHistory, 'timestamp') || {};\n    if (minTimestamp) {\n      return metricHistory.map(({ timestamp }) => (timestamp - minTimestamp) / HOUR_IN_MILLISECONDS);\n    }\n  } else if (axisType === RunsChartsLineChartXAxisType.TIME) {\n    return metricHistory.map(({ timestamp }) => timestamp);\n  }\n\n  return metricHistory.map(({ step }) => step);\n};\n\n/**\n * Prepares dataset's X axis when axisType is 'metric'. This is separate from\n * `prepareMetricHistoryByAxisType` because we need to keep track of the `step`\n * in addition to the `value`, so that the Y axis data can be associated to the\n * correct X datapoint.\n */\nconst prepareXAxisDataForMetricType = (\n  ySteps: Set<number>,\n  metricHistory?: MetricEntity[],\n): Array<{\n  value: number | undefined;\n  step: number;\n}> => {\n  if (!metricHistory) {\n    return [];\n  }\n\n  return metricHistory\n    .filter((datapoint) => ySteps.has(datapoint.step))\n    .map((datapoint) => ({\n      value: normalizeChartValue(datapoint.value),\n      step: datapoint.step,\n    }))\n    .sort((a, b) => {\n      // sort by value in ascending order\n      return Number(a.value) - Number(b.value);\n    });\n};\n\nconst getXAxisPlotlyType = (\n  xAxisKey: RunsChartsLineChartXAxisType,\n  xAxisScaleType: 'linear' | 'log',\n  dynamicXAxisKey: RunsChartsLineChartXAxisType,\n) => {\n  if (\n    xAxisKey === RunsChartsLineChartXAxisType.TIME ||\n    (shouldEnableRelativeTimeDateAxis() && dynamicXAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE)\n  ) {\n    return 'date';\n  }\n  if (xAxisKey === RunsChartsLineChartXAxisType.STEP && xAxisScaleType === 'log') {\n    return 'log';\n  }\n  return 'linear';\n};\n\n/**\n * Implementation of plotly.js chart displaying\n * line plot comparing metrics' history for a given\n * set of experiments runs\n */\nexport const RunsMetricsLinePlot = React.memo(\n  ({\n    runsData,\n    metricKey,\n    selectedMetricKeys,\n    scaleType = 'linear',\n    xAxisScaleType = 'linear',\n    xAxisKey = RunsChartsLineChartXAxisType.STEP,\n    yAxisKey = RunsChartsLineChartYAxisType.METRIC,\n    yAxisExpressions = [],\n    selectedXAxisMetricKey = '',\n    lineSmoothness = 70,\n    className,\n    margin = runsChartDefaultMargin,\n    lineShape = 'linear',\n    onUpdate,\n    onHover,\n    onUnhover,\n    width,\n    height,\n    useDefaultHoverBox = true,\n    selectedRunUuid,\n    xRange,\n    yRange,\n    lockXAxisZoom,\n    fullScreen,\n    displayPoints,\n    onSetDownloadHandler,\n    positionInSection = 0,\n  }: RunsMetricsLinePlotProps) => {\n    const { theme } = useDesignSystemTheme();\n    const usingMultipleRunsHoverTooltip = shouldEnableDeepLearningUIPhase3();\n    const usingManualRangeControls = shouldEnableManualRangeControls();\n    const { evaluateExpression } = useChartExpressionParser();\n\n    const dynamicXAxisKey = useMemo(() => {\n      let dynamicXAxisKey = xAxisKey;\n      if (shouldEnableRelativeTimeDateAxis() && xAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE) {\n        const metricKeys = selectedMetricKeys || [metricKey];\n        let maxDiff = 0;\n        runsData.forEach((runData) => {\n          const metricHistory = runData.metricsHistory;\n          if (metricHistory) {\n            metricKeys.forEach((metricKey) => {\n              if (metricHistory[metricKey]) {\n                const { timestamp: minTimestamp } = minBy(metricHistory[metricKey], 'timestamp') || {};\n                const { timestamp: maxTimestamp } = maxBy(metricHistory[metricKey], 'timestamp') || {};\n                if (maxTimestamp && minTimestamp) {\n                  const diff = maxTimestamp - minTimestamp;\n                  maxDiff = Math.max(maxDiff, diff);\n                }\n              }\n            });\n          }\n        });\n\n        if (maxDiff >= LINE_CHART_RELATIVE_TIME_THRESHOLD) {\n          dynamicXAxisKey = RunsChartsLineChartXAxisType.TIME_RELATIVE_HOURS;\n        }\n      }\n      return dynamicXAxisKey;\n    }, [runsData, selectedMetricKeys, metricKey, xAxisKey]);\n\n    const getTraceAndOriginalTrace = (props: any) => {\n      const dataTrace = getDataTraceForRun(props);\n      if (shouldEnableChartsOriginalLinesWhenSmoothing()) {\n        const originalLineProps = {\n          ...props,\n          lineSmoothness: 0,\n          useDefaultHoverBox: false,\n          displayPoints: false,\n          displayOriginalLine: true,\n        };\n        const originalDataTrace = getDataTraceForRun(originalLineProps);\n        return [dataTrace, originalDataTrace];\n      }\n      return [dataTrace];\n    };\n\n    const plotData = useMemo(() => {\n      // Generate a data trace for each metric in each run\n      const metricKeys = selectedMetricKeys ?? [metricKey];\n      return runsData\n        .map((runEntry) => {\n          if (\n            shouldEnableChartExpressions() &&\n            xAxisKey !== RunsChartsLineChartXAxisType.METRIC &&\n            yAxisKey === RunsChartsLineChartYAxisType.EXPRESSION\n          ) {\n            return yAxisExpressions.flatMap((expression: RunsChartsLineChartExpression, idx: number) => {\n              return getTraceAndOriginalTrace({\n                runEntry,\n                expression,\n                xAxisKey: dynamicXAxisKey,\n                selectedXAxisMetricKey,\n                useDefaultHoverBox,\n                lineSmoothness,\n                lineShape,\n                lineDash: lineDashStyles[idx % lineDashStyles.length],\n                displayPoints,\n                xAxisScaleType,\n                evaluateExpression,\n              });\n            });\n          } else {\n            return (\n              metricKeys\n                // Discard creating traces for metrics that don't have any history for a given run\n                .filter((metricKey) => !isEmpty(runEntry.metricsHistory?.[metricKey]))\n                .flatMap((metricKey, idx) => {\n                  return getTraceAndOriginalTrace({\n                    runEntry,\n                    metricKey,\n                    xAxisKey: dynamicXAxisKey,\n                    selectedXAxisMetricKey,\n                    useDefaultHoverBox,\n                    lineSmoothness,\n                    lineShape,\n                    lineDash: lineDashStyles[idx % lineDashStyles.length],\n                    displayPoints,\n                    xAxisScaleType,\n                  });\n                })\n            );\n          }\n        })\n        .flat();\n    }, [\n      runsData,\n      lineShape,\n      dynamicXAxisKey,\n      lineSmoothness,\n      metricKey,\n      useDefaultHoverBox,\n      selectedMetricKeys,\n      selectedXAxisMetricKey,\n      displayPoints,\n      xAxisScaleType,\n      yAxisKey,\n      yAxisExpressions,\n      evaluateExpression,\n      xAxisKey,\n    ]);\n\n    const bandsData = useMemo(() => {\n      const metricKeys = selectedMetricKeys ?? [metricKey];\n      return runsData\n        .filter(({ groupParentInfo }) => groupParentInfo)\n        .flatMap((runEntry) =>\n          metricKeys.map((metricKey) =>\n            getBandTraceForRun({\n              runEntry,\n              metricKey,\n              lineShape,\n              xAxisKey: dynamicXAxisKey,\n              selectedXAxisMetricKey,\n              xAxisScaleType,\n            }),\n          ),\n        );\n    }, [lineShape, metricKey, runsData, selectedMetricKeys, dynamicXAxisKey, selectedXAxisMetricKey, xAxisScaleType]);\n\n    const plotDataWithBands = useMemo(() => [...bandsData, ...plotData], [plotData, bandsData]);\n\n    const { layoutHeight, layoutWidth, setContainerDiv, containerDiv, isDynamicSizeSupported } = useDynamicPlotSize();\n\n    const { formatMessage } = useIntl();\n\n    const { setHoveredPointIndex } = useRenderRunsChartTraceHighlight(\n      containerDiv,\n      selectedRunUuid,\n      plotDataWithBands,\n      highlightLineTraces,\n      bandsData.length,\n    );\n\n    const xAxisPlotlyType = getXAxisPlotlyType(xAxisKey, xAxisScaleType, dynamicXAxisKey);\n\n    const xAxisKeyLabel = useMemo(() => {\n      if (dynamicXAxisKey === RunsChartsLineChartXAxisType.METRIC) {\n        return selectedXAxisMetricKey;\n      }\n\n      return formatMessage(getChartAxisLabelDescriptor(dynamicXAxisKey));\n    }, [formatMessage, dynamicXAxisKey, selectedXAxisMetricKey]);\n\n    const yAxisParams: Partial<LayoutAxis> = useMemo(() => {\n      if (usingManualRangeControls) {\n        return {\n          tickfont: { size: 11, color: theme.colors.textSecondary },\n          type: scaleType === 'log' ? 'log' : 'linear',\n          fixedrange: lockXAxisZoom,\n          range: yRange,\n          autorange: yRange === undefined,\n          tickformat: 'f',\n        };\n      } else {\n        return {\n          tickfont: { size: 11, color: theme.colors.textSecondary },\n          type: scaleType === 'log' ? 'log' : 'linear',\n          fixedrange: lockXAxisZoom,\n        };\n      }\n    }, [scaleType, lockXAxisZoom, theme, yRange, usingManualRangeControls]);\n\n    const xAxisParams: Partial<LayoutAxis> = useMemo(() => {\n      if (usingManualRangeControls) {\n        return {\n          title: xAxisKeyLabel,\n          tickfont: { size: 11, color: theme.colors.textSecondary },\n          range: xRange,\n          autorange: xRange === undefined,\n          type: xAxisPlotlyType,\n        };\n      } else {\n        return {\n          title: xAxisKeyLabel,\n          tickfont: { size: 11, color: theme.colors.textSecondary },\n        };\n      }\n    }, [theme, xAxisKeyLabel, xRange, xAxisPlotlyType, usingManualRangeControls]);\n\n    const [layout, setLayout] = useState<Partial<Layout>>({\n      width: width || layoutWidth,\n      height: height || layoutHeight,\n      margin,\n      xaxis: xAxisParams,\n      yaxis: yAxisParams,\n      showlegend: false,\n    });\n\n    useEffect(() => {\n      setLayout((current) => {\n        const updatedLayout = {\n          ...current,\n          width: width || layoutWidth,\n          height: height || layoutHeight,\n          margin,\n          yaxis: yAxisParams,\n          showlegend: false,\n        };\n        if (usingManualRangeControls) {\n          updatedLayout.xaxis = xAxisParams;\n        }\n        if (isEqual(updatedLayout, current)) {\n          return current;\n        }\n        return updatedLayout;\n      });\n    }, [\n      layoutWidth,\n      layoutHeight,\n      margin,\n      xAxisParams,\n      yAxisParams,\n      width,\n      height,\n      xAxisKeyLabel,\n      usingManualRangeControls,\n    ]);\n\n    const containsMultipleMetricKeys = useMemo(() => (selectedMetricKeys?.length || 0) > 1, [selectedMetricKeys]);\n\n    const hoverCallback = useCallback(\n      ({ points, event }) => {\n        const hoveredPoint = points[0];\n        const hoveredPointData = hoveredPoint?.data;\n        setHoveredPointIndex(hoveredPoint?.curveNumber ?? -1);\n\n        if (!hoveredPointData) {\n          return;\n        }\n        const runUuid = hoveredPointData.uuid;\n\n        // Extract metric entity\n        const metricEntity = hoveredPointData.metricHistory?.[hoveredPoint.pointIndex];\n\n        const data: RunsMetricsSingleTraceTooltipData = {\n          // Value of the \"x\" axis (time, step)\n          xValue: hoveredPoint.x,\n          // Value of the \"y\" axis\n          yValue: hoveredPoint.y,\n          // Metric entity value\n          metricEntity,\n          // The index of the X datum\n          index: hoveredPoint.pointIndex,\n          // Current label (\"Step\", \"Time\" etc.)\n          label: xAxisKeyLabel,\n        };\n        if (runUuid) {\n          onHover?.(runUuid, event, data);\n        }\n      },\n      [onHover, setHoveredPointIndex, xAxisKeyLabel],\n    );\n\n    const unhoverCallback = useCallback(() => {\n      onUnhover?.();\n      setHoveredPointIndex(-1);\n    }, [onUnhover, setHoveredPointIndex]);\n\n    const themedPlotlyLayout = useMemo(() => createThemedPlotlyLayout(theme), [theme]);\n\n    const getXAxisRange = (\n      xAxisKey: RunsChartsLineChartXAxisType,\n      xRange: [number | string, number | string],\n      xAxisScaleType: 'linear' | 'log',\n    ) => {\n      if (\n        xAxisKey === RunsChartsLineChartXAxisType.STEP &&\n        typeof xRange[0] === 'number' &&\n        typeof xRange[1] === 'number'\n      ) {\n        if (xAxisScaleType === 'log') {\n          if (xRange[0] < 0 && xRange[1] < 0) {\n            // If both are negative, autoscale\n            return undefined;\n          } else if (xRange[0] < 0) {\n            // If only the lower bound is negative, set it to 0\n            return [0, xRange[1]];\n          }\n        }\n      }\n      return [...xRange];\n    };\n\n    // When switching axis title, Plotly.js mutates its layout object\n    // internally which leads to desync problems and automatic axis range\n    // ends up with an invalid value. In order to fix it, we are mutating\n    // axis object and injecting metric key as title in\n    // the render phase.\n    // It could be fixed by wrapping plotly.js directly instead of using\n    // react-plotly.js - but the effort does not correspond to the plan of\n    // moving away from plotly soon.\n    const immediateLayout = layout;\n    if (immediateLayout.xaxis) {\n      immediateLayout.xaxis.title = xAxisKeyLabel;\n      immediateLayout.xaxis.type = xAxisPlotlyType;\n      if (xRange) {\n        immediateLayout.xaxis.range = usingManualRangeControls\n          ? xRange\n          : getXAxisRange(xAxisKey, xRange, xAxisScaleType);\n      }\n      immediateLayout.xaxis.automargin = true;\n      immediateLayout.xaxis.tickformat =\n        shouldEnableRelativeTimeDateAxis() && dynamicXAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE\n          ? '%H:%M:%S'\n          : undefined;\n    }\n    immediateLayout.template = { layout: themedPlotlyLayout };\n\n    if (immediateLayout.yaxis && yRange) {\n      immediateLayout.yaxis.range = yRange;\n      immediateLayout.yaxis.automargin = true;\n      immediateLayout.yaxis.tickformat = 'f';\n    }\n\n    const legendLabelData = useMemo(\n      () => getLineChartLegendData(runsData, selectedMetricKeys, metricKey, yAxisKey, yAxisExpressions),\n      [runsData, selectedMetricKeys, metricKey, yAxisKey, yAxisExpressions],\n    );\n\n    const {\n      scanlineElement,\n      initHandler,\n      updateHandler: updateHandlerMultipleRuns,\n      onPointHover: hoverCallbackMultipleRuns,\n      onPointUnhover: unhoverCallbackMultipleRuns,\n    } = useRunsMultipleTracesTooltipData({\n      legendLabelData,\n      plotData,\n      runsData,\n      containsMultipleMetricKeys,\n      onHover,\n      onUnhover: unhoverCallback,\n      xAxisKeyLabel,\n      xAxisKey: dynamicXAxisKey,\n      xAxisScaleType: xAxisKey === RunsChartsLineChartXAxisType.STEP ? xAxisScaleType : 'linear',\n      setHoveredPointIndex,\n      disabled: !usingMultipleRunsHoverTooltip,\n      positionInSection,\n    });\n\n    /**\n     * Unfortunately plotly.js memorizes first onHover callback given on initial render,\n     * so in order to achieve updated behavior we need to wrap its most recent implementation\n     * in the immutable callback.\n     */\n    const mutableHoverCallback = useMutableChartHoverCallback(\n      usingMultipleRunsHoverTooltip ? hoverCallbackMultipleRuns : hoverCallback,\n    );\n\n    // Prepare data for image download handler\n    useEffect(() => {\n      // Check if we are using multiple metric keys. If so, we also need to append\n      // the metric key to  the trace name in the exported image.\n      const usingMultipleMetricKeys = (selectedMetricKeys?.length || 0) > 1;\n      const dataToExport = usingMultipleMetricKeys\n        ? plotDataWithBands.map((dataTrace) =>\n            dataTrace.metricKey\n              ? {\n                  ...dataTrace,\n                  name: `${dataTrace.name} (${dataTrace.metricKey})`,\n                }\n              : dataTrace,\n          )\n        : plotDataWithBands;\n\n      const layoutToExport: Partial<Layout> = {\n        ...layout,\n        showlegend: true,\n        legend: {\n          orientation: 'h',\n        },\n      };\n      onSetDownloadHandler?.(createChartImageDownloadHandler(dataToExport, layoutToExport));\n    }, [layout, onSetDownloadHandler, plotDataWithBands, selectedMetricKeys?.length]);\n\n    const chart = (\n      <div\n        css={[commonRunsChartStyles.chartWrapper(theme), styles.highlightStyles]}\n        className={className}\n        ref={setContainerDiv}\n      >\n        <LazyPlot\n          data={plotDataWithBands}\n          useResizeHandler={!isDynamicSizeSupported}\n          css={commonRunsChartStyles.chart(theme)}\n          onUpdate={(figure: Readonly<Figure>, graphDiv: Readonly<HTMLElement>) => {\n            if (usingMultipleRunsHoverTooltip) {\n              updateHandlerMultipleRuns(figure, graphDiv);\n            }\n            onUpdate?.(figure, graphDiv);\n          }}\n          layout={immediateLayout}\n          config={PLOT_CONFIG}\n          onHover={mutableHoverCallback}\n          onUnhover={usingMultipleRunsHoverTooltip ? unhoverCallbackMultipleRuns : unhoverCallback}\n          onInitialized={initHandler}\n        />\n        {scanlineElement}\n      </div>\n    );\n\n    return (\n      <RunsMetricsLegendWrapper labelData={legendLabelData} fullScreen={fullScreen}>\n        {chart}\n      </RunsMetricsLegendWrapper>\n    );\n  },\n);\n\nconst styles = {\n  highlightStyles: {\n    '.scatterlayer g.trace': {\n      transition: 'var(--trace-transition)',\n    },\n    '.scatterlayer.is-highlight g.trace:not(.is-band)': {\n      opacity: 'var(--trace-opacity-dimmed-low) !important',\n    },\n    '.scatterlayer g.trace.is-hover-highlight:not(.is-band)': {\n      opacity: 'var(--trace-opacity-highlighted) !important',\n    },\n    '.scatterlayer g.trace.is-selection-highlight:not(.is-band)': {\n      opacity: 'var(--trace-opacity-highlighted) !important',\n    },\n    '.scatterlayer g.trace.is-selection-highlight path.point': {\n      stroke: 'var(--trace-stroke-color)',\n      strokeWidth: 'var(--trace-stroke-width) !important',\n    },\n    '.scatterlayer.is-highlight g.trace.is-band:not(.is-band-highlighted)': {\n      opacity: 'var(--trace-opacity-dimmed) !important',\n    },\n  },\n};\n","import { isUndefined } from 'lodash';\n\nimport { RunsCompareMultipleTracesTooltipData } from './RunsMetricsLinePlot';\nimport React from 'react';\nimport { TraceLabelColorIndicator } from './RunsMetricsLegend';\nimport { FormattedDate, FormattedTime, useIntl } from 'react-intl';\nimport { getChartAxisLabelDescriptor, RunsChartsLineChartXAxisType } from './RunsCharts.common';\nimport { useDesignSystemTheme } from '@databricks/design-system';\nimport { shouldEnableRelativeTimeDateAxis } from '@mlflow/mlflow/src/common/utils/FeatureUtils';\n\n// Sadly when hovering outside data point, we can't get the date-time value from Plotly chart\n// so we have to format it ourselves in a way that resembles Plotly's logic\nconst PlotlyLikeFormattedTime = ({ value }: { value: string | number }) => (\n  <>\n    <FormattedDate value={value} year=\"numeric\" />-\n    <FormattedDate value={value} month=\"2-digit\" />-\n    <FormattedDate value={value} day=\"2-digit\" /> <FormattedTime value={value} hour=\"numeric\" hourCycle=\"h24\" />:\n    <FormattedTime value={value} minute=\"2-digit\" />:\n    <FormattedTime value={value} second=\"2-digit\" fractionalSecondDigits={3} />\n  </>\n);\n\n// Sadly when hovering outside data point, we can't get the date-time value from Plotly chart\n// so we have to format it ourselves in a way that resembles Plotly's logic\nconst PlotlyLikeFormattedTimestamp = ({ value }: { value: string | number }) => (\n  <>\n    <FormattedTime value={value} hour=\"2-digit\" hourCycle=\"h23\" />:\n    <FormattedTime value={value} minute=\"2-digit\" />:\n    <FormattedTime value={value} second=\"2-digit\" fractionalSecondDigits={3} />\n  </>\n);\n\n/**\n * Variant of the tooltip body for the line chart that displays multiple traces at once.\n * Used in the compare runs page and run details metrics page.\n */\nexport const RunsMultipleTracesTooltipBody = ({ hoverData }: { hoverData: RunsCompareMultipleTracesTooltipData }) => {\n  const { tooltipLegendItems, hoveredDataPoint: singleTraceHoverData, xValue, xAxisKeyLabel } = hoverData;\n  const { traceUuid: runUuid, metricEntity } = singleTraceHoverData || {};\n\n  const intl = useIntl();\n  const { theme } = useDesignSystemTheme();\n\n  const hoveredTraceUuid = `${runUuid}.${metricEntity?.key}`;\n  const displayedXValueLabel =\n    hoverData.xAxisKey === RunsChartsLineChartXAxisType.METRIC\n      ? xAxisKeyLabel\n      : intl.formatMessage(getChartAxisLabelDescriptor(hoverData.xAxisKey));\n\n  if (tooltipLegendItems) {\n    return (\n      <div>\n        {!isUndefined(xValue) && (\n          <div css={{ marginBottom: theme.spacing.xs }}>\n            <span css={{ fontWeight: 'bold' }}>{displayedXValueLabel}</span>{' '}\n            {hoverData.xAxisKey === RunsChartsLineChartXAxisType.TIME ? (\n              <PlotlyLikeFormattedTime value={xValue} />\n            ) : shouldEnableRelativeTimeDateAxis() &&\n              hoverData.xAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE ? (\n              <PlotlyLikeFormattedTimestamp value={xValue} />\n            ) : (\n              xValue\n            )}\n          </div>\n        )}\n        <div\n          css={{\n            display: 'grid',\n            gridTemplateColumns: `${theme.general.iconSize}px auto auto`,\n            columnGap: theme.spacing.sm,\n            rowGap: theme.spacing.sm / 4,\n            alignItems: 'center',\n          }}\n        >\n          {tooltipLegendItems.map(({ displayName, color, uuid, value, dashStyle }) => (\n            <React.Fragment key={uuid}>\n              <TraceLabelColorIndicator color={color || 'transparent'} dashStyle={dashStyle} />\n\n              <div\n                css={{\n                  marginRight: theme.spacing.md,\n                  fontSize: theme.typography.fontSizeSm,\n                  color: hoveredTraceUuid === uuid ? 'unset' : theme.colors.textPlaceholder,\n                }}\n              >\n                {displayName}\n              </div>\n              <div>\n                {!isUndefined(value) && (\n                  <span\n                    css={{\n                      fontWeight: hoveredTraceUuid === uuid ? 'bold' : 'normal',\n                      color: hoveredTraceUuid === uuid ? 'unset' : theme.colors.textPlaceholder,\n                    }}\n                  >\n                    {value}\n                  </span>\n                )}\n              </div>\n            </React.Fragment>\n          ))}\n        </div>\n      </div>\n    );\n  }\n  return null;\n};\n","import { useDesignSystemTheme } from '@databricks/design-system';\nimport { isNil } from 'lodash';\nimport { Data, Datum, Layout, PlotMouseEvent } from 'plotly.js';\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { LazyPlot } from '../../LazyPlot';\nimport { useMutableChartHoverCallback } from '../hooks/useMutableHoverCallback';\nimport { highlightScatterTraces, useRenderRunsChartTraceHighlight } from '../hooks/useRunsChartTraceHighlight';\nimport {\n  commonRunsChartStyles,\n  RunsChartsRunData,\n  RunsChartAxisDef,\n  runsChartDefaultMargin,\n  runsChartHoverlabel,\n  RunsPlotsCommonProps,\n  createThemedPlotlyLayout,\n  useDynamicPlotSize,\n  getLegendDataFromRuns,\n} from './RunsCharts.common';\nimport RunsMetricsLegendWrapper from './RunsMetricsLegendWrapper';\nimport { createChartImageDownloadHandler } from '../hooks/useChartImageDownloadHandler';\n\nexport interface RunsScatterPlotProps extends RunsPlotsCommonProps {\n  /**\n   * Horizontal axis with a metric or a param\n   */\n  xAxis: RunsChartAxisDef;\n\n  /**\n   * Vertical axis with a metric or a param\n   */\n  yAxis: RunsChartAxisDef;\n\n  /**\n   * Array of runs data with corresponding values\n   */\n  runsData: RunsChartsRunData[];\n}\n\nconst PLOT_CONFIG = {\n  displaylogo: false,\n  scrollZoom: false,\n  modeBarButtonsToRemove: ['toImage'],\n};\n\nexport const createTooltipTemplate = () =>\n  '<b>%{customdata[1]}:</b><br>' +\n  '<b>%{xaxis.title.text}:</b> %{x:.2f}<br>' +\n  '<b>%{yaxis.title.text}:</b> %{y:.2f}<br>' +\n  '<extra></extra>';\n\n/**\n * Implementation of plotly.js chart displaying\n * scatter plot comparing values for a given\n * set of experiments runs\n */\nexport const RunsScatterPlot = React.memo(\n  ({\n    runsData,\n    xAxis,\n    yAxis,\n    markerSize = 10,\n    className,\n    margin = runsChartDefaultMargin,\n    onUpdate,\n    onHover,\n    onUnhover,\n    width,\n    height,\n    useDefaultHoverBox = true,\n    selectedRunUuid,\n    onSetDownloadHandler,\n  }: RunsScatterPlotProps) => {\n    const { theme } = useDesignSystemTheme();\n\n    const { layoutHeight, layoutWidth, setContainerDiv, containerDiv, isDynamicSizeSupported } = useDynamicPlotSize();\n\n    const plotData = useMemo(() => {\n      // Prepare empty values\n      const xValues: (number | string)[] = [];\n      const yValues: (number | string)[] = [];\n      const colors: (number | string)[] = [];\n      const tooltipData: Datum[] = [];\n\n      // Iterate through all the runs and aggregate selected metrics/params\n      for (const runData of runsData) {\n        const { runInfo, metrics, params, color, uuid, displayName } = runData;\n        const { runUuid, runName } = runInfo || {};\n        const xAxisData = xAxis.type === 'METRIC' ? metrics : params;\n        const yAxisData = yAxis.type === 'METRIC' ? metrics : params;\n\n        const x = xAxisData?.[xAxis.key]?.value;\n        const y = yAxisData?.[yAxis.key]?.value;\n\n        if (!isNil(x) && !isNil(y)) {\n          xValues.push(x);\n          yValues.push(y);\n          colors.push(color || theme.colors.primary);\n          if (runUuid) {\n            tooltipData.push([runUuid, runName || runUuid] as any);\n          } else {\n            tooltipData.push([uuid, displayName] as any);\n          }\n        }\n      }\n\n      return [\n        {\n          x: xValues,\n          y: yValues,\n          customdata: tooltipData,\n          text: runsData.map(({ displayName }) => displayName),\n          hovertemplate: useDefaultHoverBox ? createTooltipTemplate() : undefined,\n          hoverinfo: useDefaultHoverBox ? undefined : 'none',\n          hoverlabel: useDefaultHoverBox ? runsChartHoverlabel : undefined,\n          type: 'scatter',\n          mode: 'markers',\n          textposition: 'bottom center',\n          marker: {\n            size: markerSize,\n            color: colors,\n          },\n        } as Data,\n      ];\n    }, [runsData, xAxis, yAxis, theme, markerSize, useDefaultHoverBox]);\n\n    const plotlyThemedLayout = useMemo(() => createThemedPlotlyLayout(theme), [theme]);\n\n    const [layout, setLayout] = useState<Partial<Layout>>({\n      width: width || layoutWidth,\n      height: height || layoutHeight,\n      margin,\n      xaxis: { title: xAxis.key, tickfont: { size: 11, color: theme.colors.textSecondary } },\n      yaxis: { title: yAxis.key, tickfont: { size: 11, color: theme.colors.textSecondary } },\n      template: { layout: plotlyThemedLayout },\n    });\n\n    useEffect(() => {\n      setLayout((current) => {\n        const newLayout = {\n          ...current,\n          width: width || layoutWidth,\n          height: height || layoutHeight,\n          margin,\n        };\n\n        if (newLayout.xaxis) {\n          newLayout.xaxis.title = xAxis.key;\n        }\n\n        if (newLayout.yaxis) {\n          newLayout.yaxis.title = yAxis.key;\n        }\n\n        return newLayout;\n      });\n    }, [layoutWidth, layoutHeight, margin, xAxis.key, yAxis.key, width, height]);\n\n    const { setHoveredPointIndex } = useRenderRunsChartTraceHighlight(\n      containerDiv,\n      selectedRunUuid,\n      runsData,\n      highlightScatterTraces,\n    );\n\n    const hoverCallback = useCallback(\n      ({ points }: PlotMouseEvent) => {\n        // Find the corresponding run UUID by basing on \"customdata\" field set in the trace data.\n        // Plotly TS typings don't support custom fields so we need to cast to \"any\" first\n        const pointCustomDataRunUuid = (points[0] as any)?.customdata?.[0];\n        setHoveredPointIndex(points[0]?.pointIndex ?? -1);\n\n        if (pointCustomDataRunUuid) {\n          onHover?.(pointCustomDataRunUuid);\n        }\n      },\n      [onHover, setHoveredPointIndex],\n    );\n\n    const unhoverCallback = useCallback(() => {\n      onUnhover?.();\n      setHoveredPointIndex(-1);\n    }, [onUnhover, setHoveredPointIndex]);\n\n    /**\n     * Unfortunately plotly.js memorizes first onHover callback given on initial render,\n     * so in order to achieve updated behavior we need to wrap its most recent implementation\n     * in the immutable callback.\n     */\n    const mutableHoverCallback = useMutableChartHoverCallback(hoverCallback);\n\n    const legendLabelData = useMemo(() => getLegendDataFromRuns(runsData), [runsData]);\n\n    useEffect(() => {\n      const dataToExport: Data[] = plotData.map((trace: Data) => ({\n        ...trace,\n        mode: 'text+markers',\n      }));\n      onSetDownloadHandler?.(createChartImageDownloadHandler(dataToExport, layout));\n    }, [layout, onSetDownloadHandler, plotData]);\n\n    const chart = (\n      <div\n        css={[commonRunsChartStyles.chartWrapper(theme), commonRunsChartStyles.scatterChartHighlightStyles]}\n        className={className}\n        ref={setContainerDiv}\n      >\n        <LazyPlot\n          data={plotData}\n          useResizeHandler={!isDynamicSizeSupported}\n          css={commonRunsChartStyles.chart(theme)}\n          layout={layout}\n          config={PLOT_CONFIG}\n          onUpdate={onUpdate}\n          onHover={mutableHoverCallback}\n          onUnhover={unhoverCallback}\n        />\n      </div>\n    );\n\n    return <RunsMetricsLegendWrapper labelData={legendLabelData}>{chart}</RunsMetricsLegendWrapper>;\n  },\n);\n","import {\n  Button,\n  DragIcon,\n  DropdownMenu,\n  OverflowIcon,\n  Typography,\n  useDesignSystemTheme,\n  LegacyInfoTooltip,\n  FullscreenIcon,\n  Switch,\n  Spinner,\n} from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\nimport { PropsWithChildren, ReactNode, memo, useCallback, useRef } from 'react';\nimport { useDragAndDropElement } from '../../../../../common/hooks/useDragAndDropElement';\nimport {\n  shouldEnableDraggableChartsGridLayout,\n  shouldUseNewRunRowsVisibilityModel,\n} from '../../../../../common/utils/FeatureUtils';\nimport { FormattedMessage } from 'react-intl';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport type { RunsChartsCardConfig } from '../../runs-charts.types';\nimport type { ExperimentChartImageDownloadFileFormat } from '../../hooks/useChartImageDownloadHandler';\nimport { noop } from 'lodash';\n\nexport const DRAGGABLE_CARD_HANDLE_CLASS = 'drag-handle';\nexport const DRAGGABLE_CARD_TRANSITION_NAME = '--drag-transform';\nexport const DRAGGABLE_CARD_TRANSITION_VAR = `var(${DRAGGABLE_CARD_TRANSITION_NAME})`;\n\nexport enum RunsChartsChartsDragGroup {\n  PARALLEL_CHARTS_AREA = 'PARALLEL_CHARTS_AREA',\n  GENERAL_AREA = 'GENERAL_AREA',\n}\n\nexport interface RunsChartCardReorderProps {\n  onReorderWith: (draggedKey: string, targetDropKey: string) => void;\n  canMoveUp: boolean;\n  canMoveDown: boolean;\n  previousChartUuid?: string;\n  nextChartUuid?: string;\n}\n\nexport interface RunsChartCardSizeProps {\n  height?: number;\n  positionInSection?: number;\n}\n\nexport interface RunsChartCardVisibilityProps {\n  isInViewport?: boolean;\n  isInViewportDeferred?: boolean;\n}\n\nexport type RunsChartCardSetFullscreenFn = (chart: {\n  config: RunsChartsCardConfig;\n  title: string;\n  subtitle: ReactNode;\n}) => void;\n\nexport interface RunsChartCardFullScreenProps {\n  fullScreen?: boolean;\n  setFullScreenChart?: RunsChartCardSetFullscreenFn;\n}\n\nexport interface ChartCardToggleProps {\n  toggleLabel: string;\n  currentToggle: boolean;\n  setToggle: () => void;\n}\n\nexport interface ChartCardWrapperProps extends RunsChartCardReorderProps, RunsChartCardSizeProps {\n  title: React.ReactNode;\n  subtitle?: React.ReactNode;\n  onEdit: () => void;\n  onDelete: () => void;\n  tooltip?: React.ReactNode;\n  uuid?: string;\n  dragGroupKey: RunsChartsChartsDragGroup;\n  additionalMenuContent?: React.ReactNode;\n  toggleFullScreenChart?: () => void;\n  toggles?: ChartCardToggleProps[];\n  isRefreshing?: boolean;\n  onClickDownload?: (format: ExperimentChartImageDownloadFileFormat | 'csv' | 'csv-full') => void;\n  supportedDownloadFormats?: (ExperimentChartImageDownloadFileFormat | 'csv' | 'csv-full')[];\n  isHidden?: boolean;\n}\n\nexport const ChartRunsCountIndicator = memo(({ runsOrGroups }: { runsOrGroups: RunsChartsRunData[] }) => {\n  const containsGroups = runsOrGroups.some(({ groupParentInfo }) => groupParentInfo);\n  const containsRuns = runsOrGroups.some(({ runInfo }) => runInfo);\n\n  // After moving to the new run rows visibility model, we don't configure run count per chart\n  if (shouldUseNewRunRowsVisibilityModel()) {\n    return null;\n  }\n\n  return containsRuns && containsGroups ? (\n    <FormattedMessage\n      defaultMessage=\"Comparing first {count} groups and runs\"\n      values={{ count: runsOrGroups.length }}\n      description=\"Experiment page > compare runs > chart header > compared groups and runs count label\"\n    />\n  ) : containsGroups ? (\n    <FormattedMessage\n      defaultMessage=\"Comparing first {count} groups\"\n      values={{ count: runsOrGroups.length }}\n      description=\"Experiment page > compare runs > chart header > compared groups count label\"\n    />\n  ) : (\n    <FormattedMessage\n      defaultMessage=\"Comparing first {count} runs\"\n      values={{ count: runsOrGroups.length }}\n      description=\"Experiment page > compare runs > chart header > compared runs count label\"\n    />\n  );\n});\n\n/**\n * Wrapper components for all chart cards. Provides styles and adds\n * a dropdown menu with actions for configure and delete.\n */\nexport const RunsChartCardWrapperRaw = ({\n  title,\n  subtitle,\n  onDelete,\n  onEdit,\n  children,\n  uuid,\n  dragGroupKey,\n  tooltip = '',\n  onReorderWith = noop,\n  canMoveDown,\n  canMoveUp,\n  previousChartUuid,\n  nextChartUuid,\n  additionalMenuContent,\n  toggleFullScreenChart,\n  toggles,\n  supportedDownloadFormats = [],\n  onClickDownload,\n  isHidden,\n  height,\n  isRefreshing = false,\n}: PropsWithChildren<ChartCardWrapperProps>) => {\n  const { theme } = useDesignSystemTheme();\n\n  const { dragHandleRef, dragPreviewRef, dropTargetRef, isDraggingOtherGroup, isOver } = (() => {\n    // If draggable charts grid layout is enabled, don't use local drag and drop\n    // but rely on the visibility provided by props instead\n    if (shouldEnableDraggableChartsGridLayout()) {\n      return {\n        dragHandleRef: undefined,\n        dragPreviewRef: undefined,\n        dropTargetRef: undefined,\n        isDraggingOtherGroup: false,\n        isOver: false,\n      };\n    }\n    // We can safely disable the eslint rule here because flag evaluation is stable\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    return useDragAndDropElement({\n      dragGroupKey,\n      dragKey: uuid || '',\n      onDrop: onReorderWith,\n    });\n  })();\n\n  const onMoveUp = useCallback(\n    () => onReorderWith(uuid || '', previousChartUuid || ''),\n    [onReorderWith, uuid, previousChartUuid],\n  );\n  const onMoveDown = useCallback(\n    () => onReorderWith(uuid || '', nextChartUuid || ''),\n    [onReorderWith, uuid, nextChartUuid],\n  );\n\n  return (\n    <div\n      css={{\n        // Either use provided height or default to 360\n        height: shouldEnableDraggableChartsGridLayout() ? height ?? 360 : 360,\n        overflow: 'hidden',\n        display: 'grid',\n        gridTemplateRows: 'auto 1fr',\n        backgroundColor: theme.colors.backgroundPrimary,\n        padding: 12,\n        // have a slightly smaller padding when the enableDeepLearningUI\n        // flag is on to accomodate the legend in the charts\n        paddingBottom: theme.spacing.sm,\n        border: `1px solid ${theme.colors.border}`,\n        borderRadius: theme.general.borderRadiusBase,\n        transition: 'opacity 0.12s',\n        position: 'relative',\n      }}\n      style={{\n        opacity: isDraggingOtherGroup ? 0.1 : isOver ? 0.5 : 1,\n      }}\n      data-testid=\"experiment-view-compare-runs-card\"\n      ref={(element) => {\n        // Use this element for both drag preview and drop target\n        dragPreviewRef?.(element);\n        dropTargetRef?.(element);\n      }}\n    >\n      <div\n        css={{\n          display: 'flex',\n          overflow: 'hidden',\n        }}\n      >\n        <div\n          ref={dragHandleRef}\n          data-testid=\"experiment-view-compare-runs-card-drag-handle\"\n          css={{\n            marginTop: theme.spacing.xs,\n            marginRight: theme.spacing.sm,\n            cursor: 'grab',\n          }}\n          className={DRAGGABLE_CARD_HANDLE_CLASS}\n        >\n          <DragIcon />\n        </div>\n        <div css={{ overflow: 'hidden', flex: 1, flexShrink: 1 }}>\n          <Typography.Title\n            title={String(title)}\n            level={4}\n            css={{\n              marginBottom: 0,\n              overflow: 'hidden',\n              whiteSpace: 'nowrap',\n              textOverflow: 'ellipsis',\n            }}\n          >\n            {title}\n          </Typography.Title>\n          {subtitle && <span css={styles.subtitle(theme)}>{subtitle}</span>}\n          {tooltip && <LegacyInfoTooltip css={{ verticalAlign: 'middle' }} title={tooltip} />}\n        </div>\n        {isRefreshing && (\n          <div\n            css={{\n              width: theme.general.heightSm,\n              height: theme.general.heightSm,\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n            }}\n          >\n            <Spinner />\n          </div>\n        )}\n        {toggles && (\n          <div\n            css={{\n              display: 'flex',\n              padding: `0px ${theme.spacing.lg}px`,\n              gap: theme.spacing.md,\n              alignItems: 'flex-start',\n            }}\n          >\n            {toggles.map((toggle) => {\n              return (\n                <Switch\n                  componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_cards_chartcard.common.tsx_262\"\n                  key={toggle.toggleLabel}\n                  checked={toggle.currentToggle}\n                  onChange={toggle.setToggle}\n                  label={toggle.toggleLabel}\n                />\n              );\n            })}\n          </div>\n        )}\n        <Button\n          componentId=\"fullscreen_button_chartcard\"\n          icon={<FullscreenIcon />}\n          onClick={toggleFullScreenChart}\n          disabled={!toggleFullScreenChart}\n        />\n        <DropdownMenu.Root modal={false}>\n          <DropdownMenu.Trigger asChild>\n            <Button\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_cards_chartcard.common.tsx_158\"\n              type=\"tertiary\"\n              icon={<OverflowIcon />}\n              data-testid=\"experiment-view-compare-runs-card-menu\"\n            />\n          </DropdownMenu.Trigger>\n          <DropdownMenu.Content align=\"end\" minWidth={100}>\n            <DropdownMenu.Item\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_cards_chartcard.common.tsx_288\"\n              onClick={onEdit}\n              data-testid=\"experiment-view-compare-runs-card-edit\"\n            >\n              Configure\n            </DropdownMenu.Item>\n            <DropdownMenu.Item\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_cards_chartcard.common.tsx_291\"\n              onClick={onDelete}\n              data-testid=\"experiment-view-compare-runs-card-delete\"\n            >\n              Delete\n            </DropdownMenu.Item>\n            {supportedDownloadFormats.length > 0 && onClickDownload && (\n              <>\n                <DropdownMenu.Separator />\n                {supportedDownloadFormats.includes('csv') && (\n                  <DropdownMenu.Item\n                    componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_cards_chartcard.common.tsx_298\"\n                    onClick={() => onClickDownload('csv')}\n                  >\n                    <FormattedMessage\n                      defaultMessage=\"Export as CSV\"\n                      description=\"Experiment page > compare runs tab > chart header > export CSV data option\"\n                    />\n                  </DropdownMenu.Item>\n                )}\n                {supportedDownloadFormats.includes('svg') && (\n                  <DropdownMenu.Item\n                    componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_cards_chartcard.common.tsx_316\"\n                    onClick={() => onClickDownload('svg')}\n                  >\n                    <FormattedMessage\n                      defaultMessage=\"Download as SVG\"\n                      description=\"Experiment page > compare runs tab > chart header > download as SVG option\"\n                    />\n                  </DropdownMenu.Item>\n                )}\n                {supportedDownloadFormats.includes('png') && (\n                  <DropdownMenu.Item\n                    componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_cards_chartcard.common.tsx_324\"\n                    onClick={() => onClickDownload('png')}\n                  >\n                    <FormattedMessage\n                      defaultMessage=\"Download as PNG\"\n                      description=\"Experiment page > compare runs tab > chart header > download as PNG option\"\n                    />\n                  </DropdownMenu.Item>\n                )}\n              </>\n            )}\n            <DropdownMenu.Separator />\n            <DropdownMenu.Item\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_cards_chartcard.common.tsx_334\"\n              disabled={!canMoveUp}\n              onClick={onMoveUp}\n              data-testid=\"experiment-view-compare-runs-move-up\"\n            >\n              <FormattedMessage\n                defaultMessage=\"Move up\"\n                description=\"Experiment page > compare runs tab > chart header > move up option\"\n              />\n            </DropdownMenu.Item>\n            <DropdownMenu.Item\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_cards_chartcard.common.tsx_344\"\n              disabled={!canMoveDown}\n              onClick={onMoveDown}\n              data-testid=\"experiment-view-compare-runs-move-down\"\n            >\n              <FormattedMessage\n                defaultMessage=\"Move down\"\n                description=\"Experiment page > compare runs tab > chart header > move down option\"\n              />\n            </DropdownMenu.Item>\n            {additionalMenuContent}\n          </DropdownMenu.Content>\n        </DropdownMenu.Root>\n      </div>\n      {children}\n    </div>\n  );\n};\n\nconst styles = {\n  chartEntry: (theme: Theme) => ({\n    height: 360,\n    overflow: 'hidden',\n    display: 'grid',\n    gridTemplateRows: 'auto 1fr',\n    backgroundColor: theme.colors.backgroundPrimary,\n    padding: theme.spacing.md,\n    border: `1px solid ${theme.colors.border}`,\n    borderRadius: theme.general.borderRadiusBase,\n  }),\n  chartComponentWrapper: () => ({\n    overflow: 'hidden',\n  }),\n  subtitle: (theme: Theme) => ({\n    color: theme.colors.textSecondary,\n    fontSize: 11,\n    marginRight: 4,\n    verticalAlign: 'middle',\n  }),\n};\n\nexport const RunsChartCardWrapper = memo(RunsChartCardWrapperRaw);\n","import { useMemo } from 'react';\nimport type { RunsChartsRunData } from '../RunsCharts.common';\nimport { RunsMetricsBarPlot } from '../RunsMetricsBarPlot';\nimport { useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport type { RunsChartsBarCardConfig } from '../../runs-charts.types';\nimport { useIsInViewport } from '../../hooks/useIsInViewport';\nimport {\n  shouldEnableDraggableChartsGridLayout,\n  shouldUseNewRunRowsVisibilityModel,\n} from '../../../../../common/utils/FeatureUtils';\nimport {\n  RunsChartCardWrapper,\n  type RunsChartCardReorderProps,\n  RunsChartsChartsDragGroup,\n  ChartRunsCountIndicator,\n  RunsChartCardFullScreenProps,\n  RunsChartCardVisibilityProps,\n} from './ChartCard.common';\nimport { useChartImageDownloadHandler } from '../../hooks/useChartImageDownloadHandler';\nimport { downloadChartDataCsv } from '../../../experiment-page/utils/experimentPage.common-utils';\nimport { customMetricBehaviorDefs } from '../../../experiment-page/utils/customMetricBehaviorUtils';\nimport { RunsChartsNoDataFoundIndicator } from '../RunsChartsNoDataFoundIndicator';\n\nexport interface RunsChartsBarChartCardProps\n  extends RunsChartCardReorderProps,\n    RunsChartCardFullScreenProps,\n    RunsChartCardVisibilityProps {\n  config: RunsChartsBarCardConfig;\n  chartRunData: RunsChartsRunData[];\n\n  hideEmptyCharts?: boolean;\n\n  onDelete: () => void;\n  onEdit: () => void;\n}\n\nexport const barChartCardDefaultMargin = {\n  t: 24,\n  b: 48,\n  r: 0,\n  l: 4,\n  pad: 0,\n};\n\nexport const RunsChartsBarChartCard = ({\n  config,\n  chartRunData,\n  onDelete,\n  onEdit,\n  fullScreen,\n  setFullScreenChart,\n  hideEmptyCharts,\n  isInViewport: isInViewportProp,\n  ...reorderProps\n}: RunsChartsBarChartCardProps) => {\n  const usingDraggableChartsGridLayout = shouldEnableDraggableChartsGridLayout();\n\n  const toggleFullScreenChart = () => {\n    setFullScreenChart?.({\n      config,\n      title: customMetricBehaviorDefs[config.metricKey]?.displayName ?? config.metricKey,\n      subtitle: <ChartRunsCountIndicator runsOrGroups={chartRunData} />,\n    });\n  };\n\n  const slicedRuns = useMemo(() => {\n    if (shouldUseNewRunRowsVisibilityModel()) {\n      return chartRunData.filter(({ hidden, metrics }) => !hidden && metrics[config.metricKey]);\n    }\n    return chartRunData.slice(0, config.runsCountToCompare || 10).reverse();\n  }, [chartRunData, config]);\n\n  const isEmptyDataset = useMemo(() => {\n    const metricsInRuns = slicedRuns.flatMap(({ metrics }) => Object.keys(metrics));\n    return !metricsInRuns.includes(config.metricKey);\n  }, [config, slicedRuns]);\n\n  const { setTooltip, resetTooltip, selectedRunUuid } = useRunsChartsTooltip(config);\n\n  const { elementRef, isInViewport: isInViewportInternal } = useIsInViewport({\n    enabled: !usingDraggableChartsGridLayout,\n  });\n\n  // If the chart is in fullscreen mode, we always render its body.\n  // Otherwise, we only render the chart if it is in the viewport.\n  // Viewport flag is either consumed from the prop (new approach) or calculated internally (legacy).\n  const isInViewport = fullScreen || (isInViewportProp ?? isInViewportInternal);\n\n  const [imageDownloadHandler, setImageDownloadHandler] = useChartImageDownloadHandler();\n\n  const chartBody = (\n    <div\n      css={[\n        styles.barChartCardWrapper,\n        {\n          height: fullScreen ? '100%' : undefined,\n        },\n      ]}\n      ref={elementRef}\n    >\n      {isInViewport ? (\n        <RunsMetricsBarPlot\n          runsData={slicedRuns}\n          metricKey={config.metricKey}\n          displayRunNames={false}\n          displayMetricKey={false}\n          useDefaultHoverBox={false}\n          margin={barChartCardDefaultMargin}\n          onHover={setTooltip}\n          onUnhover={resetTooltip}\n          selectedRunUuid={selectedRunUuid}\n          onSetDownloadHandler={setImageDownloadHandler}\n        />\n      ) : null}\n    </div>\n  );\n\n  if (fullScreen) {\n    return chartBody;\n  }\n\n  // Do not render the card if the chart is empty and the user has enabled hiding empty charts\n  if (hideEmptyCharts && isEmptyDataset) {\n    return null;\n  }\n\n  return (\n    <RunsChartCardWrapper\n      onEdit={onEdit}\n      onDelete={onDelete}\n      title={customMetricBehaviorDefs[config.metricKey]?.displayName ?? config.metricKey}\n      subtitle={<ChartRunsCountIndicator runsOrGroups={slicedRuns} />}\n      uuid={config.uuid}\n      dragGroupKey={RunsChartsChartsDragGroup.GENERAL_AREA}\n      // Disable fullscreen button if the chart is empty\n      toggleFullScreenChart={isEmptyDataset ? undefined : toggleFullScreenChart}\n      supportedDownloadFormats={['png', 'svg', 'csv']}\n      onClickDownload={(format) => {\n        if (format === 'csv' || format === 'csv-full') {\n          const runsToExport = [...slicedRuns].reverse();\n          downloadChartDataCsv(runsToExport, [config.metricKey], [], config.metricKey);\n          return;\n        }\n        imageDownloadHandler?.(format, config.metricKey);\n      }}\n      {...reorderProps}\n    >\n      {isEmptyDataset ? <RunsChartsNoDataFoundIndicator /> : chartBody}\n    </RunsChartCardWrapper>\n  );\n};\n\nconst styles = {\n  barChartCardWrapper: {\n    overflow: 'hidden',\n  },\n};\n","import { LegacySkeleton } from '@databricks/design-system';\nimport { ReactNode, memo, useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { RunsChartsRunData, RunsChartsLineChartXAxisType, removeOutliersFromMetricHistory } from '../RunsCharts.common';\nimport { RunsMetricsLinePlot } from '../RunsMetricsLinePlot';\nimport { RunsChartsTooltipMode, useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport {\n  RunsChartsLineChartYAxisType,\n  type ChartRange,\n  type RunsChartsCardConfig,\n  type RunsChartsLineCardConfig,\n} from '../../runs-charts.types';\nimport {\n  type RunsChartCardReorderProps,\n  RunsChartCardWrapper,\n  RunsChartsChartsDragGroup,\n  ChartRunsCountIndicator,\n  RunsChartCardVisibilityProps,\n  RunsChartCardSizeProps,\n} from './ChartCard.common';\nimport { useSampledMetricHistory } from '../../hooks/useSampledMetricHistory';\nimport { compact, intersection, isEqual, isUndefined, pick, uniq } from 'lodash';\nimport { useIsInViewport } from '../../hooks/useIsInViewport';\nimport {\n  shouldEnableDeepLearningUIPhase3,\n  shouldUseNewRunRowsVisibilityModel,\n  shouldEnableRelativeTimeDateAxis,\n  shouldEnableManualRangeControls,\n  shouldEnableChartExpressions,\n  shouldEnableDraggableChartsGridLayout,\n} from '../../../../../common/utils/FeatureUtils';\nimport { findAbsoluteTimestampRangeForRelativeRange } from '../../utils/findChartStepsByTimestamp';\nimport { Figure } from 'react-plotly.js';\nimport { ReduxState } from '../../../../../redux-types';\nimport { shallowEqual, useSelector } from 'react-redux';\nimport { useCompareRunChartSelectedRange } from '../../hooks/useCompareRunChartSelectedRange';\nimport { MetricHistoryByName } from '@mlflow/mlflow/src/experiment-tracking/types';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\nimport { useGroupedChartRunData } from '../../../runs-compare/hooks/useGroupedChartRunData';\nimport {\n  ExperimentChartImageDownloadFileFormat,\n  useChartImageDownloadHandler,\n} from '../../hooks/useChartImageDownloadHandler';\nimport { downloadChartMetricHistoryCsv } from '../../../experiment-page/utils/experimentPage.common-utils';\nimport { useConfirmChartCardConfigurationFn } from '../../hooks/useRunsChartsUIConfiguration';\nimport { RunsChartsNoDataFoundIndicator } from '../RunsChartsNoDataFoundIndicator';\nimport { RunsChartsGlobalLineChartConfig } from '../../../experiment-page/models/ExperimentPageUIState';\nimport { useLineChartGlobalConfig } from '../hooks/useLineChartGlobalConfig';\n\nconst getV2ChartTitle = (cardConfig: RunsChartsLineCardConfig): string => {\n  if (shouldEnableChartExpressions() && cardConfig.yAxisKey === RunsChartsLineChartYAxisType.EXPRESSION) {\n    const expressions = cardConfig.yAxisExpressions?.map((exp) => exp.expression) || [];\n    return expressions?.join(' vs ') || '';\n  }\n  if (!cardConfig.selectedMetricKeys || cardConfig.selectedMetricKeys.length === 0) {\n    return cardConfig.metricKey;\n  }\n\n  return cardConfig.selectedMetricKeys.join(' vs ');\n};\n\nexport interface RunsChartsLineChartCardProps\n  extends RunsChartCardReorderProps,\n    RunsChartCardSizeProps,\n    RunsChartCardVisibilityProps {\n  config: RunsChartsLineCardConfig;\n  chartRunData: RunsChartsRunData[];\n\n  groupBy: RunsGroupByConfig | null;\n\n  onDelete: () => void;\n  onEdit: () => void;\n\n  fullScreen?: boolean;\n\n  autoRefreshEnabled?: boolean;\n  hideEmptyCharts?: boolean;\n\n  setFullScreenChart?: (chart: { config: RunsChartsCardConfig; title: string; subtitle: ReactNode }) => void;\n  onDownloadFullMetricHistoryCsv?: (runUuids: string[], metricKeys: string[]) => void;\n\n  globalLineChartConfig?: RunsChartsGlobalLineChartConfig;\n}\n\nconst SUPPORTED_DOWNLOAD_FORMATS: (ExperimentChartImageDownloadFileFormat | 'csv' | 'csv-full')[] = [\n  'png',\n  'svg',\n  'csv',\n  'csv-full',\n];\n\nexport const RunsChartsLineChartCard = ({\n  config,\n  chartRunData,\n  onDelete,\n  onEdit,\n  onDownloadFullMetricHistoryCsv,\n  groupBy,\n  fullScreen,\n  setFullScreenChart,\n  autoRefreshEnabled,\n  hideEmptyCharts,\n  globalLineChartConfig,\n  isInViewport: isInViewportProp,\n  isInViewportDeferred: isInViewportDeferredProp,\n  positionInSection,\n  ...reorderProps\n}: RunsChartsLineChartCardProps) => {\n  const usingMultipleRunsHoverTooltip = shouldEnableDeepLearningUIPhase3();\n  const usingManualRangeControls = shouldEnableManualRangeControls();\n  const usingDraggableChartsGridLayout = shouldEnableDraggableChartsGridLayout();\n\n  const { xAxisKey, selectedXAxisMetricKey, lineSmoothness } = useLineChartGlobalConfig(config, globalLineChartConfig);\n\n  const toggleFullScreenChart = useCallback(() => {\n    setFullScreenChart?.({\n      config,\n      title: getV2ChartTitle(config),\n      subtitle: <ChartRunsCountIndicator runsOrGroups={chartRunData} />,\n    });\n  }, [chartRunData, config, setFullScreenChart]);\n\n  const slicedRuns = useMemo(() => {\n    if (shouldUseNewRunRowsVisibilityModel()) {\n      return chartRunData.filter(({ hidden }) => !hidden).reverse();\n    }\n    return chartRunData.slice(0, config.runsCountToCompare || 10).reverse();\n  }, [chartRunData, config]);\n\n  const isGrouped = useMemo(() => slicedRuns.some((r) => r.groupParentInfo), [slicedRuns]);\n\n  const isEmptyDataset = useMemo(() => {\n    const metricKeys = config.selectedMetricKeys ?? [config.metricKey];\n    const metricsInRuns = slicedRuns.flatMap(({ metrics }) => Object.keys(metrics));\n    return intersection(metricKeys, uniq(metricsInRuns)).length === 0;\n  }, [config, slicedRuns]);\n\n  const runUuidsToFetch = useMemo(() => {\n    if (isGrouped) {\n      // First, get all runs inside visible groups\n      const runsInGroups = compact(slicedRuns.map((r) => r.groupParentInfo)).flatMap((g) => g.runUuids);\n\n      // Finally, get \"remaining\" runs that are not grouped\n      const ungroupedRuns = compact(\n        slicedRuns.filter((r) => !r.groupParentInfo && !r.belongsToGroup).map((r) => r.runInfo?.runUuid),\n      );\n      return [...runsInGroups, ...ungroupedRuns];\n    }\n    // If grouping is disabled, just get all run UUIDs from runInfo\n    return compact(slicedRuns.map((r) => r.runInfo?.runUuid));\n  }, [slicedRuns, isGrouped]);\n\n  const metricKeys = useMemo(() => {\n    const getYAxisKeys = (config: RunsChartsLineCardConfig) => {\n      const fallback = [config.metricKey];\n      if (!shouldEnableChartExpressions() || config.yAxisKey !== RunsChartsLineChartYAxisType.EXPRESSION) {\n        return config.selectedMetricKeys ?? fallback;\n      }\n      const yAxisKeys = config.yAxisExpressions?.reduce((acc, exp) => {\n        exp.variables.forEach((variable) => acc.add(variable));\n        return acc;\n      }, new Set<string>());\n      return yAxisKeys === undefined ? fallback : Array.from(yAxisKeys);\n    };\n    const yAxisKeys = getYAxisKeys(config);\n    const xAxisKeys = !selectedXAxisMetricKey ? [] : [selectedXAxisMetricKey];\n\n    return yAxisKeys.concat(xAxisKeys);\n  }, [config, selectedXAxisMetricKey]);\n\n  const { setTooltip, resetTooltip, destroyTooltip, selectedRunUuid } = useRunsChartsTooltip(\n    config,\n    usingMultipleRunsHoverTooltip ? RunsChartsTooltipMode.MultipleTracesWithScanline : RunsChartsTooltipMode.Simple,\n  );\n\n  const {\n    elementRef,\n    isInViewport: isInViewportInternal,\n    isInViewportDeferred: isInViewportDeferreed,\n  } = useIsInViewport({\n    enabled: !usingDraggableChartsGridLayout,\n  });\n\n  // If the chart is in fullscreen mode, we always render its body.\n  // Otherwise, we only render the chart if it is in the viewport.\n  // Viewport flag is either consumed from the prop (new approach) or calculated internally (legacy).\n  const isInViewport = fullScreen || (isInViewportProp ?? isInViewportInternal);\n  const isInViewportDeferred = fullScreen || (isInViewportDeferredProp ?? isInViewportDeferreed);\n\n  const { aggregateFunction } = groupBy || {};\n\n  const sampledMetricsByRunUuid = useSelector(\n    (state: ReduxState) => pick(state.entities.sampledMetricsByRunUuid, runUuidsToFetch),\n    shallowEqual,\n  );\n\n  /**\n   * We set a local state for changes because full screen and non-full screen charts are\n   * different components - this prevents having to sync them.\n   */\n  const [yRangeLocal, setYRangeLocal] = useState<[number, number] | undefined>(() => {\n    if (config.range && !isUndefined(config.range.yMin) && !isUndefined(config.range.yMax)) {\n      return [config.range.yMin, config.range.yMax];\n    }\n    return undefined;\n  });\n\n  // Memoizes last Y-axis range. Does't use stateful value, used only in the last immediate render dowstream.\n  const yRangeLegacy = useRef<[number, number] | undefined>(undefined);\n\n  const { setOffsetTimestamp, stepRange, xRangeLocal, setXRangeLocal } = useCompareRunChartSelectedRange(\n    config,\n    xAxisKey,\n    config.metricKey,\n    sampledMetricsByRunUuid,\n    runUuidsToFetch,\n    xAxisKey === RunsChartsLineChartXAxisType.STEP ? config.xAxisScaleType : 'linear',\n  );\n\n  const { resultsByRunUuid, isLoading, isRefreshing } = useSampledMetricHistory({\n    runUuids: runUuidsToFetch,\n    metricKeys,\n    enabled: isInViewportDeferred,\n    maxResults: 320,\n    range: stepRange,\n    autoRefreshEnabled,\n  });\n\n  const chartLayoutUpdated = ({ layout }: Readonly<Figure>) => {\n    // We only want to update the local state if the chart is not in full screen mode.\n    // If not, this can cause synchronization issues between the full screen and non-full screen charts.\n    if (!fullScreen) {\n      let yAxisMin = yRangeLocal?.[0];\n      let yAxisMax = yRangeLocal?.[1];\n      let xAxisMin = xRangeLocal?.[0];\n      let xAxisMax = xRangeLocal?.[1];\n\n      const { autorange: yAxisAutorange, range: newYRange } = layout.yaxis || {};\n      const yRangeChanged = !isEqual(yAxisAutorange ? [undefined, undefined] : newYRange, [yAxisMin, yAxisMax]);\n\n      if (yRangeChanged) {\n        // When user zoomed in/out or changed the Y range manually, hide the tooltip\n        destroyTooltip();\n      }\n\n      if (yAxisAutorange) {\n        yAxisMin = undefined;\n        yAxisMax = undefined;\n      } else if (newYRange) {\n        yAxisMin = newYRange[0];\n        yAxisMax = newYRange[1];\n      }\n\n      const { autorange: xAxisAutorange, range: newXRange } = layout.xaxis || {};\n      if (xAxisAutorange) {\n        // Remove saved range if chart is back to default viewport\n        xAxisMin = undefined;\n        xAxisMax = undefined;\n      } else if (newXRange) {\n        const ungroupedRunUuids = compact(slicedRuns.map(({ runInfo }) => runInfo?.runUuid));\n        const groupedRunUuids = slicedRuns.flatMap(({ groupParentInfo }) => groupParentInfo?.runUuids ?? []);\n\n        if (!shouldEnableRelativeTimeDateAxis() && xAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE) {\n          const timestampRange = findAbsoluteTimestampRangeForRelativeRange(\n            resultsByRunUuid,\n            [...ungroupedRunUuids, ...groupedRunUuids],\n            newXRange as [number, number],\n          );\n          setOffsetTimestamp([...(timestampRange as [number, number])]);\n        } else if (xAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE_HOURS) {\n          const timestampRange = findAbsoluteTimestampRangeForRelativeRange(\n            resultsByRunUuid,\n            [...ungroupedRunUuids, ...groupedRunUuids],\n            newXRange as [number, number],\n            1000 * 60 * 60, // Convert hours to milliseconds\n          );\n          setOffsetTimestamp([...(timestampRange as [number, number])]);\n        } else {\n          setOffsetTimestamp(undefined);\n        }\n        xAxisMin = newXRange[0];\n        xAxisMax = newXRange[1];\n      }\n\n      if (\n        !isEqual(\n          { xMin: xRangeLocal?.[0], xMax: xRangeLocal?.[1], yMin: yRangeLocal?.[0], yMax: yRangeLocal?.[1] },\n          { xMin: xAxisMin, xMax: xAxisMax, yMin: yAxisMin, yMax: yAxisMax },\n        )\n      ) {\n        setXRangeLocal(isUndefined(xAxisMin) || isUndefined(xAxisMax) ? undefined : [xAxisMin, xAxisMax]);\n        setYRangeLocal(isUndefined(yAxisMin) || isUndefined(yAxisMax) ? undefined : [yAxisMin, yAxisMax]);\n      }\n    }\n  };\n\n  const chartLayoutUpdatedLegacy = ({ layout }: Readonly<Figure>) => {\n    const { range: newYRange } = layout.yaxis || {};\n    const yRangeChanged = !isEqual(newYRange, yRangeLegacy.current);\n    if (yRangeChanged) {\n      // When user zoomed in/out or changed the Y range manually, hide the tooltip\n      destroyTooltip();\n    }\n\n    // Save the last Y range value (copy the values since plotly works on mutable arrays)\n    yRangeLegacy.current = [...(newYRange as [number, number])];\n\n    // Make sure that the x-axis is initialized\n    if (!layout.xaxis) {\n      return;\n    }\n    const { autorange, range: newXRange } = layout.xaxis;\n    if (autorange) {\n      // Remove saved range if chart is back to default viewport\n      setXRangeLocal(undefined);\n      return;\n    }\n    if (isEqual(newXRange, xRangeLocal)) {\n      // If it's the same as previous, do nothing.\n      // Note: we're doing deep comparison here because the range has\n      // to be cloned due to plotly handling values in mutable way.\n      return;\n    }\n    // If the custom range is used, memoize it\n    if (!autorange && newXRange) {\n      const ungroupedRunUuids = compact(slicedRuns.map(({ runInfo }) => runInfo?.runUuid));\n      const groupedRunUuids = slicedRuns.flatMap(({ groupParentInfo }) => groupParentInfo?.runUuids ?? []);\n\n      if (!shouldEnableRelativeTimeDateAxis() && xAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE) {\n        const timestampRange = findAbsoluteTimestampRangeForRelativeRange(\n          resultsByRunUuid,\n          [...ungroupedRunUuids, ...groupedRunUuids],\n          newXRange as [number, number],\n        );\n        setOffsetTimestamp([...(timestampRange as [number, number])]);\n      } else if (xAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE_HOURS) {\n        const timestampRange = findAbsoluteTimestampRangeForRelativeRange(\n          resultsByRunUuid,\n          [...ungroupedRunUuids, ...groupedRunUuids],\n          newXRange as [number, number],\n          1000 * 60 * 60, // Convert hours to milliseconds\n        );\n        setOffsetTimestamp([...(timestampRange as [number, number])]);\n      } else {\n        setOffsetTimestamp(undefined);\n      }\n      setXRangeLocal([...(newXRange as [number, number])]);\n    }\n  };\n\n  useEffect(() => {\n    destroyTooltip();\n  }, [destroyTooltip, isLoading]);\n\n  const sampledData: RunsChartsRunData[] = useMemo(\n    () =>\n      slicedRuns.map((run) => {\n        const metricsHistory = metricKeys.reduce((acc: MetricHistoryByName, key) => {\n          const history = resultsByRunUuid[run.uuid]?.[key]?.metricsHistory;\n          if (history) {\n            acc[key] = config.ignoreOutliers ? removeOutliersFromMetricHistory(history) : history;\n          }\n          return acc;\n        }, {});\n\n        return {\n          ...run,\n          metricsHistory,\n        };\n      }),\n    [metricKeys, resultsByRunUuid, slicedRuns, config.ignoreOutliers],\n  );\n\n  const sampledGroupData = useGroupedChartRunData({\n    enabled: isGrouped,\n    ungroupedRunsData: sampledData,\n    metricKeys,\n    sampledDataResultsByRunUuid: resultsByRunUuid,\n    aggregateFunction,\n    selectedXAxisMetricKey: xAxisKey === RunsChartsLineChartXAxisType.METRIC ? selectedXAxisMetricKey : undefined,\n    ignoreOutliers: config.ignoreOutliers ?? false,\n  });\n\n  // Use grouped data traces only if enabled and if there are any groups\n  const chartData = isGrouped ? sampledGroupData : sampledData;\n\n  const [imageDownloadHandler, setImageDownloadHandler] = useChartImageDownloadHandler();\n\n  // If the component is not in the viewport, we don't want to render the chart\n  const renderChartBody = isInViewport;\n\n  // If the data is loading or chart has just entered the viewport, show a skeleton\n  const renderSkeleton = isLoading || !isInViewportDeferred;\n\n  const chartBody = (\n    <div\n      css={[\n        styles.lineChartCardWrapper,\n        {\n          height: fullScreen ? '100%' : undefined,\n        },\n      ]}\n      ref={elementRef}\n    >\n      {!renderChartBody ? null : renderSkeleton ? (\n        <LegacySkeleton />\n      ) : (\n        <RunsMetricsLinePlot\n          runsData={chartData}\n          metricKey={config.metricKey}\n          selectedMetricKeys={config.selectedMetricKeys}\n          scaleType={config.scaleType}\n          xAxisKey={xAxisKey}\n          xAxisScaleType={config.xAxisScaleType}\n          yAxisKey={config.yAxisKey}\n          yAxisExpressions={config.yAxisExpressions}\n          selectedXAxisMetricKey={selectedXAxisMetricKey}\n          lineSmoothness={lineSmoothness}\n          useDefaultHoverBox={false}\n          onHover={setTooltip}\n          onUnhover={resetTooltip}\n          selectedRunUuid={selectedRunUuid}\n          onUpdate={usingManualRangeControls ? chartLayoutUpdated : chartLayoutUpdatedLegacy}\n          xRange={xRangeLocal}\n          yRange={usingManualRangeControls ? yRangeLocal : yRangeLegacy.current}\n          fullScreen={fullScreen}\n          displayPoints={config.displayPoints}\n          onSetDownloadHandler={setImageDownloadHandler}\n          positionInSection={positionInSection ?? 0}\n        />\n      )}\n    </div>\n  );\n\n  const onClickDownload = useCallback(\n    (format) => {\n      const savedChartTitle = config.selectedMetricKeys?.join('-') ?? config.metricKey;\n      if (format === 'csv-full') {\n        const singleRunUuids = compact(chartData.map((d) => d.runInfo?.runUuid));\n        const runUuidsFromGroups = compact(\n          chartData\n            .filter(({ groupParentInfo }) => groupParentInfo)\n            .flatMap((group) => group.groupParentInfo?.runUuids),\n        );\n        const runUuids = [...singleRunUuids, ...runUuidsFromGroups];\n        onDownloadFullMetricHistoryCsv?.(runUuids, config.selectedMetricKeys || [config.metricKey]);\n        return;\n      }\n      if (format === 'csv') {\n        downloadChartMetricHistoryCsv(chartData, config.selectedMetricKeys || [config.metricKey], savedChartTitle);\n        return;\n      }\n      imageDownloadHandler?.(format, savedChartTitle);\n    },\n    [chartData, config, imageDownloadHandler, onDownloadFullMetricHistoryCsv],\n  );\n\n  // Do not render the card if the chart is empty and the user has enabled hiding empty charts\n  if (hideEmptyCharts && isEmptyDataset) {\n    return null;\n  }\n\n  if (fullScreen) {\n    return chartBody;\n  }\n\n  return (\n    <RunsChartCardWrapper\n      onEdit={onEdit}\n      onDelete={onDelete}\n      title={getV2ChartTitle(config)}\n      subtitle={<ChartRunsCountIndicator runsOrGroups={slicedRuns} />}\n      uuid={config.uuid}\n      dragGroupKey={RunsChartsChartsDragGroup.GENERAL_AREA}\n      supportedDownloadFormats={SUPPORTED_DOWNLOAD_FORMATS}\n      onClickDownload={onClickDownload}\n      // Disable fullscreen button if the chart is empty\n      toggleFullScreenChart={isEmptyDataset ? undefined : toggleFullScreenChart}\n      isRefreshing={isRefreshing}\n      isHidden={!isInViewport}\n      {...reorderProps}\n    >\n      {isEmptyDataset ? <RunsChartsNoDataFoundIndicator /> : chartBody}\n    </RunsChartCardWrapper>\n  );\n};\n\nconst styles = {\n  lineChartCardWrapper: {\n    overflow: 'hidden',\n  },\n};\n","import { useMemo, useState } from 'react';\nimport { findChartStepsByTimestampForRuns } from '../utils/findChartStepsByTimestamp';\nimport { SampledMetricsByRunUuidState } from '../../../types';\nimport { isNumber, isString, isUndefined } from 'lodash';\nimport { RunsChartsLineChartXAxisType } from '../components/RunsCharts.common';\nimport { RunsChartsLineCardConfig } from '../runs-charts.types';\nimport { shouldEnableManualRangeControls } from '@mlflow/mlflow/src/common/utils/FeatureUtils';\n\n/**\n * Hook used in compare run charts. It's responsible for converting selected range\n * (which can be either step or timestamp) to step range, based on chart axis type.\n * @param config Line chart configuration\n * @param xAxisKey Can be 'step', 'time' or 'time-relative'\n * @param metricKey\n * @param sampledMetricsByRunUuid Recorded history for metrics for runs in compare chart\n * @param runUuids List of run UUIDs in compare chart\n * @param scaleType Scale type for the chart\n */\nexport const useCompareRunChartSelectedRange = (\n  config: RunsChartsLineCardConfig,\n  xAxisKey: RunsChartsLineChartXAxisType,\n  metricKey: string,\n  sampledMetricsByRunUuid: SampledMetricsByRunUuidState,\n  runUuids: string[],\n  scaleType: 'linear' | 'log' = 'linear',\n) => {\n  const [xRangeLocal, setXRangeLocal] = useState<[number | string, number | string] | undefined>(() => {\n    if (\n      shouldEnableManualRangeControls() &&\n      config.range &&\n      !isUndefined(config.range.xMin) &&\n      !isUndefined(config.range.xMax)\n    ) {\n      return [config.range.xMin, config.range.xMax];\n    }\n    return undefined;\n  });\n  const [offsetTimestamp, setOffsetTimestamp] = useState<[number, number] | undefined>(undefined);\n  const stepRange = useMemo<[number, number] | undefined>(() => {\n    if (!xRangeLocal) {\n      return undefined;\n    }\n    if (xAxisKey === RunsChartsLineChartXAxisType.TIME && isString(xRangeLocal[0]) && isString(xRangeLocal[1])) {\n      // If we're dealing with absolute time-based chart axis, find corresponding steps based on timestamp\n      const bounds = findChartStepsByTimestampForRuns(\n        sampledMetricsByRunUuid,\n        runUuids,\n        metricKey,\n        xRangeLocal as [string, string],\n      );\n      return bounds;\n    }\n\n    if (\n      xAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE &&\n      offsetTimestamp &&\n      isNumber(xRangeLocal[0]) &&\n      isNumber(xRangeLocal[1])\n    ) {\n      // If we're dealing with absolute time-based chart axis, find corresponding steps based on timestamp\n      const bounds = findChartStepsByTimestampForRuns(\n        sampledMetricsByRunUuid,\n        runUuids,\n        metricKey,\n        offsetTimestamp as [number, number],\n      );\n      return bounds;\n    }\n\n    if (xAxisKey === RunsChartsLineChartXAxisType.STEP && isNumber(xRangeLocal[0]) && isNumber(xRangeLocal[1])) {\n      // If we're dealing with step-based chart axis, use those steps but incremented/decremented\n      const lowerBound = Math.floor(scaleType === 'log' ? 10 ** xRangeLocal[0] : xRangeLocal[0]);\n      const upperBound = Math.ceil(scaleType === 'log' ? 10 ** xRangeLocal[1] : xRangeLocal[1]);\n      return lowerBound && upperBound ? [lowerBound - 1, upperBound + 1] : undefined;\n    }\n\n    // return undefined for xAxisKey === 'metric' because there isn't\n    // necessarily a mapping between value range and step range\n    return undefined;\n  }, [xAxisKey, metricKey, xRangeLocal, sampledMetricsByRunUuid, runUuids, offsetTimestamp, scaleType]);\n\n  return {\n    /**\n     * If there's an offset timestamp calculated from relative runs, set it using this function\n     */\n    setOffsetTimestamp,\n    /**\n     * Resulting step range\n     */\n    stepRange,\n    /**\n     * Local range selected by user\n     */\n    xRangeLocal,\n    /**\n     * Set selected range\n     */\n    setXRangeLocal,\n  };\n};\n","import { useMemo } from 'react';\nimport type { RunsChartsRunData } from '../RunsCharts.common';\nimport type { RunsChartsScatterCardConfig } from '../../runs-charts.types';\nimport {\n  ChartRunsCountIndicator,\n  RunsChartCardFullScreenProps,\n  RunsChartCardReorderProps,\n  RunsChartCardVisibilityProps,\n  RunsChartCardWrapper,\n  RunsChartsChartsDragGroup,\n} from './ChartCard.common';\nimport { RunsScatterPlot } from '../RunsScatterPlot';\nimport { useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport { useIsInViewport } from '../../hooks/useIsInViewport';\nimport {\n  shouldEnableDraggableChartsGridLayout,\n  shouldUseNewRunRowsVisibilityModel,\n} from '../../../../../common/utils/FeatureUtils';\nimport { useChartImageDownloadHandler } from '../../hooks/useChartImageDownloadHandler';\nimport { downloadChartDataCsv } from '../../../experiment-page/utils/experimentPage.common-utils';\nimport { intersection, uniq } from 'lodash';\nimport { RunsChartsNoDataFoundIndicator } from '../RunsChartsNoDataFoundIndicator';\n\nexport interface RunsChartsScatterChartCardProps\n  extends RunsChartCardReorderProps,\n    RunsChartCardVisibilityProps,\n    RunsChartCardFullScreenProps {\n  config: RunsChartsScatterCardConfig;\n  chartRunData: RunsChartsRunData[];\n\n  hideEmptyCharts?: boolean;\n\n  onDelete: () => void;\n  onEdit: () => void;\n}\n\nexport const RunsChartsScatterChartCard = ({\n  config,\n  chartRunData,\n  onDelete,\n  onEdit,\n  fullScreen,\n  setFullScreenChart,\n  hideEmptyCharts,\n  isInViewport: isInViewportProp,\n  ...reorderProps\n}: RunsChartsScatterChartCardProps) => {\n  const usingDraggableChartsGridLayout = shouldEnableDraggableChartsGridLayout();\n  const title = `${config.xaxis.key} vs. ${config.yaxis.key}`;\n\n  const toggleFullScreenChart = () => {\n    setFullScreenChart?.({\n      config,\n      title,\n      subtitle: <ChartRunsCountIndicator runsOrGroups={chartRunData} />,\n    });\n  };\n\n  const slicedRuns = useMemo(() => {\n    if (shouldUseNewRunRowsVisibilityModel()) {\n      return chartRunData.filter(({ hidden }) => !hidden);\n    }\n    return chartRunData.slice(0, config.runsCountToCompare || 10).reverse();\n  }, [chartRunData, config]);\n\n  const isEmptyDataset = useMemo(() => {\n    const metricKeys = [config.xaxis.key, config.yaxis.key];\n    const metricsInRuns = slicedRuns.flatMap(({ metrics }) => Object.keys(metrics));\n    return intersection(metricKeys, uniq(metricsInRuns)).length === 0;\n  }, [config, slicedRuns]);\n\n  const { setTooltip, resetTooltip, selectedRunUuid } = useRunsChartsTooltip(config);\n\n  const { elementRef, isInViewport: isInViewportInternal } = useIsInViewport({\n    enabled: !usingDraggableChartsGridLayout,\n  });\n\n  // If the chart is in fullscreen mode, we always render its body.\n  // Otherwise, we only render the chart if it is in the viewport.\n  // Viewport flag is either consumed from the prop (new approach) or calculated internally (legacy).\n  const isInViewport = fullScreen || (isInViewportProp ?? isInViewportInternal);\n\n  const [imageDownloadHandler, setImageDownloadHandler] = useChartImageDownloadHandler();\n\n  const chartBody = (\n    <div\n      css={[\n        styles.scatterChartCardWrapper,\n        {\n          height: fullScreen ? '100%' : undefined,\n        },\n      ]}\n      ref={elementRef}\n    >\n      {isInViewport ? (\n        <RunsScatterPlot\n          runsData={slicedRuns}\n          xAxis={config.xaxis}\n          yAxis={config.yaxis}\n          onHover={setTooltip}\n          onUnhover={resetTooltip}\n          useDefaultHoverBox={false}\n          selectedRunUuid={selectedRunUuid}\n          onSetDownloadHandler={setImageDownloadHandler}\n        />\n      ) : null}\n    </div>\n  );\n\n  // Do not render the card if the chart is empty and the user has enabled hiding empty charts\n  if (hideEmptyCharts && isEmptyDataset) {\n    return null;\n  }\n\n  if (fullScreen) {\n    return chartBody;\n  }\n\n  return (\n    <RunsChartCardWrapper\n      onEdit={onEdit}\n      onDelete={onDelete}\n      title={title}\n      subtitle={<ChartRunsCountIndicator runsOrGroups={slicedRuns} />}\n      uuid={config.uuid}\n      dragGroupKey={RunsChartsChartsDragGroup.GENERAL_AREA}\n      // Disable fullscreen button if the chart is empty\n      toggleFullScreenChart={isEmptyDataset ? undefined : toggleFullScreenChart}\n      supportedDownloadFormats={['png', 'svg', 'csv']}\n      onClickDownload={(format) => {\n        const savedChartTitle = [config.xaxis.key, config.yaxis.key].join('-');\n        if (format === 'csv' || format === 'csv-full') {\n          const paramsToExport = [];\n          const metricsToExport = [];\n          for (const axis of ['xaxis' as const, 'yaxis' as const]) {\n            if (config[axis].type === 'PARAM') {\n              paramsToExport.push(config[axis].key);\n            } else {\n              metricsToExport.push(config[axis].key);\n            }\n          }\n          downloadChartDataCsv(slicedRuns, metricsToExport, paramsToExport, savedChartTitle);\n          return;\n        }\n        imageDownloadHandler?.(format, savedChartTitle);\n      }}\n      {...reorderProps}\n    >\n      {isEmptyDataset ? <RunsChartsNoDataFoundIndicator /> : chartBody}\n    </RunsChartCardWrapper>\n  );\n};\n\nconst styles = {\n  scatterChartCardWrapper: {\n    overflow: 'hidden',\n  },\n};\n","import { useMemo } from 'react';\nimport type { RunsChartsRunData } from '../RunsCharts.common';\nimport type { RunsChartsContourCardConfig } from '../../runs-charts.types';\nimport {\n  ChartRunsCountIndicator,\n  RunsChartCardFullScreenProps,\n  RunsChartCardReorderProps,\n  RunsChartCardWrapper,\n  RunsChartsChartsDragGroup,\n} from './ChartCard.common';\nimport { RunsContourPlot } from '../RunsContourPlot';\nimport { useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport { shouldUseNewRunRowsVisibilityModel } from '../../../../../common/utils/FeatureUtils';\nimport { useChartImageDownloadHandler } from '../../hooks/useChartImageDownloadHandler';\nimport { downloadChartDataCsv } from '../../../experiment-page/utils/experimentPage.common-utils';\nimport { intersection, uniq } from 'lodash';\nimport { RunsChartsNoDataFoundIndicator } from '../RunsChartsNoDataFoundIndicator';\n\nexport interface RunsChartsContourChartCardProps extends RunsChartCardReorderProps, RunsChartCardFullScreenProps {\n  config: RunsChartsContourCardConfig;\n  chartRunData: RunsChartsRunData[];\n\n  hideEmptyCharts?: boolean;\n\n  onDelete: () => void;\n  onEdit: () => void;\n}\n\nexport const RunsChartsContourChartCard = ({\n  config,\n  chartRunData,\n  onDelete,\n  onEdit,\n  fullScreen,\n  setFullScreenChart,\n  hideEmptyCharts,\n  ...reorderProps\n}: RunsChartsContourChartCardProps) => {\n  const title = `${config.xaxis.key} vs. ${config.yaxis.key} vs. ${config.zaxis.key}`;\n\n  const toggleFullScreenChart = () => {\n    setFullScreenChart?.({\n      config,\n      title,\n      subtitle: <ChartRunsCountIndicator runsOrGroups={chartRunData} />,\n    });\n  };\n\n  const slicedRuns = useMemo(() => {\n    if (shouldUseNewRunRowsVisibilityModel()) {\n      return chartRunData.filter(({ hidden }) => !hidden);\n    }\n    return chartRunData.slice(0, config.runsCountToCompare || 10).reverse();\n  }, [chartRunData, config]);\n\n  const isEmptyDataset = useMemo(() => {\n    const metricKeys = [config.xaxis.key, config.yaxis.key, config.zaxis.key];\n    const metricsInRuns = slicedRuns.flatMap(({ metrics }) => Object.keys(metrics));\n    return intersection(metricKeys, uniq(metricsInRuns)).length === 0;\n  }, [config, slicedRuns]);\n\n  const { setTooltip, resetTooltip, selectedRunUuid } = useRunsChartsTooltip(config);\n\n  const [imageDownloadHandler, setImageDownloadHandler] = useChartImageDownloadHandler();\n\n  const chartBody = (\n    <div\n      css={[\n        styles.contourChartCardWrapper,\n        {\n          height: fullScreen ? '100%' : undefined,\n        },\n      ]}\n    >\n      <RunsContourPlot\n        runsData={slicedRuns}\n        xAxis={config.xaxis}\n        yAxis={config.yaxis}\n        zAxis={config.zaxis}\n        useDefaultHoverBox={false}\n        onHover={setTooltip}\n        onUnhover={resetTooltip}\n        selectedRunUuid={selectedRunUuid}\n        onSetDownloadHandler={setImageDownloadHandler}\n      />\n    </div>\n  );\n\n  // Do not render the card if the chart is empty and the user has enabled hiding empty charts\n  if (hideEmptyCharts && isEmptyDataset) {\n    return null;\n  }\n\n  if (fullScreen) {\n    return chartBody;\n  }\n\n  return (\n    <RunsChartCardWrapper\n      onEdit={onEdit}\n      onDelete={onDelete}\n      title={title}\n      subtitle={<ChartRunsCountIndicator runsOrGroups={slicedRuns} />}\n      uuid={config.uuid}\n      dragGroupKey={RunsChartsChartsDragGroup.GENERAL_AREA}\n      // Disable fullscreen button if the chart is empty\n      toggleFullScreenChart={isEmptyDataset ? undefined : toggleFullScreenChart}\n      supportedDownloadFormats={['png', 'svg', 'csv']}\n      onClickDownload={(format) => {\n        const savedChartTitle = [config.xaxis.key, config.yaxis.key, config.zaxis.key].join('-');\n        if (format === 'csv' || format === 'csv-full') {\n          const paramsToExport = [];\n          const metricsToExport = [];\n          for (const axis of ['xaxis' as const, 'yaxis' as const, 'zaxis' as const]) {\n            if (config[axis].type === 'PARAM') {\n              paramsToExport.push(config[axis].key);\n            } else {\n              metricsToExport.push(config[axis].key);\n            }\n          }\n          downloadChartDataCsv(slicedRuns, metricsToExport, paramsToExport, savedChartTitle);\n          return;\n        }\n        imageDownloadHandler?.(format, savedChartTitle);\n      }}\n      {...reorderProps}\n    >\n      {isEmptyDataset ? <RunsChartsNoDataFoundIndicator /> : chartBody}\n    </RunsChartCardWrapper>\n  );\n};\n\nconst styles = {\n  contourChartCardWrapper: {\n    overflow: 'hidden',\n  },\n};\n","var _path, _path2, _g, _defs;\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nimport * as React from \"react\";\nfunction SvgParallelChartPlaceholder(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 80,\n    height: 42,\n    viewBox: \"0 0 80 42\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1.28418 2.34094L39.4998 17.0908L76.3746 7.87216\",\n    stroke: \"#CF797B\",\n    strokeLinecap: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1.95459 20.443L40.1702 25.1361L77.045 21.1134M1.95459 36.5338L40.1702 35.1929L77.045 25.1361\",\n    stroke: \"#A88E6F\",\n    strokeLinecap: \"round\"\n  })), _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    opacity: 0.8\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1.28418 1V40.3341\",\n    stroke: \"#338ECC\",\n    strokeLinecap: \"round\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M40.6189 2.07251V39.9763\",\n    stroke: \"#338ECC\",\n    strokeLinecap: \"round\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M77.7156 2.07251V39.9763\",\n    stroke: \"url(#paint0_linear_2781_406689)\",\n    strokeWidth: 4,\n    strokeLinecap: \"square\"\n  }))), _defs || (_defs = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"linearGradient\", {\n    id: \"paint0_linear_2781_406689\",\n    x1: 78.2156,\n    y1: 2.07251,\n    x2: 78.2156,\n    y2: 39.9763,\n    gradientUnits: \"userSpaceOnUse\"\n  }, /*#__PURE__*/React.createElement(\"stop\", {\n    stopColor: \"#D04F5E\"\n  }), /*#__PURE__*/React.createElement(\"stop\", {\n    offset: 1,\n    stopColor: \"#4D9734\"\n  })))));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgParallelChartPlaceholder);\nexport default __webpack_public_path__ + \"static/media/parallel-chart-placeholder.234ef0c5b220ef2a5a6fa5bafff173f7.svg\";\nexport { ForwardRef as ReactComponent };","import { Button, DropdownMenu, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { useCallback, useMemo } from 'react';\nimport { ReactComponent as ParallelChartSvg } from '../../../../../common/static/parallel-chart-placeholder.svg';\nimport type { RunsChartsRunData } from '../RunsCharts.common';\nimport LazyParallelCoordinatesPlot from '../charts/LazyParallelCoordinatesPlot';\nimport { isParallelChartConfigured, processParallelCoordinateData } from '../../utils/parallelCoordinatesPlot.utils';\nimport { useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport type { RunsChartsParallelCardConfig } from '../../runs-charts.types';\nimport {\n  type RunsChartCardReorderProps,\n  RunsChartCardWrapper,\n  RunsChartsChartsDragGroup,\n  RunsChartCardFullScreenProps,\n  RunsChartCardVisibilityProps,\n} from './ChartCard.common';\nimport { useIsInViewport } from '../../hooks/useIsInViewport';\nimport {\n  shouldEnableDraggableChartsGridLayout,\n  shouldUseNewRunRowsVisibilityModel,\n} from '../../../../../common/utils/FeatureUtils';\nimport { FormattedMessage } from 'react-intl';\nimport { useUpdateExperimentViewUIState } from '../../../experiment-page/contexts/ExperimentPageUIStateContext';\nimport { downloadChartDataCsv } from '../../../experiment-page/utils/experimentPage.common-utils';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\nimport { RunsChartsNoDataFoundIndicator } from '../RunsChartsNoDataFoundIndicator';\n\nexport interface RunsChartsParallelChartCardProps\n  extends RunsChartCardReorderProps,\n    RunsChartCardFullScreenProps,\n    RunsChartCardVisibilityProps {\n  config: RunsChartsParallelCardConfig;\n  chartRunData: RunsChartsRunData[];\n\n  hideEmptyCharts?: boolean;\n\n  onDelete: () => void;\n  onEdit: () => void;\n  groupBy: RunsGroupByConfig | null;\n}\n\n/**\n * A placeholder component displayed before parallel coords chart is being configured by user\n */\nconst NotConfiguredParallelCoordsPlaceholder = ({ onEdit }: { onEdit: () => void }) => {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div css={{ display: 'flex', flex: 1, justifyContent: 'center', alignItems: 'center' }}>\n      <div css={{ display: 'flex', flexDirection: 'column', alignItems: 'center', maxWidth: 360 }}>\n        <ParallelChartSvg />\n        <Typography.Title css={{ marginTop: theme.spacing.md }} color=\"secondary\" level={3}>\n          <FormattedMessage\n            defaultMessage=\"Compare parameter importance\"\n            description=\"Experiment page > compare runs > parallel coordinates chart > chart not configured warning > title\"\n          />\n        </Typography.Title>\n        <Typography.Text css={{ marginBottom: theme.spacing.md }} color=\"secondary\">\n          <FormattedMessage\n            defaultMessage=\"Use the parallel coordinates chart to compare how various parameters in model affect your model metrics.\"\n            description=\"Experiment page > compare runs > parallel coordinates chart > chart not configured warning > description\"\n          />\n        </Typography.Text>\n        <Button componentId=\"mlflow.charts.parallel_coords_chart_configure_button\" type=\"primary\" onClick={onEdit}>\n          <FormattedMessage\n            defaultMessage=\"Configure chart\"\n            description=\"Experiment page > compare runs > parallel coordinates chart > configure chart button\"\n          />\n        </Button>\n      </div>\n    </div>\n  );\n};\n\n/**\n * A placeholder component displayed before parallel coords chart is being configured by user\n */\nconst UnsupportedDataPlaceholder = () => {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div css={{ display: 'flex', flex: 1, justifyContent: 'center', alignItems: 'center' }}>\n      <div css={{ display: 'flex', flexDirection: 'column', alignItems: 'center', maxWidth: 360 }}>\n        <ParallelChartSvg />\n        <Typography.Title css={{ marginTop: theme.spacing.md, textAlign: 'center' }} color=\"secondary\" level={3}>\n          <FormattedMessage\n            defaultMessage=\"Parallel coordinates chart does not support aggregated string values.\"\n            description=\"Experiment page > compare runs > parallel coordinates chart > unsupported string values warning > title\"\n          />\n        </Typography.Title>\n        <Typography.Text css={{ marginBottom: theme.spacing.md }} color=\"secondary\">\n          <FormattedMessage\n            defaultMessage=\"Use other parameters or disable run grouping to continue.\"\n            description=\"Experiment page > compare runs > parallel coordinates chart > unsupported string values warning > description\"\n          />\n        </Typography.Text>\n      </div>\n    </div>\n  );\n};\n\nexport const RunsChartsParallelChartCard = ({\n  config,\n  chartRunData,\n  onDelete,\n  onEdit,\n  groupBy,\n  fullScreen,\n  setFullScreenChart,\n  hideEmptyCharts,\n  isInViewport: isInViewportProp,\n  ...reorderProps\n}: RunsChartsParallelChartCardProps) => {\n  const updateUIState = useUpdateExperimentViewUIState();\n\n  const toggleFullScreenChart = () => {\n    setFullScreenChart?.({\n      config,\n      title: 'Parallel Coordinates',\n      subtitle: displaySubtitle ? subtitle : null,\n    });\n  };\n\n  const configuredChartRunData = useMemo(() => {\n    if (!shouldUseNewRunRowsVisibilityModel() || config?.showAllRuns) {\n      return chartRunData;\n    }\n    return chartRunData?.filter(({ hidden }) => !hidden);\n  }, [chartRunData, config?.showAllRuns]);\n\n  const containsStringValues = useMemo(\n    () =>\n      config.selectedParams?.some(\n        (paramKey) => configuredChartRunData?.some((dataTrace) => isNaN(Number(dataTrace.params[paramKey]?.value))),\n        [config.selectedParams, configuredChartRunData],\n      ),\n    [config.selectedParams, configuredChartRunData],\n  );\n\n  const updateVisibleOnlySetting = useCallback(\n    (showAllRuns: boolean) => {\n      updateUIState((state) => {\n        const newCompareRunCharts = state.compareRunCharts?.map((existingChartConfig) => {\n          if (existingChartConfig.uuid === config.uuid) {\n            const parallelChartConfig = existingChartConfig as RunsChartsParallelCardConfig;\n            return { ...parallelChartConfig, showAllRuns };\n          }\n          return existingChartConfig;\n        });\n\n        return { ...state, compareRunCharts: newCompareRunCharts };\n      });\n    },\n    [config.uuid, updateUIState],\n  );\n\n  const [isConfigured, parallelCoordsData] = useMemo(() => {\n    const configured = isParallelChartConfigured(config);\n\n    // Prepare the data in the parcoord-es format\n    const data = configured\n      ? processParallelCoordinateData(configuredChartRunData, config.selectedParams, config.selectedMetrics)\n      : [];\n\n    return [configured, data];\n  }, [config, configuredChartRunData]);\n\n  const isEmptyDataset = useMemo(() => {\n    return parallelCoordsData.length === 0;\n  }, [parallelCoordsData]);\n\n  const { elementRef, isInViewport: isInViewportInternal } = useIsInViewport({\n    enabled: !shouldEnableDraggableChartsGridLayout(),\n  });\n\n  // If the chart is in fullscreen mode, we always render its body.\n  // Otherwise, we only render the chart if it is in the viewport.\n  // Viewport flag is either consumed from the prop (new approach) or calculated internally (legacy).\n  const isInViewport = fullScreen || (isInViewportProp ?? isInViewportInternal);\n\n  const { setTooltip, resetTooltip, selectedRunUuid, closeContextMenu } = useRunsChartsTooltip(config);\n\n  const containsUnsupportedValues = containsStringValues && groupBy;\n  const displaySubtitle = isConfigured && !containsUnsupportedValues;\n\n  const subtitle = shouldUseNewRunRowsVisibilityModel() ? (\n    <>\n      {config.showAllRuns ? (\n        <FormattedMessage\n          defaultMessage=\"Showing all runs\"\n          description=\"Experiment page > compare runs > parallel chart > header > indicator for all runs shown\"\n        />\n      ) : (\n        <FormattedMessage\n          defaultMessage=\"Showing only visible runs\"\n          description=\"Experiment page > compare runs > parallel chart > header > indicator for only visible runs shown\"\n        />\n      )}\n    </>\n  ) : (\n    <>Comparing {parallelCoordsData.length} runs</>\n  );\n\n  const chartBody = (\n    <>\n      {!isConfigured ? (\n        <NotConfiguredParallelCoordsPlaceholder onEdit={onEdit} />\n      ) : containsUnsupportedValues ? (\n        <UnsupportedDataPlaceholder />\n      ) : parallelCoordsData.length === 0 ? (\n        <RunsChartsNoDataFoundIndicator />\n      ) : (\n        // Avoid displaying empty set, otherwise parcoord-es goes crazy\n        <div\n          css={[\n            styles.parallelChartCardWrapper,\n            {\n              height: fullScreen ? '100%' : undefined,\n            },\n          ]}\n          ref={elementRef}\n        >\n          {isInViewport ? (\n            <LazyParallelCoordinatesPlot\n              data={parallelCoordsData}\n              selectedParams={config.selectedParams}\n              selectedMetrics={config.selectedMetrics}\n              onHover={setTooltip}\n              onUnhover={resetTooltip}\n              axesRotateThreshold={8}\n              selectedRunUuid={selectedRunUuid}\n              closeContextMenu={closeContextMenu}\n            />\n          ) : null}\n        </div>\n      )}\n    </>\n  );\n\n  if (fullScreen) {\n    return chartBody;\n  }\n\n  // Do not render the card if the chart is empty and the user has enabled hiding empty charts\n  if (hideEmptyCharts && isEmptyDataset) {\n    return null;\n  }\n\n  const fullScreenEnabled = isConfigured && !containsUnsupportedValues && !isEmptyDataset;\n\n  return (\n    <RunsChartCardWrapper\n      onEdit={onEdit}\n      onDelete={onDelete}\n      title=\"Parallel Coordinates\"\n      subtitle={displaySubtitle ? subtitle : null}\n      uuid={config.uuid}\n      tooltip={\n        <FormattedMessage\n          defaultMessage=\"The parallel coordinates chart shows runs with columns that are either numbers or strings. If a column has string entries, the runs corresponding to the 30 most recent unique values will be shown. Only runs with all relevant metrics and/or parameters will be displayed.\"\n          description=\"Experiment page > charts > parallel coordinates chart > tooltip explaining what data is expected to be rendered\"\n        />\n      }\n      dragGroupKey={RunsChartsChartsDragGroup.PARALLEL_CHARTS_AREA}\n      // Disable fullscreen button if the chart is empty\n      toggleFullScreenChart={fullScreenEnabled ? toggleFullScreenChart : undefined}\n      additionalMenuContent={\n        shouldUseNewRunRowsVisibilityModel() ? (\n          <>\n            <DropdownMenu.Separator />\n            <DropdownMenu.CheckboxItem\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_cards_runschartsparallelchartcard.tsx_293\"\n              checked={!config.showAllRuns}\n              onClick={() => updateVisibleOnlySetting(false)}\n            >\n              <DropdownMenu.ItemIndicator />\n              <FormattedMessage\n                defaultMessage=\"Show only visible\"\n                description=\"Experiment page > compare runs tab > chart header > move down option\"\n              />\n            </DropdownMenu.CheckboxItem>\n            <DropdownMenu.CheckboxItem\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_cards_runschartsparallelchartcard.tsx_300\"\n              checked={config.showAllRuns}\n              onClick={() => updateVisibleOnlySetting(true)}\n            >\n              <DropdownMenu.ItemIndicator />\n              <FormattedMessage\n                defaultMessage=\"Show all runs\"\n                description=\"Experiment page > compare runs tab > chart header > move down option\"\n              />\n            </DropdownMenu.CheckboxItem>\n          </>\n        ) : null\n      }\n      supportedDownloadFormats={['csv']}\n      onClickDownload={(format) => {\n        const savedChartTitle = [...config.selectedMetrics, ...config.selectedParams].join('-');\n\n        if (format === 'csv') {\n          downloadChartDataCsv(configuredChartRunData, config.selectedMetrics, config.selectedParams, savedChartTitle);\n        }\n      }}\n      {...reorderProps}\n    >\n      {chartBody}\n    </RunsChartCardWrapper>\n  );\n};\n\nconst styles = {\n  parallelChartCardWrapper: {\n    // Set \"display: flex\" here (and \"flex: 1\" in the child element)\n    // so the chart will grow in width and height\n    display: 'flex',\n    overflow: 'hidden',\n    cursor: 'pointer',\n  },\n};\n","import { Button, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { useCallback, useMemo } from 'react';\nimport type { RunsChartsRunData } from '../RunsCharts.common';\nimport {\n  DISABLED_GROUP_WHEN_GROUPBY,\n  DifferenceCardConfigCompareGroup,\n  type RunsChartsCardConfig,\n  type RunsChartsDifferenceCardConfig,\n} from '../../runs-charts.types';\nimport {\n  type RunsChartCardReorderProps,\n  RunsChartCardWrapper,\n  RunsChartsChartsDragGroup,\n  RunsChartCardFullScreenProps,\n  ChartRunsCountIndicator,\n} from './ChartCard.common';\nimport {\n  shouldEnableNewDifferenceViewCharts,\n  shouldUseNewRunRowsVisibilityModel,\n} from '../../../../../common/utils/FeatureUtils';\nimport { DifferenceViewPlot } from '../charts/DifferenceViewPlot';\nimport { useConfirmChartCardConfigurationFn } from '../../hooks/useRunsChartsUIConfiguration';\nimport { useIntl, FormattedMessage } from 'react-intl';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\nimport { DifferenceViewPlotV2 } from '../charts/DifferenceViewPlotV2';\n\nexport interface RunsChartsDifferenceChartCardProps extends RunsChartCardReorderProps, RunsChartCardFullScreenProps {\n  config: RunsChartsDifferenceCardConfig;\n  chartRunData: RunsChartsRunData[];\n\n  hideEmptyCharts?: boolean;\n\n  onDelete: () => void;\n  onEdit: () => void;\n  groupBy: RunsGroupByConfig | null;\n}\n\n/**\n * A placeholder component displayed before runs difference chart is being configured by user\n */\nconst NotConfiguredDifferenceChartPlaceholder = ({ onEdit }: { onEdit: () => void }) => {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div css={{ display: 'flex', flex: 1, justifyContent: 'center', alignItems: 'center' }}>\n      <div css={{ display: 'flex', flexDirection: 'column', alignItems: 'center', maxWidth: 360 }}>\n        <Typography.Title css={{ marginTop: theme.spacing.md }} color=\"secondary\" level={3}>\n          <FormattedMessage\n            defaultMessage=\"Compare runs\"\n            description=\"Experiment tracking > runs charts > cards > RunsChartsDifferenceChartCard > chart not configured warning > title\"\n          />\n        </Typography.Title>\n        <Typography.Text css={{ marginBottom: theme.spacing.md }} color=\"secondary\">\n          <FormattedMessage\n            defaultMessage=\"Use the runs difference view to compare model and system metrics, parameters, attributes,\n            and tags across runs.\"\n            description=\"Experiment tracking > runs charts > cards > RunsChartsDifferenceChartCard > chart not configured warning > description\"\n          />\n        </Typography.Text>\n        <Button componentId=\"mlflow.charts.difference_chart_configure_button\" type=\"primary\" onClick={onEdit}>\n          <FormattedMessage\n            defaultMessage=\"Configure chart\"\n            description=\"Experiment tracking > runs charts > cards > RunsChartsDifferenceChartCard > configure chart button\"\n          />\n        </Button>\n      </div>\n    </div>\n  );\n};\n\nexport const RunsChartsDifferenceChartCard = ({\n  config,\n  chartRunData,\n  onDelete,\n  onEdit,\n  groupBy,\n  fullScreen,\n  setFullScreenChart,\n  hideEmptyCharts,\n  ...reorderProps\n}: RunsChartsDifferenceChartCardProps) => {\n  const toggleFullScreenChart = () => {\n    setFullScreenChart?.({\n      config,\n      title: config.chartName,\n      subtitle: <ChartRunsCountIndicator runsOrGroups={chartRunData} />,\n    });\n  };\n\n  const [isConfigured, slicedRuns] = useMemo(() => {\n    const configured = Boolean(config.compareGroups?.length);\n    if (shouldUseNewRunRowsVisibilityModel()) {\n      return [configured, chartRunData.filter(({ hidden }) => !hidden).reverse()];\n    }\n    return [configured, chartRunData.slice(0, config.runsCountToCompare || 10).reverse()];\n  }, [chartRunData, config]);\n\n  const isEmptyDataset = useMemo(() => {\n    return !isConfigured;\n  }, [isConfigured]);\n\n  const confirmChartCardConfiguration = useConfirmChartCardConfigurationFn();\n\n  const setCardConfig = (setter: (current: RunsChartsCardConfig) => RunsChartsDifferenceCardConfig) => {\n    confirmChartCardConfiguration(setter(config));\n  };\n\n  const showChangeFromBaselineToggle = useCallback(() => {\n    confirmChartCardConfiguration({\n      ...config,\n      showChangeFromBaseline: !config.showChangeFromBaseline,\n    } as RunsChartsCardConfig);\n  }, [config, confirmChartCardConfiguration]);\n\n  const showDifferencesOnlyToggle = useCallback(() => {\n    confirmChartCardConfiguration({\n      ...config,\n      showDifferencesOnly: !config.showDifferencesOnly,\n    } as RunsChartsCardConfig);\n  }, [config, confirmChartCardConfiguration]);\n\n  const { formatMessage } = useIntl();\n\n  const chartBody = (\n    <>\n      {!isConfigured ? (\n        <NotConfiguredDifferenceChartPlaceholder onEdit={onEdit} />\n      ) : shouldEnableNewDifferenceViewCharts() ? (\n        <DifferenceViewPlotV2\n          previewData={slicedRuns}\n          groupBy={groupBy}\n          cardConfig={config}\n          setCardConfig={setCardConfig}\n        />\n      ) : (\n        <DifferenceViewPlot\n          previewData={slicedRuns}\n          groupBy={groupBy}\n          cardConfig={config}\n          setCardConfig={setCardConfig}\n        />\n      )}\n    </>\n  );\n  let showTooltip = undefined;\n  if (groupBy && DISABLED_GROUP_WHEN_GROUPBY.some((group) => config.compareGroups.includes(group))) {\n    showTooltip = formatMessage({\n      defaultMessage: 'Disable grouped runs to compare parameters, tag, or attributes',\n      description:\n        'Experiment tracking > runs charts > cards > RunsChartsDifferenceChartCard > disable group runs tooltip message',\n    });\n  }\n  if (fullScreen) {\n    return chartBody;\n  }\n\n  // Do not render the card if the chart is empty and the user has enabled hiding empty charts\n  if (hideEmptyCharts && isEmptyDataset) {\n    return null;\n  }\n\n  return (\n    <RunsChartCardWrapper\n      onEdit={onEdit}\n      onDelete={onDelete}\n      title={config.chartName}\n      subtitle={<ChartRunsCountIndicator runsOrGroups={slicedRuns} />}\n      uuid={config.uuid}\n      dragGroupKey={RunsChartsChartsDragGroup.GENERAL_AREA}\n      toggleFullScreenChart={toggleFullScreenChart}\n      toggles={[\n        {\n          toggleLabel: formatMessage({\n            defaultMessage: 'Show change from baseline',\n            description:\n              'Runs charts > components > cards > RunsChartsDifferenceChartCard > Show change from baseline toggle label',\n          }),\n          currentToggle: config.showChangeFromBaseline,\n          setToggle: showChangeFromBaselineToggle,\n        },\n        {\n          toggleLabel: formatMessage({\n            defaultMessage: 'Show differences only',\n            description:\n              'Runs charts > components > cards > RunsChartsDifferenceChartCard > Show differences only toggle label',\n          }),\n          currentToggle: config.showDifferencesOnly,\n          setToggle: showDifferencesOnlyToggle,\n        },\n      ]}\n      tooltip={showTooltip}\n      {...reorderProps}\n    >\n      {chartBody}\n    </RunsChartCardWrapper>\n  );\n};\n","import { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport type { RunsChartsRunData } from '../RunsCharts.common';\nimport {\n  type RunsChartCardReorderProps,\n  RunsChartCardWrapper,\n  RunsChartsChartsDragGroup,\n  RunsChartCardFullScreenProps,\n  ChartRunsCountIndicator,\n} from './ChartCard.common';\nimport { shouldUseNewRunRowsVisibilityModel } from '../../../../../common/utils/FeatureUtils';\nimport { DifferenceViewPlot } from '../charts/DifferenceViewPlot';\nimport { useConfirmChartCardConfigurationFn } from '../../hooks/useRunsChartsUIConfiguration';\nimport { useIntl, FormattedMessage } from 'react-intl';\nimport { RunsChartsCardConfig, RunsChartsImageCardConfig } from '../../runs-charts.types';\nimport { ImageGridPlot } from '../charts/ImageGridPlot';\nimport { useDesignSystemTheme } from '@databricks/design-system';\nimport { useImageSliderStepMarks } from '../../hooks/useImageSliderStepMarks';\nimport {\n  DEFAULT_IMAGE_GRID_CHART_NAME,\n  LOG_IMAGE_TAG_INDICATOR,\n  NUM_RUNS_TO_SUPPORT_FOR_LOG_IMAGE,\n} from '@mlflow/mlflow/src/experiment-tracking/constants';\nimport { LineSmoothSlider } from '@mlflow/mlflow/src/experiment-tracking/components/LineSmoothSlider';\nimport { RunsGroupByConfig } from '@mlflow/mlflow/src/experiment-tracking/components/experiment-page/utils/experimentPage.group-row-utils';\n\nexport interface RunsChartsImageChartCardProps extends RunsChartCardReorderProps, RunsChartCardFullScreenProps {\n  config: RunsChartsImageCardConfig;\n  chartRunData: RunsChartsRunData[];\n\n  onDelete: () => void;\n  onEdit: () => void;\n  groupBy: RunsGroupByConfig | null;\n}\n\nexport const RunsChartsImageChartCard = ({\n  config,\n  chartRunData,\n  onDelete,\n  onEdit,\n  groupBy,\n  fullScreen,\n  setFullScreenChart,\n  ...reorderProps\n}: RunsChartsImageChartCardProps) => {\n  const { theme } = useDesignSystemTheme();\n  const containerRef = useRef(null);\n  const [containerWidth, setContainerWidth] = useState(0);\n\n  useEffect(() => {\n    const resizeObserver = new ResizeObserver((entries) => {\n      setContainerWidth(entries[0].contentRect.width);\n    });\n    if (containerRef.current) {\n      resizeObserver.observe(containerRef.current);\n    }\n    return () => {\n      resizeObserver.disconnect();\n    };\n  }, [containerRef]);\n\n  // Optimizations for smoother slider experience. Maintain a local copy of config, and update\n  // the global state only after the user has finished dragging the slider.\n  const [tmpConfig, setTmpConfig] = useState(config);\n  const confirmChartCardConfiguration = useConfirmChartCardConfigurationFn();\n  const updateStep = useCallback(\n    (step: number) => {\n      confirmChartCardConfiguration({ ...config, step } as RunsChartsImageCardConfig);\n    },\n    [config, confirmChartCardConfiguration],\n  );\n  const tmpStepChange = (step: number) => {\n    setTmpConfig((conf) => ({ ...conf, step }));\n  };\n\n  const chartName = config.imageKeys.length === 1 ? config.imageKeys[0] : DEFAULT_IMAGE_GRID_CHART_NAME;\n\n  const toggleFullScreenChart = () => {\n    setFullScreenChart?.({\n      config,\n      title: chartName,\n      subtitle: <ChartRunsCountIndicator runsOrGroups={chartRunData} />,\n    });\n  };\n\n  const slicedRuns = useMemo(() => {\n    if (shouldUseNewRunRowsVisibilityModel()) {\n      return chartRunData.filter(({ hidden }) => !hidden).reverse();\n    }\n    return chartRunData.slice(0, config.runsCountToCompare || 10).reverse();\n  }, [chartRunData, config]);\n\n  const setCardConfig = (setter: (current: RunsChartsCardConfig) => RunsChartsImageCardConfig) => {\n    confirmChartCardConfiguration(setter(config));\n  };\n\n  const { stepMarks, maxMark, minMark } = useImageSliderStepMarks({\n    data: slicedRuns,\n    selectedImageKeys: config.imageKeys || [],\n  });\n\n  const stepMarkLength = Object.keys(stepMarks).length;\n\n  useEffect(() => {\n    // If there is only one step mark, set the step to the min mark\n    if (stepMarkLength === 1 && tmpConfig.step !== minMark) {\n      updateStep(minMark);\n    }\n  }, [minMark, stepMarkLength, tmpConfig.step, updateStep]);\n\n  const shouldDisplayImageLimitIndicator =\n    slicedRuns.filter((run) => {\n      return run.tags[LOG_IMAGE_TAG_INDICATOR];\n    }).length > NUM_RUNS_TO_SUPPORT_FOR_LOG_IMAGE;\n\n  const chartBody = (\n    <div\n      css={{\n        display: 'flex',\n        flexDirection: 'column',\n        height: fullScreen ? '100%' : undefined,\n        width: '100%',\n        overflow: 'auto',\n      }}\n    >\n      <div\n        ref={containerRef}\n        css={{\n          cursor: 'pointer',\n          height: `calc(100% - ${theme.spacing.md * 2}px)`,\n          overflow: 'auto',\n        }}\n      >\n        <ImageGridPlot\n          previewData={slicedRuns}\n          groupBy={groupBy}\n          cardConfig={tmpConfig}\n          setCardConfig={setCardConfig}\n          containerWidth={containerWidth}\n        />\n      </div>\n      <div\n        css={{\n          justifyContent: 'center',\n          alignItems: 'center',\n          display: 'inline-flex',\n          gap: theme.spacing.md,\n        }}\n      >\n        <div css={{ width: '350px' }}>\n          <LineSmoothSlider\n            defaultValue={tmpConfig.step}\n            onChange={tmpStepChange}\n            max={maxMark}\n            min={minMark}\n            marks={stepMarks}\n            step={null}\n            disabled={Object.keys(stepMarks).length <= 1}\n            onAfterChange={updateStep}\n          />\n        </div>\n      </div>\n    </div>\n  );\n\n  if (fullScreen) {\n    return chartBody;\n  }\n\n  return (\n    <RunsChartCardWrapper\n      onEdit={onEdit}\n      onDelete={onDelete}\n      title={chartName}\n      subtitle={\n        shouldDisplayImageLimitIndicator && `Displaying images from first ${NUM_RUNS_TO_SUPPORT_FOR_LOG_IMAGE} runs`\n      }\n      uuid={config.uuid}\n      dragGroupKey={RunsChartsChartsDragGroup.GENERAL_AREA}\n      toggleFullScreenChart={toggleFullScreenChart}\n      {...reorderProps}\n    >\n      {chartBody}\n    </RunsChartCardWrapper>\n  );\n};\n","import { useMemo, memo } from 'react';\nimport { RunsChartType } from '../../runs-charts.types';\nimport type {\n  RunsChartsBarCardConfig,\n  RunsChartsCardConfig,\n  RunsChartsContourCardConfig,\n  RunsChartsDifferenceCardConfig,\n  RunsChartsImageCardConfig,\n  RunsChartsLineCardConfig,\n  RunsChartsParallelCardConfig,\n  RunsChartsScatterCardConfig,\n} from '../../runs-charts.types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport {\n  shouldEnableDraggableChartsGridLayout,\n  shouldEnableDifferenceViewCharts,\n  shouldEnableImageGridCharts,\n  shouldUseNewRunRowsVisibilityModel,\n} from '../../../../../common/utils/FeatureUtils';\nimport { RunsChartsBarChartCard } from './RunsChartsBarChartCard';\nimport { RunsChartsLineChartCard } from './RunsChartsLineChartCard';\nimport { RunsChartsScatterChartCard } from './RunsChartsScatterChartCard';\nimport { RunsChartsContourChartCard } from './RunsChartsContourChartCard';\nimport { RunsChartsParallelChartCard } from './RunsChartsParallelChartCard';\nimport type {\n  RunsChartCardFullScreenProps,\n  RunsChartCardReorderProps,\n  RunsChartCardSizeProps,\n  RunsChartCardVisibilityProps,\n} from './ChartCard.common';\nimport { RunsChartsDifferenceChartCard } from './RunsChartsDifferenceChartCard';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\nimport { RunsChartsImageChartCard } from './RunsChartsImageChartCard';\nimport { RunsChartsGlobalLineChartConfig } from '../../../experiment-page/models/ExperimentPageUIState';\n\nexport interface RunsChartsCardProps\n  extends RunsChartCardReorderProps,\n    RunsChartCardFullScreenProps,\n    RunsChartCardVisibilityProps,\n    RunsChartCardSizeProps {\n  cardConfig: RunsChartsCardConfig;\n  chartRunData: RunsChartsRunData[];\n  onStartEditChart: (chart: RunsChartsCardConfig) => void;\n  onRemoveChart: (chart: RunsChartsCardConfig) => void;\n  onDownloadFullMetricHistoryCsv?: (runUuids: string[], metricKeys: string[]) => void;\n  index: number;\n  sectionIndex?: number;\n  autoRefreshEnabled?: boolean;\n  hideEmptyCharts?: boolean;\n  groupBy: RunsGroupByConfig | null;\n  globalLineChartConfig?: RunsChartsGlobalLineChartConfig;\n}\n\nconst RunsChartsCardRaw = ({\n  cardConfig,\n  chartRunData,\n  index,\n  sectionIndex,\n  onStartEditChart,\n  onRemoveChart,\n  setFullScreenChart,\n  groupBy,\n  fullScreen,\n  canMoveDown,\n  canMoveUp,\n  previousChartUuid,\n  nextChartUuid,\n  onReorderWith,\n  autoRefreshEnabled,\n  onDownloadFullMetricHistoryCsv,\n  hideEmptyCharts,\n  globalLineChartConfig,\n  height,\n  isInViewport,\n  isInViewportDeferred,\n}: RunsChartsCardProps) => {\n  const usingGridLayout = shouldEnableDraggableChartsGridLayout();\n  const chartElementKey = `${cardConfig.uuid}-${index}-${sectionIndex}`;\n\n  const reorderProps = useMemo(\n    () => ({\n      onReorderWith,\n      canMoveDown,\n      canMoveUp,\n      previousChartUuid,\n      nextChartUuid,\n    }),\n    [onReorderWith, canMoveDown, canMoveUp, previousChartUuid, nextChartUuid],\n  );\n\n  const editProps = useMemo(\n    () => ({\n      onEdit: () => onStartEditChart(cardConfig),\n      onDelete: () => onRemoveChart(cardConfig),\n      setFullScreenChart,\n    }),\n    [onStartEditChart, onRemoveChart, setFullScreenChart, cardConfig],\n  );\n\n  const commonChartProps = useMemo(\n    () => ({\n      fullScreen,\n      key: usingGridLayout ? undefined : chartElementKey,\n      autoRefreshEnabled,\n      groupBy,\n      hideEmptyCharts,\n      height,\n      isInViewport,\n      isInViewportDeferred,\n      ...editProps,\n      ...reorderProps,\n    }),\n    [\n      fullScreen,\n      usingGridLayout,\n      chartElementKey,\n      autoRefreshEnabled,\n      groupBy,\n      editProps,\n      reorderProps,\n      hideEmptyCharts,\n      height,\n      isInViewport,\n      isInViewportDeferred,\n    ],\n  );\n\n  const slicedRuns = useMemo(() => {\n    if (shouldUseNewRunRowsVisibilityModel()) {\n      return chartRunData.filter(({ hidden }) => !hidden).reverse();\n    }\n    return chartRunData.slice(0, cardConfig.runsCountToCompare || 10).reverse();\n  }, [chartRunData, cardConfig.runsCountToCompare]);\n\n  if (cardConfig.type === RunsChartType.PARALLEL) {\n    return (\n      <RunsChartsParallelChartCard\n        config={cardConfig as RunsChartsParallelCardConfig}\n        chartRunData={chartRunData}\n        {...commonChartProps}\n      />\n    );\n  }\n\n  if (shouldEnableDifferenceViewCharts() && cardConfig.type === RunsChartType.DIFFERENCE) {\n    return (\n      <RunsChartsDifferenceChartCard\n        config={cardConfig as RunsChartsDifferenceCardConfig}\n        chartRunData={chartRunData}\n        {...commonChartProps}\n      />\n    );\n  }\n\n  if (shouldEnableImageGridCharts() && cardConfig.type === RunsChartType.IMAGE) {\n    return (\n      <RunsChartsImageChartCard\n        config={cardConfig as RunsChartsImageCardConfig}\n        chartRunData={chartRunData}\n        {...commonChartProps}\n      />\n    );\n  }\n\n  if (cardConfig.type === RunsChartType.BAR) {\n    return (\n      <RunsChartsBarChartCard\n        config={cardConfig as RunsChartsBarCardConfig}\n        chartRunData={slicedRuns}\n        {...commonChartProps}\n      />\n    );\n  } else if (cardConfig.type === RunsChartType.LINE) {\n    return (\n      <RunsChartsLineChartCard\n        config={cardConfig as RunsChartsLineCardConfig}\n        chartRunData={slicedRuns}\n        onDownloadFullMetricHistoryCsv={onDownloadFullMetricHistoryCsv}\n        globalLineChartConfig={globalLineChartConfig}\n        positionInSection={index}\n        {...commonChartProps}\n      />\n    );\n  } else if (cardConfig.type === RunsChartType.SCATTER) {\n    return (\n      <RunsChartsScatterChartCard\n        config={cardConfig as RunsChartsScatterCardConfig}\n        chartRunData={slicedRuns}\n        {...commonChartProps}\n      />\n    );\n  } else if (cardConfig.type === RunsChartType.CONTOUR) {\n    return (\n      <RunsChartsContourChartCard\n        config={cardConfig as RunsChartsContourCardConfig}\n        chartRunData={slicedRuns}\n        {...commonChartProps}\n      />\n    );\n  }\n  return null;\n};\n\nexport const RunsChartsCard = memo(RunsChartsCardRaw);\n","import { ExperimentRunsSelectorResult } from '@mlflow/mlflow/src/experiment-tracking/components/experiment-page/utils/experimentRuns.selector';\nimport {\n  DifferenceCardAttributes,\n  DifferenceCardConfigCompareGroup,\n  RunsChartsCardConfig,\n  RunsChartsDifferenceCardConfig,\n} from '../../runs-charts.types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { ReactChild, ReactFragment, ReactPortal, useCallback, useMemo, useState } from 'react';\nimport { MLFLOW_SYSTEM_METRIC_PREFIX } from '@mlflow/mlflow/src/experiment-tracking/constants';\nimport { ColumnDef, flexRender, getCoreRowModel, useReactTable } from '@tanstack/react-table';\nimport {\n  Table,\n  TableCell,\n  TableHeader,\n  TableRow,\n  useDesignSystemTheme,\n  Typography,\n  Tag,\n  LegacyTooltip,\n} from '@databricks/design-system';\nimport { RunColorPill } from '@mlflow/mlflow/src/experiment-tracking/components/experiment-page/components/RunColorPill';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { MetricEntitiesByName } from '@mlflow/mlflow/src/experiment-tracking/types';\nimport {\n  differenceView,\n  getDifferenceViewDataGroups,\n  getDifferenceChartDisplayedValue,\n} from '../../utils/differenceView';\nimport { OverflowIcon, Button, DropdownMenu } from '@databricks/design-system';\nimport Utils from '@mlflow/mlflow/src/common/utils/Utils';\nimport { TableSkeletonRows } from '@databricks/design-system';\nimport { ArrowUpIcon } from '@databricks/design-system';\nimport { ArrowDownIcon } from '@databricks/design-system';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\n\nconst HEADING_COLUMN_ID = 'headingColumn';\nconst COLUMN_WIDTH = 200;\n\n/**\n * A placeholder component displayed when no difference view data is available to be displayed\n */\n\nconst NoDifferenceDataPlaceholder = () => {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div css={{ display: 'flex', flex: 1, justifyContent: 'center', alignItems: 'center' }}>\n      <div css={{ display: 'flex', flexDirection: 'column', alignItems: 'center', maxWidth: 360 }}>\n        <Typography.Title css={{ marginTop: theme.spacing.md, textAlign: 'center' }} color=\"secondary\" level={3}>\n          <FormattedMessage\n            defaultMessage=\"No run differences to display\"\n            description=\"Experiment tracking > runs charts > charts > DifferenceViewPlot > no runs to display warning > title\"\n          />\n        </Typography.Title>\n        <Typography.Text css={{ marginBottom: theme.spacing.md, textAlign: 'center' }} color=\"secondary\">\n          <FormattedMessage\n            defaultMessage=\"Select other runs, toggle 'Show differences only', or re-configure the chart to compare model metrics, system metrics, parameters, tag, or attributes.\"\n            description=\"Experiment tracking > runs charts > charts > DifferenceViewPlot > no runs to display warning > text\"\n          />\n        </Typography.Text>\n      </div>\n    </div>\n  );\n};\n\nexport const DifferenceViewPlot = ({\n  previewData,\n  cardConfig,\n  groupBy,\n  setCardConfig,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsDifferenceCardConfig;\n  groupBy: RunsGroupByConfig | null;\n  setCardConfig?: (setter: (current: RunsChartsCardConfig) => RunsChartsDifferenceCardConfig) => void;\n}) => {\n  const { formatMessage } = useIntl();\n  const { theme } = useDesignSystemTheme();\n\n  const { modelMetrics, systemMetrics, parameters, tags, attributes } = useMemo(\n    () => getDifferenceViewDataGroups(previewData, cardConfig, HEADING_COLUMN_ID, groupBy),\n    [previewData, cardConfig, groupBy],\n  );\n  // Each metric/param is a row in the table\n  const getData = [\n    ...(cardConfig.compareGroups.includes(DifferenceCardConfigCompareGroup.MODEL_METRICS) ? modelMetrics : []),\n    ...(cardConfig.compareGroups.includes(DifferenceCardConfigCompareGroup.SYSTEM_METRICS) ? systemMetrics : []),\n    ...(cardConfig.compareGroups.includes(DifferenceCardConfigCompareGroup.PARAMETERS) ? parameters : []),\n    ...(cardConfig.compareGroups.includes(DifferenceCardConfigCompareGroup.ATTRIBUTES) ? attributes : []),\n    ...(cardConfig.compareGroups.includes(DifferenceCardConfigCompareGroup.TAGS) ? tags : []),\n  ];\n\n  const { baselineColumn, nonBaselineColumns } = useMemo(() => {\n    // baseline column (can be undefined if no baseline selected)\n    let baselineColumn = previewData.find((runData) => runData.uuid === cardConfig.baselineColumnUuid);\n    if (baselineColumn === undefined && previewData.length > 0) {\n      // Set the first column as baseline column\n      baselineColumn = previewData[0];\n    }\n    // non-baseline columns\n    const nonBaselineColumns = previewData.filter(\n      (runData) => baselineColumn === undefined || runData.uuid !== baselineColumn.uuid,\n    );\n\n    return { baselineColumn, nonBaselineColumns };\n  }, [previewData, cardConfig.baselineColumnUuid]);\n\n  // Split columns into baseline/non-baseline\n  const getColumns = useMemo(() => {\n    const convertRunToColumnInfo = (runData: RunsChartsRunData, isBaseline: boolean) => {\n      const accessorFn = (row: Record<string, string | number>) => {\n        return {\n          text: row[runData.uuid],\n          difference: baselineColumn ? differenceView(row[runData.uuid], row[baselineColumn.uuid])?.label : null,\n        };\n      };\n\n      const baselineAccessorFn = (row: Record<string, string | number>) => {\n        return row[runData.uuid];\n      };\n      if (isBaseline) {\n        return {\n          id: runData.uuid,\n          header: () => {\n            return (\n              <span css={{ display: 'flex', flexDirection: 'row', justifyContent: 'space-between' }}>\n                <span css={{ display: 'inline-flex', gap: theme.spacing.sm, alignItems: 'center' }}>\n                  <RunColorPill color={runData.color} />\n                  {runData.displayName}\n                  <Tag\n                    componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_charts_differenceviewplot.tsx_132\"\n                    css={{ margin: 0 }}\n                  >\n                    <FormattedMessage\n                      defaultMessage=\"baseline\"\n                      description=\"Runs charts > components > charts > DifferenceViewPlot > baseline tag\"\n                    />\n                  </Tag>\n                </span>\n              </span>\n            );\n          },\n          size: COLUMN_WIDTH,\n          accessorFn: baselineAccessorFn,\n          cell: (row: any) => <span>{getDifferenceChartDisplayedValue(row.getValue())}</span>,\n        };\n      }\n      return {\n        id: runData.uuid,\n        header: () => {\n          return (\n            <span css={{ display: 'flex', flexDirection: 'row', justifyContent: 'space-between' }}>\n              <span css={{ display: 'inline-flex', gap: theme.spacing.sm, alignItems: 'center' }}>\n                <RunColorPill color={runData.color} />\n                {runData.displayName}\n              </span>\n            </span>\n          );\n        },\n        size: COLUMN_WIDTH,\n        accessorFn: accessorFn,\n        cell: (row: any) => (\n          <span css={{ display: 'inline-flex', gap: theme.spacing.md, verticalAlign: 'middle' }}>\n            <Typography.Text>{getDifferenceChartDisplayedValue(row.getValue().text)}</Typography.Text>\n            {baselineColumn &&\n              cardConfig.showChangeFromBaseline &&\n              row.getValue().difference &&\n              (row.getValue().difference[0] === '-' ? (\n                <div css={{ display: 'inline-flex', gap: theme.spacing.xs }}>\n                  <Typography.Paragraph color=\"error\">{row.getValue().difference}</Typography.Paragraph>\n                  <ArrowDownIcon color=\"danger\" />\n                </div>\n              ) : (\n                <div css={{ display: 'inline-flex', gap: theme.spacing.xs }}>\n                  <Typography.Paragraph color=\"success\">{row.getValue().difference}</Typography.Paragraph>\n                  <ArrowUpIcon color=\"success\" />\n                </div>\n              ))}\n          </span>\n        ),\n      };\n    };\n\n    return [\n      {\n        id: HEADING_COLUMN_ID,\n        header: formatMessage({\n          defaultMessage: 'Compare by',\n          description: 'Runs charts > components > charts > DifferenceViewPlot > Compare by column heading',\n        }),\n        accessorKey: HEADING_COLUMN_ID,\n        size: COLUMN_WIDTH,\n      },\n      ...(baselineColumn ? [convertRunToColumnInfo(baselineColumn, true)] : []),\n      ...nonBaselineColumns.map((runData) => convertRunToColumnInfo(runData, false)),\n    ];\n  }, [theme.spacing, formatMessage, baselineColumn, nonBaselineColumns, cardConfig.showChangeFromBaseline]);\n\n  const table = useReactTable({\n    data: getData,\n    columns: getColumns,\n    enableColumnResizing: true,\n    columnResizeMode: 'onChange',\n    getCoreRowModel: getCoreRowModel(),\n  });\n\n  const updateBaselineColumnUuid = useCallback(\n    (baselineColumnUuid: string) => {\n      if (setCardConfig) {\n        setCardConfig((current) => ({\n          ...(current as RunsChartsDifferenceCardConfig),\n          baselineColumnUuid,\n        }));\n      }\n    },\n    [setCardConfig],\n  );\n\n  if (previewData.length === 0) {\n    return null;\n  }\n\n  if (table.getRowModel().rows.length === 0) {\n    return <NoDifferenceDataPlaceholder />;\n  }\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        overflow: 'auto hidden',\n        cursor: 'pointer',\n        height: undefined,\n        width: '100%',\n      }}\n    >\n      <div css={{ width: '100%' }}>\n        <Table style={{ width: table.getTotalSize() }} scrollable>\n          {table.getHeaderGroups().map((headerGroup) => (\n            <TableRow key={headerGroup.id} isHeader>\n              {headerGroup.headers.map((header, index) => {\n                return (\n                  <TableHeader\n                    componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_charts_differenceviewplot.tsx_248\"\n                    key={header.id}\n                    style={{\n                      maxWidth: header.column.getSize(),\n                    }}\n                    resizable={header.column.getCanResize()}\n                    resizeHandler={header.getResizeHandler()}\n                  >\n                    <div\n                      css={{\n                        display: 'flex',\n                        flexDirection: 'row',\n                        gap: theme.spacing.xs,\n                        alignItems: 'center',\n                      }}\n                    >\n                      <div css={{ flexShrink: 1, flexGrow: 1, overflow: 'hidden' }}>\n                        {flexRender(header.column.columnDef.header, header.getContext())}\n                      </div>\n                      {index !== 0 && setCardConfig && (\n                        <div>\n                          <DropdownMenu.Root>\n                            <DropdownMenu.Trigger asChild>\n                              <Button componentId=\"set_as_baseline_button\" icon={<OverflowIcon />} />\n                            </DropdownMenu.Trigger>\n                            <DropdownMenu.Content>\n                              <DropdownMenu.Item\n                                componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_charts_differenceviewplot.tsx_271\"\n                                onClick={() => updateBaselineColumnUuid(header.id)}\n                              >\n                                <FormattedMessage\n                                  defaultMessage=\"Set as baseline\"\n                                  description=\"Runs charts > components > charts > DifferenceViewPlot > Set as baseline dropdown option\"\n                                />\n                              </DropdownMenu.Item>\n                            </DropdownMenu.Content>\n                          </DropdownMenu.Root>\n                        </div>\n                      )}\n                    </div>\n                  </TableHeader>\n                );\n              })}\n            </TableRow>\n          ))}\n          {table.getRowModel().rows.map((row) => (\n            <TableRow key={row.id}>\n              {row.getAllCells().map((cell) => (\n                <TableCell key={cell.id} style={{ maxWidth: cell.column.getSize() }} multiline>\n                  {flexRender(cell.column.columnDef.cell, cell.getContext())}\n                </TableCell>\n              ))}\n            </TableRow>\n          ))}\n        </Table>\n      </div>\n    </div>\n  );\n};\n","/**\n * Difference view plot implemented with AntD. Has additional requested features.\n */\n\nimport {\n  DifferenceCardConfigCompareGroup,\n  RunsChartsCardConfig,\n  RunsChartsDifferenceCardConfig,\n} from '../../runs-charts.types';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport {\n  ArrowDownIcon,\n  ArrowUpIcon,\n  Button,\n  ChevronDownIcon,\n  ChevronRightIcon,\n  DashIcon,\n  DropdownMenu,\n  OverflowIcon,\n  Tag,\n  Typography,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport { ReactNode, useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport {\n  DifferenceChartCellDirection,\n  differenceView,\n  getDifferenceViewDataGroups,\n  getDifferenceChartDisplayedValue,\n  DIFFERENCE_CHART_DEFAULT_EMPTY_VALUE,\n} from '../../utils/differenceView';\n/**\n * We are using the antd Table component temporarily because it has accordions features built in while dubois does not.\n * We plan to deprecate and convert to dubois table when it is ready and supports nested accordions.\n */\nimport { Table } from 'antd';\n\nimport { RunColorPill } from '../../../experiment-page/components/RunColorPill';\nimport { Resizable, ResizableProps } from 'react-resizable';\nimport { useElementHeight } from '@mlflow/mlflow/src/common/utils/useElementHeight';\n\nconst HEADING_COLUMN_ID = 'headingColumn';\nconst DEFAULT_COLUMN_WIDTH = 200;\n\nconst ResizableTitle = (\n  props: { width: number; onResize: ResizableProps['onResize'] } & React.ThHTMLAttributes<HTMLTableCellElement>,\n) => {\n  const { onResize, width, ...restProps } = props;\n  if (!width) {\n    return <th {...restProps} />;\n  }\n\n  return (\n    <Resizable\n      width={width}\n      height={0}\n      handle={\n        <span\n          css={{\n            position: 'absolute',\n            right: '-5px',\n            bottom: '0',\n            zIndex: '1',\n            width: '10px',\n            height: '100%',\n            cursor: 'col-resize',\n          }}\n          onClick={(e) => {\n            e.stopPropagation();\n          }}\n        />\n      }\n      onResize={onResize}\n      draggableOpts={{ enableUserSelectHack: false }}\n      css={{\n        '.react-resizable': {\n          position: 'relative',\n          backgroundClip: 'padding-box',\n        },\n      }}\n    >\n      <th {...restProps} />\n    </Resizable>\n  );\n};\n\ninterface RecordType {\n  children: ReactNode;\n}\n\nconst customExpandIcon = (props: {\n  record: RecordType;\n  expanded: boolean;\n  onExpand: (record: RecordType, e: React.MouseEvent<HTMLElement>) => void;\n}) => {\n  if (!props.record.children) {\n    // These custom padding is required to align the expand icon with the content\n    return <div style={{ padding: '1px 14px', float: 'left' }} />;\n  }\n  return (\n    <span>\n      <Button\n        icon={props.expanded ? <ChevronDownIcon /> : <ChevronRightIcon />}\n        onClick={(e) => {\n          props.onExpand(props.record, e);\n        }}\n        componentId=\"mlflow.charts.difference_chart_expand_button\"\n        // The margin is required to align the expand icon in the button\n        style={{ float: 'left', margin: '-2px 4px -2px 0px' }}\n        size=\"small\"\n      />\n    </span>\n  );\n};\n\n/**\n * Transforms an array of objects into a format suitable for rendering in a table.\n * Each object in the array represents a row in the table.\n * If all values in a row are JSON objects with the same keys, the row is transformed into a parent row with child rows.\n * Each child row represents a key-value pair from the JSON objects.\n * If a value in a row is not a JSON object or the JSON objects don't have the same keys, the row is not transformed.\n *\n * @param data - An array of objects. Each object represents a row in the table.\n * @returns An array of objects. Each object represents a row or a parent row with child rows in the table.\n */\nconst getJSONRows = (data: { [key: string]: string | number }[]) => {\n  const validateParseJSON = (value: string) => {\n    try {\n      const parsed = JSON.parse(value);\n      if (parsed === null || typeof parsed !== 'object' || Array.isArray(parsed) || Object.keys(parsed).length === 0) {\n        return null;\n      }\n      return parsed;\n    } catch (e) {\n      return null;\n    }\n  };\n\n  const extractMaximumCommonSchema = (schema1: Record<any, any> | undefined, schema2: Record<any, any> | undefined) => {\n    if (schema1 !== undefined && Object.keys(schema1).length === 0) {\n      // This may not be a suitable object, return null\n      return null;\n    } else if (schema2 !== undefined && Object.keys(schema2).length === 0) {\n      return null;\n    }\n\n    const schema: Record<string, unknown> = {};\n\n    const collectKeys = (target: Record<any, any>, source: Record<any, any>) => {\n      for (const key in source) {\n        if (!target.hasOwnProperty(key) || target[key]) {\n          if (typeof source[key] === 'object' && source[key] !== null && !Array.isArray(source[key])) {\n            target[key] = target[key] || {};\n            collectKeys(target[key], source[key]);\n          } else if (source[key] === DIFFERENCE_CHART_DEFAULT_EMPTY_VALUE) {\n            target[key] = true;\n          } else {\n            target[key] = false;\n          }\n        }\n      }\n    };\n\n    schema1 !== undefined && collectKeys(schema, schema1);\n    schema2 !== undefined && collectKeys(schema, schema2);\n\n    return schema;\n  };\n\n  const getChildren = (\n    parsedRowWithoutHeadingCol: { [key: string]: Record<any, any> | undefined },\n    schema: Record<any, any>,\n  ): Record<string, any>[] => {\n    return Object.keys(schema).map((key) => {\n      if (typeof schema[key] === 'boolean') {\n        let result = {\n          key: key,\n          [HEADING_COLUMN_ID]: key,\n        };\n        Object.keys(parsedRowWithoutHeadingCol).forEach((runUuid) => {\n          const value = parsedRowWithoutHeadingCol[runUuid]?.[key];\n          result = {\n            ...result,\n            [runUuid]: value === undefined ? DIFFERENCE_CHART_DEFAULT_EMPTY_VALUE : value,\n          };\n        });\n        return result;\n      }\n      // Recurse\n      const newParsedRow: { [key: string]: Record<any, any> | undefined } = {};\n      Object.keys(parsedRowWithoutHeadingCol).forEach((runUuid) => {\n        newParsedRow[runUuid] = parsedRowWithoutHeadingCol[runUuid]?.[key];\n      });\n\n      return {\n        key: key,\n        [HEADING_COLUMN_ID]: key,\n        children: getChildren(newParsedRow, schema[key]),\n      };\n    });\n  };\n\n  const isAllElementsJSON = (row: { [key: string]: string | number }) => {\n    let jsonSchema: Record<any, any> | undefined = undefined;\n    let isAllJson = true;\n    const parsedRow: Record<string, any> = {};\n\n    Object.keys(row).forEach((runUuid) => {\n      if (runUuid !== HEADING_COLUMN_ID) {\n        if (row[runUuid] !== DIFFERENCE_CHART_DEFAULT_EMPTY_VALUE) {\n          const json = validateParseJSON(row[runUuid] as string);\n          parsedRow[runUuid] = json;\n          if (json === null) {\n            isAllJson = false;\n          } else {\n            const commonSchema = extractMaximumCommonSchema(jsonSchema, json);\n            if (commonSchema === null) {\n              isAllJson = false;\n            } else {\n              jsonSchema = commonSchema;\n            }\n          }\n        }\n      }\n    });\n    if (isAllJson && jsonSchema !== undefined) {\n      try {\n        return {\n          [HEADING_COLUMN_ID]: row[HEADING_COLUMN_ID],\n          children: getChildren(parsedRow, jsonSchema),\n          key: row[HEADING_COLUMN_ID],\n        };\n      } catch {\n        return row;\n      }\n    } else {\n      return row;\n    }\n  };\n  return data.map(isAllElementsJSON);\n};\n\nconst getTableBodyHeight = (tableHeight: number | undefined) => {\n  if (!tableHeight) return 0;\n  const headerHeight = 40;\n  return tableHeight - headerHeight;\n};\n\nconst antdTableComponents = {\n  header: {\n    cell: ResizableTitle,\n  },\n};\n\nexport const CellDifference = ({ label, direction }: { label: string; direction: DifferenceChartCellDirection }) => {\n  const { theme } = useDesignSystemTheme();\n  let paragraphColor = undefined;\n  let icon = null;\n  switch (direction) {\n    case DifferenceChartCellDirection.NEGATIVE:\n      paragraphColor = 'error';\n      icon = <ArrowDownIcon color=\"danger\" data-testid=\"negative-cell-direction\" />;\n      break;\n    case DifferenceChartCellDirection.POSITIVE:\n      paragraphColor = 'success';\n      icon = <ArrowUpIcon color=\"success\" data-testid=\"positive-cell-direction\" />;\n      break;\n    case DifferenceChartCellDirection.SAME:\n      paragraphColor = 'info';\n      icon = <DashIcon css={{ color: theme.colors.textSecondary }} data-testid=\"same-cell-direction\" />;\n      break;\n    default:\n      break;\n  }\n\n  return (\n    <div css={{ display: 'inline-flex', gap: theme.spacing.xs, alignItems: 'center' }}>\n      <Typography.Paragraph color={paragraphColor} css={{ margin: 0 }}>\n        {label}\n      </Typography.Paragraph>\n      {icon}\n    </div>\n  );\n};\n\nexport const DifferenceViewPlotV2 = ({\n  previewData,\n  cardConfig,\n  groupBy,\n  setCardConfig,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsDifferenceCardConfig;\n  groupBy: RunsGroupByConfig | null;\n  setCardConfig?: (setter: (current: RunsChartsCardConfig) => RunsChartsDifferenceCardConfig) => void;\n}) => {\n  const { formatMessage } = useIntl();\n  const { theme } = useDesignSystemTheme();\n\n  const { observeHeight, elementHeight } = useElementHeight();\n\n  const { modelMetrics, systemMetrics, parameters, tags, attributes } = useMemo(\n    () => getDifferenceViewDataGroups(previewData, cardConfig, HEADING_COLUMN_ID, groupBy),\n    [previewData, cardConfig, groupBy],\n  );\n\n  // Add one length due to the heading column\n  const [columnWidths, setColumnWidths] = useState(() => Array(previewData.length + 1).fill(DEFAULT_COLUMN_WIDTH));\n\n  useEffect(() => {\n    setColumnWidths(Array(previewData.length + 1).fill(DEFAULT_COLUMN_WIDTH));\n  }, [previewData.length]);\n\n  const { baselineColumn, nonBaselineColumns } = useMemo(() => {\n    // baseline column (can be undefined if no baseline selected)\n    let baselineColumn = previewData.find((runData) => runData.uuid === cardConfig.baselineColumnUuid);\n    if (baselineColumn === undefined && previewData.length > 0) {\n      // Set the first column as baseline column\n      baselineColumn = previewData[0];\n    }\n    // non-baseline columns\n    const nonBaselineColumns = previewData.filter(\n      (runData) => baselineColumn === undefined || runData.uuid !== baselineColumn.uuid,\n    );\n    return { baselineColumn, nonBaselineColumns };\n  }, [previewData, cardConfig.baselineColumnUuid]);\n\n  const updateBaselineColumnUuid = useCallback(\n    (baselineColumnUuid: string) => {\n      if (setCardConfig) {\n        setCardConfig((current) => ({\n          ...(current as RunsChartsDifferenceCardConfig),\n          baselineColumnUuid,\n        }));\n      }\n    },\n    [setCardConfig],\n  );\n\n  // Group each column by 5 groups\n\n  const dataSource = cardConfig.compareGroups.reduce((acc: any[], group: DifferenceCardConfigCompareGroup) => {\n    switch (group) {\n      case DifferenceCardConfigCompareGroup.MODEL_METRICS:\n        acc.push({\n          [HEADING_COLUMN_ID]: formatMessage({\n            defaultMessage: `Model Metrics`,\n            description:\n              'Experiment tracking > runs charts > cards > RunsChartsDifferenceChartCard > model metrics heading',\n          }),\n          children: [...modelMetrics],\n          key: 'modelMetrics',\n        });\n        break;\n      case DifferenceCardConfigCompareGroup.SYSTEM_METRICS:\n        acc.push({\n          [HEADING_COLUMN_ID]: formatMessage({\n            defaultMessage: `System Metrics`,\n            description:\n              'Experiment tracking > runs charts > cards > RunsChartsDifferenceChartCard > system metrics heading',\n          }),\n          children: [...systemMetrics],\n          key: 'systemMetrics',\n        });\n        break;\n      case DifferenceCardConfigCompareGroup.PARAMETERS:\n        acc.push({\n          [HEADING_COLUMN_ID]: formatMessage({\n            defaultMessage: `Parameters`,\n            description:\n              'Experiment tracking > runs charts > cards > RunsChartsDifferenceChartCard > parameters heading',\n          }),\n          children: getJSONRows(parameters),\n          key: 'parameters',\n        });\n        break;\n      case DifferenceCardConfigCompareGroup.ATTRIBUTES:\n        acc.push({\n          [HEADING_COLUMN_ID]: formatMessage({\n            defaultMessage: `Attributes`,\n            description:\n              'Experiment tracking > runs charts > cards > RunsChartsDifferenceChartCard > attributes heading',\n          }),\n          children: [...attributes],\n          key: 'attributes',\n        });\n        break;\n      case DifferenceCardConfigCompareGroup.TAGS:\n        acc.push({\n          [HEADING_COLUMN_ID]: formatMessage({\n            defaultMessage: `Tags`,\n            description: 'Experiment tracking > runs charts > cards > RunsChartsDifferenceChartCard > tags heading',\n          }),\n          children: [...tags],\n          key: 'tags',\n        });\n        break;\n    }\n    return acc;\n  }, []);\n\n  const columns = useMemo(() => {\n    const handleResize =\n      (index: number) =>\n      (_: any, { size }: any) => {\n        setColumnWidths((current) => {\n          const next = [...current];\n          next[index] = size.width;\n          return next;\n        });\n      };\n\n    const convertRunToColumnInfo = (runData: RunsChartsRunData, isBaseline: boolean, index: number) => {\n      return {\n        key: runData.uuid,\n        dataIndex: runData.uuid,\n        title: (\n          <span css={{ display: 'flex', flexDirection: 'row', justifyContent: 'space-between' }}>\n            <span css={{ display: 'inline-flex', gap: theme.spacing.sm, alignItems: 'center' }}>\n              <RunColorPill color={runData.color} />\n              {runData.displayName}\n              {isBaseline && (\n                <Tag\n                  componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_charts_differenceviewplotv2.tsx_427\"\n                  css={{ margin: 0 }}\n                >\n                  <FormattedMessage\n                    defaultMessage=\"baseline\"\n                    description=\"Runs charts > components > charts > DifferenceViewPlot > baseline tag\"\n                  />\n                </Tag>\n              )}\n            </span>\n          </span>\n        ),\n        render: (value: string | number, record: any) => {\n          if (isBaseline) {\n            return getDifferenceChartDisplayedValue(value);\n          }\n          if (value === undefined) {\n            return null;\n          }\n          const rowDifference = baselineColumn ? differenceView(value, record[baselineColumn.uuid]) : null;\n          return (\n            <span css={{ display: 'inline-flex', gap: theme.spacing.md, verticalAlign: 'middle' }}>\n              <Typography.Text>{getDifferenceChartDisplayedValue(value)}</Typography.Text>\n              {baselineColumn && cardConfig.showChangeFromBaseline && rowDifference && (\n                <CellDifference label={rowDifference.label} direction={rowDifference.direction} />\n              )}\n            </span>\n          );\n        },\n        ellipsis: true,\n        width: columnWidths[index],\n        onHeaderCell: (column: any) => ({\n          width: column.width,\n          onResize: handleResize(index),\n          style: { background: 'transparent' },\n        }),\n        filterIcon: (\n          <DropdownMenu.Root>\n            <DropdownMenu.Trigger asChild>\n              <OverflowIcon />\n            </DropdownMenu.Trigger>\n            <DropdownMenu.Content>\n              <DropdownMenu.Item\n                componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_charts_differenceviewplotv2.tsx_467\"\n                onClick={() => updateBaselineColumnUuid(runData.uuid)}\n              >\n                <FormattedMessage\n                  defaultMessage=\"Set as baseline\"\n                  description=\"Runs charts > components > charts > DifferenceViewPlot > Set as baseline dropdown option\"\n                />\n              </DropdownMenu.Item>\n            </DropdownMenu.Content>\n          </DropdownMenu.Root>\n        ),\n        // This is needed to let the filter iconshow up.\n        filterDropdown: () => null,\n      };\n    };\n\n    return [\n      {\n        dataIndex: HEADING_COLUMN_ID,\n        title: formatMessage({\n          defaultMessage: 'Compare by',\n          description: 'Runs charts > components > charts > DifferenceViewPlot > Compare by column heading',\n        }),\n        key: HEADING_COLUMN_ID,\n        ellipsis: true,\n        fixed: true,\n        width: columnWidths[0],\n        onHeaderCell: (column: any) => ({\n          width: column.width,\n          onResize: handleResize(0),\n          style: { background: 'white' }, // White is needed to block other columns when scrolling\n        }),\n      },\n      ...(baselineColumn ? [convertRunToColumnInfo(baselineColumn, true, 1)] : []),\n      ...nonBaselineColumns.map((runData, index) => convertRunToColumnInfo(runData, false, index + 2)),\n    ];\n  }, [\n    theme.spacing,\n    formatMessage,\n    baselineColumn,\n    nonBaselineColumns,\n    cardConfig.showChangeFromBaseline,\n    columnWidths,\n    setColumnWidths,\n    updateBaselineColumnUuid,\n  ]);\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        overflow: 'auto hidden',\n        cursor: 'pointer',\n        height: '100%',\n        width: '100%',\n      }}\n      ref={observeHeight}\n    >\n      <Table\n        components={antdTableComponents}\n        size=\"small\"\n        columns={columns}\n        dataSource={dataSource}\n        scroll={{ y: getTableBodyHeight(elementHeight) }}\n        pagination={false}\n        expandable={{\n          expandIcon: customExpandIcon,\n          defaultExpandAllRows: true,\n          indentSize: 15,\n        }}\n        sticky\n      />\n    </div>\n  );\n};\n","import { ImageIcon } from '@databricks/design-system';\nimport { GenericSkeleton, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from 'react-intl';\nimport { getArtifactLocationUrl } from '@mlflow/mlflow/src/common/utils/ArtifactUtils';\nimport { ImageEntity } from '@mlflow/mlflow/src/experiment-tracking/types';\nimport { useState } from 'react';\nimport { Typography } from '@databricks/design-system';\nimport { ImagePreviewGroup, Image } from '../../../../../shared/building_blocks/Image';\n\nexport const MAX_IMAGE_SIZE = 225;\nexport const MIN_IMAGE_SIZE = 120;\nexport const IMAGE_GAP_SIZE = 10;\n\nexport const getImageSize = (numImages: number, width: number) => {\n  // Scale image size based on number of images\n  const maxImagesPerRow = Math.floor(width / MIN_IMAGE_SIZE);\n  if (numImages < maxImagesPerRow) {\n    return Math.min(width / numImages - IMAGE_GAP_SIZE, MAX_IMAGE_SIZE);\n  }\n  return width / maxImagesPerRow - IMAGE_GAP_SIZE;\n};\n\ntype ImagePlotProps = {\n  imageUrl: string;\n  compressedImageUrl: string;\n  imageSize?: number;\n  maxImageSize?: number;\n};\n\nexport const ImagePlot = ({ imageUrl, compressedImageUrl, imageSize, maxImageSize }: ImagePlotProps) => {\n  const [previewVisible, setPreviewVisible] = useState(false);\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div css={{ width: imageSize, height: imageSize || '100%' }}>\n      <div css={{ height: imageSize || '100%' }}>\n        {compressedImageUrl === undefined ? (\n          <GenericSkeleton label=\"Loading...\" css={{ height: imageSize, width: imageSize }} />\n        ) : (\n          <div\n            css={{\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              width: imageSize || '100%',\n              height: imageSize || '100%',\n              maxWidth: maxImageSize,\n              maxHeight: maxImageSize,\n              backgroundColor: theme.colors.backgroundSecondary,\n              '& .ant-image': {\n                height: '100%',\n                display: 'flex',\n                alignItems: 'center',\n              },\n            }}\n          >\n            <ImagePreviewGroup visible={previewVisible} onVisibleChange={setPreviewVisible}>\n              <Image\n                src={compressedImageUrl}\n                preview={{ src: imageUrl }}\n                style={{ maxWidth: maxImageSize || '100%', maxHeight: maxImageSize || '100%' }}\n              />\n            </ImagePreviewGroup>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport const ImagePlotWithHistory = ({\n  metadataByStep,\n  imageSize,\n  step,\n  runUuid,\n}: {\n  metadataByStep: Record<number, ImageEntity>;\n  imageSize?: number;\n  step: number;\n  runUuid: string;\n}) => {\n  const { theme } = useDesignSystemTheme();\n\n  if (metadataByStep[step] === undefined) {\n    return (\n      <div\n        css={{\n          display: 'flex',\n          flexDirection: 'column',\n          alignItems: 'center',\n          justifyContent: 'center',\n          textAlign: 'center',\n          width: imageSize,\n          height: imageSize,\n          backgroundColor: theme.colors.backgroundSecondary,\n          padding: theme.spacing.md,\n        }}\n      >\n        <ImageIcon />\n        <FormattedMessage\n          defaultMessage=\"No image logged at this step\"\n          description=\"Experiment tracking > runs charts > charts > image plot with history > no image text\"\n        />\n      </div>\n    );\n  }\n  return (\n    <ImagePlot\n      imageUrl={getArtifactLocationUrl(metadataByStep[step].filepath, runUuid)}\n      compressedImageUrl={getArtifactLocationUrl(metadataByStep[step].compressed_filepath, runUuid)}\n      imageSize={imageSize}\n    />\n  );\n};\n\nexport const EmptyImageGridPlot = () => {\n  return (\n    <div\n      css={{\n        display: 'flex',\n        flexDirection: 'column',\n        justifyContent: 'center',\n        alignItems: 'center',\n        height: '100%',\n        width: '100%',\n        fontSize: 16,\n      }}\n    >\n      <Typography.Title css={{ marginTop: 16 }} color=\"secondary\" level={3}>\n        Compare logged images\n      </Typography.Title>\n      <Typography.Text css={{ marginBottom: 16 }} color=\"secondary\">\n        Use the image grid chart to compare logged images across runs.\n      </Typography.Text>\n    </div>\n  );\n};\n","import { LegacyTooltip, useDesignSystemTheme } from '@databricks/design-system';\nimport { RunColorPill } from '@mlflow/mlflow/src/experiment-tracking/components/experiment-page/components/RunColorPill';\nimport { useMemo } from 'react';\nimport { RunsChartsImageCardConfig, RunsChartsCardConfig } from '../../runs-charts.types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { EmptyImageGridPlot, IMAGE_GAP_SIZE, ImagePlotWithHistory, getImageSize } from './ImageGridPlot.common';\nimport { ImageEntity } from '@mlflow/mlflow/src/experiment-tracking/types';\n\nexport const ImageGridSingleKeyPlot = ({\n  previewData,\n  cardConfig,\n  width,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsImageCardConfig;\n  groupBy?: string;\n  setCardConfig?: (setter: (current: RunsChartsCardConfig) => RunsChartsImageCardConfig) => void;\n  width: number;\n}) => {\n  const { theme } = useDesignSystemTheme();\n\n  const displayRuns = previewData.filter((run: RunsChartsRunData) => {\n    const imageMetadata = run.images[cardConfig.imageKeys[0]];\n    return imageMetadata && Object.keys(imageMetadata).length > 0;\n  });\n\n  const imageSize = useMemo(() => {\n    return getImageSize(displayRuns.length, width);\n  }, [displayRuns, width]);\n\n  if (displayRuns.length === 0) {\n    return <EmptyImageGridPlot />;\n  }\n  return (\n    <div css={{ display: 'flex', justifyContent: 'flex-start', flexWrap: 'wrap' }}>\n      {displayRuns.map((run: RunsChartsRunData) => {\n        // There is exactly one key in this plot\n        const imageMetadataByStep = Object.values(run.images[cardConfig.imageKeys[0]]).reduce(\n          (acc, metadata: ImageEntity) => {\n            if (metadata.step !== undefined) {\n              acc[metadata.step] = metadata;\n            }\n            return acc;\n          },\n          {} as Record<number, ImageEntity>,\n        );\n        return (\n          <div key={run.uuid} css={{ padding: `${IMAGE_GAP_SIZE / 2}px` }}>\n            <LegacyTooltip title={run.displayName}>\n              <div\n                css={{\n                  width: imageSize,\n                  height: theme.typography.lineHeightMd,\n                  overflow: 'hidden',\n                  whiteSpace: 'nowrap',\n                  display: 'inline-flex',\n                  alignItems: 'center',\n                  gap: theme.spacing.sm,\n                }}\n              >\n                <RunColorPill color={run.color} />\n                {run.displayName}\n              </div>\n            </LegacyTooltip>\n            <ImagePlotWithHistory\n              key={run.uuid}\n              step={cardConfig.step}\n              metadataByStep={imageMetadataByStep}\n              imageSize={imageSize}\n              runUuid={run.uuid}\n            />\n          </div>\n        );\n      })}\n    </div>\n  );\n};\n","import {\n  useDesignSystemTheme,\n  TableRow,\n  TableHeader,\n  TableCell,\n  Table,\n  LegacyTooltip,\n  Typography,\n} from '@databricks/design-system';\nimport { RunColorPill } from '@mlflow/mlflow/src/experiment-tracking/components/experiment-page/components/RunColorPill';\nimport { useMemo } from 'react';\nimport { RunsChartsImageCardConfig, RunsChartsCardConfig } from '../../runs-charts.types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { EmptyImageGridPlot, getImageSize, ImagePlotWithHistory } from './ImageGridPlot.common';\nimport { ImageEntity } from '@mlflow/mlflow/src/experiment-tracking/types';\nimport { FormattedMessage } from 'react-intl';\n\nexport const ImageGridMultipleKeyPlot = ({\n  previewData,\n  cardConfig,\n  width,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsImageCardConfig;\n  groupBy?: string;\n  setCardConfig?: (setter: (current: RunsChartsCardConfig) => RunsChartsImageCardConfig) => void;\n  width: number;\n}) => {\n  const { theme } = useDesignSystemTheme();\n\n  const displayRuns = previewData.filter((run: RunsChartsRunData) => Object.keys(run.images).length !== 0);\n\n  const imageSize = useMemo(() => {\n    return getImageSize(displayRuns.length, width);\n  }, [displayRuns, width]);\n\n  if (displayRuns.length === 0) {\n    return <EmptyImageGridPlot />;\n  }\n  return (\n    <div css={{ height: '100%', width: '100%' }}>\n      <Table grid scrollable>\n        <TableRow isHeader>\n          <TableHeader\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_charts_imagegridmultiplekeyplot.tsx_44\"\n            css={{ minWidth: imageSize + theme.spacing.md }}\n          >\n            <FormattedMessage\n              defaultMessage=\"images\"\n              description=\"Experiment tracking > runs charts > charts > image grid multiple key > table header text\"\n            />\n          </TableHeader>\n          {displayRuns.map((run: RunsChartsRunData) => {\n            return (\n              <TableHeader\n                componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_charts_imagegridmultiplekeyplot.tsx_52\"\n                key={run.uuid}\n                css={{ minWidth: imageSize + theme.spacing.md }}\n              >\n                <LegacyTooltip title={run.displayName}>\n                  <div\n                    css={{\n                      height: theme.typography.lineHeightMd,\n                      whiteSpace: 'nowrap',\n                      display: 'inline-flex',\n                      alignItems: 'center',\n                      margin: 'auto',\n                      gap: theme.spacing.sm,\n                    }}\n                  >\n                    <RunColorPill color={run.color} />\n                    {run.displayName}\n                  </div>\n                </LegacyTooltip>\n              </TableHeader>\n            );\n          })}\n        </TableRow>\n        {cardConfig.imageKeys.map((imageKey) => {\n          return (\n            <TableRow key={imageKey}>\n              <TableCell css={{ minWidth: imageSize + theme.spacing.md }}>\n                <div style={{ whiteSpace: 'normal' }}>{imageKey}</div>\n              </TableCell>\n              {displayRuns.map((run: RunsChartsRunData) => {\n                if (run.images[imageKey] && Object.keys(run.images[imageKey]).length > 0) {\n                  const metadataByStep = Object.values(run.images[imageKey]).reduce((acc, metadata) => {\n                    if (metadata.step !== undefined) {\n                      acc[metadata.step] = metadata;\n                    }\n                    return acc;\n                  }, {} as Record<number, ImageEntity>);\n                  return (\n                    <TableCell key={run.uuid} css={{ minWidth: imageSize + theme.spacing.md }}>\n                      <ImagePlotWithHistory\n                        metadataByStep={metadataByStep}\n                        imageSize={imageSize}\n                        step={cardConfig.step}\n                        runUuid={run.uuid}\n                      />\n                    </TableCell>\n                  );\n                }\n                return <TableCell key={run.uuid} css={{ minWidth: imageSize + theme.spacing.md }} />;\n              })}\n            </TableRow>\n          );\n        })}\n      </Table>\n    </div>\n  );\n};\n","import { useDispatch } from 'react-redux';\nimport { RunsChartsImageCardConfig, RunsChartsCardConfig } from '../../runs-charts.types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { ThunkDispatch } from '@mlflow/mlflow/src/redux-types';\nimport { useEffect } from 'react';\nimport { shouldEnableImageGridCharts } from '@mlflow/mlflow/src/common/utils/FeatureUtils';\nimport { ImageGridSingleKeyPlot } from './ImageGridSingleKeyPlot';\nimport { ImageGridMultipleKeyPlot } from './ImageGridMultipleKeyPlot';\nimport {\n  DEFAULT_IMAGE_GRID_CHART_NAME,\n  LOG_IMAGE_TAG_INDICATOR,\n  NUM_RUNS_TO_SUPPORT_FOR_LOG_IMAGE,\n} from '@mlflow/mlflow/src/experiment-tracking/constants';\nimport { RunsGroupByConfig } from '@mlflow/mlflow/src/experiment-tracking/components/experiment-page/utils/experimentPage.group-row-utils';\n\nexport const ImageGridPlot = ({\n  previewData,\n  cardConfig,\n  groupBy,\n  setCardConfig,\n  containerWidth,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsImageCardConfig;\n  groupBy: RunsGroupByConfig | null;\n  setCardConfig?: (setter: (current: RunsChartsCardConfig) => RunsChartsImageCardConfig) => void;\n  containerWidth: number;\n}) => {\n  const filteredPreviewData = previewData\n    .filter((run: RunsChartsRunData) => {\n      return run.tags[LOG_IMAGE_TAG_INDICATOR];\n    })\n    .slice(-NUM_RUNS_TO_SUPPORT_FOR_LOG_IMAGE);\n\n  if (cardConfig.imageKeys.length === 1) {\n    return <ImageGridSingleKeyPlot previewData={filteredPreviewData} cardConfig={cardConfig} width={containerWidth} />;\n  } else if (cardConfig.imageKeys.length > 1) {\n    return (\n      <ImageGridMultipleKeyPlot previewData={filteredPreviewData} cardConfig={cardConfig} width={containerWidth} />\n    );\n  }\n  return null;\n};\n","import { LegacySkeleton } from '@databricks/design-system';\nimport React, { Suspense } from 'react';\n\nconst ParallelCoordinatesPlot = React.lazy(() => import('./ParallelCoordinatesPlot'));\n\nconst LazyParallelCoordinatesPlot = (props: any) => {\n  return (\n    <Suspense fallback={<LegacySkeleton />}>\n      <ParallelCoordinatesPlot {...props}></ParallelCoordinatesPlot>\n    </Suspense>\n  );\n};\n\nexport default LazyParallelCoordinatesPlot;\n","import { isUndefined, pick } from 'lodash';\nimport type { RunsChartsLineCardConfig } from '../../runs-charts.types';\nimport type { RunsChartsGlobalLineChartConfig } from '../../../experiment-page/models/ExperimentPageUIState';\nimport { useMemo } from 'react';\nimport { shouldEnableGlobalLineChartConfig } from '../../../../../common/utils/FeatureUtils';\nimport { RunsChartsLineChartXAxisType } from '../RunsCharts.common';\n\n/**\n * A utility hook that selects if certain line chart settings should be\n * taken from global configuration or from local chard card settings.\n */\nexport const useLineChartGlobalConfig = (\n  originalCardConfig: RunsChartsLineCardConfig,\n  globalLineChartConfig?: RunsChartsGlobalLineChartConfig,\n) =>\n  useMemo(() => {\n    const result = pick(originalCardConfig, ['xAxisKey', 'selectedXAxisMetricKey', 'lineSmoothness']);\n\n    if (!shouldEnableGlobalLineChartConfig() || !globalLineChartConfig) {\n      return result;\n    }\n\n    const globalXAxisKey = globalLineChartConfig.xAxisKey;\n\n    if (originalCardConfig.useGlobalLineSmoothing && !isUndefined(globalLineChartConfig.lineSmoothness)) {\n      result.lineSmoothness = globalLineChartConfig.lineSmoothness;\n    }\n\n    if (!isUndefined(globalXAxisKey) && originalCardConfig.useGlobalXaxisKey) {\n      result.xAxisKey = globalXAxisKey;\n      const globalSelectedXAxisMetricKey = globalLineChartConfig?.selectedXAxisMetricKey;\n      if (globalXAxisKey === RunsChartsLineChartXAxisType.METRIC && globalSelectedXAxisMetricKey) {\n        result.selectedXAxisMetricKey = globalSelectedXAxisMetricKey;\n      }\n    }\n\n    return result;\n  }, [originalCardConfig, globalLineChartConfig]);\n","import { Accordion, useDesignSystemTheme } from '@databricks/design-system';\nimport { CSSObject, css } from '@emotion/react';\nimport { useMemo } from 'react';\n\nexport const METRIC_CHART_SECTION_HEADER_SIZE = 55;\n\ninterface MetricChartsAccordionProps {\n  activeKey?: string | string[];\n  onActiveKeyChange?: (key: string | string[]) => void;\n  children: React.ReactNode;\n  disableCollapse?: boolean;\n}\n\nconst MetricChartsAccordion = ({\n  activeKey,\n  onActiveKeyChange,\n  children,\n  disableCollapse = false,\n}: MetricChartsAccordionProps) => {\n  const { theme, getPrefixedClassName } = useDesignSystemTheme();\n  const clsPrefix = getPrefixedClassName('collapse');\n\n  const styles = useMemo(() => {\n    const classItem = `.${clsPrefix}-item`;\n    const classItemActive = `${classItem}-active`;\n    const classHeader = `.${clsPrefix}-header`;\n    const classContent = `.${clsPrefix}-content`;\n    const classContentBox = `.${clsPrefix}-content-box`;\n    const classArrow = `.${clsPrefix}-arrow`;\n\n    const styles: CSSObject = {\n      [classContent]: {\n        padding: '0px !important',\n        backgroundColor: 'transparent !important',\n      },\n\n      [classContentBox]: {\n        padding: '0 0 12px 0px !important',\n        backgroundColor: 'transparent !important',\n      },\n\n      [`& > ${classItem} > ${classHeader} > ${classArrow}`]: {\n        fontSize: theme.general.iconSize,\n        left: 12,\n        // TODO: This is needed currently because the rotated icon isn't centered, remove when accordion is fixed\n        verticalAlign: '-7px',\n        transform: 'rotate(-90deg)',\n        display: disableCollapse ? 'none' : undefined,\n      },\n\n      [`& > ${classItemActive} > ${classHeader} > ${classArrow}`]: {\n        transform: 'rotate(0deg)',\n      },\n\n      [classHeader]: {\n        display: 'flex',\n        color: theme.colors.textPrimary,\n        fontWeight: 600,\n        alignItems: 'center',\n\n        '&:focus-visible': {\n          outlineColor: `${theme.colors.primary} !important`,\n          outlineStyle: 'auto !important',\n        },\n      },\n\n      [`& > ${classItem}`]: {\n        borderBottom: `1px solid ${theme.colors.border}`,\n        borderRadius: 0,\n      },\n\n      [`& > ${classItem} > ${classHeader}`]: {\n        padding: 0,\n        lineHeight: '20px',\n        height: METRIC_CHART_SECTION_HEADER_SIZE,\n      },\n    };\n    return styles;\n  }, [theme, clsPrefix, disableCollapse]);\n\n  return (\n    <Accordion\n      componentId=\"codegen_mlflow_app_src_experiment-tracking_components_metricchartsaccordion.tsx_82\"\n      {...(activeKey ? { activeKey } : {})}\n      {...(onActiveKeyChange ? { onChange: onActiveKeyChange } : {})}\n      dangerouslyAppendEmotionCSS={css(styles)}\n      dangerouslySetAntdProps={{ expandIconPosition: 'left' }}\n    >\n      {children}\n    </Accordion>\n  );\n};\n\nexport default MetricChartsAccordion;\n","import { Button, DropdownMenu, PlusIcon } from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\n\nimport { ReactComponent as ChartBarIcon } from '../../../../common/static/chart-bar.svg';\nimport { ReactComponent as ChartContourIcon } from '../../../../common/static/chart-contour.svg';\nimport { ReactComponent as ChartLineIcon } from '../../../../common/static/chart-line.svg';\nimport { ReactComponent as ChartParallelIcon } from '../../../../common/static/chart-parallel.svg';\nimport { ReactComponent as ChartScatterIcon } from '../../../../common/static/chart-scatter.svg';\nimport { ReactComponent as ChartDifferenceIcon } from '../../../../common/static/chart-difference.svg';\nimport { ReactComponent as ChartImageIcon } from '../../../../common/static/chart-image.svg';\nimport { RunsChartType } from '../runs-charts.types';\nimport {\n  shouldEnableDifferenceViewCharts,\n  shouldEnableImageGridCharts,\n} from '@mlflow/mlflow/src/common/utils/FeatureUtils';\nimport { FormattedMessage } from 'react-intl';\n\nexport interface RunsChartsAddChartMenuProps {\n  onAddChart: (type: RunsChartType) => void;\n  supportedChartTypes?: RunsChartType[];\n}\n\nexport const RunsChartsAddChartMenu = ({ onAddChart, supportedChartTypes }: RunsChartsAddChartMenuProps) => {\n  const isChartTypeSupported = (type: RunsChartType) => !supportedChartTypes || supportedChartTypes.includes(type);\n  return (\n    <DropdownMenu.Root modal={false}>\n      <DropdownMenu.Trigger asChild>\n        <Button\n          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_runscompareaddchartmenu.tsx_19\"\n          css={styles.addChartButton}\n          icon={<PlusIcon />}\n          data-testid=\"experiment-view-compare-runs-add-chart\"\n        >\n          <FormattedMessage\n            defaultMessage=\"Add chart\"\n            description=\"Experiment tracking > runs charts > add chart menu\"\n          />\n        </Button>\n      </DropdownMenu.Trigger>\n      <DropdownMenu.Content align=\"end\">\n        {isChartTypeSupported(RunsChartType.BAR) && (\n          <DropdownMenu.Item\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_runschartsaddchartmenu.tsx_42\"\n            onClick={() => onAddChart(RunsChartType.BAR)}\n            data-testid=\"experiment-view-compare-runs-chart-type-bar\"\n          >\n            <DropdownMenu.IconWrapper css={styles.iconWrapper}>\n              <ChartBarIcon />\n            </DropdownMenu.IconWrapper>\n            <FormattedMessage\n              defaultMessage=\"Bar chart\"\n              description=\"Experiment tracking > runs charts > add chart menu > bar chart\"\n            />\n          </DropdownMenu.Item>\n        )}\n        {isChartTypeSupported(RunsChartType.LINE) && (\n          <DropdownMenu.Item\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_runschartsaddchartmenu.tsx_56\"\n            onClick={() => onAddChart(RunsChartType.LINE)}\n            data-testid=\"experiment-view-compare-runs-chart-type-line\"\n          >\n            <DropdownMenu.IconWrapper css={styles.iconWrapper}>\n              <ChartLineIcon />\n            </DropdownMenu.IconWrapper>\n            <FormattedMessage\n              defaultMessage=\"Line chart\"\n              description=\"Experiment tracking > runs charts > add chart menu > line chart\"\n            />\n          </DropdownMenu.Item>\n        )}\n        {isChartTypeSupported(RunsChartType.PARALLEL) && (\n          <DropdownMenu.Item\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_runschartsaddchartmenu.tsx_70\"\n            onClick={() => onAddChart(RunsChartType.PARALLEL)}\n            data-testid=\"experiment-view-compare-runs-chart-type-parallel\"\n          >\n            <DropdownMenu.IconWrapper css={styles.iconWrapper}>\n              <ChartParallelIcon />\n            </DropdownMenu.IconWrapper>\n            <FormattedMessage\n              defaultMessage=\"Parallel coordinates\"\n              description=\"Experiment tracking > runs charts > add chart menu > parallel coordinates\"\n            />\n          </DropdownMenu.Item>\n        )}\n        {isChartTypeSupported(RunsChartType.SCATTER) && (\n          <DropdownMenu.Item\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_runschartsaddchartmenu.tsx_84\"\n            onClick={() => onAddChart(RunsChartType.SCATTER)}\n            data-testid=\"experiment-view-compare-runs-chart-type-scatter\"\n          >\n            <DropdownMenu.IconWrapper css={styles.iconWrapper}>\n              <ChartScatterIcon />\n            </DropdownMenu.IconWrapper>\n            <FormattedMessage\n              defaultMessage=\"Scatter chart\"\n              description=\"Experiment tracking > runs charts > add chart menu > scatter plot\"\n            />\n          </DropdownMenu.Item>\n        )}\n        {isChartTypeSupported(RunsChartType.CONTOUR) && (\n          <DropdownMenu.Item\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_runschartsaddchartmenu.tsx_98\"\n            onClick={() => onAddChart(RunsChartType.CONTOUR)}\n            data-testid=\"experiment-view-compare-runs-chart-type-contour\"\n          >\n            <DropdownMenu.IconWrapper css={styles.iconWrapper}>\n              <ChartContourIcon />\n            </DropdownMenu.IconWrapper>\n            <FormattedMessage\n              defaultMessage=\"Contour chart\"\n              description=\"Experiment tracking > runs charts > add chart menu > contour chart\"\n            />\n          </DropdownMenu.Item>\n        )}\n        {shouldEnableDifferenceViewCharts() && isChartTypeSupported(RunsChartType.DIFFERENCE) && (\n          <DropdownMenu.Item\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_runschartsaddchartmenu.tsx_112\"\n            onClick={() => onAddChart(RunsChartType.DIFFERENCE)}\n            data-testid=\"experiment-view-compare-runs-chart-type-difference\"\n          >\n            <DropdownMenu.IconWrapper css={styles.iconWrapper}>\n              <ChartDifferenceIcon />\n            </DropdownMenu.IconWrapper>\n            <FormattedMessage\n              defaultMessage=\"Difference view\"\n              description=\"Experiment tracking > runs charts > add chart menu > difference view\"\n            />\n          </DropdownMenu.Item>\n        )}\n        {shouldEnableImageGridCharts() && isChartTypeSupported(RunsChartType.IMAGE) && (\n          <DropdownMenu.Item\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_runschartsaddchartmenu.tsx_126\"\n            onClick={() => onAddChart(RunsChartType.IMAGE)}\n            data-testid=\"experiment-view-compare-runs-chart-type-image\"\n          >\n            <DropdownMenu.IconWrapper css={styles.iconWrapper}>\n              <ChartImageIcon />\n            </DropdownMenu.IconWrapper>\n            <FormattedMessage\n              defaultMessage=\"Image grid\"\n              description=\"Experiment tracking > runs charts > add chart menu > image grid\"\n            />\n          </DropdownMenu.Item>\n        )}\n      </DropdownMenu.Content>\n    </DropdownMenu.Root>\n  );\n};\n\nconst styles = {\n  addChartButton: (theme: Theme) => ({\n    // Overriden while waiting for design decision in DuBois (FEINF-1711)\n    backgroundColor: `${theme.colors.backgroundPrimary} !important`,\n  }),\n  iconWrapper: (theme: Theme) => ({\n    width: theme.general.iconSize + theme.spacing.xs,\n  }),\n};\n","import {\n  Button,\n  DangerModal,\n  DragIcon,\n  DropdownMenu,\n  Input,\n  Modal,\n  OverflowIcon,\n  PencilIcon,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport { ChartSectionConfig } from '../../../../types';\nimport { RunsChartsAddChartMenu } from '../RunsChartsAddChartMenu';\nimport { RunsChartType } from '../../runs-charts.types';\nimport { useEffect, useRef, useState } from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { useDragAndDropElement } from '@mlflow/mlflow/src/common/hooks/useDragAndDropElement';\nimport { CheckIcon } from '@databricks/design-system';\nimport { METRIC_CHART_SECTION_HEADER_SIZE } from '../../../MetricChartsAccordion';\nimport cx from 'classnames';\n\nexport interface RunsChartsSectionHeaderProps {\n  index: number;\n  section: ChartSectionConfig;\n  sectionChartsLength: number;\n  addNewChartCard: (metricSectionId: string) => (type: RunsChartType) => void;\n  onDeleteSection: (sectionId: string) => void;\n  onAddSection: (sectionId: string, above: boolean) => void;\n  editSection: number;\n  onSetEditSection: React.Dispatch<React.SetStateAction<number>>;\n  onSetSectionName: (sectionId: string, name: string) => void;\n  onSectionReorder: (sourceSectionId: string, targetSectionId: string) => void;\n  isExpanded: boolean;\n  supportedChartTypes?: RunsChartType[] | undefined;\n  /**\n   * Set to \"true\" to hide various controls (e.g. edit, add, delete) in the section header.\n   */\n  hideExtraControls: boolean;\n}\n\nexport const RunsChartsSectionHeader = ({\n  index,\n  section,\n  sectionChartsLength,\n  addNewChartCard,\n  onDeleteSection,\n  onAddSection,\n  editSection,\n  onSetEditSection,\n  onSetSectionName,\n  onSectionReorder,\n  isExpanded,\n  hideExtraControls,\n  supportedChartTypes,\n}: RunsChartsSectionHeaderProps) => {\n  const { theme } = useDesignSystemTheme();\n  // Change name locally for better performance\n  const [tmpSectionName, setTmpSectionName] = useState(section.name);\n  // State to check if element is being dragged\n  const [isDraggingHandle, setIsDraggingHandle] = useState(false);\n\n  // Ref and state to measure the width of the section name\n  const sectionNameRef = useRef<HTMLDivElement>(null);\n  const confirmButtonRef = useRef<HTMLButtonElement>(null);\n  const [sectionNameWidth, setSectionNameWidth] = useState(0.0);\n\n  // Delete section modal\n  const [isDeleteSectionModalOpen, setIsDeleteSectionModalOpen] = useState(false);\n\n  const stopPropagation = (e: any) => {\n    e.stopPropagation();\n  };\n\n  const deleteModalConfirm = () => {\n    onDeleteSection(section.uuid);\n  };\n\n  const deleteModalCancel = () => {\n    setIsDeleteSectionModalOpen(false);\n  };\n\n  const deleteSection = () => {\n    setIsDeleteSectionModalOpen(true);\n  };\n\n  const addSectionAbove = () => {\n    onAddSection(section.uuid, true);\n  };\n\n  const addSectionBelow = () => {\n    onAddSection(section.uuid, false);\n  };\n\n  const onEdit = (e: React.MouseEvent<HTMLElement>) => {\n    e.stopPropagation();\n    onSetEditSection(index);\n  };\n\n  const onChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setTmpSectionName(e.target.value);\n  };\n\n  const onSubmit = (e: React.KeyboardEvent<HTMLInputElement> | React.MouseEvent<HTMLElement>) => {\n    e.stopPropagation();\n    if (!tmpSectionName.trim()) {\n      e.preventDefault();\n      return;\n    }\n    onSetEditSection(-1);\n    onSetSectionName(section.uuid, tmpSectionName);\n  };\n\n  const onEsc = (e: React.KeyboardEvent<HTMLInputElement>) => {\n    if (e.key === 'Escape') {\n      e.stopPropagation();\n      onSetEditSection(-1);\n      setTmpSectionName(section.name);\n    }\n  };\n\n  const onBlur = (e: React.FocusEvent) => {\n    if (e.relatedTarget === confirmButtonRef.current) {\n      return;\n    }\n    onSetEditSection(-1);\n    onSetSectionName(section.uuid, tmpSectionName);\n  };\n\n  useEffect(() => {\n    if (!sectionNameRef.current) {\n      return;\n    }\n\n    const resizeObserver = new ResizeObserver(([entry]) => {\n      setSectionNameWidth(entry.contentRect.width);\n    });\n\n    resizeObserver.observe(sectionNameRef.current);\n\n    return () => resizeObserver.disconnect();\n  }, []);\n\n  // For explicitness:\n  const EDITABLE_LABEL_PADDING_WIDTH = 6;\n  const EDITABLE_LABEL_BORDER_WIDTH = 1;\n  const EDITABLE_LABEL_OFFSET = EDITABLE_LABEL_PADDING_WIDTH + EDITABLE_LABEL_BORDER_WIDTH;\n\n  const isCurrentlyEdited = editSection === index;\n  const [isCurrentlyHovered, setIsCurrentlyHovered] = useState(false);\n\n  const { dragHandleRef, dragPreviewRef, dropTargetRef, isOver, isDragging } = useDragAndDropElement({\n    dragGroupKey: 'sections',\n    dragKey: section.uuid,\n    onDrop: onSectionReorder,\n  });\n\n  return (\n    <>\n      <div\n        role=\"figure\"\n        css={{\n          display: 'flex',\n          alignItems: 'center',\n          width: '100%',\n          padding: `${theme.spacing.xs}px 0px`,\n          height: `${METRIC_CHART_SECTION_HEADER_SIZE}px`,\n          '.section-element-visibility-on-hover': {\n            visibility: isCurrentlyHovered ? 'visible' : 'hidden',\n            opacity: isCurrentlyHovered ? 1 : 0,\n          },\n          '.section-element-visibility-on-hover-and-not-drag': {\n            visibility: isCurrentlyHovered ? 'visible' : 'hidden',\n            opacity: isCurrentlyHovered ? (isDraggingHandle ? 0 : 1) : 0,\n          },\n          '.section-element-hidden-on-edit': { display: isCurrentlyEdited ? 'none' : 'inherit' },\n        }}\n        onMouseMove={() => setIsCurrentlyHovered(true)}\n        onMouseLeave={() => setIsCurrentlyHovered(false)}\n        ref={(element) => {\n          // Use this element for both drag preview and drop target\n          dropTargetRef?.(element);\n          dragPreviewRef?.(element);\n        }}\n        data-testid=\"experiment-view-compare-runs-section-header\"\n      >\n        {isOver && (\n          // Visual overlay for target drop element\n          <div\n            css={{\n              position: 'absolute',\n              inset: 0,\n              backgroundColor: theme.isDarkMode ? theme.colors.blue800 : theme.colors.blue100,\n              border: `2px dashed ${theme.colors.blue400}`,\n              opacity: 0.75,\n            }}\n          />\n        )}\n        <div\n          style={{\n            maxWidth: '40%',\n            display: 'flex',\n            alignItems: 'center',\n          }}\n        >\n          <div\n            ref={sectionNameRef}\n            style={{\n              position: !isCurrentlyEdited ? 'relative' : 'absolute',\n              visibility: !isCurrentlyEdited ? 'visible' : 'hidden',\n              textOverflow: isCurrentlyEdited ? undefined : 'ellipsis',\n              maxWidth: '100%',\n              overflow: 'clip',\n              paddingLeft: EDITABLE_LABEL_OFFSET,\n              whiteSpace: 'pre',\n            }}\n          >\n            {tmpSectionName}\n          </div>\n          {editSection === index && (\n            <Input\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_sections_runschartssectionheader.tsx_220\"\n              autoFocus\n              onClick={stopPropagation}\n              onMouseDown={stopPropagation}\n              onMouseUp={stopPropagation}\n              onDoubleClick={stopPropagation}\n              onChange={onChange}\n              value={tmpSectionName}\n              css={{\n                color: theme.colors.textPrimary,\n                fontWeight: 600,\n                padding: `1px ${EDITABLE_LABEL_PADDING_WIDTH}px 1px ${EDITABLE_LABEL_PADDING_WIDTH}px`,\n                background: theme.colors.backgroundSecondary,\n                minWidth: '50px',\n                width: sectionNameWidth + 2 * EDITABLE_LABEL_OFFSET,\n                position: 'relative',\n                lineHeight: theme.typography.lineHeightBase,\n                maxWidth: '100%',\n              }}\n              onKeyDown={onEsc}\n              onPressEnter={onSubmit}\n              dangerouslyAppendEmotionCSS={{ '&&': { minHeight: '20px !important' } }}\n              onBlur={onBlur}\n            />\n          )}\n          <div\n            css={{\n              padding: theme.spacing.xs,\n              position: 'relative',\n            }}\n            style={{\n              visibility: !isCurrentlyEdited ? 'visible' : 'hidden',\n              display: isCurrentlyEdited ? 'none' : 'inherit',\n            }}\n          >\n            {`(${sectionChartsLength})`}\n          </div>\n          {!hideExtraControls && (\n            <div className=\"section-element-visibility-on-hover-and-not-drag section-element-hidden-on-edit\">\n              <Button\n                componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_sections_runscomparesectionheader.tsx_246\"\n                onClick={onEdit}\n                aria-label=\"Icon label\"\n                icon={<PencilIcon />}\n              />\n            </div>\n          )}\n        </div>\n        {editSection === index && !hideExtraControls && (\n          <div style={{ padding: `0 ${theme.spacing.xs}px` }}>\n            <Button\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_sections_runscomparesectionheader.tsx_251\"\n              onClick={onSubmit}\n              icon={<CheckIcon />}\n              ref={confirmButtonRef}\n            />\n          </div>\n        )}\n        {!hideExtraControls && (\n          <div\n            className=\"section-element-visibility-on-hover section-element-hidden-on-edit\"\n            css={{ position: 'absolute', top: '50%', left: '50%', transform: 'translate(-50%, -50%)', cursor: 'grab' }}\n          >\n            <DragIcon\n              rotate={90}\n              style={{ color: theme.colors.textSecondary }}\n              ref={dragHandleRef}\n              onMouseDown={() => setIsDraggingHandle(true)}\n              onMouseLeave={() => {\n                setIsDraggingHandle(false);\n              }}\n              data-testid=\"experiment-view-compare-runs-section-header-drag-handle\"\n            />\n          </div>\n        )}\n        {!hideExtraControls && (\n          <div\n            style={{\n              position: 'absolute',\n              top: '50%',\n              right: '0',\n              transform: 'translate(0, -50%)',\n              display: 'flex',\n              alignItems: 'center',\n            }}\n          >\n            <div\n              onClick={stopPropagation}\n              onMouseDown={stopPropagation}\n              onMouseUp={stopPropagation}\n              onDoubleClick={stopPropagation}\n              className=\"section-element-visibility-on-hover-and-not-drag section-element-hidden-on-edit\"\n            >\n              <DropdownMenu.Root modal={false}>\n                <DropdownMenu.Trigger asChild>\n                  <Button\n                    componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_sections_runscomparesectionheader.tsx_288\"\n                    icon={<OverflowIcon />}\n                  />\n                </DropdownMenu.Trigger>\n                <DropdownMenu.Content>\n                  <DropdownMenu.Item\n                    componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_sections_runschartssectionheader.tsx_321\"\n                    onClick={addSectionAbove}\n                  >\n                    <FormattedMessage\n                      defaultMessage=\"Add section above\"\n                      description=\"Experiment page > compare runs > chart section > add section above label\"\n                    />\n                  </DropdownMenu.Item>\n                  <DropdownMenu.Item\n                    componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_sections_runschartssectionheader.tsx_327\"\n                    onClick={addSectionBelow}\n                  >\n                    <FormattedMessage\n                      defaultMessage=\"Add section below\"\n                      description=\"Experiment page > compare runs > chart section > add section below label\"\n                    />\n                  </DropdownMenu.Item>\n                  <DropdownMenu.Item\n                    componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_sections_runschartssectionheader.tsx_333\"\n                    onClick={deleteSection}\n                  >\n                    <FormattedMessage\n                      defaultMessage=\"Delete section\"\n                      description=\"Experiment page > compare runs > chart section > delete section label\"\n                    />\n                  </DropdownMenu.Item>\n                </DropdownMenu.Content>\n              </DropdownMenu.Root>\n              <DangerModal\n                componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-charts_components_sections_runschartssectionheader.tsx_351\"\n                visible={isDeleteSectionModalOpen}\n                onOk={deleteModalConfirm}\n                onCancel={deleteModalCancel}\n                title=\"Delete section\"\n              >\n                <FormattedMessage\n                  defaultMessage=\"Deleting the section will permanently remove it and the charts it contains. This cannot be undone.\"\n                  description=\"Experiment page > compare runs > chart section > delete section warning message\"\n                />\n              </DangerModal>\n            </div>\n\n            <div\n              onClick={stopPropagation}\n              onMouseDown={stopPropagation}\n              onMouseUp={stopPropagation}\n              onDoubleClick={stopPropagation}\n              className={cx(\n                {\n                  'section-element-visibility-on-hover-and-not-drag': !isExpanded,\n                },\n                'section-element-hidden-on-edit',\n              )}\n              css={{\n                alignSelf: 'flex-end',\n                marginLeft: theme.spacing.xs,\n              }}\n            >\n              <RunsChartsAddChartMenu\n                onAddChart={addNewChartCard(section.uuid)}\n                supportedChartTypes={supportedChartTypes}\n              />\n            </div>\n          </div>\n        )}\n      </div>\n    </>\n  );\n};\n","import { useMemo, useState } from 'react';\nimport type { RunsChartsRunData } from './RunsCharts.common';\nimport type { RunsChartsCardConfig } from '../runs-charts.types';\nimport { RunsChartType } from '../runs-charts.types';\nimport { useDesignSystemTheme } from '@databricks/design-system';\nimport { getGridColumnSetup } from '../../../../common/utils/CssGrid.utils';\nimport { RunsChartCardSetFullscreenFn, RunsChartsChartsDragGroup } from './cards/ChartCard.common';\nimport { useDragAndDropElement } from '@mlflow/mlflow/src/common/hooks/useDragAndDropElement';\nimport { FormattedMessage } from 'react-intl';\nimport { Empty } from '@databricks/design-system';\nimport { RunsChartsCard } from './cards/RunsChartsCard';\nimport type { RunsGroupByConfig } from '../../experiment-page/utils/experimentPage.group-row-utils';\nimport type { RunsChartsGlobalLineChartConfig } from '../../experiment-page/models/ExperimentPageUIState';\n\nexport interface RunsChartsProps {\n  sectionId: string;\n  chartRunData: RunsChartsRunData[];\n  cardsConfig: RunsChartsCardConfig[];\n  isMetricHistoryLoading?: boolean;\n  onRemoveChart: (chart: RunsChartsCardConfig) => void;\n  onStartEditChart: (chart: RunsChartsCardConfig) => void;\n  onReorderCharts: (sourceChartUuid: string, targetChartUuid: string) => void;\n  onInsertCharts: (sourceChartUuid: string, targetSectionId: string) => void;\n  groupBy: RunsGroupByConfig | null;\n  sectionIndex: number;\n  setFullScreenChart: RunsChartCardSetFullscreenFn;\n  autoRefreshEnabled?: boolean;\n  hideEmptyCharts?: boolean;\n  globalLineChartConfig?: RunsChartsGlobalLineChartConfig;\n}\n\nexport const RunsCharts = ({\n  sectionId,\n  chartRunData,\n  cardsConfig,\n  isMetricHistoryLoading,\n  onRemoveChart,\n  onStartEditChart,\n  onReorderCharts,\n  onInsertCharts,\n  groupBy,\n  sectionIndex,\n  setFullScreenChart,\n  autoRefreshEnabled,\n  hideEmptyCharts,\n  globalLineChartConfig,\n}: RunsChartsProps) => {\n  const { theme } = useDesignSystemTheme();\n\n  const [parallelChartCards, differenceChartCards, imageChartCards, remainingChartCards] = useMemo(() => {\n    // Play it safe in case that cards config somehow failed to load\n    if (!Array.isArray(cardsConfig)) {\n      return [[], [], [], []];\n    }\n    return [\n      cardsConfig.filter((c) => c.type === RunsChartType.PARALLEL),\n      cardsConfig.filter((c) => c.type === RunsChartType.DIFFERENCE),\n      cardsConfig.filter((c) => c.type === RunsChartType.IMAGE),\n      cardsConfig.filter(\n        (c) =>\n          c.type !== RunsChartType.PARALLEL && c.type !== RunsChartType.DIFFERENCE && c.type !== RunsChartType.IMAGE,\n      ),\n    ];\n  }, [cardsConfig]);\n\n  const gridSetup = useMemo(\n    () =>\n      getGridColumnSetup({\n        maxColumns: 3,\n        gap: theme.spacing.md,\n        additionalBreakpoints: [{ breakpointWidth: 3 * 720, minColumnWidthForBreakpoint: 600 }],\n      }),\n    [theme],\n  );\n\n  const { dropTargetRef: dropTargetGeneralRef, isOver: isOverGeneral } = useDragAndDropElement({\n    dragGroupKey: RunsChartsChartsDragGroup.GENERAL_AREA,\n    dragKey: sectionId,\n    onDrop: onInsertCharts,\n  });\n\n  const { dropTargetRef: dropTargetParallelRef, isOver: isOverParallel } = useDragAndDropElement({\n    dragGroupKey: RunsChartsChartsDragGroup.PARALLEL_CHARTS_AREA,\n    dragKey: sectionId,\n    onDrop: onInsertCharts,\n  });\n\n  const isChartsEmpty =\n    !parallelChartCards.length &&\n    !differenceChartCards.length &&\n    !imageChartCards.length &&\n    !remainingChartCards.length;\n\n  return (\n    <div\n      role=\"figure\"\n      ref={(element) => {\n        // Use this element for drop target\n        dropTargetGeneralRef?.(element);\n        dropTargetParallelRef?.(element);\n      }}\n      css={{\n        padding: cardsConfig.length === 0 ? theme.spacing.lg : 0,\n        position: 'relative',\n        overflow: 'hidden',\n      }}\n    >\n      {(isOverGeneral || isOverParallel) && cardsConfig.length === 0 && (\n        // Visual overlay for target drop element\n        <div\n          css={{\n            position: 'absolute',\n            inset: 0,\n            backgroundColor: theme.isDarkMode ? theme.colors.blue800 : theme.colors.blue100,\n            border: `2px dashed ${theme.colors.blue400}`,\n            opacity: 0.75,\n          }}\n        />\n      )}\n      {isChartsEmpty && (\n        <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center' }}>\n          <Empty\n            title={\n              <FormattedMessage\n                defaultMessage=\"No charts in this section\"\n                description=\"Runs compare page > Charts tab > No charts placeholder title\"\n              />\n            }\n            description={\n              <FormattedMessage\n                defaultMessage=\"Click 'Add chart' or drag and drop to add charts here.\"\n                description=\"Runs compare page > Charts tab > No charts placeholder description\"\n              />\n            }\n          />\n        </div>\n      )}\n      {[differenceChartCards, parallelChartCards, imageChartCards].map((chartCards, index) => {\n        if (chartCards.length) {\n          return (\n            <div\n              key={`chart-cards-${index}`}\n              css={{\n                display: 'flex',\n                flexDirection: 'column',\n                gap: theme.spacing.md,\n                marginBottom: theme.spacing.md,\n              }}\n            >\n              {chartCards.map((cardConfig, index) => {\n                const reorderProps = {\n                  onReorderWith: onReorderCharts,\n                  canMoveDown: index < chartCards.length - 1,\n                  canMoveUp: index > 0,\n                  onMoveDown: () => onReorderCharts(cardConfig.uuid || '', chartCards[index + 1]?.uuid || ''),\n                  onMoveUp: () => onReorderCharts(cardConfig.uuid || '', chartCards[index - 1]?.uuid || ''),\n                };\n                return (\n                  <RunsChartsCard\n                    cardConfig={cardConfig}\n                    chartRunData={chartRunData}\n                    onStartEditChart={onStartEditChart}\n                    onRemoveChart={onRemoveChart}\n                    setFullScreenChart={setFullScreenChart}\n                    index={index}\n                    sectionIndex={sectionIndex}\n                    groupBy={groupBy}\n                    autoRefreshEnabled={autoRefreshEnabled}\n                    hideEmptyCharts={hideEmptyCharts}\n                    key={`${cardConfig.uuid}-${index}-${sectionIndex}`}\n                    {...reorderProps}\n                  />\n                );\n              })}\n            </div>\n          );\n        }\n        return null;\n      })}\n      <div css={gridSetup}>\n        {remainingChartCards.map((cardConfig, index) => {\n          const reorderProps = {\n            onReorderWith: onReorderCharts,\n            canMoveDown: index < remainingChartCards.length - 1,\n            canMoveUp: index > 0,\n            previousChartUuid: remainingChartCards[index - 1]?.uuid,\n            nextChartUuid: remainingChartCards[index + 1]?.uuid,\n          };\n\n          return (\n            <RunsChartsCard\n              cardConfig={cardConfig}\n              chartRunData={chartRunData}\n              onStartEditChart={onStartEditChart}\n              onRemoveChart={onRemoveChart}\n              setFullScreenChart={setFullScreenChart}\n              index={index}\n              sectionIndex={sectionIndex}\n              groupBy={groupBy}\n              autoRefreshEnabled={autoRefreshEnabled}\n              hideEmptyCharts={hideEmptyCharts}\n              key={`${cardConfig.uuid}-${index}-${sectionIndex}`}\n              globalLineChartConfig={globalLineChartConfig}\n              {...reorderProps}\n            />\n          );\n        })}\n      </div>\n    </div>\n  );\n};\n","import { useEffect, useRef, useState } from 'react';\nimport { useDebounce } from 'use-debounce';\nimport { shouldDeferLineChartRendering } from '../../../../common/utils/FeatureUtils';\n\n// Define a module-global observer and a WeakMap on elements to hold callbacks\nlet sharedObserver: IntersectionObserver | null = null;\nconst entryCallbackMap = new WeakMap();\n\nconst ensureSharedObserverExists = () => {\n  if (!sharedObserver) {\n    sharedObserver = new IntersectionObserver((entries) => {\n      for (const entry of entries) {\n        const entryCallback = entryCallbackMap.get(entry.target);\n        entryCallback?.(entry.isIntersecting);\n      }\n    });\n  }\n};\n\nfunction observeElement(element: Element, callback: (isIntersecting: boolean) => void) {\n  ensureSharedObserverExists();\n  entryCallbackMap.set(element, callback);\n  sharedObserver?.observe(element);\n\n  return () => {\n    if (element) {\n      sharedObserver?.unobserve(element);\n      entryCallbackMap.delete(element);\n    }\n  };\n}\n\n/**\n * Checks if the element is currently visible within the viewport using IntersectionObserver.\n * If \"enabled\" is set to false, the returned value will always be true.\n */\nexport const useIsInViewportV2 = <T extends Element>({ enabled = true }: { enabled?: boolean } = {}) => {\n  const [element, setElementRef] = useState<T | null>(null);\n  const [isInViewport, setIsInViewport] = useState(!enabled);\n\n  useEffect(() => {\n    // If already viewed or element is not available, do nothing\n    if (!element) {\n      return;\n    }\n\n    // If IntersectionObserver is not available, assume that the element is visible\n    if (!window.IntersectionObserver || !enabled) {\n      setIsInViewport(true);\n      return;\n    }\n\n    return observeElement(element, setIsInViewport);\n  }, [enabled, element]);\n\n  // When the flag is disabled, deferred result is the same as the regular one\n  return { isInViewport, setElementRef };\n};\n","import { forwardRef, memo, useCallback, useRef, useState } from 'react';\nimport { RunsChartsCard, type RunsChartsCardProps } from './cards/RunsChartsCard';\nimport { DraggableCore, type DraggableEventHandler } from 'react-draggable';\nimport { Resizable } from 'react-resizable';\nimport { useDesignSystemTheme } from '@databricks/design-system';\nimport { useIsInViewportV2 } from '../hooks/useIsInViewportV2';\nimport { shouldDeferLineChartRendering } from '../../../../common/utils/FeatureUtils';\nimport { useDebounce } from 'use-debounce';\nimport { DRAGGABLE_CARD_HANDLE_CLASS, DRAGGABLE_CARD_TRANSITION_VAR } from './cards/ChartCard.common';\nimport { useRunsChartsDraggableGridActionsContext } from './RunsChartsDraggableCardsGridContext';\nimport { RUNS_CHARTS_UI_Z_INDEX } from '../utils/runsCharts.const';\n\nconst VIEWPORT_DEBOUNCE_MS = 150;\n\ninterface RunsChartsDraggableCardProps extends RunsChartsCardProps {\n  uuid?: string;\n  translateBy?: { x: number; y: number; overflowing: boolean };\n  onResizeStart: (rect: DOMRect) => void;\n  onResize: (width: number, height: number) => void;\n  onResizeStop: () => void;\n}\n\nexport const RunsChartsDraggableCard = memo((props: RunsChartsDraggableCardProps) => {\n  const { setElementRef, isInViewport } = useIsInViewportV2<HTMLDivElement>();\n  const { uuid, translateBy, onResizeStart, onResize, onResizeStop, ...cardProps } = props;\n\n  let isInViewportDeferred = isInViewport;\n\n  if (shouldDeferLineChartRendering()) {\n    // We can safely disable the eslint rule here because flag evaluation is stable\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    const [deferredValue] = useDebounce(isInViewport, VIEWPORT_DEBOUNCE_MS);\n    isInViewportDeferred = deferredValue;\n  }\n\n  const [resizeWidth, setResizeWidth] = useState(0);\n  const [resizeHeight, setResizeHeight] = useState(0);\n  const [isDragging, setIsDragging] = useState(false);\n  const [origin, setOrigin] = useState<{ x: number; y: number }>({ x: 0, y: 0 });\n\n  const { setDraggedCardUuid, onDropChartCard } = useRunsChartsDraggableGridActionsContext();\n\n  const draggedCardElementRef = useRef<HTMLDivElement | null>(null);\n\n  const onStartDrag = useCallback<DraggableEventHandler>(\n    (_, { x, y }) => {\n      setIsDragging(true);\n      setDraggedCardUuid(uuid ?? null);\n      setOrigin({ x, y });\n    },\n    [setDraggedCardUuid, uuid],\n  );\n\n  const onDrag = useCallback(\n    (_, { x, y }) => {\n      if (draggedCardElementRef.current) {\n        draggedCardElementRef.current.style.transform = `translate3d(${x - origin.x}px, ${y - origin.y}px, 0)`;\n      }\n    },\n    [origin],\n  );\n\n  const onStopDrag = useCallback(() => {\n    onDropChartCard();\n    setDraggedCardUuid(null);\n    if (draggedCardElementRef.current) {\n      draggedCardElementRef.current.style.transform = '';\n    }\n    setIsDragging(false);\n  }, [onDropChartCard, setDraggedCardUuid, draggedCardElementRef]);\n\n  const onResizeStartInternal = useCallback(() => {\n    const rect = draggedCardElementRef.current?.getBoundingClientRect();\n    if (rect) {\n      setResizeWidth(rect?.width ?? 0);\n      setResizeHeight(rect?.height ?? 0);\n      onResizeStart?.(rect);\n    }\n  }, [onResizeStart, draggedCardElementRef]);\n\n  const onResizeInternal = useCallback(\n    (_, { size }) => {\n      setResizeWidth(size.width);\n      setResizeHeight(size.height);\n      onResize(size.width, size.height);\n    },\n    [onResize],\n  );\n\n  return (\n    <DraggableCore\n      enableUserSelectHack={false}\n      onStart={onStartDrag}\n      onDrag={onDrag}\n      onStop={onStopDrag}\n      handle={`.${DRAGGABLE_CARD_HANDLE_CLASS}`}\n    >\n      <Resizable\n        width={resizeWidth}\n        height={resizeHeight}\n        axis=\"both\"\n        onResizeStart={onResizeStartInternal}\n        onResizeStop={onResizeStop}\n        onResize={onResizeInternal}\n        handle={<ResizableHandle />}\n      >\n        <div\n          ref={(element) => {\n            draggedCardElementRef.current = element;\n            setElementRef(element);\n          }}\n          style={\n            isDragging\n              ? {\n                  // Make sure the dragged card is on top of all other cards\n                  zIndex: RUNS_CHARTS_UI_Z_INDEX.CARD_DRAGGED,\n                  pointerEvents: 'none',\n                }\n              : {\n                  transition: DRAGGABLE_CARD_TRANSITION_VAR,\n                  transform: `translate3d(${translateBy?.x ?? 0}px,${translateBy?.y ?? 0}px,0)`,\n                  opacity: translateBy?.overflowing ? 0 : 1,\n                }\n          }\n        >\n          <RunsChartsCard {...cardProps} isInViewport={isInViewport} isInViewportDeferred={isInViewportDeferred} />\n        </div>\n      </Resizable>\n    </DraggableCore>\n  );\n});\n\nconst ResizableHandle = forwardRef((props, ref) => {\n  const { theme } = useDesignSystemTheme();\n  return (\n    <div\n      ref={ref as any}\n      {...props}\n      data-testid=\"draggable-card-resize-handle\"\n      css={{\n        position: 'absolute',\n        bottom: 0,\n        right: 0,\n        cursor: 'se-resize',\n        lineHeight: 0,\n        padding: theme.spacing.xs,\n        color: theme.colors.actionDefaultIconDefault,\n      }}\n    >\n      <svg width=\"8\" height=\"8\" viewBox=\"0 0 8 8\">\n        <path d=\"M6 6V0H8V8H0V6H6Z\" fill=\"currentColor\" />\n      </svg>\n    </div>\n  );\n});\n","import { useDesignSystemTheme } from '@databricks/design-system';\nimport { RUNS_CHARTS_UI_Z_INDEX } from '../utils/runsCharts.const';\n\nexport const RunsChartsDraggablePreview = ({\n  x,\n  y,\n  width,\n  height,\n}: {\n  x?: number;\n  y?: number;\n  width?: number | string;\n  height?: number | string;\n}) => {\n  const { theme } = useDesignSystemTheme();\n  return (\n    <>\n      {/* Cover pointer events */}\n      <div\n        css={{\n          position: 'absolute',\n          inset: 0,\n        }}\n      />\n      <div\n        css={{\n          position: 'absolute',\n          backgroundColor: theme.colors.actionDefaultBackgroundHover,\n          borderStyle: 'dashed',\n          borderColor: theme.colors.actionDefaultBorderDefault,\n          pointerEvents: 'none',\n          borderRadius: theme.general.borderRadiusBase,\n          borderWidth: 2,\n          inset: 0,\n          // Make sure the preview is above other cards\n          zIndex: RUNS_CHARTS_UI_Z_INDEX.CARD_PREVIEW,\n        }}\n        style={{\n          transform: `translate3d(${x}px, ${y}px, 0)`,\n          width: width,\n          height: height,\n        }}\n      />\n    </>\n  );\n};\n","import { Empty, useDesignSystemTheme } from '@databricks/design-system';\nimport { memo, useCallback, useMemo, useRef, useState } from 'react';\nimport { useUpdateRunsChartsUIConfiguration } from '../hooks/useRunsChartsUIConfiguration';\nimport { RunsChartsCardConfig } from '../runs-charts.types';\nimport type { RunsChartsProps } from './RunsCharts';\nimport { isEmptyChartCard } from './RunsCharts.common';\nimport { useMediaQuery } from '@databricks/web-shared/hooks';\nimport { Global } from '@emotion/react';\nimport { FormattedMessage } from 'react-intl';\nimport { ChartSectionConfig } from '../../../types';\nimport { RunsChartsDraggableCard } from './RunsChartsDraggableCard';\nimport {\n  useRunsChartsDraggableGridActionsContext,\n  useRunsChartsDraggableGridStateContext,\n} from './RunsChartsDraggableCardsGridContext';\nimport { RunsChartsDraggablePreview } from './RunsChartsDraggablePreview';\nimport { DRAGGABLE_CARD_TRANSITION_NAME } from './cards/ChartCard.common';\n\nconst rowHeightSuggestions = [300, 330, 360, 400, 500];\n\nconst getColumnSuggestions = (containerWidth: number, gapSize = 8) =>\n  [1, 2, 3, 4, 5].map((n) => ({\n    cols: n,\n    width: (containerWidth - (n - 1) * gapSize) / n,\n  }));\n\nconst PlaceholderSymbol = Symbol('placeholder');\n\ninterface RunsChartsDraggableCardsGridProps\n  extends Pick<\n    RunsChartsProps,\n    | 'onStartEditChart'\n    | 'onRemoveChart'\n    | 'setFullScreenChart'\n    | 'sectionId'\n    | 'groupBy'\n    | 'autoRefreshEnabled'\n    | 'hideEmptyCharts'\n    | 'chartRunData'\n    | 'cardsConfig'\n    | 'globalLineChartConfig'\n  > {\n  sectionConfig: ChartSectionConfig;\n}\n\n// Renders draggable cards grid in a single chart section\nexport const RunsChartsDraggableCardsGridSection = memo(\n  ({\n    cardsConfig,\n    sectionConfig,\n    chartRunData,\n    sectionId,\n    hideEmptyCharts,\n    ...cardProps\n  }: RunsChartsDraggableCardsGridProps) => {\n    const { theme } = useDesignSystemTheme();\n\n    // If below medium breakpoint, display only 1 card per row.\n    // Otherwise, use section configuration or fall back to 3 columns.\n    const isCompactMode = useMediaQuery(`(max-width: ${theme.responsive.breakpoints.md}px)`);\n    const columns = isCompactMode ? 1 : sectionConfig.columns ?? 3;\n\n    // Use card height from the section configuration or fall back to 360 pixels.\n    const cardHeight = sectionConfig.cardHeight ?? 360;\n\n    const gridBoxRef = useRef<HTMLDivElement | null>(null);\n\n    const { draggedCardUuid, isDragging } = useRunsChartsDraggableGridStateContext();\n    const { setTargetSection, setTargetPosition, onSwapCards } = useRunsChartsDraggableGridActionsContext();\n\n    const updateUIState = useUpdateRunsChartsUIConfiguration();\n\n    const setColumns = useCallback(\n      (columnCount: number) => {\n        updateUIState((current) => {\n          const section = current.compareRunSections?.find((section) => section.uuid === sectionId);\n          if (!section) {\n            return current;\n          }\n\n          return {\n            ...current,\n            compareRunSections: current.compareRunSections?.map((s) => {\n              if (s.uuid === sectionId) {\n                return {\n                  ...s,\n                  columns: columnCount,\n                };\n              }\n              return s;\n            }),\n          };\n        });\n      },\n      [sectionId, updateUIState],\n    );\n\n    const setCardHeight = useCallback(\n      (height: number) => {\n        updateUIState((current) => {\n          const section = current.compareRunSections?.find((section) => section.uuid === sectionId);\n          if (!section) {\n            return current;\n          }\n\n          return {\n            ...current,\n            compareRunSections: current.compareRunSections?.map((s) => {\n              if (s.uuid === sectionId) {\n                return {\n                  ...s,\n                  cardHeight: height,\n                };\n              }\n              return s;\n            }),\n          };\n        });\n      },\n      [sectionId, updateUIState],\n    );\n\n    const lastElementCount = useRef<number>(0);\n\n    const [positionInSection, setPositionInSection] = useState<number | null>(null);\n    const [resizePreview, setResizePreview] = useState<null | Partial<DOMRect>>(null);\n\n    lastElementCount.current = cardsConfig.length;\n    const position = !draggedCardUuid ? null : positionInSection;\n\n    // Helper function that calculates the x, y coordinates of a card based on its position in the grid\n    const findCoords = useCallback(\n      (position) => {\n        const gap = theme.spacing.sm;\n        const rowCount = Math.ceil(cardsConfig.length / columns);\n\n        const row = Math.floor(position / columns);\n        const col = position % columns;\n\n        const colGapsCount = columns - 1;\n\n        const passedColGaps = col;\n        const passedRowGaps = row;\n        const rect = gridBoxRef.current?.getBoundingClientRect();\n\n        const singleWidth = ((rect?.width ?? 0) - colGapsCount * gap) / columns;\n\n        const overflowing = row >= rowCount;\n\n        return {\n          overflowing,\n          row,\n          col,\n          x: col * singleWidth + passedColGaps * gap,\n          y: row * cardHeight + passedRowGaps * gap,\n        };\n      },\n      [columns, cardHeight, theme, cardsConfig.length],\n    );\n\n    const cardsToRender = useMemo(() => {\n      return cardsConfig.filter((cardConfig) => {\n        if (!hideEmptyCharts) {\n          return true;\n        }\n        return !isEmptyChartCard(chartRunData, cardConfig);\n      });\n    }, [cardsConfig, chartRunData, hideEmptyCharts]);\n\n    // Calculate the transforms for each card based on the dragged card and its position.\n    const cardTransforms = useMemo(() => {\n      if (!draggedCardUuid || position === null) {\n        return {};\n      }\n\n      const result: Record<string, { x: number; y: number; overflowing: boolean }> = {};\n\n      const newArray: (RunsChartsCardConfig | typeof PlaceholderSymbol)[] = cardsToRender.slice();\n      const fromIndex = cardsToRender.findIndex((x) => x.uuid === draggedCardUuid);\n      const toIndex = position;\n\n      if (fromIndex !== -1) {\n        // If the card is dragged within same section, just rearrange the cards\n        newArray.splice(fromIndex, 1);\n        newArray.splice(toIndex, 0, cardsToRender[fromIndex]);\n      } else {\n        // If the card is dragged from another section, insert empty placeholder element\n        newArray.splice(toIndex, 0, PlaceholderSymbol);\n      }\n\n      for (const cardConfig of cardsToRender) {\n        const newIndex = newArray.indexOf(cardConfig);\n        const oldIndex = cardsToRender.indexOf(cardConfig);\n\n        const oldCoords = findCoords(oldIndex);\n        const newCoords = findCoords(newIndex);\n\n        // If the card is not moving, skip it\n        if (newCoords.x === oldCoords.x && newCoords.y === oldCoords.y) {\n          continue;\n        }\n\n        // Calculate the delta between the old and new positions\n        const deltaX = newCoords.x - oldCoords.x;\n        const deltaY = newCoords.y - oldCoords.y;\n\n        if (cardConfig.uuid) {\n          result[cardConfig.uuid] = {\n            x: deltaX,\n            y: deltaY,\n            overflowing: newCoords.overflowing,\n          };\n        }\n      }\n\n      return result;\n    }, [draggedCardUuid, position, cardsToRender, findCoords]);\n\n    // Calculate the preview (placeholder) for the dragged card based on its new position\n    const dragPreview = useMemo(() => {\n      if (position === null) {\n        return null;\n      }\n      if (cardsToRender.length === 0) {\n        return { x: 0, y: 0, width: '100%', height: '100%' };\n      }\n      const { x, y } = findCoords(position);\n      const colGapsCount = columns - 1;\n      const rect = gridBoxRef.current?.getBoundingClientRect();\n\n      const singleWidth = ((rect?.width ?? 0) - colGapsCount * theme.spacing.sm) / columns;\n\n      const height = cardHeight;\n      return { x, y, width: singleWidth, height };\n    }, [position, findCoords, columns, cardHeight, theme, cardsToRender.length]);\n\n    const mouseMove = useCallback(\n      (e: React.MouseEvent) => {\n        if (!isDragging() || !gridBoxRef.current) {\n          return;\n        }\n\n        const rect = gridBoxRef.current.getBoundingClientRect();\n        const rowCount = Math.ceil(lastElementCount.current / columns);\n\n        setTargetSection(sectionId);\n        const pos =\n          Math.floor(((e.clientY - rect.top) / rect.height) * rowCount) * columns +\n          Math.floor(((e.clientX - rect.left) / rect.width) * columns);\n\n        setPositionInSection(pos);\n        setTargetPosition(pos);\n      },\n\n      [columns, isDragging, sectionId, setTargetSection, setTargetPosition],\n    );\n\n    const [columnSuggestions, setColumnSuggestions] = useState<{ cols: number; width: number }[]>([]);\n\n    const immediateColSuggestion = useRef<number | null>(null);\n    const immediateRowSuggestion = useRef<number | null>(null);\n\n    const onResizeStart = useCallback((rect: DOMRect) => {\n      const gridBoxRefSize = gridBoxRef.current?.getBoundingClientRect();\n      if (!gridBoxRefSize) {\n        return;\n      }\n\n      setResizePreview({\n        x: rect.left - gridBoxRefSize.left,\n        y: rect.top - gridBoxRefSize.top,\n        width: rect.width,\n        height: rect.height,\n      });\n\n      setColumnSuggestions(getColumnSuggestions(gridBoxRefSize.width));\n    }, []);\n\n    const onResizeStop = useCallback(() => {\n      setColumns(immediateColSuggestion.current ?? columns);\n      setCardHeight(immediateRowSuggestion.current ?? cardHeight);\n      setResizePreview(null);\n    }, [cardHeight, columns, setCardHeight, setColumns]);\n\n    const onResize = useCallback(\n      (width: number, height: number) => {\n        const columnSuggestion = columnSuggestions.reduce((prev, curr) =>\n          Math.abs(curr.width - width) < Math.abs(prev.width - width) ? curr : prev,\n        );\n\n        const rowHeightSuggestion = rowHeightSuggestions.reduce((prev, curr) =>\n          Math.abs(curr - height) < Math.abs(prev - height) ? curr : prev,\n        );\n\n        immediateColSuggestion.current = columnSuggestion.cols;\n        immediateRowSuggestion.current = rowHeightSuggestion;\n\n        setResizePreview((current) => {\n          if (!current) {\n            return null;\n          }\n          if (current.width !== columnSuggestion.width || current.height !== rowHeightSuggestion) {\n            return { ...current, width: columnSuggestion.width, height: rowHeightSuggestion };\n          }\n          return current;\n        });\n      },\n      [columnSuggestions],\n    );\n\n    return (\n      <div\n        ref={gridBoxRef}\n        css={[\n          { position: 'relative' },\n          cardsToRender.length > 0 && {\n            display: 'grid',\n            gap: theme.spacing.sm,\n          },\n        ]}\n        style={{\n          gridTemplateColumns: 'repeat(' + columns + ', 1fr)',\n          ...(draggedCardUuid && {\n            [DRAGGABLE_CARD_TRANSITION_NAME]: 'transform 0.1s',\n          }),\n        }}\n        data-testid=\"draggable-chart-cards-grid\"\n        onMouseMove={mouseMove}\n        onMouseLeave={() => {\n          setPositionInSection(null);\n        }}\n      >\n        {(draggedCardUuid || resizePreview) && (\n          <Global\n            styles={{\n              'body, :host': {\n                userSelect: 'none',\n              },\n            }}\n          />\n        )}\n        {cardsToRender.length === 0 && (\n          <div css={{ display: 'flex', justifyContent: 'center', minHeight: 160 }}>\n            <Empty\n              title={\n                <FormattedMessage\n                  defaultMessage=\"No charts in this section\"\n                  description=\"Runs compare page > Charts tab > No charts placeholder title\"\n                />\n              }\n              description={\n                <FormattedMessage\n                  defaultMessage=\"Click 'Add chart' or drag and drop to add charts here.\"\n                  description=\"Runs compare page > Charts tab > No charts placeholder description\"\n                />\n              }\n            />\n          </div>\n        )}\n        {cardsToRender.map((cardConfig, index, array) => {\n          return (\n            <RunsChartsDraggableCard\n              key={cardConfig.uuid}\n              uuid={cardConfig.uuid ?? ''}\n              translateBy={cardTransforms[cardConfig.uuid ?? '']}\n              onResizeStart={onResizeStart}\n              onResizeStop={onResizeStop}\n              onResize={onResize}\n              cardConfig={cardConfig}\n              chartRunData={chartRunData}\n              onReorderWith={onSwapCards}\n              index={index}\n              height={cardHeight}\n              canMoveDown={Boolean(array[index + 1])}\n              canMoveUp={Boolean(array[index - 1])}\n              previousChartUuid={array[index - 1]?.uuid}\n              nextChartUuid={array[index + 1]?.uuid}\n              hideEmptyCharts={hideEmptyCharts}\n              {...cardProps}\n            />\n          );\n        })}\n        {dragPreview && <RunsChartsDraggablePreview {...dragPreview} />}\n        {resizePreview && <RunsChartsDraggablePreview {...resizePreview} />}\n      </div>\n    );\n  },\n);\n","import type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\nimport { RunsChartsCardConfig } from '../../runs-charts.types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { RunsCharts } from '../RunsCharts';\nimport type { RunsChartCardSetFullscreenFn } from '../cards/ChartCard.common';\nimport { RunsChartsGlobalLineChartConfig } from '../../../experiment-page/models/ExperimentPageUIState';\nimport type { ChartSectionConfig } from '../../../../types';\nimport { RunsChartsDraggableCardsGridSection } from '../RunsChartsDraggableCardsGridSection';\nimport { shouldEnableDraggableChartsGridLayout } from '../../../../../common/utils/FeatureUtils';\n\nexport interface RunsChartsSectionProps {\n  sectionId: string;\n  sectionConfig: ChartSectionConfig;\n  sectionCharts: RunsChartsCardConfig[];\n  reorderCharts: (sourceChartUuid: string, targetChartUuid: string) => void;\n  insertCharts: (sourceChartUuid: string, targetSectionId: string) => void;\n  isMetricHistoryLoading: boolean;\n  chartData: RunsChartsRunData[];\n  startEditChart: (chartCard: RunsChartsCardConfig) => void;\n  removeChart: (configToDelete: RunsChartsCardConfig) => void;\n  groupBy: RunsGroupByConfig | null;\n  sectionIndex: number;\n  setFullScreenChart: RunsChartCardSetFullscreenFn;\n  autoRefreshEnabled?: boolean;\n  hideEmptyCharts?: boolean;\n  globalLineChartConfig?: RunsChartsGlobalLineChartConfig;\n}\n\nexport const RunsChartsSection = ({\n  sectionId,\n  sectionCharts,\n  reorderCharts,\n  insertCharts,\n  isMetricHistoryLoading,\n  chartData,\n  startEditChart,\n  removeChart,\n  groupBy,\n  sectionIndex,\n  setFullScreenChart,\n  autoRefreshEnabled,\n  hideEmptyCharts,\n  globalLineChartConfig,\n  sectionConfig,\n}: RunsChartsSectionProps) => {\n  // If the feature flag is enabled, use the draggable grid layout\n  if (shouldEnableDraggableChartsGridLayout()) {\n    return (\n      <RunsChartsDraggableCardsGridSection\n        sectionConfig={sectionConfig}\n        cardsConfig={sectionCharts}\n        chartRunData={chartData}\n        onStartEditChart={startEditChart}\n        onRemoveChart={removeChart}\n        setFullScreenChart={setFullScreenChart}\n        sectionId={sectionId}\n        groupBy={groupBy}\n        autoRefreshEnabled={autoRefreshEnabled}\n        hideEmptyCharts={hideEmptyCharts}\n        globalLineChartConfig={globalLineChartConfig}\n      />\n    );\n  }\n\n  return (\n    <RunsCharts\n      sectionId={sectionId}\n      chartRunData={chartData}\n      cardsConfig={sectionCharts}\n      isMetricHistoryLoading={isMetricHistoryLoading}\n      onRemoveChart={removeChart}\n      onStartEditChart={startEditChart}\n      onReorderCharts={reorderCharts}\n      onInsertCharts={insertCharts}\n      groupBy={groupBy}\n      sectionIndex={sectionIndex}\n      setFullScreenChart={setFullScreenChart}\n      autoRefreshEnabled={autoRefreshEnabled}\n      hideEmptyCharts={hideEmptyCharts}\n      globalLineChartConfig={globalLineChartConfig}\n    />\n  );\n};\n","import { Accordion } from '@databricks/design-system';\nimport { ChartSectionConfig } from '../../../../types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport {\n  RunsChartsBarCardConfig,\n  RunsChartsCardConfig,\n  RunsChartType,\n  RunsChartsLineCardConfig,\n  RunsChartsScatterCardConfig,\n  RunsChartsContourCardConfig,\n  SerializedRunsChartsCardConfigCard,\n  RunsChartsParallelCardConfig,\n} from '../../runs-charts.types';\nimport MetricChartsAccordion, { METRIC_CHART_SECTION_HEADER_SIZE } from '../../../MetricChartsAccordion';\nimport { RunsChartsSectionHeader } from './RunsChartsSectionHeader';\nimport { RunsChartsSection } from './RunsChartsSection';\nimport { useCallback, useMemo } from 'react';\nimport { getUUID } from '@mlflow/mlflow/src/common/utils/ActionUtils';\nimport { useState } from 'react';\nimport { Button, PlusIcon } from '@databricks/design-system';\nimport { FormattedMessage } from 'react-intl';\nimport { Empty } from '@databricks/design-system';\nimport { useDesignSystemTheme } from '@databricks/design-system';\nimport { Spacer } from '@databricks/design-system';\nimport { useUpdateRunsChartsUIConfiguration } from '../../hooks/useRunsChartsUIConfiguration';\nimport { isArray } from 'lodash';\nimport { RunsChartCardSetFullscreenFn } from '../cards/ChartCard.common';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\nimport { shouldUseRegexpBasedChartFiltering } from '../../../../../common/utils/FeatureUtils';\nimport type { RunsChartsGlobalLineChartConfig } from '../../../experiment-page/models/ExperimentPageUIState';\n\nconst chartMatchesFilter = (filter: string, config: RunsChartsCardConfig) => {\n  // Use regexp-based filtering if a feature flag is enabled\n  if (shouldUseRegexpBasedChartFiltering()) {\n    // Don't filter image or difference charts out\n    if (config.type === RunsChartType.IMAGE || config.type === RunsChartType.DIFFERENCE) {\n      return true;\n    }\n\n    try {\n      const filterRegex = new RegExp(filter, 'i');\n      return getChartMetricsAndParams(config).some((metricOrParam) => metricOrParam.match(filterRegex));\n    } catch {\n      // If the regex is invalid (e.g. user it still typing it), prevent from filtering\n      return true;\n    }\n  }\n\n  const filterLowerCase = filter.toLowerCase();\n\n  if (config.type === RunsChartType.BAR) {\n    const barConfig = config as RunsChartsBarCardConfig;\n    return barConfig.metricKey.toLowerCase().includes(filterLowerCase);\n  } else if (config.type === RunsChartType.LINE) {\n    const lineConfig = config as RunsChartsLineCardConfig;\n    if (isArray(lineConfig.selectedMetricKeys)) {\n      return lineConfig.selectedMetricKeys.some((metricKey) => metricKey.toLowerCase().includes(filterLowerCase));\n    }\n    return lineConfig.metricKey.toLowerCase().includes(filterLowerCase);\n  } else if (config.type === RunsChartType.SCATTER) {\n    const scatterConfig = config as RunsChartsScatterCardConfig;\n    return (\n      scatterConfig.xaxis.key.toLowerCase().includes(filterLowerCase) ||\n      scatterConfig.yaxis.key.toLowerCase().includes(filterLowerCase)\n    );\n  } else if (config.type === RunsChartType.PARALLEL) {\n    return 'Parallel Coordinates'.toLowerCase().includes(filterLowerCase);\n  } else if (config.type === RunsChartType.CONTOUR) {\n    const contourConfig = config as RunsChartsContourCardConfig;\n    return (\n      contourConfig.xaxis.key.toLowerCase().includes(filterLowerCase) ||\n      contourConfig.yaxis.key.toLowerCase().includes(filterLowerCase) ||\n      contourConfig.zaxis.key.toLowerCase().includes(filterLowerCase)\n    );\n  }\n\n  return true;\n};\n\nconst getChartMetricsAndParams = (config: RunsChartsCardConfig): string[] => {\n  if (config.type === RunsChartType.BAR) {\n    const barConfig = config as RunsChartsBarCardConfig;\n    return [barConfig.metricKey];\n  } else if (config.type === RunsChartType.LINE) {\n    const lineConfig = config as RunsChartsLineCardConfig;\n    if (isArray(lineConfig.selectedMetricKeys)) {\n      return lineConfig.selectedMetricKeys;\n    }\n    return [lineConfig.metricKey];\n  } else if (config.type === RunsChartType.SCATTER) {\n    const scatterConfig = config as RunsChartsScatterCardConfig;\n    return [scatterConfig.xaxis.key.toLowerCase(), scatterConfig.yaxis.key.toLowerCase()];\n  } else if (config.type === RunsChartType.PARALLEL) {\n    const parallelConfig = config as RunsChartsParallelCardConfig;\n    return [...parallelConfig.selectedMetrics, ...parallelConfig.selectedParams];\n  } else {\n    const contourConfig = config as RunsChartsContourCardConfig;\n    return [contourConfig.xaxis.key, contourConfig.yaxis.key, contourConfig.zaxis.key];\n  }\n};\n\nexport interface RunsChartsSectionAccordionProps {\n  compareRunSections?: ChartSectionConfig[];\n  compareRunCharts?: SerializedRunsChartsCardConfigCard[];\n  reorderCharts: (sourceChartUuid: string, targetChartUuid: string) => void;\n  insertCharts: (sourceChartUuid: string, targetSectionId: string) => void;\n  chartData: RunsChartsRunData[];\n  isMetricHistoryLoading?: boolean;\n  startEditChart: (chartCard: RunsChartsCardConfig) => void;\n  removeChart: (configToDelete: RunsChartsCardConfig) => void;\n  addNewChartCard: (metricSectionId: string) => (type: RunsChartType) => void;\n  search: string;\n  groupBy: RunsGroupByConfig | null;\n  autoRefreshEnabled?: boolean;\n  hideEmptyCharts?: boolean;\n  supportedChartTypes?: RunsChartType[] | undefined;\n  setFullScreenChart: RunsChartCardSetFullscreenFn;\n  globalLineChartConfig?: RunsChartsGlobalLineChartConfig;\n}\n\nexport const RunsChartsSectionAccordion = ({\n  compareRunSections,\n  compareRunCharts,\n  reorderCharts,\n  insertCharts,\n  chartData,\n  isMetricHistoryLoading = false,\n  autoRefreshEnabled = false,\n  startEditChart,\n  removeChart,\n  addNewChartCard,\n  search,\n  groupBy,\n  supportedChartTypes,\n  hideEmptyCharts,\n  setFullScreenChart = () => {},\n  globalLineChartConfig,\n}: RunsChartsSectionAccordionProps) => {\n  const updateUIState = useUpdateRunsChartsUIConfiguration();\n  const [editSection, setEditSection] = useState(-1);\n  const { theme } = useDesignSystemTheme();\n\n  /**\n   * Get the active (expanded) panels for the accordion\n   */\n  const activeKey = useMemo(() => {\n    const activeSections = (compareRunSections || []).flatMap((sectionConfig: ChartSectionConfig) => {\n      if (sectionConfig.display) {\n        return [sectionConfig.uuid];\n      } else {\n        return [];\n      }\n    });\n    return activeSections;\n  }, [compareRunSections]);\n\n  /**\n   * Updates the active (expanded) panels for the accordion\n   */\n  const onActivePanelChange = useCallback(\n    (key: string | string[]) => {\n      updateUIState((current) => {\n        const newCompareRunPanels = (current.compareRunSections || []).map((sectionConfig: ChartSectionConfig) => {\n          const sectionId = sectionConfig.uuid;\n          const shouldDisplaySection =\n            (typeof key === 'string' && sectionId === key) || (Array.isArray(key) && key.includes(sectionId));\n          return {\n            ...sectionConfig,\n            display: shouldDisplaySection,\n          };\n        });\n        return {\n          ...current,\n          compareRunSections: newCompareRunPanels,\n        };\n      });\n    },\n    [updateUIState],\n  );\n\n  /**\n   * Deletes a section from the accordion\n   */\n  const deleteSection = useCallback(\n    (sectionId: string) => {\n      updateUIState((current) => {\n        const newCompareRunCharts = (current.compareRunCharts || [])\n          // Keep charts that are generated or not in section\n          .filter((chartConfig: RunsChartsCardConfig) => {\n            return chartConfig.isGenerated || chartConfig.metricSectionId !== sectionId;\n          })\n          // For charts that are generated and in section, set deleted to true\n          .map((chartConfig: RunsChartsCardConfig) => {\n            if (chartConfig.isGenerated && chartConfig.metricSectionId === sectionId) {\n              return { ...chartConfig, deleted: true };\n            } else {\n              return chartConfig;\n            }\n          });\n\n        // Delete section\n        const newCompareRunSections = (current.compareRunSections || [])\n          .slice()\n          .filter((sectionConfig: ChartSectionConfig) => {\n            return sectionConfig.uuid !== sectionId;\n          });\n\n        return {\n          ...current,\n          compareRunCharts: newCompareRunCharts,\n          compareRunSections: newCompareRunSections,\n          isAccordionReordered: true,\n        };\n      });\n    },\n    [updateUIState],\n  );\n\n  /**\n   * Adds a section to the accordion\n   * @param sectionId indicates the section selected to anchor at\n   * @param above is a boolean value indicating whether to add the section above or below the anchor\n   */\n  const addSection = useCallback(\n    (sectionId: string, above: boolean) => {\n      let idx = -1;\n      updateUIState((current) => {\n        // Look for index\n        const newCompareRunSections = [...(current.compareRunSections || [])];\n        idx = newCompareRunSections.findIndex((sectionConfig: ChartSectionConfig) => sectionConfig.uuid === sectionId);\n        const newSection = { name: '', uuid: getUUID(), display: false, isReordered: false };\n        if (idx < 0) {\n          // Index not found, add to end\n          newCompareRunSections.push(newSection);\n        } else if (above) {\n          newCompareRunSections.splice(idx, 0, newSection);\n        } else {\n          idx += 1;\n          newCompareRunSections.splice(idx, 0, newSection);\n        }\n        return {\n          ...current,\n          compareRunSections: newCompareRunSections,\n          isAccordionReordered: true,\n        };\n      });\n      return idx;\n    },\n    [updateUIState],\n  );\n\n  /**\n   * Appends a section to the end of the accordion\n   */\n  const appendSection = useCallback(() => {\n    updateUIState((current) => {\n      const newCompareRunSections = [\n        ...(current.compareRunSections || []),\n        { name: '', uuid: getUUID(), display: false, isReordered: false },\n      ];\n      return {\n        ...current,\n        compareRunSections: newCompareRunSections,\n        isAccordionReordered: true,\n      };\n    });\n    setEditSection(compareRunSections?.length || -1);\n  }, [updateUIState, compareRunSections?.length]);\n\n  /**\n   * Updates the name of a section\n   * @param sectionId the section to update the name of\n   * @param name the new name of the section\n   */\n  const setSectionName = useCallback(\n    (sectionId: string, name: string) => {\n      updateUIState((current) => {\n        const newCompareRunSections = (current.compareRunSections || []).map((sectionConfig: ChartSectionConfig) => {\n          if (sectionConfig.uuid === sectionId) {\n            return { ...sectionConfig, name: name };\n          } else {\n            return sectionConfig;\n          }\n        });\n        return {\n          ...current,\n          compareRunSections: newCompareRunSections,\n          isAccordionReordered: true,\n        };\n      });\n    },\n    [updateUIState],\n  );\n\n  /**\n   * Reorders the sections in the accordion\n   * @param sourceSectionId the section you are dragging\n   * @param targetSectionId the section to drop\n   */\n  const sectionReorder = useCallback(\n    (sourceSectionId: string, targetSectionId: string) => {\n      updateUIState((current) => {\n        const newCompareRunSections = (current.compareRunSections || []).slice();\n        const sourceSectionIdx = newCompareRunSections.findIndex(\n          (sectionConfig: ChartSectionConfig) => sectionConfig.uuid === sourceSectionId,\n        );\n        const targetSectionIdx = newCompareRunSections.findIndex(\n          (sectionConfig: ChartSectionConfig) => sectionConfig.uuid === targetSectionId,\n        );\n        const sourceSection = newCompareRunSections.splice(sourceSectionIdx, 1)[0];\n        // If the source section is above the target section, the target section index will be shifted down by 1\n        newCompareRunSections.splice(targetSectionIdx, 0, sourceSection);\n        return {\n          ...current,\n          compareRunSections: newCompareRunSections,\n          isAccordionReordered: true,\n        };\n      });\n    },\n    [updateUIState],\n  );\n\n  const noRunsSelected = useMemo(() => chartData.filter(({ hidden }) => !hidden).length === 0, [chartData]);\n\n  const { sectionsToRender, chartsToRender } = useMemo(() => {\n    if (search === '') {\n      return { sectionsToRender: compareRunSections, chartsToRender: compareRunCharts };\n    }\n\n    const compareRunChartsFiltered = (compareRunCharts || []).filter((config: RunsChartsCardConfig) => {\n      return !config.deleted && chartMatchesFilter(search, config);\n    });\n    // Get the sections that have these charts\n    const sectionsWithCharts = new Set<string>();\n    compareRunChartsFiltered.forEach((config: RunsChartsCardConfig) => {\n      if (config.metricSectionId) {\n        sectionsWithCharts.add(config.metricSectionId);\n      }\n    });\n    // Filter the sections\n    const compareRunSectionsFiltered = (compareRunSections || []).filter((sectionConfig: ChartSectionConfig) => {\n      return sectionsWithCharts.has(sectionConfig.uuid);\n    });\n\n    return { sectionsToRender: compareRunSectionsFiltered, chartsToRender: compareRunChartsFiltered };\n  }, [search, compareRunCharts, compareRunSections]);\n\n  const isSearching = search !== '';\n\n  if (!compareRunSections || !compareRunCharts) {\n    return null;\n  }\n\n  if (noRunsSelected) {\n    return (\n      <div css={{ marginTop: theme.spacing.lg }}>\n        <Empty\n          description={\n            <FormattedMessage\n              defaultMessage=\"All runs are hidden. Select at least one run to view charts.\"\n              description=\"Experiment tracking > runs charts > indication displayed when no runs are selected for comparison\"\n            />\n          }\n        />\n      </div>\n    );\n  }\n\n  if (isSearching && chartsToRender?.length === 0) {\n    // Render empty in the center of the page\n    return (\n      <>\n        <Spacer size=\"lg\" />\n        <Empty\n          title={\n            <FormattedMessage\n              defaultMessage=\"No metric charts\"\n              description=\"Experiment page > compare runs > no metric charts\"\n            />\n          }\n          description={\n            <FormattedMessage\n              defaultMessage=\"All charts are filtered. Clear the search filter to see hidden metric charts.\"\n              description=\"Experiment page > compare runs > no metric charts > description\"\n            />\n          }\n        />\n      </>\n    );\n  }\n\n  return (\n    <div>\n      <MetricChartsAccordion activeKey={activeKey} onActiveKeyChange={onActivePanelChange}>\n        {(sectionsToRender || []).map((sectionConfig: ChartSectionConfig, index: number) => {\n          const sectionCharts = (chartsToRender || []).filter((config: RunsChartsCardConfig) => {\n            const section = (config as RunsChartsBarCardConfig).metricSectionId;\n            return !config.deleted && section === sectionConfig.uuid;\n          });\n\n          return (\n            <Accordion.Panel\n              header={\n                <RunsChartsSectionHeader\n                  index={index}\n                  section={sectionConfig}\n                  onDeleteSection={deleteSection}\n                  onAddSection={addSection}\n                  editSection={editSection}\n                  onSetEditSection={setEditSection}\n                  onSetSectionName={setSectionName}\n                  sectionChartsLength={sectionCharts.length}\n                  addNewChartCard={addNewChartCard}\n                  onSectionReorder={sectionReorder}\n                  isExpanded={activeKey.includes(sectionConfig.uuid)}\n                  supportedChartTypes={supportedChartTypes}\n                  // When searching, hide the section placement controls\n                  hideExtraControls={isSearching}\n                />\n              }\n              key={sectionConfig.uuid}\n              aria-hidden={!activeKey.includes(sectionConfig.uuid)}\n            >\n              <RunsChartsSection\n                sectionId={sectionConfig.uuid}\n                sectionConfig={sectionConfig}\n                sectionCharts={sectionCharts}\n                reorderCharts={reorderCharts}\n                insertCharts={insertCharts}\n                isMetricHistoryLoading={isMetricHistoryLoading}\n                chartData={chartData}\n                startEditChart={startEditChart}\n                removeChart={removeChart}\n                groupBy={groupBy}\n                sectionIndex={index}\n                setFullScreenChart={setFullScreenChart}\n                autoRefreshEnabled={autoRefreshEnabled}\n                hideEmptyCharts={hideEmptyCharts}\n                globalLineChartConfig={globalLineChartConfig}\n              />\n            </Accordion.Panel>\n          );\n        })}\n      </MetricChartsAccordion>\n      {!isSearching && (\n        <div>\n          <Button\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_sections_runscomparesectionaccordion.tsx_405\"\n            block\n            onClick={appendSection}\n            icon={<PlusIcon />}\n            style={{ border: 'none', marginTop: '6px' }}\n          >\n            <FormattedMessage\n              defaultMessage=\"Add section\"\n              description=\"Experiment page > compare runs > chart section > add section bar\"\n            />\n          </Button>\n        </div>\n      )}\n    </div>\n  );\n};\n","import { last, uniq } from 'lodash';\nimport { RunsChartsLineChartExpression } from '../runs-charts.types';\nimport { useCallback } from 'react';\n\nconst VARIABLE_OPERATOR = '$';\nconst MATCH_VARIABLE_REGEX = /\\$\\{([^}]+)\\}/g;\n\nenum Operator {\n  ADD = '+',\n  SUBTRACT = '-',\n  MULTIPLY = '*',\n  DIVIDE = '/',\n  POWER = '^',\n  // unary operators\n  NEGATIVE_SIGN = '_',\n  POSITIVE_SIGN = '|',\n}\nenum Parenthesis {\n  OPEN = '(',\n  CLOSE = ')',\n}\nenum VariableParenthesis {\n  OPEN = '{',\n  CLOSE = '}',\n}\n// Higher precedence value means higher priority\nconst precedence = {\n  [Operator.ADD]: 1,\n  [Operator.SUBTRACT]: 1,\n  [Operator.MULTIPLY]: 2,\n  [Operator.DIVIDE]: 2,\n  [Operator.POWER]: 3,\n  [Operator.NEGATIVE_SIGN]: 4,\n  [Operator.POSITIVE_SIGN]: 4,\n};\n\nconst isBinaryOperator = (char: string | number | undefined) => {\n  if (typeof char === 'string') {\n    return [Operator.ADD, Operator.SUBTRACT, Operator.MULTIPLY, Operator.DIVIDE, Operator.POWER].includes(\n      char as Operator,\n    );\n  }\n  return false;\n};\n\nconst isUnaryOperator = (char: string | number | undefined) => {\n  if (typeof char === 'string') {\n    return [Operator.NEGATIVE_SIGN, Operator.POSITIVE_SIGN].includes(char as Operator);\n  }\n  return false;\n};\nconst isHigherPrecedence = (op1: Operator, op2: Operator) => precedence[op1] > precedence[op2];\n\nconst indexToVariableString = (name: number) => `${VARIABLE_OPERATOR}{${name}}`;\nconst variableStringToIndex = (variable: string) => variable.slice(2, -1);\n\n// Parses variables from an expression and replace with an index\nexport const parseVariablesAndReplaceWithIndex = (expression: string) => {\n  const matches = expression.match(MATCH_VARIABLE_REGEX);\n  if (!matches) {\n    return { expression, variables: [] };\n  }\n  // De-duplicate matches and map them to their index\n  const dedupMatches = uniq(matches);\n  const matchesMap: Record<string, string> = {};\n  dedupMatches.forEach((match, index) => {\n    matchesMap[match] = indexToVariableString(index);\n  });\n  // Convert each variable into an index number e.g. ${train/loss} => ${0}\n  const replacedExpression = expression.replace(MATCH_VARIABLE_REGEX, (match) => {\n    if (match in matchesMap) {\n      return matchesMap[match];\n    }\n    return match;\n  });\n\n  const variables = dedupMatches.map(variableStringToIndex);\n  return { expression: replacedExpression, variables };\n};\n\n// Pop function that throws an error if the stack is empty\nconst popAndValidate = (stack: (string | number)[], operandCount: number[]): string | number => {\n  const lastElement = stack.pop();\n  if (lastElement === undefined) {\n    throw new Error('Invalid expression: stack is empty');\n  } else if (isBinaryOperator(lastElement)) {\n    if (operandCount[operandCount.length - 1] < 2) {\n      throw new Error('Invalid expression: Stack has binary operator without enough operands');\n    }\n    operandCount[operandCount.length - 1]--;\n  } else if (isUnaryOperator(lastElement)) {\n    if (operandCount[operandCount.length - 1] < 1) {\n      throw new Error('Invalid expression: Stack has unary operator without enough operands');\n    }\n  } else {\n    throw new Error('Invalid expression: Stack has invalid elements');\n  }\n  return lastElement;\n};\n\n// Flushes all the unary operators on a given value\nconst flushUnaryOperators = (stack: (string | number)[], output: (string | number)[], operandCount: number[]) => {\n  while (stack.length > 0 && isUnaryOperator(last(stack))) {\n    output.push(popAndValidate(stack, operandCount));\n  }\n};\n\nconst toRPN = (expression: string) => {\n  const stack: (string | number)[] = [];\n  const output: (string | number)[] = [];\n  const operandCount: number[] = [0];\n\n  const incrementOperand = () => {\n    operandCount[operandCount.length - 1]++;\n  };\n  for (let i = 0; i < expression.length; i++) {\n    let char = expression[i];\n\n    // Convert unary operators to placeholder negative and positive signs\n    const isUnarySign = i === 0 || isBinaryOperator(expression[i - 1]) || expression[i - 1] === Parenthesis.OPEN;\n    if (char === Operator.SUBTRACT && isUnarySign) {\n      char = Operator.NEGATIVE_SIGN;\n    } else if (char === Operator.ADD && isUnarySign) {\n      char = Operator.POSITIVE_SIGN;\n    }\n\n    if (char === VARIABLE_OPERATOR) {\n      let variable = '';\n      if (i + 1 >= expression.length || expression[i + 1] !== VariableParenthesis.OPEN) {\n        throw new Error('Invalid expression: Variable must be followed by {');\n      }\n      i++; // Skip '{'\n      while (i + 1 < expression.length && expression[i + 1] !== VariableParenthesis.CLOSE) {\n        variable += expression[++i];\n      }\n      i++; // Skip '}'\n      output.push(variable);\n      incrementOperand();\n      flushUnaryOperators(stack, output, operandCount);\n    } else if (/\\d/.test(char) || char === '.') {\n      // If the character is part of a number (digit or decimal point)\n      let num = char;\n      // Parse full number\n      while (i + 1 < expression.length && (/\\d/.test(expression[i + 1]) || expression[i + 1] === '.')) {\n        num += expression[++i];\n      }\n      const periodMatches = num.match(/\\./g);\n      if (periodMatches && periodMatches.length > 1) {\n        throw new Error('Invalid expression: Number has multiple decimal points');\n      }\n      const floatNum = parseFloat(num);\n      incrementOperand();\n      output.push(floatNum);\n      flushUnaryOperators(stack, output, operandCount);\n    } else if (isUnaryOperator(char)) {\n      stack.push(char);\n    } else if (isBinaryOperator(char)) {\n      // If its a binary operator, we should have at least on element in the output to operate on\n      if (output.length === 0) {\n        throw new Error('Invalid expression: Binary operator without operands');\n      }\n      while (\n        stack.length > 0 &&\n        isBinaryOperator(last(stack)) &&\n        (isHigherPrecedence(last(stack) as Operator, char as Operator) ||\n          (last(stack) === char && char !== Operator.POWER))\n      ) {\n        output.push(popAndValidate(stack, operandCount));\n      }\n      stack.push(char);\n    } else if (char === Parenthesis.OPEN) {\n      stack.push(char);\n      operandCount.push(0);\n    } else if (char === Parenthesis.CLOSE) {\n      while (stack.length > 0 && last(stack) !== Parenthesis.OPEN) {\n        output.push(popAndValidate(stack, operandCount));\n      }\n      const openParen = stack.pop(); // Remove '(' from the stack\n      if (openParen !== Parenthesis.OPEN) {\n        throw new Error('Invalid expression: Parenthesis mismatch');\n      }\n      if (operandCount[operandCount.length - 1] !== 1) {\n        throw new Error('Invalid expression: Parenthesis does not have exactly one operand');\n      }\n      operandCount.pop();\n      incrementOperand();\n      flushUnaryOperators(stack, output, operandCount);\n    } else {\n      throw new Error('Invalid expression: Unknown character in expression');\n    }\n  }\n  // The stack should only have unary and binary operators at the end\n  while (stack.length > 0) {\n    output.push(popAndValidate(stack, operandCount));\n  }\n  if (operandCount.length !== 1 || operandCount[0] !== 1) {\n    throw new Error('Invalid expression: Invalid number of operands');\n  }\n  return output;\n};\n\nconst fromRPN = (tokens: (string | number)[]) => {\n  const stack: (number | string)[] = [];\n  tokens.forEach((token) => {\n    if (typeof token === 'number') {\n      stack.push(token);\n      return;\n    }\n    if (isUnaryOperator(token)) {\n      const x = stack.pop();\n      if (typeof x !== 'number') {\n        throw new Error('Invalid expression: Unary operator without operand');\n      }\n      switch (token) {\n        case Operator.NEGATIVE_SIGN:\n          stack.push(-x);\n          break;\n        case Operator.POSITIVE_SIGN:\n          stack.push(x);\n          break;\n      }\n    } else if (isBinaryOperator(token)) {\n      const b = stack.pop();\n      const a = stack.pop();\n      if (typeof a !== 'number' || typeof b !== 'number') {\n        throw new Error('Invalid expression: Binary operator without enough operands');\n      }\n      switch (token) {\n        case Operator.ADD:\n          stack.push(a + b);\n          break;\n        case Operator.SUBTRACT:\n          stack.push(a - b);\n          break;\n        case Operator.MULTIPLY:\n          stack.push(a * b);\n          break;\n        case Operator.DIVIDE:\n          stack.push(a / b);\n          break;\n        case Operator.POWER:\n          stack.push(Math.pow(a, b));\n          break;\n      }\n    } else {\n      throw new Error('Invalid expression: Unknown token in expression');\n    }\n  });\n  if (stack.length !== 1 || typeof stack[0] !== 'number') {\n    throw new Error('Invalid expression: Invalid expression result');\n  }\n  return stack[0];\n};\n\nexport const useChartExpressionParser = () => {\n  const compileExpression = useCallback(\n    (expression: string, metricKeyList: string[]): RunsChartsLineChartExpression | undefined => {\n      try {\n        // Validate only contains valid characters\n        const noVariableExpression = expression.replace(MATCH_VARIABLE_REGEX, '');\n        if (!/^[0-9+\\-*/().\\s^]*$/.test(noVariableExpression)) {\n          return undefined;\n        }\n        // Parse variables from expression and remove whitespace elsewhere\n        const { expression: parsedExpression, variables } = parseVariablesAndReplaceWithIndex(expression);\n        // Check if all variables are valid\n        for (const variable of variables) {\n          if (!metricKeyList.includes(variable)) {\n            return undefined;\n          }\n        }\n        const cleanedExpression = parsedExpression.replace(/\\s/g, '');\n        const replacedExpression = cleanedExpression.replace(MATCH_VARIABLE_REGEX, (match) => {\n          const index = parseInt(match.slice(2, -1), 10);\n          return `${VARIABLE_OPERATOR}{${variables[index]}}`;\n        });\n        // Convert expression to RPN\n        const rpn = toRPN(replacedExpression);\n        return {\n          rpn,\n          variables,\n          expression,\n        };\n      } catch (e) {\n        // If not a valid expression, return undefined\n        return undefined;\n      }\n    },\n    [],\n  );\n\n  const evaluateExpression = (\n    chartExpression: RunsChartsLineChartExpression | undefined,\n    variables: Record<string, number>,\n  ): number | undefined => {\n    if (chartExpression === undefined) {\n      return undefined;\n    }\n    try {\n      const parsedRPN = chartExpression.rpn.map((token) => {\n        if (typeof token === 'string' && chartExpression.variables.includes(token)) {\n          return variables[token];\n        }\n        return token;\n      });\n      return fromRPN(parsedRPN);\n    } catch (e) {\n      return undefined;\n    }\n  };\n\n  return {\n    compileExpression,\n    evaluateExpression,\n  };\n};\n","import { useCallback, useRef, useState } from 'react';\nimport { type Data, type Layout, type Config, downloadImage } from 'plotly.js';\n\nexport type ExperimentChartImageDownloadFileFormat = 'svg' | 'png';\nexport type ExperimentChartImageDownloadHandler = (\n  format: ExperimentChartImageDownloadFileFormat,\n  chartTitle: string,\n) => void;\n\nconst experimentChartImageDefaultDownloadLayout: Partial<Layout> = {\n  paper_bgcolor: 'white',\n  plot_bgcolor: 'white',\n};\n\nconst experimentChartImageDefaultDownloadSettings = {\n  width: 1200,\n  height: 600,\n};\n\nconst experimentChartImageDefaultDownloadPlotConfig: Partial<Config> = {\n  displaylogo: false,\n  modeBarButtonsToRemove: ['toImage'],\n};\n\nexport const createChartImageDownloadHandler =\n  (data: Data[], layout: Partial<Layout>) => (format: 'svg' | 'png', title: string) =>\n    downloadImage(\n      {\n        data,\n        layout: { ...layout, ...experimentChartImageDefaultDownloadLayout },\n        config: experimentChartImageDefaultDownloadPlotConfig,\n      },\n      { ...experimentChartImageDefaultDownloadSettings, format, filename: title },\n    );\n\n/**\n * Returns a memoized download handler for chart images.\n * Uses ref-based caching to ensure that the download handler is not recreated on every render.\n */\nexport const useChartImageDownloadHandler = () => {\n  const downloadHandlerRef = useRef<ExperimentChartImageDownloadHandler | null>(null);\n  const [downloadHandler, setDownloadHandler] = useState<ExperimentChartImageDownloadHandler | null>(null);\n\n  const setDownloadHandlerCached = useCallback((downloadHandler: ExperimentChartImageDownloadHandler) => {\n    downloadHandlerRef.current = downloadHandler;\n    setDownloadHandler((existingHandler: ExperimentChartImageDownloadHandler | null) => {\n      if (existingHandler) {\n        return existingHandler;\n      }\n\n      return (format: ExperimentChartImageDownloadFileFormat, chartTitle: string) =>\n        downloadHandlerRef.current?.(format, chartTitle);\n    });\n  }, []);\n\n  return [downloadHandler, setDownloadHandlerCached] as const;\n};\n","import { ImageEntity } from '@mlflow/mlflow/src/experiment-tracking/types';\nimport { RunsChartsRunData } from '../components/RunsCharts.common';\n\nexport const useImageSliderStepMarks = ({\n  data,\n  selectedImageKeys,\n}: {\n  data: RunsChartsRunData[];\n  selectedImageKeys: string[];\n}) => {\n  const stepMarks = data.reduce((acc, run: RunsChartsRunData) => {\n    for (const imageKey of Object.keys(run.images)) {\n      if (selectedImageKeys?.includes(imageKey)) {\n        const metadata = run.images[imageKey];\n        for (const meta of Object.values(metadata)) {\n          if (meta.step !== undefined) {\n            acc[meta.step] = {\n              style: { display: 'none' },\n              label: '',\n            };\n          }\n        }\n      }\n    }\n    return acc;\n  }, {} as Record<number, any>);\n\n  return {\n    stepMarks,\n    maxMark: Math.max(...Object.keys(stepMarks).map(Number)),\n    minMark: Math.min(...Object.keys(stepMarks).map(Number)),\n  };\n};\n","import { useCallback, useEffect, useRef, useState } from 'react';\nimport { shouldDeferLineChartRendering } from '../../../../common/utils/FeatureUtils';\nimport { useDebounce } from 'use-debounce';\n\nconst VIEWPORT_DEBOUNCE_MS = 150;\n\n/**\n * Checks if the element is currently visible within the viewport using IntersectionObserver.\n * If \"enabled\" is set to false, the returned value will always be true.\n */\nexport const useIsInViewport = ({\n  enabled = true,\n  deferTimeoutMs = VIEWPORT_DEBOUNCE_MS,\n}: { enabled?: boolean; deferTimeoutMs?: number } = {}) => {\n  const activeObserver = useRef<IntersectionObserver | null>(null);\n  const [isInViewport, setIsInViewport] = useState(!enabled);\n  // Let's use IntersectionObserver to determine if the element is displayed within the viewport\n  const startObserver = useCallback(\n    (element: Element | null) => {\n      // If \"enabled\" is set to false or IntersectionObserver is not available, assume that the element is visible\n      if (!enabled || !window.IntersectionObserver) {\n        setIsInViewport(true);\n        return () => {};\n      }\n\n      if (!element) {\n        return () => {};\n      }\n\n      // Set the state flag only if element is in viewport\n      const intersectionObserver = new IntersectionObserver(([entry]) => {\n        setIsInViewport(entry.isIntersecting);\n      });\n\n      // Run intersection observer as a macrotask, makes it wait for the next tick\n      // before start observing the element to make sure the observer will register the element\n      setTimeout(() => {\n        if (element) {\n          intersectionObserver.observe(element);\n        }\n      });\n\n      activeObserver.current = intersectionObserver;\n\n      return intersectionObserver;\n    },\n    [enabled],\n  );\n\n  const disconnect = useCallback(() => {\n    if (activeObserver.current) {\n      activeObserver.current.disconnect();\n      activeObserver.current = null;\n    }\n  }, []);\n\n  const setElementRef = useCallback(\n    (ref: Element | null) => {\n      // Attempt to disconnect the previous observer\n      disconnect();\n\n      // Start a new observer\n      startObserver(ref);\n    },\n    [disconnect, startObserver],\n  );\n\n  // Disconnect the observer when the component is unmounted\n  useEffect(() => disconnect, [disconnect]);\n\n  // If the feature flag is flipped, append deferred value to the result\n  if (shouldDeferLineChartRendering()) {\n    // We can safely disable the eslint rule here because flag evaluation is stable\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    const [isInViewportDeferred] = useDebounce(isInViewport, deferTimeoutMs);\n    return { isInViewport, elementRef: setElementRef, isInViewportDeferred };\n  }\n\n  // When the flag is disabled, deferred result is the same as the regular one\n  return { isInViewport, elementRef: setElementRef, isInViewportDeferred: isInViewport };\n};\n","import type { PlotMouseEvent } from 'plotly.js';\nimport { useEffect, useRef } from 'react';\n\n/**\n * Unfortunately plotly.js memorizes first onHover callback given on initial render,\n * so in order to achieve updated behavior we need to wrap each onHover callback with an\n * immutable callback that will call mutable implementation.\n */\nexport const useMutableChartHoverCallback = <T extends (event: Readonly<PlotMouseEvent>) => void>(callback: T) => {\n  const mutableRef = useRef<T>(callback);\n\n  useEffect(() => {\n    mutableRef.current = callback;\n  }, [callback]);\n\n  return (event: Readonly<PlotMouseEvent>) => {\n    mutableRef.current(event);\n  };\n};\n","import { isUndefined, noop } from 'lodash';\nimport {\n  type PropsWithChildren,\n  createContext,\n  createElement,\n  useContext,\n  useMemo,\n  useRef,\n  useEffect,\n  useState,\n  useCallback,\n} from 'react';\nimport { shouldEnableUnifiedChartDataTraceHighlight } from '../../../../common/utils/FeatureUtils';\n\n/**\n * Function used to highlight particular trace in the experiment runs chart,\n * for both hover and select scenarios.\n * Since implementation varies across chart types, the function is curryable where\n * two first-level parameters determine the target SVG selector paths to the trace within\n * target chart type.\n *\n * @param traceSelector selector path to the trace for a particular chart type\n * @param parentSelector selector path to the traces container for a particular chart type\n */\nconst highlightChartTracesFn =\n  (traceSelector: string, parentSelector: string) =>\n  /**\n   * @param parent a HTML element containing the chart\n   * @param hoverIndex index of a trace that should be hover-higlighted, set -1 to remove highlight\n   * @param selectIndex index of a trace that should be select-higlighted, set -1 to remove highlight\n   */\n  (parent: HTMLElement, hoverIndex: number, selectIndex: number, numberOfBands = 0) => {\n    const deselected = hoverIndex === -1 && selectIndex === -1;\n\n    parent.querySelector('.is-hover-highlight')?.classList.remove('is-hover-highlight');\n    if (hoverIndex > -1) {\n      parent.querySelectorAll(traceSelector)[hoverIndex]?.classList.add('is-hover-highlight');\n    }\n\n    parent.querySelector('.is-selection-highlight')?.classList.remove('is-selection-highlight');\n    if (selectIndex > -1) {\n      parent.querySelectorAll(traceSelector)[selectIndex]?.classList.add('is-selection-highlight');\n    }\n\n    if (numberOfBands > 0) {\n      const bandTraceIndex =\n        selectIndex > -1 ? selectIndex - numberOfBands : hoverIndex > -1 ? hoverIndex - numberOfBands : -1;\n      parent.querySelectorAll(traceSelector).forEach((e, index) => {\n        e.classList.toggle('is-band', index >= 0 && index < numberOfBands);\n        e.classList.toggle('is-band-highlighted', index === bandTraceIndex);\n      });\n    } else {\n      parent.querySelectorAll(traceSelector).forEach((e) => e.classList.remove('is-band'));\n    }\n\n    if (deselected) {\n      parent.querySelector(parentSelector)?.classList.remove('is-highlight');\n    } else {\n      parent.querySelector(parentSelector)?.classList.add('is-highlight');\n    }\n  };\n\n/**\n * Type-specific implementation of highlightChartTracesFn for bar charts\n */\nexport const highlightBarTraces = highlightChartTracesFn('svg .trace.bars g.point', '.trace.bars');\n\n/**\n * Type-specific implementation of highlightChartTracesFn for line charts\n */\nexport const highlightLineTraces = highlightChartTracesFn('svg .scatterlayer g.trace', '.scatterlayer');\n\n/**\n * Type-specific implementation of highlightChartTracesFn for scatter and contour charts\n */\nexport const highlightScatterTraces = highlightChartTracesFn('svg .scatterlayer path.point', '.trace.scatter');\n\n/**\n * This hook provides mechanisms necessary for highlighting SVG trace paths\n * in experiment runs charts.\n *\n * @param containerDiv HTML element containing the chart\n * @param selectedRunUuid currently selected run UUID (set to -1 if none)\n * @param runsData array containing run informations, should be the same order as provided to the chart\n * @param highlightFn a styling function that will be called when the trace should be (un)highlighted, please refer to `highlightCallbackFn()`\n */\nexport const useRenderRunsChartTraceHighlight = (\n  containerDiv: HTMLElement | null,\n  selectedRunUuid: string | null | undefined,\n  runsData: { uuid?: string }[],\n  highlightFn: ReturnType<typeof highlightChartTracesFn>,\n  numberOfBands = 0,\n) => {\n  // Save the last runs data to be available immediately on non-stateful callbacks\n  const lastRunsData = useRef(runsData);\n  lastRunsData.current = runsData;\n\n  const selectedTraceIndex = useMemo(() => {\n    if (!containerDiv || !selectedRunUuid) {\n      return -1;\n    }\n    return runsData.findIndex(({ uuid }) => uuid === selectedRunUuid);\n  }, [runsData, containerDiv, selectedRunUuid]);\n\n  const [hoveredPointIndex, setHoveredPointIndex] = useState(-1);\n  const { onHighlightChange } = useRunsChartTraceHighlight();\n\n  useEffect(() => {\n    // Disable this hook variant if new highlight model is enabled\n    if (shouldEnableUnifiedChartDataTraceHighlight()) {\n      return;\n    }\n    if (!containerDiv) {\n      return;\n    }\n    highlightFn(containerDiv, hoveredPointIndex, selectedTraceIndex, numberOfBands);\n  }, [highlightFn, containerDiv, selectedTraceIndex, hoveredPointIndex, numberOfBands]);\n\n  useEffect(() => {\n    // Use this hook variant only if new highlight model is enabled\n    if (!shouldEnableUnifiedChartDataTraceHighlight()) {\n      return;\n    }\n    if (!containerDiv) {\n      return;\n    }\n    // Here, we don't report stateful hovered run UUID since it's handled by the new highlight model\n    highlightFn(containerDiv, -1, selectedTraceIndex, numberOfBands);\n  }, [highlightFn, containerDiv, selectedTraceIndex, numberOfBands]);\n\n  // Save the last selected trace index to be available immediately on non-stateful callbacks\n  const lastSelectedTraceIndex = useRef(selectedTraceIndex);\n  lastSelectedTraceIndex.current = selectedTraceIndex;\n\n  const highlightChangeListener = useCallback(\n    (newExtern: string | null) => {\n      if (!containerDiv) {\n        return;\n      }\n\n      const externallyHighlightedRunIndex = lastRunsData.current.findIndex(({ uuid }) => uuid === newExtern);\n      highlightFn(containerDiv, externallyHighlightedRunIndex, lastSelectedTraceIndex.current, numberOfBands);\n    },\n    [highlightFn, containerDiv, numberOfBands],\n  );\n\n  // Listen to the highlight change event\n  useEffect(() => onHighlightChange(highlightChangeListener), [onHighlightChange, highlightChangeListener]);\n\n  return {\n    selectedTraceIndex,\n    hoveredPointIndex,\n    // With the unified chart data trace highlight, we don't need to do costly state updates anymore\n    setHoveredPointIndex: shouldEnableUnifiedChartDataTraceHighlight() ? noop : setHoveredPointIndex,\n  };\n};\n\nexport enum ChartsTraceHighlightSource {\n  NONE,\n  CHART,\n  TABLE,\n}\n\ninterface RunsChartsSetHighlightContextType {\n  highlightDataTrace: (\n    traceUuid: string | null,\n    options?: { source?: ChartsTraceHighlightSource; shouldBlock?: boolean },\n  ) => void;\n  onHighlightChange: (fn: (traceUuid: string | null, source?: ChartsTraceHighlightSource) => void) => () => void;\n}\n\nconst RunsChartsSetHighlightContext = createContext<RunsChartsSetHighlightContextType>({\n  highlightDataTrace: () => {},\n  onHighlightChange: () => () => {},\n});\n\nexport const RunsChartsSetHighlightContextProvider = ({ children }: PropsWithChildren<unknown>) => {\n  const highlightListenerFns = useRef<((traceUuid: string | null, source?: ChartsTraceHighlightSource) => void)[]>([]);\n  const block = useRef(false);\n\n  // Stable and memoized context value\n  const contextValue = useMemo<RunsChartsSetHighlightContextType>(() => {\n    // If new highlight model is disabled, disable entire feature by providint empty logic to the context\n    if (!shouldEnableUnifiedChartDataTraceHighlight()) {\n      return {\n        highlightDataTrace: () => {},\n        onHighlightChange: () => () => {},\n      };\n    }\n\n    const notifyListeners = (traceUuid: string | null, source?: ChartsTraceHighlightSource) => {\n      for (const fn of highlightListenerFns.current) {\n        fn(traceUuid, source);\n      }\n    };\n\n    const highlightDataTrace = (\n      traceUuid: string | null,\n      { shouldBlock, source }: { source?: ChartsTraceHighlightSource; shouldBlock?: boolean } = {},\n    ) => {\n      if (!isUndefined(shouldBlock)) {\n        block.current = shouldBlock;\n      } else if (block.current) {\n        return;\n      }\n      notifyListeners(traceUuid, source);\n    };\n\n    const onHighlightChange = (listener: (traceUuid: string | null, source?: ChartsTraceHighlightSource) => void) => {\n      highlightListenerFns.current.push(listener);\n      return () => {\n        highlightListenerFns.current = highlightListenerFns.current.filter((fn) => fn !== listener);\n      };\n    };\n\n    return {\n      highlightDataTrace,\n      onHighlightChange,\n    };\n  }, []);\n\n  return createElement(RunsChartsSetHighlightContext.Provider, { value: contextValue }, children);\n};\n\nexport const useRunsChartTraceHighlight = () => useContext(RunsChartsSetHighlightContext);\n","import { Interpolation, Theme } from '@emotion/react';\nimport React, { useCallback, useContext, useEffect, useLayoutEffect, useMemo, useRef, useState } from 'react';\nimport type {\n  RunsCompareMultipleTracesTooltipData,\n  RunsMetricsSingleTraceTooltipData,\n} from '../components/RunsMetricsLinePlot';\nimport { RunsMetricsBarPlotHoverData } from '../components/RunsMetricsBarPlot';\nimport { shouldEnableDeepLearningUIPhase3 } from '../../../../common/utils/FeatureUtils';\nimport { ChartsTraceHighlightSource, useRunsChartTraceHighlight } from './useRunsChartTraceHighlight';\nimport { RUNS_CHARTS_UI_Z_INDEX } from '../utils/runsCharts.const';\n\nexport interface RunsChartsTooltipBodyProps<TContext = any, TChartData = any, THoverData = any> {\n  runUuid: string;\n  hoverData: THoverData;\n  chartData: TChartData;\n  contextData: TContext;\n  closeContextMenu: () => void;\n  isHovering?: boolean;\n  mode: RunsChartsTooltipMode;\n}\n\nexport interface RunsChartsChartMouseEvent {\n  x: number;\n  y: number;\n  originalEvent?: MouseEvent;\n}\n\nexport enum RunsChartsTooltipMode {\n  Simple = 1,\n  MultipleTracesWithScanline = 2,\n}\n\nexport type RunsChartsTooltipBodyComponent<C = any, T = any> = React.ComponentType<RunsChartsTooltipBodyProps<C, T>>;\n\nconst RunsChartsTooltipContext = React.createContext<{\n  selectedRunUuid: string | null;\n  closeContextMenu: () => void;\n  resetTooltip: () => void;\n  destroyTooltip: () => void;\n  updateTooltip: (\n    runUuid: string,\n    mode: RunsChartsTooltipMode,\n    chartData?: any,\n    event?: RunsChartsChartMouseEvent,\n    additionalData?: any,\n  ) => void;\n} | null>(null);\n\nexport enum ContextMenuVisibility {\n  HIDDEN,\n  HOVER,\n  VISIBLE,\n}\n\nexport const containsMultipleRunsTooltipData = (\n  hoverData: RunsMetricsBarPlotHoverData | RunsMetricsSingleTraceTooltipData | RunsCompareMultipleTracesTooltipData,\n): hoverData is RunsCompareMultipleTracesTooltipData => hoverData && 'tooltipLegendItems' in hoverData;\n\n/**\n * Extract first ancestor HTML element in the hierarchy, even if the target is an SVG element.\n * Necessary for proper behavior of '.contains()'\n */\nconst extractHTMLAncestorElement = (element: Element | EventTarget | null) => {\n  if (element === null || !(element instanceof Element)) {\n    return null;\n  }\n  if (element instanceof HTMLElement) {\n    return element;\n  }\n\n  let currentElement: Element | null = element;\n  while (currentElement && !(currentElement instanceof HTMLElement)) {\n    currentElement = currentElement.parentElement;\n  }\n\n  return currentElement;\n};\n\n/**\n * Context and DOM container necessary for chart context menu to work.\n * Can wrap multiple charts.\n */\nexport const RunsChartsTooltipWrapper = <\n  // Type for the context data passed to the tooltip, e.g. list of all runs\n  TContext = any,\n  // Type for local hover data passed to the tooltip, e.g. configuration of particular chart\n  THover = any,\n>({\n  className,\n  children,\n  contextData,\n  component: Component,\n  hoverOnly = false,\n}: React.PropsWithChildren<{\n  className?: string;\n  contextData: TContext;\n  component: React.ComponentType<RunsChartsTooltipBodyProps<TContext, THover>>;\n  hoverOnly?: boolean;\n}>) => {\n  // A reference to the viewport-wide element containing the context menu\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  // A reference to the tooltip/context-menu element\n  const ctxMenuRef = useRef<HTMLDivElement>(null);\n\n  // Mutable value containing current mouse position\n  const currentPos = useRef<{ x: number; y: number }>({ x: 0, y: 0 });\n\n  const usingImprovedClickMechanism = shouldEnableDeepLearningUIPhase3();\n\n  // Mutable value containing current snapped mouse position, provided externally by the tooltip data providers\n  // Used instead of `currentPos` when the tooltip is in the \"multiple runs\" mode\n  const currentSnappedCoordinates = useRef<{ x: number; y: number }>({ x: 0, y: 0 });\n\n  const [mode, setMode] = useState<RunsChartsTooltipMode>(RunsChartsTooltipMode.Simple);\n\n  // Current visibility of the tooltip/context-menu\n  const [contextMenuShown, setContextMenuShown] = useState<ContextMenuVisibility>(ContextMenuVisibility.HIDDEN);\n\n  const [tooltipDisplayParams, setTooltipDisplayParams] = useState<any | null>(null);\n  const [hoveredRunUuid, setHoveredRunUuid] = useState<string>('');\n\n  // Apart from run uuid, It's also possible to set bonus axis data (helpful for line charts with data lineage)\n  const [additionalAxisData, setAdditionalAxisData] = useState<any>(null);\n\n  // Stores data about the run that has been clicked, but mouse has not been released.\n  const focusedRunData = useRef<{ x: number; y: number; runUuid: string } | null>(null);\n\n  // Mutable version of certain state values, used in processes outside the React event lifecycle\n  const mutableContextMenuShownRef = useRef<ContextMenuVisibility>(contextMenuShown);\n  const mutableHoveredRunUuid = useRef(hoveredRunUuid);\n  const mutableTooltipDisplayParams = useRef(tooltipDisplayParams);\n  const mutableAdditionalAxisData = useRef(additionalAxisData);\n\n  // Get the higlighting function from the context\n  const { highlightDataTrace } = useRunsChartTraceHighlight();\n\n  // This method applies the tooltip position basing on the mouse position\n  const applyPositioning = useCallback(\n    (isChangingVisibilityMode = false) => {\n      if (!ctxMenuRef.current || !containerRef.current) {\n        return;\n      }\n\n      // For the X coordinate, If the tooltip is in the \"multiple runs\" mode, use the snapped coordinates.\n      // Otherwise, use the current mouse position.\n      let targetX =\n        mode === RunsChartsTooltipMode.MultipleTracesWithScanline\n          ? currentSnappedCoordinates.current.x\n          : currentPos.current.x;\n\n      let targetY = currentPos.current.y;\n\n      const currentCtxMenu = ctxMenuRef.current;\n      const containerRect = containerRef.current.getBoundingClientRect();\n\n      if (mode === RunsChartsTooltipMode.MultipleTracesWithScanline) {\n        // In particular cases, the tooltip container can not take entire viewport size\n        // so we need to adjust the position of the tooltip\n        targetX -= containerRect.x;\n        targetY -= containerRect.y;\n      }\n\n      ctxMenuRef.current.style.left = '0px';\n      ctxMenuRef.current.style.top = '0px';\n      ctxMenuRef.current.style.transform = `translate3d(${targetX + 1}px, ${targetY + 1}px, 0)`;\n\n      // This function is used to reposition the tooltip if it's out of the viewport\n      const reposition = () => {\n        const menuRect = currentCtxMenu.getBoundingClientRect();\n\n        if (targetX + menuRect.width >= containerRect.width) {\n          targetX -= menuRect.width;\n        }\n\n        if (targetY + menuRect.height >= containerRect.height) {\n          targetY -= menuRect.height;\n        }\n\n        currentCtxMenu.style.transform = `translate3d(${targetX + 1}px, ${targetY + 1}px, 0)`;\n      };\n\n      // If the tooltip changes it's visibility mode during the process, defer repositioning to the next frame\n      // to make sure that the position is correct after possible change of the tooltip size.\n      // Otherwise, reposition immediately to save computation cycles.\n      if (isChangingVisibilityMode) {\n        requestAnimationFrame(reposition);\n      } else {\n        reposition();\n      }\n    },\n    [mode],\n  );\n\n  // Save mutable visibility each time a stateful one changes\n  useEffect(() => {\n    mutableContextMenuShownRef.current = contextMenuShown;\n  }, [contextMenuShown]);\n\n  // This function returns X and Y of the target element relative to the container\n  const getCoordinatesForTargetElement = useCallback((targetElement: HTMLElement, event: MouseEvent) => {\n    const targetRect = targetElement.getBoundingClientRect();\n    const containerRect = containerRef.current?.getBoundingClientRect() || { left: 0, top: 0 };\n    const x = event.offsetX + (targetRect.left - containerRect.left);\n    const y = event.offsetY + (targetRect.top - containerRect.top);\n    return { x, y };\n  }, []);\n\n  const mouseMove: React.MouseEventHandler<HTMLDivElement> = useCallback(\n    (event) => {\n      // Apply only if the tooltip is in the hover mode\n      if (\n        mutableContextMenuShownRef.current === ContextMenuVisibility.HOVER &&\n        ctxMenuRef.current &&\n        containerRef.current\n      ) {\n        focusedRunData.current = null;\n        const targetElement = extractHTMLAncestorElement(event.target);\n        if (targetElement) {\n          currentPos.current = getCoordinatesForTargetElement(targetElement, event.nativeEvent);\n          applyPositioning();\n        }\n      }\n    },\n    [applyPositioning, getCoordinatesForTargetElement],\n  );\n\n  // This callback is being fired on every new run being hovered\n  const updateTooltip = useCallback(\n    (\n      runUuid: string,\n      mode: RunsChartsTooltipMode,\n      chartData?: any,\n      event?: RunsChartsChartMouseEvent,\n      additionalRunData?: any,\n    ) => {\n      mutableHoveredRunUuid.current = runUuid;\n      mutableTooltipDisplayParams.current = chartData;\n      mutableAdditionalAxisData.current = additionalRunData;\n\n      // If the tooltip is visible and hardwired to the position, don't change it\n      if (mutableContextMenuShownRef.current === ContextMenuVisibility.VISIBLE) {\n        return;\n      }\n\n      // Update the event-specific data in the state\n      setTooltipDisplayParams(chartData);\n\n      // If the mouse button has been clicked on a run but hover\n      // has been lost, do nothing\n      if (!runUuid && focusedRunData.current?.runUuid) {\n        return;\n      }\n\n      if (mode === RunsChartsTooltipMode.MultipleTracesWithScanline) {\n        currentSnappedCoordinates.current.x = event?.x || 0;\n      }\n\n      // Set the mode - single run or multiple runs\n      setMode(mode);\n\n      // Update the currently hovered run\n      setHoveredRunUuid((currentRunUuid) => {\n        if (additionalRunData) {\n          setAdditionalAxisData(additionalRunData);\n        }\n        // If the tooltip was hidden or it's shown but it's another run,\n        // make sure that the state is updated\n        if (\n          mutableContextMenuShownRef.current === ContextMenuVisibility.HIDDEN ||\n          (mutableContextMenuShownRef.current === ContextMenuVisibility.HOVER && runUuid !== currentRunUuid)\n        ) {\n          setContextMenuShown(ContextMenuVisibility.HOVER);\n          return runUuid;\n        }\n        return currentRunUuid;\n      });\n    },\n    [],\n  );\n\n  const mouseDownCapture: React.MouseEventHandler<HTMLDivElement> = useCallback(\n    (event) => {\n      if (hoverOnly) {\n        return;\n      }\n      // Saves the current position and hovered run ID after lowering the mouse button,\n      // we use it afterwards to confirm that user has clicked on the same run and scrubbing/zooming\n      // didn't occur in the meanwhile\n      if (event.button === 0 && mutableHoveredRunUuid.current) {\n        focusedRunData.current = {\n          x: event.pageX,\n          y: event.pageY,\n          runUuid: mutableHoveredRunUuid.current,\n        };\n      }\n    },\n    [hoverOnly],\n  );\n\n  // Callback for the click event for the tooltip area, checks if context menu needs to be shown.\n  // We're not using `mouseup` because plotly.js hijacks the event by appending drag cover to the document on `mousedown`.\n  const tooltipAreaClicked: React.MouseEventHandler<HTMLDivElement> = useCallback(\n    (event) => {\n      if (hoverOnly) {\n        return;\n      }\n\n      const clickedInTheSamePlace = () => {\n        if (!usingImprovedClickMechanism) {\n          return (\n            focusedRunData.current?.runUuid &&\n            event.pageX === focusedRunData.current.x &&\n            event.pageY === focusedRunData.current.y\n          );\n        }\n        const epsilonPixels = 5;\n\n        return (\n          focusedRunData.current?.runUuid &&\n          Math.abs(event.pageX - focusedRunData.current.x) < epsilonPixels &&\n          Math.abs(event.pageY - focusedRunData.current.y) < epsilonPixels\n        );\n      };\n\n      // We're interested in displaying the context menu only if\n      // mouse is in the same position as when lowering the button,\n      // this way we won't display it when zooming on the chart.\n      if (focusedRunData.current && clickedInTheSamePlace()) {\n        // If the context menu is already visible, we need to reposition it and provide\n        // the updated run UUID\n        if (mutableContextMenuShownRef.current === ContextMenuVisibility.VISIBLE) {\n          setHoveredRunUuid(focusedRunData.current.runUuid);\n          setAdditionalAxisData(mutableAdditionalAxisData.current);\n          const targetElement = extractHTMLAncestorElement(event.nativeEvent.target);\n          if (targetElement) {\n            currentPos.current = getCoordinatesForTargetElement(targetElement, event.nativeEvent);\n            applyPositioning(true);\n          }\n        } else {\n          // If the context menu was not visible before (it was a tooltip), just enable it.\n          setContextMenuShown(ContextMenuVisibility.VISIBLE);\n          applyPositioning(true);\n        }\n        event.stopPropagation();\n      }\n      // Since the mouse button is up, reset the currently focused run\n      focusedRunData.current = null;\n    },\n    [applyPositioning, hoverOnly, getCoordinatesForTargetElement, usingImprovedClickMechanism],\n  );\n\n  // Exposed function used to hide the context menu\n  const closeContextMenu = useCallback(() => setContextMenuShown(ContextMenuVisibility.HIDDEN), []);\n\n  // Set up main listeners in the useLayoutEffect hook\n  useLayoutEffect(() => {\n    if (!containerRef.current) {\n      return undefined;\n    }\n\n    // Find the DOM root - it can be either document or a shadow root\n    const domRoot = containerRef.current.getRootNode() as Document;\n\n    // This function is being called on every click in the document,\n    // it's used to dismiss the shown context menu\n    const rootClickListener = (e: MouseEvent) => {\n      // We're interested only in dismissing context menu mode, tooltip is fine\n      if (mutableContextMenuShownRef.current !== ContextMenuVisibility.VISIBLE) {\n        return;\n      }\n\n      const targetElement = extractHTMLAncestorElement(e.target);\n\n      if (!targetElement) {\n        return;\n      }\n\n      // Check if the click event occurred within the\n      // context menu\n      const contextMenuClicked =\n        targetElement instanceof HTMLElement &&\n        ctxMenuRef?.current instanceof HTMLElement &&\n        ctxMenuRef.current.contains(targetElement);\n\n      // Dismiss the context menu only if click didn't occur on\n      // the context menu content or on another run\n      if (!contextMenuClicked && !focusedRunData.current?.runUuid) {\n        setContextMenuShown(ContextMenuVisibility.HIDDEN);\n      }\n    };\n    domRoot.addEventListener('click', rootClickListener, { capture: true });\n\n    return () => {\n      domRoot.removeEventListener('click', rootClickListener, { capture: true });\n    };\n  }, [getCoordinatesForTargetElement, applyPositioning]);\n\n  // Callback used to reset the tooltip, fired when the mouse leaves the run\n  const resetTooltip = useCallback(() => {\n    mutableHoveredRunUuid.current = '';\n    if (focusedRunData.current?.runUuid || mutableContextMenuShownRef.current === ContextMenuVisibility.VISIBLE) {\n      return;\n    }\n    setHoveredRunUuid('');\n    setContextMenuShown(ContextMenuVisibility.HIDDEN);\n  }, []);\n\n  // Callback used to remove the tooltip,\n  const destroyTooltip = useCallback((force = false) => {\n    mutableHoveredRunUuid.current = '';\n    setHoveredRunUuid('');\n    setContextMenuShown(ContextMenuVisibility.HIDDEN);\n  }, []);\n\n  // Export the currently selected run ID. Set to \"null\" if there is nothing selected.\n  const selectedRunUuid = useMemo(() => {\n    if (contextMenuShown !== ContextMenuVisibility.VISIBLE) {\n      return null;\n    }\n    return hoveredRunUuid;\n  }, [contextMenuShown, hoveredRunUuid]);\n\n  // When the selected data trace changes, report the highlight event\n  useEffect(\n    () =>\n      highlightDataTrace(selectedRunUuid, {\n        source: ChartsTraceHighlightSource.CHART,\n        // Block the highlight event so it won't change as long as the tooltip is in selected mode\n        shouldBlock: Boolean(selectedRunUuid),\n      }),\n    [highlightDataTrace, selectedRunUuid],\n  );\n\n  const contextValue = useMemo(\n    () => ({ updateTooltip, resetTooltip, destroyTooltip, selectedRunUuid, closeContextMenu }),\n    [updateTooltip, resetTooltip, destroyTooltip, selectedRunUuid, closeContextMenu],\n  );\n\n  // We're displaying tooltip if:\n  // - it's not in the hidden mode\n  // - it's in the single run tooltip mode and hovered run is not empty\n  // - it's in the multiple runs tooltip mode\n  const displayTooltip =\n    contextMenuShown !== ContextMenuVisibility.HIDDEN &&\n    (mode === RunsChartsTooltipMode.MultipleTracesWithScanline || hoveredRunUuid !== '');\n\n  return (\n    <RunsChartsTooltipContext.Provider value={contextValue}>\n      {/* The element below wraps all the children (where charts are expected to be mounted)\n      and tracks mouse movement inside */}\n      <div\n        onMouseMove={mouseMove}\n        onMouseDownCapture={mouseDownCapture}\n        onClickCapture={tooltipAreaClicked}\n        css={{ height: '100%' }}\n      >\n        {children}\n      </div>\n      {/* The element below houses the tooltip/context menu */}\n      <div css={styles.contextMenuContainer} className={className} ref={containerRef}>\n        {displayTooltip && (\n          <div\n            ref={ctxMenuRef}\n            css={styles.contextMenuWrapper}\n            data-testid=\"tooltip-container\"\n            style={{\n              userSelect: contextMenuShown === ContextMenuVisibility.HOVER ? 'none' : 'unset',\n              pointerEvents: contextMenuShown === ContextMenuVisibility.HOVER ? 'none' : 'all',\n            }}\n          >\n            {/* A tooltip body component passed from the props */}\n            <Component\n              runUuid={hoveredRunUuid}\n              hoverData={additionalAxisData}\n              chartData={tooltipDisplayParams}\n              contextData={contextData}\n              isHovering={contextMenuShown === ContextMenuVisibility.HOVER}\n              closeContextMenu={closeContextMenu}\n              mode={mode}\n            />\n          </div>\n        )}\n      </div>\n    </RunsChartsTooltipContext.Provider>\n  );\n};\n\n/**\n * This hook is used to wire up tooltip to particular experiment runs chart.\n * Returns \"setTooltip\" and \"resetTooltip\" functions that should be called\n * upon chart's \"onHover\" and \"onUnhover\" events. \"setTooltip\" function consumes\n * the runUuid that was hovered on.\n */\nexport const useRunsChartsTooltip = <\n  // Type for local hover data passed to the tooltip, e.g. configuration of particular chart\n  TChart = any,\n  TAxisData = any,\n>(\n  chartData?: TChart,\n  mode = RunsChartsTooltipMode.Simple,\n) => {\n  const contextValue = useContext(RunsChartsTooltipContext);\n\n  if (!contextValue) {\n    throw new Error(\n      'You must invoke useRunsChartsTooltip() in a component being ancestor of <RunsChartsTooltipWrapper />!',\n    );\n  }\n\n  const { updateTooltip, resetTooltip, selectedRunUuid, closeContextMenu, destroyTooltip } = contextValue;\n  const { highlightDataTrace } = useRunsChartTraceHighlight();\n\n  const setTooltip = useCallback(\n    (runUuid = '', event?: RunsChartsChartMouseEvent, additionalAxisData?: TAxisData) => {\n      updateTooltip(runUuid, mode, chartData, event, additionalAxisData);\n      highlightDataTrace(runUuid, {\n        source: ChartsTraceHighlightSource.CHART,\n      });\n    },\n    [updateTooltip, chartData, mode, highlightDataTrace],\n  );\n\n  const resetTooltipWithHighlight = useCallback(() => {\n    resetTooltip();\n    highlightDataTrace(null);\n  }, [resetTooltip, highlightDataTrace]);\n\n  return { setTooltip, resetTooltip: resetTooltipWithHighlight, selectedRunUuid, closeContextMenu, destroyTooltip };\n};\n\nconst styles = {\n  contextMenuContainer: {\n    overflow: 'hidden',\n    top: 0,\n    left: 0,\n    width: '100%',\n    height: '100%',\n    position: 'fixed',\n    pointerEvents: 'none',\n    zIndex: RUNS_CHARTS_UI_Z_INDEX.TOOLTIP_CONTAINER,\n  } as Interpolation<Theme>,\n  contextMenuWrapper: (theme: Theme) => ({\n    zIndex: RUNS_CHARTS_UI_Z_INDEX.TOOLTIP,\n    position: 'absolute' as const,\n    padding: theme.spacing.sm,\n    backgroundColor: theme.colors.backgroundPrimary,\n    border: `1px solid ${theme.colors.border}`,\n    left: -999,\n    top: -999,\n    borderRadius: theme.general.borderRadiusBase,\n    boxShadow: theme.general.shadowLow,\n  }),\n  overlayElement: (): Interpolation<Theme> => ({\n    '&::after': {\n      content: '\"\"',\n      position: 'absolute',\n      left: 0,\n      top: 0,\n      right: 0,\n      bottom: 0,\n      backgroundColor: 'transparent',\n    },\n  }),\n};\n","import React, { useCallback } from 'react';\nimport { ExperimentRunsChartsUIConfiguration } from '../../experiment-page/models/ExperimentPageUIState';\nimport { RunsChartsCardConfig } from '../runs-charts.types';\nimport { getUUID } from '../../../../common/utils/ActionUtils';\n\nexport type RunsChartsUIConfigurationSetter = (\n  state: ExperimentRunsChartsUIConfiguration,\n) => ExperimentRunsChartsUIConfiguration;\n\nconst RunsChartsUIConfigurationContext = React.createContext<(stateSetter: RunsChartsUIConfigurationSetter) => void>(\n  () => {},\n);\n\n/**\n * Creates a localized context to manage the UI state of the runs charts.\n * Accepts a function to update the state object, coming from simple state setter or a reducer.\n */\nexport const RunsChartsUIConfigurationContextProvider = ({\n  children,\n  updateChartsUIState,\n}: {\n  children: React.ReactNode;\n  updateChartsUIState: (stateSetter: RunsChartsUIConfigurationSetter) => void;\n}) => (\n  <RunsChartsUIConfigurationContext.Provider value={updateChartsUIState}>\n    {children}\n  </RunsChartsUIConfigurationContext.Provider>\n);\n\n/**\n * Returns a function to update the current overarching UI state of the runs charts.\n */\nexport const useUpdateRunsChartsUIConfiguration = () => React.useContext(RunsChartsUIConfigurationContext);\n\nexport const useReorderRunsChartsFn = () => {\n  const updateChartsUIState = useUpdateRunsChartsUIConfiguration();\n\n  return useCallback(\n    (sourceChartUuid: string, targetChartUuid: string) => {\n      updateChartsUIState((current) => {\n        const newChartsOrder = current.compareRunCharts?.slice();\n        const newSectionsState = current.compareRunSections?.slice();\n        if (!newChartsOrder || !newSectionsState) {\n          return current;\n        }\n\n        const indexSource = newChartsOrder.findIndex((c) => c.uuid === sourceChartUuid);\n        const indexTarget = newChartsOrder.findIndex((c) => c.uuid === targetChartUuid);\n\n        // If one of the charts is not found, do nothing\n        if (indexSource < 0 || indexTarget < 0) {\n          return current;\n        }\n\n        const sourceChart = newChartsOrder[indexSource];\n        const targetChart = newChartsOrder[indexTarget];\n\n        const isSameMetricSection = targetChart.metricSectionId === sourceChart.metricSectionId;\n\n        // Update the sections to indicate that the charts have been reordered\n        const sourceSectionIdx = newSectionsState.findIndex((c) => c.uuid === sourceChart.metricSectionId);\n        const targetSectionIdx = newSectionsState.findIndex((c) => c.uuid === targetChart.metricSectionId);\n        newSectionsState.splice(sourceSectionIdx, 1, { ...newSectionsState[sourceSectionIdx], isReordered: true });\n        newSectionsState.splice(targetSectionIdx, 1, { ...newSectionsState[targetSectionIdx], isReordered: true });\n\n        // Set new chart metric group\n        const newSourceChart = { ...sourceChart };\n        newSourceChart.metricSectionId = targetChart.metricSectionId;\n\n        // Remove the source graph from array\n        newChartsOrder.splice(indexSource, 1);\n        if (!isSameMetricSection) {\n          // Insert the source graph into target\n          newChartsOrder.splice(\n            newChartsOrder.findIndex((c) => c.uuid === targetChartUuid),\n            0,\n            newSourceChart,\n          );\n        } else {\n          // The indexTarget is not neccessarily the target now, but it will work as the insert index\n          newChartsOrder.splice(indexTarget, 0, newSourceChart);\n        }\n\n        return {\n          ...current,\n          compareRunCharts: newChartsOrder,\n          compareRunSections: newSectionsState,\n        };\n      });\n    },\n    [updateChartsUIState],\n  );\n};\n\nexport const useConfirmChartCardConfigurationFn = () => {\n  const updateChartsUIState = useUpdateRunsChartsUIConfiguration();\n  return (configuredCard: Partial<RunsChartsCardConfig>) => {\n    const serializedCard = RunsChartsCardConfig.serialize({\n      ...configuredCard,\n      uuid: getUUID(),\n    });\n\n    // Creating new chart\n    if (!configuredCard.uuid) {\n      updateChartsUIState((current) => ({\n        ...current,\n        // This condition ensures that chart collection will remain undefined if not set previously\n        compareRunCharts: current.compareRunCharts && [...current.compareRunCharts, serializedCard],\n      }));\n    } /* Editing existing chart */ else {\n      updateChartsUIState((current) => ({\n        ...current,\n        compareRunCharts: current.compareRunCharts?.map((existingChartCard) => {\n          if (existingChartCard.uuid === configuredCard.uuid) {\n            return serializedCard;\n          }\n          return existingChartCard;\n        }),\n      }));\n    }\n  };\n};\n\nexport const useInsertRunsChartsFn = () => {\n  const updateChartsUIState = useUpdateRunsChartsUIConfiguration();\n  return (sourceChartUuid: string, targetSectionId: string) => {\n    updateChartsUIState((current) => {\n      const newChartsOrder = current.compareRunCharts?.slice();\n      const newSectionsState = current.compareRunSections?.slice();\n      if (!newChartsOrder || !newSectionsState) {\n        return current;\n      }\n\n      const indexSource = newChartsOrder.findIndex((c) => c.uuid === sourceChartUuid);\n      if (indexSource < 0) {\n        return current;\n      }\n      const sourceChart = newChartsOrder[indexSource];\n      // Set new chart metric group\n      const newSourceChart = { ...sourceChart };\n      newSourceChart.metricSectionId = targetSectionId;\n\n      // Update the sections to indicate that the charts have been reordered\n      const sourceSectionIdx = newSectionsState.findIndex((c) => c.uuid === sourceChart.metricSectionId);\n      const targetSectionIdx = newSectionsState.findIndex((c) => c.uuid === targetSectionId);\n      newSectionsState.splice(sourceSectionIdx, 1, { ...newSectionsState[sourceSectionIdx], isReordered: true });\n      newSectionsState.splice(targetSectionIdx, 1, { ...newSectionsState[targetSectionIdx], isReordered: true });\n\n      // Remove the source graph from array and append\n      newChartsOrder.splice(indexSource, 1);\n      newChartsOrder.push(newSourceChart);\n\n      return {\n        ...current,\n        compareRunCharts: newChartsOrder,\n        compareRunSections: newSectionsState,\n      };\n    });\n  };\n};\n\nexport const useRemoveRunsChartFn = () => {\n  const updateChartsUIState = useUpdateRunsChartsUIConfiguration();\n\n  return useCallback(\n    (configToDelete: RunsChartsCardConfig) => {\n      updateChartsUIState((current) => ({\n        ...current,\n        compareRunCharts: configToDelete.isGenerated\n          ? current.compareRunCharts?.map((setup) =>\n              setup.uuid === configToDelete.uuid ? { ...setup, deleted: true } : setup,\n            )\n          : current.compareRunCharts?.filter((setup) => setup.uuid !== configToDelete.uuid),\n      }));\n    },\n    [updateChartsUIState],\n  );\n};\n","import { gql, NetworkStatus } from '@apollo/client';\nimport { useQuery } from '@mlflow/mlflow/src/common/utils/graphQLHooks';\nimport { EXPERIMENT_RUNS_METRIC_AUTO_REFRESH_INTERVAL } from '../../../utils/MetricsUtils';\nimport { groupBy, keyBy } from 'lodash';\nimport { useEffect, useMemo } from 'react';\nimport type { SampledMetricsByRun } from './useSampledMetricHistory';\nimport { GetMetricHistoryBulkInterval } from '../../../../graphql/__generated__/graphql';\nimport Utils from '../../../../common/utils/Utils';\nimport { useIntl } from 'react-intl';\n\nconst GET_METRIC_HISTORY_BULK_INTERVAL = gql`\n  query GetMetricHistoryBulkInterval($data: MlflowGetMetricHistoryBulkIntervalInput!)\n  @component(name: \"MLflow.ExperimentRunTracking\") {\n    mlflowGetMetricHistoryBulkInterval(input: $data) {\n      __typename\n      metrics {\n        timestamp\n        step\n        runId\n        key\n        value\n      }\n      apiError {\n        code\n        message\n      }\n    }\n  }\n`;\n\nexport const useSampledMetricHistoryGraphQL = ({\n  metricKey,\n  runUuids,\n  autoRefreshEnabled,\n  enabled,\n  maxResults = 320,\n  range,\n}: {\n  runUuids: string[];\n  metricKey: string;\n  maxResults?: number;\n  range?: [number, number];\n  enabled?: boolean;\n  autoRefreshEnabled?: boolean;\n}) => {\n  const intl = useIntl();\n  const { data, refetch, startPolling, stopPolling, networkStatus, error } = useQuery<GetMetricHistoryBulkInterval>(\n    GET_METRIC_HISTORY_BULK_INTERVAL,\n    {\n      skip: !enabled,\n      notifyOnNetworkStatusChange: true,\n      pollInterval: autoRefreshEnabled ? EXPERIMENT_RUNS_METRIC_AUTO_REFRESH_INTERVAL : undefined,\n      onCompleted(data) {\n        if (data.mlflowGetMetricHistoryBulkInterval?.apiError?.code === 'RESOURCE_DOES_NOT_EXIST') {\n          Utils.displayGlobalErrorNotification(\n            intl.formatMessage({\n              defaultMessage: 'Requested resource does not exist',\n              description:\n                'Error message displayed when a requested run does not exist while fetching sampled metric data',\n            }),\n          );\n        } else if (data.mlflowGetMetricHistoryBulkInterval?.apiError?.message) {\n          Utils.logErrorAndNotifyUser(new Error(data.mlflowGetMetricHistoryBulkInterval.apiError.message));\n        }\n      },\n      variables: {\n        data: {\n          runIds: runUuids,\n          metricKey,\n          startStep: range?.[0] ?? null,\n          endStep: range?.[1] ?? null,\n          maxResults,\n        },\n      },\n    },\n  );\n\n  useEffect(() => {\n    if (autoRefreshEnabled) {\n      startPolling(EXPERIMENT_RUNS_METRIC_AUTO_REFRESH_INTERVAL);\n    } else {\n      stopPolling();\n    }\n  }, [autoRefreshEnabled, startPolling, stopPolling]);\n\n  const resultsByRunUuid = useMemo<Record<string, SampledMetricsByRun>>(() => {\n    if (data) {\n      const metrics = data?.mlflowGetMetricHistoryBulkInterval?.metrics;\n      const metricsByRunId = groupBy(metrics, 'runId');\n\n      // Transform the data into the already existing format\n      return keyBy(\n        runUuids.map(\n          (runId) =>\n            ({\n              runUuid: runId,\n              [metricKey]: {\n                metricsHistory: metricsByRunId[runId]?.map(({ key, step, timestamp, value }) => ({\n                  key: key ?? undefined,\n                  step: Number(step),\n                  timestamp: Number(timestamp),\n                  value: value ?? undefined,\n                })),\n              },\n            } as SampledMetricsByRun),\n        ),\n        'runUuid',\n      );\n    }\n\n    return {};\n  }, [data, metricKey, runUuids]);\n\n  const isLoading = networkStatus === NetworkStatus.loading || networkStatus === NetworkStatus.setVariables;\n  const isRefreshing = networkStatus === NetworkStatus.poll;\n  return {\n    resultsByRunUuid,\n    isLoading,\n    isRefreshing,\n    refresh: refetch,\n    error,\n    apiError: data?.mlflowGetMetricHistoryBulkInterval?.apiError,\n  };\n};\n","import { chunk, isEqual, keyBy } from 'lodash';\nimport { useCallback, useEffect, useMemo, useRef } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { ReduxState, ThunkDispatch } from '../../../../redux-types';\nimport { createChartAxisRangeKey } from '../components/RunsCharts.common';\nimport { getSampledMetricHistoryBulkAction } from '../../../sdk/SampledMetricHistoryService';\nimport type { SampledMetricsByRunUuidState } from '@mlflow/mlflow/src/experiment-tracking/types';\nimport { EXPERIMENT_RUNS_METRIC_AUTO_REFRESH_INTERVAL } from '../../../utils/MetricsUtils';\nimport Utils from '../../../../common/utils/Utils';\nimport { shouldEnableGraphQLSampledMetrics } from '../../../../common/utils/FeatureUtils';\nimport { useSampledMetricHistoryGraphQL } from './useSampledMetricHistoryGraphQL';\n\ntype SampledMetricData = SampledMetricsByRunUuidState[string][string][string];\n\nexport type SampledMetricsByRun = {\n  runUuid: string;\n} & {\n  [metricKey: string]: SampledMetricData;\n};\n\nconst SAMPLED_METRIC_HISTORY_API_RUN_LIMIT = 100;\n\n/**\n * Automatically fetches sampled metric history for runs, used in run runs charts.\n * After updating list of metrics or runs, optimizes the request and fetches\n * only the missing entries.\n *\n * REST-based implementation.\n */\nexport const useSampledMetricHistoryREST = (params: {\n  runUuids: string[];\n  metricKeys: string[];\n  maxResults?: number;\n  range?: [number, number];\n  enabled?: boolean;\n  autoRefreshEnabled?: boolean;\n}) => {\n  const { metricKeys, runUuids, enabled, maxResults, range, autoRefreshEnabled } = params;\n  const dispatch = useDispatch<ThunkDispatch>();\n\n  const { resultsByRunUuid, isLoading, isRefreshing } = useSelector(\n    (store: ReduxState) => {\n      const rangeKey = createChartAxisRangeKey(range);\n\n      let anyRunRefreshing = false;\n      let anyRunLoading = false;\n\n      const returnValues: SampledMetricsByRun[] = runUuids.map((runUuid) => {\n        const metricsByMetricKey = metricKeys.reduce(\n          (dataByMetricKey: { [key: string]: SampledMetricData }, metricKey: string) => {\n            const runMetricData = store.entities.sampledMetricsByRunUuid[runUuid]?.[metricKey]?.[rangeKey];\n\n            if (!runMetricData) {\n              return dataByMetricKey;\n            }\n\n            anyRunLoading = anyRunLoading || Boolean(runMetricData.loading);\n            anyRunRefreshing = anyRunRefreshing || Boolean(runMetricData.refreshing);\n\n            dataByMetricKey[metricKey] = runMetricData;\n            return dataByMetricKey;\n          },\n          {},\n        );\n\n        return {\n          runUuid,\n          ...metricsByMetricKey,\n        };\n      });\n\n      return {\n        isLoading: anyRunLoading,\n        isRefreshing: anyRunRefreshing,\n        resultsByRunUuid: keyBy(returnValues, 'runUuid'),\n      };\n    },\n    (left, right) =>\n      isEqual(left.resultsByRunUuid, right.resultsByRunUuid) &&\n      left.isLoading === right.isLoading &&\n      left.isRefreshing === right.isRefreshing,\n  );\n\n  const refreshFn = useCallback(() => {\n    metricKeys.forEach((metricKey) => {\n      chunk(runUuids, SAMPLED_METRIC_HISTORY_API_RUN_LIMIT).forEach((runUuidsChunk) => {\n        const action = getSampledMetricHistoryBulkAction(runUuidsChunk, metricKey, maxResults, range, 'all');\n        dispatch(action);\n      });\n    });\n  }, [dispatch, maxResults, runUuids, metricKeys, range]);\n\n  const refreshTimeoutRef = useRef<number | undefined>(undefined);\n  const autoRefreshEnabledRef = useRef(autoRefreshEnabled && params.enabled);\n  autoRefreshEnabledRef.current = autoRefreshEnabled && params.enabled;\n\n  // Serialize runUuids to a string to use as a dependency in the effect,\n  // directly used runUuids can cause unnecessary re-fetches\n  const runUuidsSerialized = useMemo(() => runUuids.join(','), [runUuids]);\n\n  // Regular single fetch effect with no auto-refresh capabilities. Used if auto-refresh is disabled.\n  useEffect(() => {\n    if (!enabled || autoRefreshEnabled) {\n      return;\n    }\n    metricKeys.forEach((metricKey) => {\n      chunk(runUuids, SAMPLED_METRIC_HISTORY_API_RUN_LIMIT).forEach((runUuidsChunk) => {\n        const action = getSampledMetricHistoryBulkAction(runUuidsChunk, metricKey, maxResults, range);\n        dispatch(action);\n      });\n    });\n  }, [dispatch, maxResults, runUuids, metricKeys, range, enabled, autoRefreshEnabled]);\n\n  // A fetch effect with auto-refresh capabilities. Used only if auto-refresh is enabled.\n  useEffect(() => {\n    let hookUnmounted = false;\n    if (!enabled || !autoRefreshEnabled) {\n      return;\n    }\n\n    // Base fetching function, used for both initial call and subsequent auto-refresh calls\n    const fetchMetricsFn = async (isAutoRefreshing = false) => {\n      const runUuids = runUuidsSerialized.split(',').filter((runUuid: string) => runUuid !== '');\n      await Promise.all(\n        metricKeys.map(async (metricKey) =>\n          Promise.all(\n            chunk(runUuids, SAMPLED_METRIC_HISTORY_API_RUN_LIMIT).map(async (runUuidsChunk) =>\n              dispatch(\n                getSampledMetricHistoryBulkAction(\n                  runUuidsChunk,\n                  metricKey,\n                  maxResults,\n                  range,\n                  isAutoRefreshing ? 'auto' : undefined,\n                ),\n              ),\n            ),\n          ),\n        ),\n      );\n    };\n\n    const scheduleRefresh = async () => {\n      // Initial check to confirm that auto-refresh is still enabled and the hook is still mounted\n      if (!autoRefreshEnabledRef.current || hookUnmounted) {\n        return;\n      }\n      try {\n        await fetchMetricsFn(true);\n      } catch (e) {\n        // In case of error during auto-refresh, log the error but do break the auto-refresh loop\n        Utils.logErrorAndNotifyUser(e);\n      }\n      clearTimeout(refreshTimeoutRef.current);\n\n      // After loading the data, schedule the next refresh if the hook is still enabled and mounted\n      if (!autoRefreshEnabledRef.current || hookUnmounted) {\n        return;\n      }\n\n      refreshTimeoutRef.current = window.setTimeout(scheduleRefresh, EXPERIMENT_RUNS_METRIC_AUTO_REFRESH_INTERVAL);\n    };\n\n    fetchMetricsFn().then(scheduleRefresh);\n\n    return () => {\n      // Mark the hook as unmounted to prevent scheduling new auto-refreshes with current data\n      hookUnmounted = true;\n\n      // Clear the timeout\n      clearTimeout(refreshTimeoutRef.current);\n    };\n  }, [dispatch, maxResults, runUuidsSerialized, metricKeys, range, enabled, autoRefreshEnabled]);\n\n  return { isLoading, isRefreshing, resultsByRunUuid, refresh: refreshFn };\n};\n\n/**\n * A switcher hook that selects between the REST and GraphQL implementations of the\n * `useSampledMetricHistory` hook based on flags and parameter context.\n */\nexport const useSampledMetricHistory = (params: {\n  runUuids: string[];\n  metricKeys: string[];\n  maxResults?: number;\n  range?: [number, number];\n  enabled?: boolean;\n  autoRefreshEnabled?: boolean;\n}) => {\n  const { metricKeys, enabled, autoRefreshEnabled, runUuids } = params;\n\n  // We should use the apollo hook if there is only one metric key and the number of runUuids is less than 100.\n  // To be improved after endpoint will start supporting multiple metric keys.\n  const shouldUseGraphql = shouldEnableGraphQLSampledMetrics() && metricKeys.length === 1 && runUuids.length <= 100;\n\n  const legacyResult = useSampledMetricHistoryREST({\n    ...params,\n    enabled: enabled && !shouldUseGraphql,\n    autoRefreshEnabled: autoRefreshEnabled && !shouldUseGraphql,\n  });\n\n  const graphQlResult = useSampledMetricHistoryGraphQL({\n    ...params,\n    metricKey: metricKeys[0],\n    enabled: enabled && shouldUseGraphql,\n    autoRefreshEnabled: autoRefreshEnabled && shouldUseGraphql,\n  });\n\n  return shouldUseGraphql ? graphQlResult : legacyResult;\n};\n","import { MLFLOW_SYSTEM_METRIC_PREFIX } from '@mlflow/mlflow/src/experiment-tracking/constants';\nimport { KeyValueEntity, MetricEntitiesByName } from '@mlflow/mlflow/src/experiment-tracking/types';\nimport { useCallback, useMemo } from 'react';\nimport { RunsChartsRunData } from '../components/RunsCharts.common';\nimport { DifferenceCardAttributes, RunsChartsDifferenceCardConfig } from '../runs-charts.types';\nimport Utils from '@mlflow/mlflow/src/common/utils/Utils';\nimport type { RunsGroupByConfig } from '../../experiment-page/utils/experimentPage.group-row-utils';\n\nexport const DIFFERENCE_CHART_DEFAULT_EMPTY_VALUE = '-';\nconst DIFFERENCE_EPSILON = 1e-6;\nexport const getDifferenceChartDisplayedValue = (val: any, places = 2) => {\n  if (typeof val === 'number') {\n    return val.toFixed(places);\n  } else if (typeof val === 'string') {\n    return val;\n  }\n  try {\n    return JSON.stringify(val);\n  } catch {\n    return DIFFERENCE_CHART_DEFAULT_EMPTY_VALUE;\n  }\n};\n\nexport enum DifferenceChartCellDirection {\n  POSITIVE,\n  NEGATIVE,\n  SAME,\n}\nexport const differenceView = (a: any, b: any) => {\n  if (typeof a !== 'number' || typeof b !== 'number') {\n    return undefined;\n  } else {\n    const diff = a - b;\n    if (diff === 0) {\n      return { label: getDifferenceChartDisplayedValue(diff).toString(), direction: DifferenceChartCellDirection.SAME };\n    } else if (diff > 0) {\n      return { label: `+${getDifferenceChartDisplayedValue(diff)}`, direction: DifferenceChartCellDirection.POSITIVE };\n    } else {\n      return {\n        label: getDifferenceChartDisplayedValue(diff).toString(),\n        direction: DifferenceChartCellDirection.NEGATIVE,\n      };\n    }\n  }\n};\n\nexport const isDifferent = (a: any, b: any) => {\n  if (a === DIFFERENCE_CHART_DEFAULT_EMPTY_VALUE || b === DIFFERENCE_CHART_DEFAULT_EMPTY_VALUE) {\n    return false;\n  }\n  // Check if type a and b are the same\n  if (typeof a !== typeof b) {\n    return true;\n  } else if (typeof a === 'number' && typeof b === 'number') {\n    return Math.abs(a - b) > DIFFERENCE_EPSILON;\n  } else if (typeof a === 'string' && typeof b === 'string') {\n    return a !== b;\n  }\n  return false;\n};\n\nexport const getDifferenceViewDataGroups = (\n  previewData: RunsChartsRunData[],\n  cardConfig: RunsChartsDifferenceCardConfig,\n  headingColumnId: string,\n  groupBy: RunsGroupByConfig | null,\n) => {\n  const getMetrics = (\n    filterCondition: (metric: string) => boolean,\n    runDataKeys: (data: RunsChartsRunData) => string[],\n    runDataAttribute: (\n      data: RunsChartsRunData,\n    ) =>\n      | MetricEntitiesByName\n      | Record<string, KeyValueEntity>\n      | Record<string, { key: string; value: string | number }>,\n  ) => {\n    // Get array of sorted keys\n    const keys = Array.from(new Set(previewData.flatMap((runData) => runDataKeys(runData))))\n      .filter((key) => filterCondition(key))\n      .sort();\n    const values = keys.flatMap((key: string) => {\n      const data: Record<string, string | number> = {};\n      let hasDifference = false;\n\n      previewData.forEach((runData, index) => {\n        // Set the key as runData.uuid and the value as the metric's value or DEFAULT_EMPTY_VALUE\n        data[runData.uuid] = runDataAttribute(runData)[key]\n          ? runDataAttribute(runData)[key].value\n          : DIFFERENCE_CHART_DEFAULT_EMPTY_VALUE;\n        if (index > 0) {\n          const prev = previewData[index - 1];\n          if (isDifferent(data[prev.uuid], data[runData.uuid])) {\n            hasDifference = true;\n          }\n        }\n      });\n      if (cardConfig.showDifferencesOnly && !hasDifference) {\n        return [];\n      }\n      return [\n        {\n          [headingColumnId]: key,\n          ...data,\n        },\n      ];\n    });\n    return values;\n  };\n\n  const modelMetrics = getMetrics(\n    (metric: string) => !metric.startsWith(MLFLOW_SYSTEM_METRIC_PREFIX),\n    (runData: RunsChartsRunData) => Object.keys(runData.metrics),\n    (runData: RunsChartsRunData) => runData.metrics,\n  );\n\n  const systemMetrics = getMetrics(\n    (metric: string) => metric.startsWith(MLFLOW_SYSTEM_METRIC_PREFIX),\n    (runData: RunsChartsRunData) => Object.keys(runData.metrics),\n    (runData: RunsChartsRunData) => runData.metrics,\n  );\n\n  if (groupBy) {\n    return { modelMetrics, systemMetrics, parameters: [], tags: [], attributes: [] };\n  }\n\n  const parameters = getMetrics(\n    () => true,\n    (runData: RunsChartsRunData) => Object.keys(runData.params),\n    (runData: RunsChartsRunData) => runData.params,\n  );\n\n  const tags = getMetrics(\n    () => true,\n    (runData: RunsChartsRunData) => Utils.getVisibleTagValues(runData.tags).map(([key]) => key),\n    (runData: RunsChartsRunData) => runData.tags,\n  );\n\n  // Get attributes\n  const attributeGroups = [\n    DifferenceCardAttributes.USER,\n    DifferenceCardAttributes.SOURCE,\n    DifferenceCardAttributes.VERSION,\n    DifferenceCardAttributes.MODELS,\n  ];\n  const attributes = attributeGroups.flatMap((attribute) => {\n    const attributeData: Record<string, string | number> = {};\n    let hasDifference = false;\n    previewData.forEach((runData, index) => {\n      if (attribute === DifferenceCardAttributes.USER) {\n        const user = Utils.getUser(runData.runInfo, runData.tags);\n        attributeData[runData.uuid] = user;\n      } else if (attribute === DifferenceCardAttributes.SOURCE) {\n        const source = Utils.getSourceName(runData.tags);\n        attributeData[runData.uuid] = source;\n      } else if (attribute === DifferenceCardAttributes.VERSION) {\n        const version = Utils.getSourceVersion(runData.tags);\n        attributeData[runData.uuid] = version;\n      } else {\n        const models = Utils.getLoggedModelsFromTags(runData.tags);\n        attributeData[runData.uuid] = models.join(',');\n      }\n      if (index > 0) {\n        const prev = previewData[index - 1];\n        if (isDifferent(attributeData[prev.uuid], attributeData[runData.uuid])) {\n          hasDifference = true;\n        }\n      }\n    });\n    if (cardConfig.showDifferencesOnly && !hasDifference) {\n      return [];\n    }\n    return [\n      {\n        [headingColumnId]: attribute,\n        ...attributeData,\n      },\n    ];\n  });\n  return { modelMetrics, systemMetrics, parameters, tags, attributes };\n};\n","import { type Dictionary, compact, first, isUndefined, last, max, min, minBy, orderBy, values } from 'lodash';\nimport { MetricEntity, SampledMetricsByRunUuidState } from '../../../types';\nimport { SampledMetricsByRun } from '../hooks/useSampledMetricHistory';\n\n/**\n * This function consumes chart timestamp range and returns\n * corresponding step range for a given metric basing on a history.\n */\nexport const findChartStepsByTimestamp = (\n  // Currently fetched metric history\n  currentMetricHistory: {\n    [rangeKey: string]: {\n      loading?: boolean | undefined;\n      metricsHistory?: MetricEntity[] | undefined;\n    };\n  },\n  // Timestamp range - either textual (\"2022-10-23 10:00:00\") or numeric (milliseconds)\n  range: [string | number, string | number],\n  // If set to true, will return entire boundaries from history if timestamps are not found.\n  // Otherwise, will return undefined.\n  useDefaultIfNotFound = true,\n): [number, number] | undefined => {\n  // First, let's compile a history of all metric values from all ranges,\n  // then sort it by timestamp\n  const flatHistory = orderBy(\n    compact(\n      values(currentMetricHistory)\n        .map(({ metricsHistory }) => metricsHistory)\n        .flat(),\n    ),\n    'timestamp',\n  );\n\n  // If there's no sufficient entries, return nothing\n  if (flatHistory.length < 2) {\n    return undefined;\n  }\n\n  // We consume textual ranges produced by charts so we have\n  // to convert them to timestamps\n  const lowerBound = new Date(range[0]).valueOf();\n  const upperBound = new Date(range[1]).valueOf();\n\n  // First, try to find the lower entry using loop\n  let lowerEntry = useDefaultIfNotFound ? first(flatHistory) : undefined;\n\n  for (let index = 0; index < flatHistory.length; index++) {\n    const entry = flatHistory[index];\n    if (entry.timestamp > lowerBound) {\n      lowerEntry = flatHistory[index - 1] || entry;\n      break;\n    }\n  }\n\n  // Repeat for the upper entry\n  let upperEntry = useDefaultIfNotFound ? last(flatHistory) : undefined;\n\n  for (let index = flatHistory.length - 1; index >= 0; index--) {\n    const entry = flatHistory[index];\n    if (entry.timestamp < upperBound) {\n      upperEntry = flatHistory[index + 1] || entry;\n      break;\n    }\n  }\n\n  // If boundaries are not found, return nothing\n  if (isUndefined(lowerEntry) || isUndefined(upperEntry)) {\n    return undefined;\n  }\n\n  // Return found boundary entries\n  return [lowerEntry.step, upperEntry.step];\n};\n\n/**\n * Finds the chart steps by absolute timestamp for multiple runs.\n *\n * @param sampledMetrics - The sampled metrics by run UUID state.\n * @param runUuids - The array of run UUIDs.\n * @param metricKey - The metric key.\n * @param range - The range of timestamps.\n * @returns The lower and upper bounds of the chart steps, or undefined if not found.\n */\nexport const findChartStepsByTimestampForRuns = (\n  sampledMetrics: SampledMetricsByRunUuidState,\n  runUuids: string[],\n  metricKey: string,\n  range: [string | number, string | number],\n): [number, number] | undefined => {\n  const stepRangesPerRun = compact(\n    runUuids.map((runUuid) => {\n      const metricHistoryForRun = sampledMetrics[runUuid]?.[metricKey];\n      return metricHistoryForRun ? findChartStepsByTimestamp(metricHistoryForRun, range, false) : undefined;\n    }),\n  );\n  const lowerBound = min(stepRangesPerRun.map(([bound]) => bound));\n  const upperBound = max(stepRangesPerRun.map(([, bound]) => bound));\n\n  if (!isUndefined(lowerBound) && !isUndefined(upperBound)) {\n    return [lowerBound, upperBound];\n  }\n\n  return undefined;\n};\n\n/**\n * This function consumes chart relative time range and returns\n * corresponding step range for a given metric basing on a history.\n *\n * @param currentlyVisibleMetrics currentlyVisibleMetrics is a dictionary of currently rendered metric traces for run\n * @param runUuids a list of run UUIDs to process\n * @param relativeRange a relative time range in seconds\n * @returns a range of steps or undefined if no relevant are found\n */\nexport const findAbsoluteTimestampRangeForRelativeRange = (\n  currentlyVisibleMetrics: Dictionary<SampledMetricsByRun>,\n  runUuids: string[],\n  relativeRange: [number, number],\n  multiplier = 1000,\n): [number, number] | undefined => {\n  const stepRangesPerRun = compact(\n    runUuids.map((runUuid) => {\n      const runData = currentlyVisibleMetrics[runUuid];\n\n      if (!runData) {\n        return null;\n      }\n\n      // omit the \"runUuid\" key so we can conveniently access the metrics data\n      const { runUuid: _, ...runMetrics } = runData;\n\n      // concat all the metrics history for the run\n      const visibleMetricHistoryForRun = values(runMetrics).flatMap((metric) => metric.metricsHistory ?? []);\n\n      // Find the timestamp offset for the run. Should be equal to lowest timestamp value for each run.\n      const timestampOffset = minBy(visibleMetricHistoryForRun, 'timestamp')?.timestamp || 0;\n\n      // Convert relative time range to timestamp range. Relative range comes\n      // in seconds so we have to multiply it by 1000 to get milliseconds.\n      return [relativeRange[0] * multiplier + timestampOffset, relativeRange[1] * multiplier + timestampOffset] as [\n        number,\n        number,\n      ];\n    }),\n  );\n  const lowerBound = min(stepRangesPerRun.map(([bound]) => bound));\n  const upperBound = max(stepRangesPerRun.map(([, bound]) => bound));\n  if (!isUndefined(lowerBound) && !isUndefined(upperBound)) {\n    return [lowerBound, upperBound];\n  }\n\n  return undefined;\n};\n","export const RUNS_CHARTS_UI_Z_INDEX = {\n  CARD_PREVIEW: 1,\n  CARD_DRAGGED: 2,\n  TOOLTIP_CONTAINER: 3,\n  SEARCH_BAR: 3,\n  TOOLTIP: 4,\n};\n","import { useMemo } from 'react';\nimport type { RunGroupingAggregateFunction } from '../../experiment-page/utils/experimentPage.row-types';\nimport invariant from 'invariant';\nimport {\n  removeOutliersFromMetricHistory,\n  type RunsChartsRunData,\n} from '../../runs-charts/components/RunsCharts.common';\nimport {\n  createAggregatedMetricHistory,\n  createValueAggregatedMetricHistory,\n  type SyntheticMetricHistory,\n} from '../../experiment-page/utils/experimentPage.group-row-utils';\nimport { uniq, type Dictionary, compact, pick, isNil } from 'lodash';\nimport type { SampledMetricsByRun } from '../../runs-charts/hooks/useSampledMetricHistory';\nimport type { MetricHistoryByName } from '../../../types';\n\nexport interface UseGroupedChartRunDataParams {\n  ungroupedRunsData: RunsChartsRunData[];\n  enabled: boolean;\n  aggregateFunction?: RunGroupingAggregateFunction;\n  metricKeys: string[];\n  sampledDataResultsByRunUuid: Dictionary<SampledMetricsByRun>;\n  selectedXAxisMetricKey?: string;\n  ignoreOutliers: boolean;\n}\n\n/**\n * Returns a new array of RunsChartsRunData with aggregated metrics for grouped runs.\n * In order to make rendering of the confidence interval possible, the returned dataset contains\n * min, max and average values for each metric while respecting the metric history.\n */\nexport const useGroupedChartRunData = ({\n  ungroupedRunsData,\n  enabled,\n  aggregateFunction,\n  metricKeys,\n  sampledDataResultsByRunUuid,\n  selectedXAxisMetricKey,\n  ignoreOutliers,\n}: UseGroupedChartRunDataParams) => {\n  return useMemo(() => {\n    if (!enabled || !aggregateFunction) {\n      return ungroupedRunsData;\n    }\n\n    // Extract groups from the result set and calculate aggregated metrics\n    const perGroupData: RunsChartsRunData[] = ungroupedRunsData\n      .filter(({ groupParentInfo }) => groupParentInfo)\n      .map((group) => {\n        const aggregatedMetricsHistory: Record<string, SyntheticMetricHistory> = {};\n        metricKeys.forEach((metricKey) => {\n          invariant(group.groupParentInfo, 'groupParentInfo should be defined');\n\n          const aggregatedRunUuidsInGroup =\n            group.groupParentInfo.runUuidsForAggregation ?? group.groupParentInfo.runUuids;\n\n          let aggregatedMetricsHistoryForMetric;\n          if (!isNil(selectedXAxisMetricKey)) {\n            aggregatedMetricsHistoryForMetric = createValueAggregatedMetricHistory(\n              pick(sampledDataResultsByRunUuid, aggregatedRunUuidsInGroup),\n              metricKey,\n              selectedXAxisMetricKey,\n              ignoreOutliers,\n            );\n          } else {\n            const metricsHistoryInGroup = compact(\n              aggregatedRunUuidsInGroup.flatMap((runUuid) => {\n                const metricsHistory = sampledDataResultsByRunUuid[runUuid]?.[metricKey]?.metricsHistory;\n                if (ignoreOutliers) {\n                  return metricsHistory ? removeOutliersFromMetricHistory(metricsHistory) : undefined;\n                }\n                return metricsHistory;\n              }),\n            );\n\n            // Get all step numbers from all runs in the group\n            const steps = uniq(metricsHistoryInGroup.map((h) => h.step)).sort((a, b) => a - b);\n\n            aggregatedMetricsHistoryForMetric = createAggregatedMetricHistory(steps, metricKey, metricsHistoryInGroup);\n          }\n\n          aggregatedMetricsHistory[metricKey] = aggregatedMetricsHistoryForMetric;\n        });\n        const metricsHistory = metricKeys.reduce<MetricHistoryByName>((acc, key) => {\n          const history = aggregatedMetricsHistory[key][aggregateFunction];\n          if (history && history.length > 0) {\n            acc[key] = history;\n          }\n          return acc;\n        }, {});\n\n        return {\n          ...group,\n          metricsHistory,\n          aggregatedMetricsHistory,\n        };\n      });\n\n    const ungroupedRuns = ungroupedRunsData.filter(({ belongsToGroup }) => belongsToGroup === false);\n\n    return [...perGroupData, ...ungroupedRuns];\n  }, [\n    metricKeys,\n    sampledDataResultsByRunUuid,\n    ungroupedRunsData,\n    enabled,\n    aggregateFunction,\n    selectedXAxisMetricKey,\n    ignoreOutliers,\n  ]);\n};\n","import { type ModelTraceInfo } from '@databricks/web-shared/model-trace-explorer';\nimport { useCallback, useEffect, useMemo, useState } from 'react';\nimport { MlflowService } from '../../../sdk/MlflowService';\nimport { EXPERIMENT_TRACES_SORTABLE_COLUMNS, getTraceInfoRunId } from '../TracesView.utils';\nimport { ViewType } from '../../../sdk/MlflowEnums';\nimport { first, uniq, values } from 'lodash';\nimport { RunEntity } from '../../../types';\nimport { isExperimentLoggedModelsUIEnabled } from '../../../../common/utils/FeatureUtils';\n\n// A filter expression used to filter traces by run ID\nconst RUN_ID_FILTER_EXPRESSION = 'request_metadata.`mlflow.sourceRun`';\nconst LOGGED_MODEL_ID_FILTER_EXPRESSION = 'request_metadata.`mlflow.modelId`';\n\nconst createRunIdsFilterExpression = (runUuids: string[]) => {\n  const runIdsInQuotes = runUuids.map((runId: any) => `'${runId}'`);\n  return `run_id IN (${runIdsInQuotes.join(',')})`;\n};\n\n/**\n * Utility function that fetches run names for traces.\n */\nconst fetchRunNamesForTraces = async (experimentIds: string[], traces: ModelTraceInfo[]) => {\n  const traceIdToRunIdMap = traces.reduce<Record<string, string>>((acc, trace) => {\n    const traceId = trace.request_id;\n    const runId = getTraceInfoRunId(trace);\n    if (!traceId || !runId) {\n      return acc;\n    }\n    return { ...acc, [traceId]: runId };\n  }, {});\n\n  const runUuids = uniq(values(traceIdToRunIdMap));\n  if (runUuids.length < 1) {\n    return {};\n  }\n  const runResponse = (await MlflowService.searchRuns({\n    experiment_ids: experimentIds,\n    filter: createRunIdsFilterExpression(runUuids),\n    run_view_type: ViewType.ALL,\n  })) as { runs?: RunEntity[] };\n\n  const runs = runResponse.runs;\n\n  const runIdsToRunNames = (runs || []).reduce<Record<string, string>>((acc, run) => {\n    return { ...acc, [run.info.runUuid]: run.info.runName };\n  }, {});\n\n  const traceIdsToRunNames = traces.reduce<Record<string, string>>((acc, trace) => {\n    const traceId = trace.request_id;\n    if (!traceId) {\n      return acc;\n    }\n    const runId = traceIdToRunIdMap[traceId];\n\n    return { ...acc, [traceId]: runIdsToRunNames[runId] || runId };\n  }, {});\n\n  return traceIdsToRunNames;\n};\n\nexport interface ModelTraceInfoWithRunName extends ModelTraceInfo {\n  runName?: string;\n}\n\nexport const useExperimentTraces = ({\n  experimentIds,\n  sorting,\n  filter = '',\n  runUuid,\n  loggedModelId,\n}: {\n  experimentIds: string[];\n  sorting: {\n    id: string;\n    desc: boolean;\n  }[];\n  filter?: string;\n  runUuid?: string;\n  loggedModelId?: string;\n}) => {\n  const [traces, setTraces] = useState<ModelTraceInfoWithRunName[]>([]);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [error, setError] = useState<Error | undefined>(undefined);\n\n  // Backend currently only supports ordering by timestamp\n  const orderByString = useMemo(() => {\n    const firstOrderByColumn = first(sorting);\n    if (firstOrderByColumn && EXPERIMENT_TRACES_SORTABLE_COLUMNS.includes(firstOrderByColumn.id)) {\n      return `${firstOrderByColumn.id} ${firstOrderByColumn.desc ? 'DESC' : 'ASC'}`;\n    }\n    return 'timestamp_ms DESC';\n  }, [sorting]);\n\n  const filterString = useMemo(() => {\n    if (!runUuid && !loggedModelId) {\n      return filter;\n    }\n\n    if (isExperimentLoggedModelsUIEnabled() && loggedModelId) {\n      if (filter) {\n        return `${filter} AND ${LOGGED_MODEL_ID_FILTER_EXPRESSION}='${loggedModelId}'`;\n      }\n      return `${LOGGED_MODEL_ID_FILTER_EXPRESSION}='${loggedModelId}'`;\n    }\n\n    if (filter) {\n      return `${filter} AND ${RUN_ID_FILTER_EXPRESSION}='${runUuid}'`;\n    }\n\n    return `${RUN_ID_FILTER_EXPRESSION}='${runUuid}'`;\n  }, [filter, runUuid, loggedModelId]);\n\n  const [pageTokens, setPageTokens] = useState<Record<string, string | undefined>>({ 0: undefined });\n  const [currentPage, setCurrentPage] = useState(0);\n  const currentPageToken = pageTokens[currentPage];\n\n  const fetchTraces = useCallback(\n    async ({\n      experimentIds,\n      currentPage = 0,\n      pageToken,\n      silent,\n      orderByString = '',\n      filterString = '',\n    }: {\n      experimentIds: string[];\n      currentPage?: number;\n      pageToken?: string;\n      filterString?: string;\n      orderByString?: string;\n      silent?: boolean;\n    }) => {\n      if (!silent) {\n        setLoading(true);\n      }\n      setError(undefined);\n\n      try {\n        const response = await MlflowService.getExperimentTraces(experimentIds, orderByString, pageToken, filterString);\n\n        if (!response.traces) {\n          setTraces([]);\n          return;\n        }\n\n        const runNamesForTraces = await fetchRunNamesForTraces(experimentIds, response.traces);\n        const tracesWithRunNames = response.traces.map((trace) => {\n          const traceId = trace.request_id;\n          if (!traceId) {\n            return { ...trace };\n          }\n          const runName = runNamesForTraces[traceId];\n          return { ...trace, runName };\n        });\n\n        setTraces(tracesWithRunNames);\n        setPageTokens((prevPages) => {\n          return { ...prevPages, [currentPage + 1]: response.next_page_token };\n        });\n      } catch (e: any) {\n        setError(e);\n      } finally {\n        setLoading(false);\n      }\n    },\n    [],\n  );\n\n  const hasNextPage = !loading && pageTokens[currentPage + 1] !== undefined;\n  const hasPreviousPage = !loading && (currentPage === 1 || pageTokens[currentPage - 1] !== undefined);\n\n  useEffect(() => {\n    fetchTraces({ experimentIds, filterString, orderByString });\n  }, [fetchTraces, filterString, experimentIds, orderByString]);\n\n  const reset = useCallback(() => {\n    setTraces([]);\n    setPageTokens({ 0: undefined });\n    setCurrentPage(0);\n    fetchTraces({ experimentIds });\n  }, [fetchTraces, experimentIds]);\n\n  const fetchNextPage = useCallback(() => {\n    setCurrentPage((prevPage) => prevPage + 1);\n    fetchTraces({\n      experimentIds,\n      currentPage: currentPage + 1,\n      pageToken: pageTokens[currentPage + 1],\n      filterString,\n      orderByString,\n    });\n  }, [experimentIds, currentPage, fetchTraces, pageTokens, filterString, orderByString]);\n\n  const fetchPrevPage = useCallback(() => {\n    setCurrentPage((prevPage) => prevPage - 1);\n    fetchTraces({\n      experimentIds,\n      currentPage: currentPage - 1,\n      pageToken: pageTokens[currentPage - 1],\n      filterString,\n      orderByString,\n    });\n  }, [experimentIds, currentPage, fetchTraces, pageTokens, filterString, orderByString]);\n\n  const refreshCurrentPage = useCallback(\n    (silent = false) => {\n      return fetchTraces({\n        experimentIds,\n        currentPage,\n        pageToken: currentPageToken,\n        silent,\n        filterString,\n        orderByString,\n      });\n    },\n    [experimentIds, currentPage, fetchTraces, currentPageToken, filterString, orderByString],\n  );\n\n  return {\n    traces,\n    loading,\n    error,\n    hasNextPage,\n    hasPreviousPage,\n    fetchNextPage,\n    fetchPrevPage,\n    refreshCurrentPage,\n    reset,\n  };\n};\n","import { Button, PencilIcon, SpeechBubblePlusIcon, useDesignSystemTheme } from '@databricks/design-system';\nimport { MLFLOW_INTERNAL_PREFIX } from '../../../common/utils/TagUtils';\nimport { KeyValueTag } from '../../../common/components/KeyValueTag';\n\nexport const TracesViewTableTagCell = ({\n  onAddEditTags,\n  tags,\n  baseComponentId,\n}: {\n  tags: { key: string; value: string }[];\n  onAddEditTags: () => void;\n  baseComponentId: string;\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const visibleTagList = tags?.filter(({ key }) => key && !key.startsWith(MLFLOW_INTERNAL_PREFIX)) || [];\n  const containsTags = visibleTagList.length > 0;\n  return (\n    <div\n      css={{\n        display: 'flex',\n        alignItems: 'flex-start',\n        flexWrap: 'wrap',\n        columnGap: theme.spacing.xs / 2,\n        rowGap: theme.spacing.xs / 2,\n      }}\n    >\n      {visibleTagList.map((tag) => (\n        <KeyValueTag\n          key={tag.key}\n          tag={tag}\n          css={{ marginRight: 0 }}\n          charLimit={20}\n          maxWidth={150}\n          enableFullViewModal\n        />\n      ))}{' '}\n      <Button\n        componentId={`${baseComponentId}.traces_table.edit_tag`}\n        size=\"small\"\n        icon={!containsTags ? <SpeechBubblePlusIcon /> : <PencilIcon />}\n        onClick={onAddEditTags}\n      />\n    </div>\n  );\n};\n","import type { CellContext, ColumnDefTemplate } from '@tanstack/react-table';\nimport { ModelTraceInfoWithRunName } from './hooks/useExperimentTraces';\nimport { CheckCircleIcon, ClockIcon, XCircleIcon, useDesignSystemTheme } from '@databricks/design-system';\nimport { ExperimentViewTracesStatusLabels } from './TracesView.utils';\nimport { useIntl } from 'react-intl';\nimport type { Theme } from '@emotion/react';\n\nconst getIcon = (status: ModelTraceInfoWithRunName['status'], theme: Theme) => {\n  if (status === 'IN_PROGRESS') {\n    return <ClockIcon css={{ color: theme.colors.textValidationWarning }} />;\n  }\n\n  if (status === 'OK') {\n    return <CheckCircleIcon css={{ color: theme.colors.textValidationSuccess }} />;\n  }\n\n  if (status === 'ERROR') {\n    return <XCircleIcon css={{ color: theme.colors.textValidationDanger }} />;\n  }\n\n  return null;\n};\n\nexport const TracesViewTableStatusCell: ColumnDefTemplate<CellContext<ModelTraceInfoWithRunName, unknown>> = ({\n  row: { original },\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const intl = useIntl();\n\n  const labelDescriptor = ExperimentViewTracesStatusLabels[original.status || 'UNSET'];\n\n  return (\n    <div css={{ display: 'flex', gap: theme.spacing.xs, alignItems: 'center' }}>\n      {getIcon(original.status, theme)}\n      {labelDescriptor ? intl.formatMessage(labelDescriptor) : ''}\n    </div>\n  );\n};\n","import { Button, ChevronDownIcon, ChevronRightIcon, useDesignSystemTheme } from '@databricks/design-system';\nimport { isString } from 'lodash';\nimport { useCallback, useMemo, useState } from 'react';\nimport { MlflowService } from '../../sdk/MlflowService';\nimport Utils from '../../../common/utils/Utils';\nimport { ErrorWrapper } from '../../../common/utils/ErrorWrapper';\nimport type { CellContext, ColumnDefTemplate } from '@tanstack/react-table';\nimport type { ModelTraceInfoWithRunName } from './hooks/useExperimentTraces';\nimport { getTraceInfoInputs, getTraceInfoOutputs, isTraceMetadataPossiblyTruncated } from './TracesView.utils';\n\nconst TracesViewTablePreviewCell = ({\n  value,\n  traceId,\n  previewFieldName,\n}: {\n  value: string;\n  traceId: string;\n  previewFieldName: 'request' | 'response';\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const [isExpanded, setIsExpanded] = useState(false);\n  const [fullData, setFullData] = useState<string | null>(null);\n\n  const [loading, setLoading] = useState<boolean>(false);\n\n  const fetchFullData = useCallback(async () => {\n    setLoading(true);\n    try {\n      const response = await MlflowService.getExperimentTraceData<{\n        request?: any;\n        response?: any;\n      }>(traceId);\n\n      if (previewFieldName in response) {\n        const previewValue = response[previewFieldName];\n        const requestData = isString(previewValue) ? previewValue : JSON.stringify(previewValue);\n        setFullData(requestData);\n      }\n    } catch (e: any) {\n      const errorMessage = e instanceof ErrorWrapper ? e.getUserVisibleError() : e.message;\n      Utils.logErrorAndNotifyUser(`Error fetching response: ${errorMessage}`);\n    }\n    setLoading(false);\n  }, [previewFieldName, traceId]);\n\n  const expand = useCallback(async () => {\n    if (!fullData) {\n      await fetchFullData();\n    }\n    setIsExpanded(true);\n  }, [fullData, fetchFullData]);\n\n  const collapse = useCallback(() => {\n    setIsExpanded(false);\n  }, []);\n\n  const showExpander = isTraceMetadataPossiblyTruncated(value);\n\n  return (\n    <div css={{ display: 'flex', gap: theme.spacing.xs }}>\n      {showExpander && (\n        <Button\n          // it's difficult to distinguish between run and experiment page\n          // in this component due to how the data is passed to the table,\n          // so the base component ID here is simply `mlflow.traces`\n          componentId=\"mlflow.traces.traces_table.expand_cell_preview\"\n          size=\"small\"\n          icon={isExpanded ? <ChevronDownIcon /> : <ChevronRightIcon />}\n          onClick={isExpanded ? collapse : expand}\n          css={{ flexShrink: 0 }}\n          loading={loading}\n          type=\"primary\"\n        />\n      )}\n      <div\n        title={value}\n        css={{\n          overflow: 'hidden',\n          textOverflow: 'ellipsis',\n        }}\n      >\n        {isExpanded ? <ExpandedParamCell value={fullData ?? value} /> : value}\n      </div>\n    </div>\n  );\n};\n\nconst ExpandedParamCell = ({ value }: { value: string }) => {\n  const structuredJSONValue = useMemo(() => {\n    // Attempts to parse the value as JSON and returns a pretty printed version if successful.\n    // If JSON structure is not found, returns null.\n    try {\n      const objectData = JSON.parse(value);\n      return JSON.stringify(objectData, null, 2);\n    } catch (e) {\n      return null;\n    }\n  }, [value]);\n  return (\n    <div\n      css={{\n        whiteSpace: 'pre-wrap',\n        wordBreak: 'break-word',\n        fontFamily: structuredJSONValue ? 'monospace' : undefined,\n      }}\n    >\n      {structuredJSONValue || value}\n    </div>\n  );\n};\n\nexport const TracesViewTableRequestPreviewCell: ColumnDefTemplate<CellContext<ModelTraceInfoWithRunName, unknown>> = ({\n  row: { original },\n}) => (\n  <TracesViewTablePreviewCell\n    previewFieldName=\"request\"\n    traceId={original.request_id || ''}\n    value={getTraceInfoInputs(original) || ''}\n  />\n);\n\nexport const TracesViewTableResponsePreviewCell: ColumnDefTemplate<CellContext<ModelTraceInfoWithRunName, unknown>> = ({\n  row: { original },\n}) => (\n  <TracesViewTablePreviewCell\n    previewFieldName=\"response\"\n    traceId={original.request_id || ''}\n    value={getTraceInfoOutputs(original) || ''}\n  />\n);\n","import type { CellContext, ColumnDefTemplate } from '@tanstack/react-table';\nimport { ModelTraceInfoWithRunName } from './hooks/useExperimentTraces';\nimport { keyBy } from 'lodash';\nimport { SourceCellRenderer } from '../experiment-page/components/runs/cells/SourceCellRenderer';\n\nexport const TracesViewTableSourceCell: ColumnDefTemplate<CellContext<ModelTraceInfoWithRunName, unknown>> = ({\n  row: { original },\n}) => <SourceCellRenderer value={keyBy(original.tags, 'key')} />;\n","import { ColumnDef } from '@tanstack/react-table';\nimport { ModelTraceInfoWithRunName } from './hooks/useExperimentTraces';\nimport { Interpolation, Theme } from '@emotion/react';\n\nexport type TracesColumnDef = ColumnDef<ModelTraceInfoWithRunName> & {\n  meta?: {\n    styles?: Interpolation<Theme>;\n    multiline?: boolean;\n  };\n};\n\nexport const getHeaderSizeClassName = (id: string) => `--header-${id}-size`;\nexport const getColumnSizeClassName = (id: string) => `--col-${id}-size`;\n","import React from 'react';\nimport { ModelTraceInfoWithRunName } from './hooks/useExperimentTraces';\nimport { Row, flexRender } from '@tanstack/react-table';\nimport { useDesignSystemTheme } from '@databricks/design-system';\nimport { TracesColumnDef, getColumnSizeClassName } from './TracesViewTable.utils';\nimport { TRACE_TABLE_CHECKBOX_COLUMN_ID } from './TracesView.utils';\nimport { isEqual } from 'lodash';\n\ntype TracesViewTableRowProps = {\n  row: Row<ModelTraceInfoWithRunName>;\n  // used only for memoization updates\n  selected: boolean;\n  columns: TracesColumnDef[];\n};\n\nexport const TracesViewTableRow = React.memo(\n  ({ row }: TracesViewTableRowProps) => {\n    const { theme } = useDesignSystemTheme();\n\n    return (\n      <div\n        role=\"row\"\n        key={row.id}\n        data-testid=\"endpoints-list-table-rows\"\n        css={{\n          minHeight: theme.general.buttonHeight,\n          display: 'flex',\n          flexDirection: 'row',\n          ':hover': {\n            backgroundColor: 'var(--table-row-hover)',\n          },\n        }}\n      >\n        {row.getAllCells().map((cell) => {\n          const multiline = (cell.column.columnDef as TracesColumnDef).meta?.multiline;\n          const isSelect = cell.column.id === TRACE_TABLE_CHECKBOX_COLUMN_ID;\n          const padding = isSelect ? theme.spacing.sm : `${theme.spacing.sm}px ${theme.spacing.xs}px`;\n\n          return (\n            <div\n              role=\"cell\"\n              css={[\n                {\n                  '--table-row-vertical-padding': `${theme.spacing.sm}px`,\n                  flex: `calc(var(${getColumnSizeClassName(cell.column.id)}) / 100)`,\n                  overflow: 'hidden',\n                  borderBottom: `1px solid var(--table-separator-color)`,\n                  whiteSpace: multiline ? 'pre-wrap' : 'nowrap',\n                  textOverflow: multiline ? 'ellipsis' : undefined,\n                  padding,\n                },\n                (cell.column.columnDef as TracesColumnDef).meta?.styles,\n              ]}\n              key={cell.id}\n            >\n              {flexRender(cell.column.columnDef.cell, cell.getContext())}\n            </div>\n          );\n        })}\n      </div>\n    );\n  },\n  (prev, next) => {\n    return (\n      prev.columns === next.columns &&\n      prev.selected === next.selected &&\n      isEqual(prev.row.original.tags, next.row.original.tags)\n    );\n  },\n);\n","import { CellContext, ColumnDefTemplate } from '@tanstack/react-table';\nimport React from 'react';\nimport { ModelTraceInfoWithRunName } from './hooks/useExperimentTraces';\nimport { LegacyTooltip } from '@databricks/design-system';\nimport Utils from '@mlflow/mlflow/src/common/utils/Utils';\n\nexport const TracesViewTableTimestampCell: ColumnDefTemplate<CellContext<ModelTraceInfoWithRunName, unknown>> =\n  React.memo(\n    ({ row: { original } }) => {\n      if (!original.timestamp_ms) {\n        return null;\n      }\n      return (\n        <LegacyTooltip\n          title={new Date(original.timestamp_ms).toLocaleString(navigator.language, {\n            timeZoneName: 'short',\n          })}\n          placement=\"right\"\n        >\n          <span>{Utils.timeSinceStr(original.timestamp_ms)}</span>\n        </LegacyTooltip>\n      );\n    },\n    () => true,\n  );\n","import React from 'react';\nimport { ModelTraceInfoWithRunName } from './hooks/useExperimentTraces';\nimport { Table } from '@tanstack/react-table';\nimport { Checkbox } from '@databricks/design-system';\n\ntype TracesViewTableCheckboxProps = {\n  table: Table<ModelTraceInfoWithRunName>;\n};\n\nexport const TracesViewTableHeaderCheckbox = ({ table }: TracesViewTableCheckboxProps) => {\n  const isChecked = table.getIsAllRowsSelected() || (table.getIsSomeRowsSelected() ? null : false);\n\n  return (\n    <Checkbox\n      componentId=\"codegen_mlflow_app_src_experiment-tracking_components_traces_tracesviewtableheadercheckbox.tsx_14\"\n      data-testid=\"trace-table-header-checkbox\"\n      isChecked={isChecked}\n      wrapperStyle={{ padding: 0, margin: 0 }}\n      onChange={table.toggleAllRowsSelected}\n    />\n  );\n};\n","import React from 'react';\nimport { ModelTraceInfoWithRunName } from './hooks/useExperimentTraces';\nimport { Row } from '@tanstack/react-table';\nimport { Checkbox } from '@databricks/design-system';\n\ntype TracesViewCellCheckboxProps = {\n  row: Row<ModelTraceInfoWithRunName>;\n};\n\nexport const TracesViewTableCellCheckbox = ({ row }: TracesViewCellCheckboxProps) => {\n  return (\n    <Checkbox\n      componentId=\"codegen_mlflow_app_src_experiment-tracking_components_traces_tracesviewtablecellcheckbox.tsx_12\"\n      data-testid={`trace-table-cell-checkbox-${row.id}`}\n      disabled={!row.getCanSelect()}\n      isChecked={row.getIsSelected()}\n      wrapperStyle={{ padding: 0, margin: 0 }}\n      onChange={() => row.toggleSelected()}\n    />\n  );\n};\n","import { CopyIcon, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from 'react-intl';\nimport { CodeSnippet } from '@databricks/web-shared/snippet';\nimport { CopyButton } from '@mlflow/mlflow/src/shared/building_blocks/CopyButton';\n\nexport const TraceTableLangchainQuickstartContent = ({\n  baseComponentId,\n  experimentId,\n  runUuid,\n}: {\n  baseComponentId: string;\n  experimentId: string | null;\n  runUuid?: string;\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const code = `import mlflow\nfrom langchain_openai import OpenAI\nfrom langchain_core.prompts import PromptTemplate\n${experimentId ? `\\nmlflow.set_experiment(experiment_id=\"${experimentId}\")` : ''}\nmlflow.langchain.autolog()\n\n# Ensure that the \"OPENAI_API_KEY\" environment variable is set\nllm = OpenAI()\nprompt = PromptTemplate.from_template(\"Answer the following question: {question}\")\nchain = prompt | llm\n\n# Invoking the chain will cause a trace to be logged\n${runUuid ? `with mlflow.start_run():\\n    ` : ''}chain.invoke(\"What is MLflow?\")`;\n\n  return (\n    <div>\n      <Typography.Text>\n        <FormattedMessage\n          defaultMessage=\"Automatically log traces for LangChain or LangGraph invocations by calling the {code} function. For example:\"\n          description=\"Description of how to log traces for the LangChain/LangGraph package using MLflow autologging. This message is followed by a code example.\"\n          values={{\n            code: <code>mlflow.langchain.autolog()</code>,\n          }}\n        />\n      </Typography.Text>\n      <div css={{ position: 'relative', width: 'min-content' }}>\n        <CopyButton\n          componentId={`${baseComponentId}.traces_table.langchain_quickstart_snippet_copy`}\n          css={{ zIndex: 1, position: 'absolute', top: theme.spacing.xs, right: theme.spacing.xs }}\n          showLabel={false}\n          copyText={code}\n          icon={<CopyIcon />}\n        />\n        <CodeSnippet\n          showLineNumbers\n          style={{\n            padding: `${theme.spacing.sm}px ${theme.spacing.md}px`,\n            marginTop: theme.spacing.md,\n          }}\n          language=\"python\"\n        >\n          {code}\n        </CodeSnippet>\n      </div>\n    </div>\n  );\n};\n","import { CopyIcon, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from 'react-intl';\nimport { CodeSnippet } from '@databricks/web-shared/snippet';\nimport { CopyButton } from '@mlflow/mlflow/src/shared/building_blocks/CopyButton';\n\nexport const TraceTableLlamaIndexQuickstartContent = ({\n  baseComponentId,\n  experimentId,\n  runUuid,\n}: {\n  baseComponentId: string;\n  experimentId: string | null;\n  runUuid?: string;\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const code = `import mlflow\nfrom llama_index.core import Document, VectorStoreIndex\n${experimentId ? `\\nmlflow.set_experiment(experiment_id=\"${experimentId}\")` : ''}\nmlflow.llama_index.autolog()\n\n# Ensure that the \"OPENAI_API_KEY\" environment variable is set\nindex = VectorStoreIndex.from_documents([Document.example()])\nquery_engine = index.as_query_engine()\n\n# Querying the engine will cause a trace to be logged\n${runUuid ? `with mlflow.start_run():\\n    ` : ''}query_engine.query(\"What is LlamaIndex?\")`;\n\n  return (\n    <div>\n      <Typography.Text>\n        <FormattedMessage\n          defaultMessage=\"Automatically log traces for LlamaIndex queries by calling the {code} function. For example:\"\n          description=\"Description of how to log traces for the LlamaIndex package using MLflow autologging. This message is followed by a code example.\"\n          values={{\n            code: <code>mlflow.llama_index.autolog()</code>,\n          }}\n        />\n      </Typography.Text>\n      <div css={{ position: 'relative', width: 'min-content' }}>\n        <CopyButton\n          componentId={`${baseComponentId}.traces_table.llama_index_quickstart_snippet_copy`}\n          css={{ zIndex: 1, position: 'absolute', top: theme.spacing.xs, right: theme.spacing.xs }}\n          showLabel={false}\n          copyText={code}\n          icon={<CopyIcon />}\n        />\n        <CodeSnippet\n          showLineNumbers\n          style={{\n            padding: `${theme.spacing.sm}px ${theme.spacing.md}px`,\n            marginTop: theme.spacing.md,\n          }}\n          language=\"python\"\n        >\n          {code}\n        </CodeSnippet>\n      </div>\n    </div>\n  );\n};\n","import { CopyIcon, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from 'react-intl';\nimport { CodeSnippet } from '@databricks/web-shared/snippet';\nimport { CopyButton } from '@mlflow/mlflow/src/shared/building_blocks/CopyButton';\n\nexport const TraceTableCustomQuickstartContent = ({\n  baseComponentId,\n  experimentId,\n  runUuid,\n}: {\n  baseComponentId: string;\n  experimentId: string | null;\n  runUuid?: string;\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const code = `import mlflow\n${experimentId ? `\\nmlflow.set_experiment(experiment_id=\"${experimentId}\")\\n` : ''}\n@mlflow.trace\ndef foo(a):\n    return a + bar(a)\n\n# Various attributes can be passed to the decorator\n# to modify the information contained in the span\n@mlflow.trace(name=\"custom_name\", attributes={\"key\": \"value\"})\ndef bar(b):\n    return b + 1\n\n# Invoking the traced function will cause a trace to be logged\n${runUuid ? `with mlflow.start_run():\\n    ` : ''}foo(1)`;\n\n  return (\n    <div>\n      <Typography.Text>\n        <FormattedMessage\n          defaultMessage={\n            'To manually instrument your own traces, the most convenient method is to use the {code} function decorator. ' +\n            'This will cause the inputs and outputs of the function to be captured in the trace. For example:'\n          }\n          description=\"Description of how to log custom code traces using MLflow. This message is followed by a code example.\"\n          values={{\n            code: <code>@mlflow.trace</code>,\n          }}\n        />\n      </Typography.Text>\n      <div css={{ position: 'relative', width: 'min-content' }}>\n        <CopyButton\n          componentId={`${baseComponentId}.traces_table.custom_quickstart_snippet_copy`}\n          css={{ zIndex: 1, position: 'absolute', top: theme.spacing.xs, right: theme.spacing.xs }}\n          showLabel={false}\n          copyText={code}\n          icon={<CopyIcon />}\n        />\n        <CodeSnippet\n          showLineNumbers\n          style={{\n            padding: `${theme.spacing.sm}px ${theme.spacing.md}px`,\n            marginTop: theme.spacing.md,\n            marginBottom: theme.spacing.md,\n          }}\n          language=\"python\"\n        >\n          {code}\n        </CodeSnippet>\n      </div>\n      <Typography.Text>\n        <FormattedMessage\n          defaultMessage={\n            'For more complex use cases, MLflow also provides granular APIs that can be used to ' +\n            'control tracing behavior. For more information, please visit the <a>official documentation</a> on ' +\n            'fluent and client APIs for MLflow Tracing.'\n          }\n          description={\n            'Explanation of alternative APIs for custom tracing in MLflow. ' +\n            'The link leads to the MLflow documentation for the user to learn more.'\n          }\n          values={{\n            a: (text: string) => (\n              <Typography.Link\n                title=\"official documentation\"\n                componentId={`${baseComponentId}.traces_table.custom_tracing_docs_link`}\n                href=\"https://mlflow.org/docs/latest/llms/tracing/index.html#tracing-fluent-apis\"\n                openInNewTab\n              >\n                {text}\n              </Typography.Link>\n            ),\n          }}\n        />\n      </Typography.Text>\n    </div>\n  );\n};\n","import { CopyIcon, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from 'react-intl';\nimport { CodeSnippet } from '@databricks/web-shared/snippet';\nimport { CopyButton } from '@mlflow/mlflow/src/shared/building_blocks/CopyButton';\n\nexport const TraceTableAutogenQuickstartContent = ({\n  baseComponentId,\n  experimentId,\n  runUuid,\n}: {\n  baseComponentId: string;\n  experimentId: string | null;\n  runUuid?: string;\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const code = `import os\nimport mlflow\nfrom autogen import AssistantAgent, UserProxyAgent\n${experimentId ? `\\nmlflow.set_experiment(experiment_id=\"${experimentId}\")` : ''}\nmlflow.autogen.autolog()\n\n# Ensure that the \"OPENAI_API_KEY\" environment variable is set\nllm_config = {\"model\": \"gpt-4o-mini\", \"api_key\": os.environ[\"OPENAI_API_KEY\"]}\nassistant = AssistantAgent(\"assistant\", llm_config=llm_config)\nuser_proxy = UserProxyAgent(\"user_proxy\", code_execution_config=False)\n\n# All intermediate executions within the chat session will be logged\n${\n  runUuid ? `with mlflow.start_run():\\n    ` : ''\n}user_proxy.initiate_chat(assistant, message=\"What is MLflow?\", max_turns=1)`;\n\n  return (\n    <div>\n      <Typography.Text>\n        <FormattedMessage\n          defaultMessage=\"Automatically log traces for AutoGen conversations by calling the {code} function. For example:\"\n          description=\"Description of how to log traces for the AutoGen package using MLflow autologging. This message is followed by a code example.\"\n          values={{\n            code: <code>mlflow.autogen.autolog()</code>,\n          }}\n        />\n      </Typography.Text>\n      <div css={{ position: 'relative', width: 'min-content' }}>\n        <CopyButton\n          componentId={`${baseComponentId}.traces_table.autogen_quickstart_snippet_copy`}\n          css={{ zIndex: 1, position: 'absolute', top: theme.spacing.xs, right: theme.spacing.xs }}\n          showLabel={false}\n          copyText={code}\n          icon={<CopyIcon />}\n        />\n        <CodeSnippet\n          showLineNumbers\n          style={{\n            padding: `${theme.spacing.sm}px ${theme.spacing.md}px`,\n            marginTop: theme.spacing.md,\n          }}\n          language=\"python\"\n        >\n          {code}\n        </CodeSnippet>\n      </div>\n    </div>\n  );\n};\n","import { CopyIcon, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from 'react-intl';\nimport { CodeSnippet } from '@databricks/web-shared/snippet';\nimport { CopyButton } from '@mlflow/mlflow/src/shared/building_blocks/CopyButton';\n\nexport const TraceTableOpenAIQuickstartContent = ({\n  baseComponentId,\n  experimentId,\n  runUuid,\n}: {\n  baseComponentId: string;\n  experimentId: string | null;\n  runUuid?: string;\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const code = `import mlflow\nfrom openai import OpenAI\n${experimentId ? `\\nmlflow.set_experiment(experiment_id=\"${experimentId}\")` : ''}\nmlflow.openai.autolog()\n\n# Ensure that the \"OPENAI_API_KEY\" environment variable is set\nclient = OpenAI()\n\nmessages = [\n  {\"role\": \"system\", \"content\": \"You are a helpful assistant.\"},\n  {\"role\": \"user\", \"content\": \"Hello!\"}\n]\n\n# Inputs and outputs of the API request will be logged in a trace\n${\n  runUuid ? `with mlflow.start_run():\\n    ` : ''\n}client.chat.completions.create(model=\"gpt-4o-mini\", messages=messages)`;\n\n  return (\n    <div>\n      <Typography.Text>\n        <FormattedMessage\n          defaultMessage=\"Automatically log traces for OpenAI API calls by calling the {code} function. For example:\"\n          description=\"Description of how to log traces for the OpenAI package using MLflow autologging. This message is followed by a code example.\"\n          values={{\n            code: <code>mlflow.openai.autolog()</code>,\n          }}\n        />\n      </Typography.Text>\n      <div css={{ position: 'relative', width: 'min-content' }}>\n        <CopyButton\n          componentId={`${baseComponentId}.traces_table.openai_quickstart_snippet_copy`}\n          css={{ zIndex: 1, position: 'absolute', top: theme.spacing.xs, right: theme.spacing.xs }}\n          showLabel={false}\n          copyText={code}\n          icon={<CopyIcon />}\n        />\n        <CodeSnippet\n          showLineNumbers\n          style={{\n            padding: `${theme.spacing.sm}px ${theme.spacing.md}px`,\n            marginTop: theme.spacing.md,\n          }}\n          language=\"python\"\n        >\n          {code}\n        </CodeSnippet>\n      </div>\n    </div>\n  );\n};\n","import { Header, Tabs, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from 'react-intl';\nimport { TraceTableLangchainQuickstartContent } from './TraceTableLangchainQuickstartContent';\nimport { TraceTableLlamaIndexQuickstartContent } from './TraceTableLlamaIndexQuickstartContent';\nimport { TraceTableCustomQuickstartContent } from './TraceTableCustomQuickstartContent';\nimport { TraceTableAutogenQuickstartContent } from './TraceTableAutogenQuickstartContent';\nimport { TraceTableOpenAIQuickstartContent } from './TraceTableOpenAIQuickstartContent';\nimport { isNil } from 'lodash';\n\nexport const TracesViewTableNoTracesQuickstart = ({\n  baseComponentId,\n  experimentIds,\n  runUuid,\n}: {\n  baseComponentId: string;\n  experimentIds: string[];\n  runUuid?: string;\n}) => {\n  const { theme } = useDesignSystemTheme();\n  // only display the experiment ID if the user is viewing exactly one experiment\n  const experimentId = experimentIds.length === 1 ? experimentIds[0] : null;\n\n  return (\n    <div css={{ marginLeft: -theme.spacing.md }}>\n      <Header\n        title={\n          <FormattedMessage\n            defaultMessage=\"No traces recorded\"\n            description=\"Message displayed when there are no traces logged to the experiment\"\n          />\n        }\n        titleElementLevel={3}\n      />\n      <Typography.Text\n        css={{\n          display: 'block',\n          marginTop: theme.spacing.md,\n          marginBottom: theme.spacing.md,\n        }}\n      >\n        <FormattedMessage\n          defaultMessage={\n            'This tab displays all the traces logged to this {isRun, select, true {run} other {experiment}}. ' +\n            'MLflow supports automatic tracing for many popular generative AI frameworks. Follow the steps below to log ' +\n            'your first trace. For more information about MLflow Tracing, visit the <a>MLflow documentation</a>.'\n          }\n          description={\n            \"Message that explains the function of the 'Traces' tab in the MLflow UI.\" +\n            'This message is followed by a tutorial explaining how to get started with MLflow Tracing.'\n          }\n          values={{\n            isRun: !isNil(runUuid),\n            a: (text: string) => (\n              <Typography.Link\n                componentId={`${baseComponentId}.traces_table.quickstart_docs_link`}\n                href=\"https://mlflow.org/docs/latest/llms/tracing/index.html\"\n                openInNewTab\n              >\n                {text}\n              </Typography.Link>\n            ),\n          }}\n        />\n      </Typography.Text>\n      <Tabs.Root componentId={`${baseComponentId}.traces_table.quickstart`} defaultValue=\"langchain\">\n        <Tabs.List>\n          <Tabs.Trigger value=\"langchain\">\n            <FormattedMessage\n              defaultMessage=\"LangChain / LangGraph\"\n              description=\"Header for LangChain / LangGraph tab in the MLflow Tracing quickstart guide\"\n            />\n          </Tabs.Trigger>\n          <Tabs.Trigger value=\"llama-index\">\n            <FormattedMessage\n              defaultMessage=\"LlamaIndex\"\n              description=\"Header for LlamaIndex tab in the MLflow Tracing quickstart guide\"\n            />\n          </Tabs.Trigger>\n          <Tabs.Trigger value=\"autogen\">\n            <FormattedMessage\n              defaultMessage=\"AutoGen\"\n              description=\"Header for AutoGen tab in the MLflow Tracing quickstart guide\"\n            />\n          </Tabs.Trigger>\n          <Tabs.Trigger value=\"openai\">\n            <FormattedMessage\n              defaultMessage=\"OpenAI\"\n              description=\"Header for OpenAI tab in the MLflow Tracing quickstart guide\"\n            />\n          </Tabs.Trigger>\n          <Tabs.Trigger value=\"custom\">\n            <FormattedMessage\n              defaultMessage=\"Custom\"\n              description=\"Header for custom tracing tab in the MLflow Tracing quickstart guide\"\n            />\n          </Tabs.Trigger>\n        </Tabs.List>\n        <Tabs.Content value=\"langchain\">\n          <TraceTableLangchainQuickstartContent\n            baseComponentId={baseComponentId}\n            experimentId={experimentId}\n            runUuid={runUuid}\n          />\n        </Tabs.Content>\n        <Tabs.Content value=\"llama-index\">\n          <TraceTableLlamaIndexQuickstartContent\n            baseComponentId={baseComponentId}\n            experimentId={experimentId}\n            runUuid={runUuid}\n          />\n        </Tabs.Content>\n        <Tabs.Content value=\"autogen\">\n          <TraceTableAutogenQuickstartContent\n            baseComponentId={baseComponentId}\n            experimentId={experimentId}\n            runUuid={runUuid}\n          />\n        </Tabs.Content>\n        <Tabs.Content value=\"openai\">\n          <TraceTableOpenAIQuickstartContent\n            baseComponentId={baseComponentId}\n            experimentId={experimentId}\n            runUuid={runUuid}\n          />\n        </Tabs.Content>\n        <Tabs.Content value=\"custom\">\n          <TraceTableCustomQuickstartContent\n            baseComponentId={baseComponentId}\n            experimentId={experimentId}\n            runUuid={runUuid}\n          />\n        </Tabs.Content>\n      </Tabs.Root>\n    </div>\n  );\n};\n","import {\n  CursorPagination,\n  DangerIcon,\n  Empty,\n  Table,\n  TableHeader,\n  TableRow,\n  TableSkeletonRows,\n  Typography,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport { SortingState, flexRender, getCoreRowModel, getSortedRowModel, useReactTable } from '@tanstack/react-table';\nimport React, { useMemo } from 'react';\nimport { isNil } from 'lodash';\nimport Utils from '../../../common/utils/Utils';\nimport { Link } from '../../../common/utils/RoutingUtils';\nimport { ErrorWrapper } from '../../../common/utils/ErrorWrapper';\nimport Routes from '../../routes';\nimport {\n  ExperimentViewTracesTableColumnLabels,\n  ExperimentViewTracesTableColumns,\n  TRACE_TABLE_CHECKBOX_COLUMN_ID,\n  TRACE_TAG_NAME_TRACE_NAME,\n  getTraceInfoRunId,\n  getTraceInfoTotalTokens,\n  getTraceTagValue,\n} from './TracesView.utils';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { type ModelTraceInfo } from '@databricks/web-shared/model-trace-explorer';\nimport { TracesViewTableTagCell } from './TracesViewTableTagCell';\nimport type { ModelTraceInfoWithRunName } from './hooks/useExperimentTraces';\nimport { TracesViewTableStatusCell } from './TracesViewTableStatusCell';\nimport { TracesViewTableRequestPreviewCell, TracesViewTableResponsePreviewCell } from './TracesViewTablePreviewCell';\nimport { TracesViewTableSourceCell } from './TracesViewTableSourceCell';\nimport { TracesColumnDef, getColumnSizeClassName, getHeaderSizeClassName } from './TracesViewTable.utils';\nimport { TracesViewTableRow } from './TracesViewTableRow';\nimport { TracesViewTableTimestampCell } from './TracesViewTableTimestampCell';\nimport { TracesViewTableHeaderCheckbox } from './TracesViewTableHeaderCheckbox';\nimport { TracesViewTableCellCheckbox } from './TracesViewTableCellCheckbox';\nimport { TracesViewTableNoTracesQuickstart } from './quickstart/TracesViewTableNoTracesQuickstart';\n\nexport interface TracesViewTableProps {\n  experimentIds: string[];\n  runUuid?: string;\n  traces: ModelTraceInfoWithRunName[];\n  onTraceClicked?: (trace: ModelTraceInfo) => void;\n  onTraceTagsEdit?: (trace: ModelTraceInfo) => void;\n  onTagsUpdated?: () => void;\n  loading: boolean;\n  error?: Error;\n  usingFilters?: boolean;\n  hasNextPage: boolean;\n  hasPreviousPage: boolean;\n  onNextPage: () => void;\n  onPreviousPage: () => void;\n  onResetFilters: () => void;\n  sorting: SortingState;\n  setSorting: React.Dispatch<React.SetStateAction<SortingState>>;\n  rowSelection: { [id: string]: boolean };\n  setRowSelection: React.Dispatch<React.SetStateAction<{ [id: string]: boolean }>>;\n  hiddenColumns?: string[];\n  disableTokenColumn?: boolean;\n  baseComponentId: string;\n}\n\nexport const TracesViewTable = React.memo(\n  ({\n    experimentIds,\n    runUuid,\n    traces,\n    loading,\n    error,\n    onTraceClicked,\n    onTraceTagsEdit,\n    hasNextPage,\n    hasPreviousPage,\n    onNextPage,\n    onPreviousPage,\n    usingFilters,\n    onResetFilters,\n    sorting,\n    setSorting,\n    rowSelection,\n    setRowSelection,\n    hiddenColumns = [],\n    disableTokenColumn,\n    baseComponentId,\n  }: TracesViewTableProps) => {\n    const intl = useIntl();\n\n    const columns = useMemo<TracesColumnDef[]>(() => {\n      const columns: TracesColumnDef[] = [\n        {\n          id: TRACE_TABLE_CHECKBOX_COLUMN_ID,\n          header: TracesViewTableHeaderCheckbox,\n          enableResizing: false,\n          enableSorting: false,\n          cell: TracesViewTableCellCheckbox,\n          meta: { styles: { minWidth: 32, maxWidth: 32 } },\n        },\n        {\n          header: intl.formatMessage(ExperimentViewTracesTableColumnLabels[ExperimentViewTracesTableColumns.requestId]),\n          enableSorting: false,\n          enableResizing: true,\n          id: ExperimentViewTracesTableColumns.requestId,\n          cell({ row: { original } }) {\n            return (\n              <Typography.Link\n                componentId={`${baseComponentId}.traces_table.request_id_link`}\n                ellipsis\n                css={{ maxWidth: '100%', textOverflow: 'ellipsis' }}\n                onClick={() => {\n                  onTraceClicked?.(original);\n                }}\n              >\n                {original.request_id}\n              </Typography.Link>\n            );\n          },\n          meta: { styles: { minWidth: 200 } },\n        },\n        {\n          header: intl.formatMessage(ExperimentViewTracesTableColumnLabels[ExperimentViewTracesTableColumns.traceName]),\n          enableSorting: false,\n          enableResizing: true,\n          id: ExperimentViewTracesTableColumns.traceName,\n          cell({ row: { original } }) {\n            return (\n              <Typography.Link\n                componentId={`${baseComponentId}.traces_table.trace_name_link`}\n                ellipsis\n                css={{ maxWidth: '100%', textOverflow: 'ellipsis' }}\n                onClick={() => {\n                  onTraceClicked?.(original);\n                }}\n              >\n                {getTraceTagValue(original, TRACE_TAG_NAME_TRACE_NAME)}\n              </Typography.Link>\n            );\n          },\n          meta: { styles: { minWidth: 150 } },\n        },\n        {\n          header: intl.formatMessage(\n            ExperimentViewTracesTableColumnLabels[ExperimentViewTracesTableColumns.timestampMs],\n          ),\n          id: ExperimentViewTracesTableColumns.timestampMs,\n          accessorFn: (data) => data.timestamp_ms,\n          enableSorting: true,\n          enableResizing: false,\n          cell: TracesViewTableTimestampCell,\n          meta: { styles: { minWidth: 140, maxWidth: 140 } },\n        },\n        {\n          header: intl.formatMessage(ExperimentViewTracesTableColumnLabels[ExperimentViewTracesTableColumns.status]),\n          id: ExperimentViewTracesTableColumns.status,\n          enableSorting: false,\n          enableResizing: false,\n          cell: TracesViewTableStatusCell,\n          meta: { styles: { minWidth: 110, maxWidth: 110 } },\n        },\n        {\n          header: intl.formatMessage(ExperimentViewTracesTableColumnLabels[ExperimentViewTracesTableColumns.inputs]),\n          id: ExperimentViewTracesTableColumns.inputs,\n          enableSorting: false,\n          enableResizing: true,\n          cell: TracesViewTableRequestPreviewCell,\n          meta: { multiline: true },\n        },\n        {\n          header: intl.formatMessage(ExperimentViewTracesTableColumnLabels[ExperimentViewTracesTableColumns.outputs]),\n          enableSorting: false,\n          enableResizing: true,\n          id: ExperimentViewTracesTableColumns.outputs,\n          cell: TracesViewTableResponsePreviewCell,\n          meta: { multiline: true },\n        },\n        {\n          header: intl.formatMessage(ExperimentViewTracesTableColumnLabels[ExperimentViewTracesTableColumns.runName]),\n          enableSorting: false,\n          enableResizing: true,\n          id: ExperimentViewTracesTableColumns.runName,\n          cell({ row: { original } }) {\n            const runId = getTraceInfoRunId(original);\n            if (!runId || !original.experiment_id) {\n              return null;\n            }\n            const label = original.runName || runId;\n            return (\n              <Link\n                css={{\n                  maxWidth: '100%',\n                  textOverflow: 'ellipsis',\n                  display: 'inline-block',\n                  overflow: 'hidden',\n                }}\n                to={Routes.getRunPageRoute(original.experiment_id, runId)}\n              >\n                {label}\n              </Link>\n            );\n          },\n        },\n        {\n          header: intl.formatMessage(ExperimentViewTracesTableColumnLabels[ExperimentViewTracesTableColumns.source]),\n          enableSorting: true,\n          enableResizing: true,\n          id: ExperimentViewTracesTableColumns.source,\n          cell: TracesViewTableSourceCell,\n          meta: { styles: { minWidth: 100 } },\n        },\n      ];\n\n      if (!disableTokenColumn) {\n        columns.push({\n          header: intl.formatMessage(\n            ExperimentViewTracesTableColumnLabels[ExperimentViewTracesTableColumns.totalTokens],\n          ),\n          enableSorting: false,\n          enableResizing: true,\n          id: ExperimentViewTracesTableColumns.totalTokens,\n          accessorFn: (data) => getTraceInfoTotalTokens(data),\n          meta: { styles: { minWidth: 80, maxWidth: 80 } },\n        });\n      }\n      columns.push(\n        {\n          header: intl.formatMessage(ExperimentViewTracesTableColumnLabels[ExperimentViewTracesTableColumns.latency]),\n          enableSorting: false,\n          enableResizing: false,\n          id: ExperimentViewTracesTableColumns.latency,\n          accessorFn: (data) => {\n            if (isNil(data.execution_time_ms) || !isFinite(data.execution_time_ms)) {\n              return null;\n            }\n            return Utils.formatDuration(data.execution_time_ms);\n          },\n          meta: { styles: { width: 120 } },\n        },\n        {\n          header: intl.formatMessage(ExperimentViewTracesTableColumnLabels[ExperimentViewTracesTableColumns.tags]),\n          enableSorting: false,\n          enableResizing: true,\n          id: ExperimentViewTracesTableColumns.tags,\n          cell({ row: { original } }) {\n            return (\n              <TracesViewTableTagCell\n                tags={original.tags || []}\n                onAddEditTags={() => onTraceTagsEdit?.(original)}\n                baseComponentId={baseComponentId}\n              />\n            );\n          },\n        },\n      );\n\n      return columns.filter((column) => column.id && !hiddenColumns.includes(column.id));\n    }, [intl, onTraceClicked, onTraceTagsEdit, disableTokenColumn, hiddenColumns, baseComponentId]);\n\n    const table = useReactTable<ModelTraceInfoWithRunName>({\n      columns,\n      data: traces,\n      state: { sorting, rowSelection },\n      getCoreRowModel: getCoreRowModel(),\n      getRowId: (row, index) => row.request_id || index.toString(),\n      getSortedRowModel: getSortedRowModel(),\n      onSortingChange: setSorting,\n      onRowSelectionChange: setRowSelection,\n      enableColumnResizing: true,\n      enableRowSelection: true,\n      columnResizeMode: 'onChange',\n    });\n\n    const getEmptyState = () => {\n      if (error) {\n        const errorMessage = error instanceof ErrorWrapper ? error.getMessageField() : error.message;\n        return (\n          <Empty\n            image={<DangerIcon />}\n            description={errorMessage}\n            title={\n              <FormattedMessage\n                defaultMessage=\"Error\"\n                description=\"Experiment page > traces table > error state title\"\n              />\n            }\n          />\n        );\n      }\n      if (!loading && traces.length === 0 && usingFilters) {\n        return (\n          <Empty\n            description={\n              <FormattedMessage\n                defaultMessage=\"No traces found with the current filter query. <button>Reset filters</button> to see all traces.\"\n                description=\"Experiment page > traces table > no traces recorded\"\n                values={{\n                  button: (chunks: any) => (\n                    <Typography.Link\n                      componentId=\"codegen_mlflow_app_src_experiment-tracking_components_traces_tracesviewtable.tsx_289\"\n                      onClick={onResetFilters}\n                    >\n                      {chunks}\n                    </Typography.Link>\n                  ),\n                }}\n              />\n            }\n            title={\n              <FormattedMessage\n                defaultMessage=\"No traces found\"\n                description=\"Experiment page > traces table > no traces recorded\"\n              />\n            }\n          />\n        );\n      }\n      if (!loading && traces.length === 0) {\n        return (\n          <TracesViewTableNoTracesQuickstart\n            baseComponentId={baseComponentId}\n            experimentIds={experimentIds}\n            runUuid={runUuid}\n          />\n        );\n      }\n      return null;\n    };\n\n    // to improve performance, we pass the column sizes as inline styles to the table\n    const columnSizeInfo = table.getState().columnSizingInfo;\n    const columnSizeVars = React.useMemo(() => {\n      const headers = table.getFlatHeaders();\n      const colSizes: { [key: string]: number } = {};\n      headers.forEach((header) => {\n        colSizes[getHeaderSizeClassName(header.id)] = header.getSize();\n        colSizes[getColumnSizeClassName(header.column.id)] = header.column.getSize();\n      });\n      return colSizes;\n      // we need to recompute this whenever columns get resized or changed\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [columnSizeInfo, columns, table]);\n\n    return (\n      <Table\n        scrollable\n        empty={getEmptyState()}\n        style={columnSizeVars}\n        pagination={\n          <CursorPagination\n            componentId={`${baseComponentId}.traces_table.pagination`}\n            hasNextPage={hasNextPage}\n            hasPreviousPage={hasPreviousPage}\n            onNextPage={onNextPage}\n            onPreviousPage={onPreviousPage}\n          />\n        }\n      >\n        <TableRow isHeader>\n          {table.getLeafHeaders().map((header) => {\n            return (\n              <TableHeader\n                componentId=\"codegen_mlflow_app_src_experiment-tracking_components_traces_tracesviewtable.tsx_365\"\n                key={header.id}\n                css={(header.column.columnDef as TracesColumnDef).meta?.styles}\n                sortable={header.column.getCanSort()}\n                sortDirection={header.column.getIsSorted() || 'none'}\n                onToggleSort={header.column.getToggleSortingHandler()}\n                resizable={header.column.getCanResize()}\n                resizeHandler={header.getResizeHandler()}\n                isResizing={header.column.getIsResizing()}\n                style={{\n                  flex: `calc(var(${getHeaderSizeClassName(header.id)}) / 100)`,\n                }}\n              >\n                {flexRender(header.column.columnDef.header, header.getContext())}\n              </TableHeader>\n            );\n          })}\n        </TableRow>\n        {loading && <TableSkeletonRows table={table} />}\n        {!loading &&\n          !error &&\n          table\n            .getRowModel()\n            .rows.map((row) => (\n              <TracesViewTableRow key={row.id} row={row} columns={columns} selected={rowSelection[row.id]} />\n            ))}\n      </Table>\n    );\n  },\n);\n","import React, { useEffect, useRef } from 'react';\n\nimport {\n  ModelTraceChildToParentFrameMessage,\n  ModelTraceParentToChildFrameMessage,\n} from '@databricks/web-shared/model-trace-explorer';\nimport type { ModelTrace, ModelTraceChildToParentFrameMessageType } from '@databricks/web-shared/model-trace-explorer';\nimport { TableSkeleton, TitleSkeleton } from '@databricks/design-system';\nimport { Version } from '../../../common/constants';\n\nexport const ModelTraceExplorerFrameRenderer = ({\n  modelTrace,\n  height = 700,\n  useLatestVersion = false,\n}: {\n  modelTrace: ModelTrace;\n  height?: number | string;\n  useLatestVersion?: boolean;\n}) => {\n  const iframeRef = useRef<HTMLIFrameElement>(null);\n  const [isLoading, setIsLoading] = React.useState(true);\n\n  useEffect(() => {\n    const handleMessage = (event: MessageEvent<ModelTraceChildToParentFrameMessageType>) => {\n      // only handle messages from the child iframe\n      const iframeWindow = iframeRef.current?.contentWindow;\n      if (!iframeWindow || event.source !== iframeWindow) {\n        return;\n      }\n\n      switch (event.data.type) {\n        case ModelTraceChildToParentFrameMessage.Ready: {\n          setIsLoading(false);\n          break;\n        }\n        default:\n          break;\n      }\n    };\n\n    window.addEventListener('message', handleMessage);\n    return () => {\n      window.removeEventListener('message', handleMessage);\n    };\n  }, [modelTrace]);\n\n  useEffect(() => {\n    const iframeWindow = iframeRef.current?.contentWindow;\n    if (!iframeWindow || isLoading) {\n      return;\n    }\n\n    iframeWindow.postMessage({\n      type: ModelTraceParentToChildFrameMessage.UpdateTrace,\n      traceData: modelTrace,\n    });\n  }, [modelTrace, isLoading]);\n\n  return (\n    <div css={{ height }}>\n      {isLoading && (\n        <div\n          css={{\n            position: 'absolute',\n            width: '100%',\n            height,\n          }}\n        >\n          <TitleSkeleton />\n          <TableSkeleton lines={5} />\n        </div>\n      )}\n      <iframe\n        title=\"Model Trace Explorer\"\n        // Include the current mlflow version as a query parameter to bust the browser cache\n        // generated and prevent https://github.com/mlflow/mlflow/issues/13829.\n        src={`static-files/lib/ml-model-trace-renderer/index.html?version=${Version}`}\n        ref={iframeRef}\n        css={{\n          border: 'none',\n          width: '100%',\n          height,\n        }}\n      />\n    </div>\n  );\n};\n","export { ModelTraceExplorerFrameRenderer } from './ModelTraceExplorerFrameRenderer';\n\nexport enum ModelSpanType {\n  LLM = 'LLM',\n  CHAIN = 'CHAIN',\n  AGENT = 'AGENT',\n  TOOL = 'TOOL',\n  FUNCTION = 'FUNCTION',\n  CHAT_MODEL = 'CHAT_MODEL',\n  RETRIEVER = 'RETRIEVER',\n  PARSER = 'PARSER',\n  EMBEDDING = 'EMBEDDING',\n  RERANKER = 'RERANKER',\n  UNKNOWN = 'UNKNOWN',\n}\n\nexport enum ModelIconType {\n  MODELS = 'models',\n  DOCUMENT = 'document',\n  CONNECT = 'connect',\n}\n\n/**\n * Represents a single model trace span.\n * Based on https://github.com/mlflow/mlflow/blob/tracing/mlflow/entities/span.py\n */\nexport type ModelTraceSpan = {\n  context: {\n    span_id: string;\n    trace_id: string;\n  };\n  name: string;\n  /* deprecated, renamed to `parent_id` */\n  parent_span_id?: string | null;\n  parent_id?: string | null;\n  /* deprecated, contained in attributes['mlflow.spanType'] */\n  span_type?: ModelSpanType | string;\n  /* deprecated, migrated to `status_code` and `status_message` */\n  status?: ModelTraceStatus;\n  status_code?: string;\n  status_message?: string | null;\n  start_time: number;\n  end_time: number;\n  /* deprecated, contained in attributes['mlflow.spanInputs'] */\n  inputs?: any;\n  /* deprecated, contained in attributes['mlflow.spanOutputs'] */\n  outputs?: any;\n  attributes?: Record<string, any>;\n  /* metadata for ui usage logging */\n  type: ModelSpanType;\n};\n\nexport type ModelTraceEvent = {\n  name: string;\n  timestamp?: number;\n  attributes?: Record<string, any>;\n};\n\nexport type ModelTraceData = {\n  spans: ModelTraceSpan[];\n};\n\n/**\n * Represents a single model trace object.\n * Based on https://github.com/mlflow/mlflow/blob/8e44d102e9568d09d9dc376136d13a5a5d1ab46f/mlflow/tracing/types/model.py#L11\n */\nexport type ModelTrace = {\n  /* deprecated, renamed to `data` */\n  trace_data?: ModelTraceData;\n  /* deprecated, renamed to `info` */\n  trace_info?: ModelTraceInfo;\n  data: ModelTraceData;\n  info: ModelTraceInfo;\n};\n\nexport type ModelTraceInfo = {\n  request_id?: string;\n  experiment_id?: string;\n  timestamp_ms?: number;\n  execution_time_ms?: number;\n  status?: ModelTraceStatus['description'];\n  attributes?: Record<string, any>;\n  request_metadata?: { key: string; value: string }[];\n  tags?: { key: string; value: string }[];\n};\n\nexport type ModelTraceStatusUnset = {\n  description: 'UNSET';\n  status_code: 0;\n};\n\nexport type ModelTraceStatusOk = {\n  description: 'OK';\n  status_code: 1;\n};\n\nexport type ModelTraceStatusError = {\n  description: 'ERROR';\n  status_code: 2;\n};\n\nexport type ModelTraceStatusInProgress = {\n  description: 'IN_PROGRESS';\n  status_code: 3;\n};\n\nexport enum ModelTraceSpanType {\n  LLM = 'LLM',\n  CHAIN = 'CHAIN',\n  AGENT = 'AGENT',\n  TOOL = 'TOOL',\n  CHAT_MODEL = 'CHAT_MODEL',\n  RETRIEVER = 'RETRIEVER',\n  PARSER = 'PARSER',\n  EMBEDDING = 'EMBEDDING',\n  RERANKER = 'RERANKER',\n  UNKNOWN = 'UNKNOWN',\n}\n\nexport type ModelTraceStatus =\n  | ModelTraceStatusUnset\n  | ModelTraceStatusOk\n  | ModelTraceStatusError\n  | ModelTraceStatusInProgress;\n\nexport enum ModelTraceChildToParentFrameMessage {\n  Ready = 'READY',\n}\n\ntype ModelTraceFrameReadyMessage = {\n  type: ModelTraceChildToParentFrameMessage.Ready;\n};\n\nexport enum ModelTraceParentToChildFrameMessage {\n  UpdateTrace = 'UPDATE_TRACE',\n}\n\ntype ModelTraceFrameUpdateTraceMessage = {\n  type: ModelTraceParentToChildFrameMessage.UpdateTrace;\n  traceData: ModelTrace;\n};\n\nexport type ModelTraceChildToParentFrameMessageType = ModelTraceFrameReadyMessage;\nexport type ModelTraceParentToChildFrameMessageType = ModelTraceFrameUpdateTraceMessage;\n","import { type ModelTraceInfo } from '@databricks/web-shared/model-trace-explorer';\nimport { useCallback, useEffect, useState } from 'react';\nimport { MlflowService } from '../../../sdk/MlflowService';\n\n/**\n * Fetches single trace info object for a given trace request ID.\n */\nexport const useExperimentTraceInfo = (requestId: string, enabled = true) => {\n  const [traceInfo, setTraceInfoData] = useState<ModelTraceInfo | undefined>(undefined);\n  const [loading, setLoading] = useState<boolean>(enabled);\n  const [error, setError] = useState<Error | undefined>(undefined);\n\n  const fetchTraceInfo = useCallback(async () => {\n    if (!enabled) {\n      return;\n    }\n    setError(undefined);\n\n    try {\n      const response = await MlflowService.getExperimentTraceInfo(requestId);\n\n      if (!response.trace_info) {\n        setTraceInfoData(undefined);\n        return;\n      }\n\n      setTraceInfoData(response.trace_info);\n    } catch (e: any) {\n      setError(e);\n    } finally {\n      setLoading(false);\n    }\n  }, [enabled, requestId]);\n\n  useEffect(() => {\n    fetchTraceInfo();\n  }, [fetchTraceInfo]);\n\n  return {\n    traceInfo,\n    loading,\n    error,\n  };\n};\n","import {\n  DangerIcon,\n  Drawer,\n  Empty,\n  Spacer,\n  TableSkeleton,\n  TitleSkeleton,\n  WarningIcon,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport { getTraceDisplayName } from './TracesView.utils';\nimport { useExperimentTraceData } from './hooks/useExperimentTraceData';\nimport {\n  type ModelTrace,\n  ModelTraceInfo,\n  ModelTraceExplorerFrameRenderer,\n} from '@databricks/web-shared/model-trace-explorer';\nimport { useMemo } from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { useExperimentTraceInfo } from './hooks/useExperimentTraceInfo';\n\nexport const TraceDataDrawer = ({\n  requestId,\n  traceInfo,\n  loadingTraceInfo,\n  onClose,\n}: {\n  requestId: string;\n  traceInfo?: ModelTraceInfo;\n  loadingTraceInfo?: boolean;\n  onClose: () => void;\n}) => {\n  const {\n    traceData,\n    loading: loadingTraceData,\n    error,\n  } = useExperimentTraceData(\n    requestId,\n    // skip fetching trace data if trace is in progress\n    traceInfo?.status === 'IN_PROGRESS',\n  );\n  const { theme } = useDesignSystemTheme();\n\n  // Usually, we rely on the parent component to provide trace info object (when clicked in a table row).\n  // But in some cases it's not available (e.g. when deep linking to a trace when the entity is not on the same page)\n  // and then we fetch it independently here.\n  const shouldFetchTraceInfo = !loadingTraceInfo && !traceInfo;\n\n  const { traceInfo: internalTraceInfo, loading: loadingInternalTracingInfo } = useExperimentTraceInfo(\n    requestId,\n    shouldFetchTraceInfo,\n  );\n\n  const traceInfoToUse = traceInfo || internalTraceInfo;\n\n  const title = useMemo(() => {\n    if (loadingTraceInfo || loadingInternalTracingInfo) {\n      return <TitleSkeleton />;\n    }\n    if (traceInfoToUse) {\n      return getTraceDisplayName(traceInfoToUse as ModelTraceInfo);\n    }\n    return requestId;\n  }, [loadingTraceInfo, loadingInternalTracingInfo, traceInfoToUse, requestId]);\n\n  // Construct the model trace object with the trace info and trace data\n  const combinedModelTrace = useMemo(\n    () =>\n      traceData\n        ? {\n            // We're assigning values redunantly due to a name change in the upstream interface,\n            // will be cleaned up shortly\n            trace_info: traceInfoToUse || {},\n            info: traceInfoToUse || {},\n            trace_data: traceData,\n            data: traceData,\n          }\n        : undefined,\n    [traceData, traceInfoToUse],\n  );\n\n  const containsSpans = (traceData?.spans || []).length > 0;\n\n  const renderContent = () => {\n    if (loadingTraceData || loadingTraceInfo || loadingInternalTracingInfo) {\n      return (\n        <>\n          <TitleSkeleton />\n          <TableSkeleton lines={5} />\n        </>\n      );\n    }\n    if (traceInfo?.status === 'IN_PROGRESS') {\n      return (\n        <>\n          <Spacer size=\"lg\" />\n          <Empty\n            image={<WarningIcon />}\n            description={\n              <FormattedMessage\n                defaultMessage=\"Trace data is not available for in-progress traces. Please wait for the trace to complete.\"\n                description=\"Experiment page > traces data drawer > in-progress description\"\n              />\n            }\n            title={\n              <FormattedMessage\n                defaultMessage=\"Trace data not available\"\n                description=\"Experiment page > traces data drawer > in-progress title\"\n              />\n            }\n          />\n        </>\n      );\n    }\n    if (error) {\n      return (\n        <>\n          <Spacer size=\"lg\" />\n          <Empty\n            image={<DangerIcon />}\n            description={\n              <FormattedMessage\n                defaultMessage=\"An error occurred while attemptying to fetch the trace data. Please wait a moment and try again.\"\n                description=\"Experiment page > traces data drawer > error state description\"\n              />\n            }\n            title={\n              <FormattedMessage\n                defaultMessage=\"Error\"\n                description=\"Experiment page > traces data drawer > error state title\"\n              />\n            }\n          />\n        </>\n      );\n    }\n    if (!containsSpans) {\n      return (\n        <>\n          <Spacer size=\"lg\" />\n          <Empty\n            description={null}\n            title={\n              <FormattedMessage\n                defaultMessage=\"No trace data recorded\"\n                description=\"Experiment page > traces data drawer > no trace data recorded empty state\"\n              />\n            }\n          />\n        </>\n      );\n    }\n    if (combinedModelTrace) {\n      return (\n        <div\n          css={{\n            height: `calc(100% - ${theme.spacing.sm}px)`,\n            marginLeft: -theme.spacing.lg,\n            marginRight: -theme.spacing.lg,\n            marginBottom: -theme.spacing.lg,\n          }}\n          onWheel={(e) => e.stopPropagation()}\n        >\n          <ModelTraceExplorerFrameRenderer modelTrace={combinedModelTrace as ModelTrace} height=\"100%\" />\n        </div>\n      );\n    }\n    return null;\n  };\n\n  return (\n    <Drawer.Root\n      modal\n      open\n      onOpenChange={(open) => {\n        if (!open) {\n          onClose();\n        }\n      }}\n    >\n      <Drawer.Content\n        componentId=\"codegen_mlflow_app_src_experiment-tracking_components_traces_tracedatadrawer.tsx_222\"\n        width=\"85vw\"\n        title={title}\n        expandContentToFullHeight\n      >\n        {renderContent()}\n      </Drawer.Content>\n    </Drawer.Root>\n  );\n};\n","import { useCallback, useEffect, useState } from 'react';\nimport { MlflowService } from '../../../sdk/MlflowService';\nimport { ModelTraceStatus, type ModelTraceData } from '@databricks/web-shared/model-trace-explorer';\nimport Utils from '../../../../common/utils/Utils';\n\nexport const useExperimentTraceData = (traceId?: string, skip = false) => {\n  const [traceData, setTraceData] = useState<ModelTraceData | undefined>(undefined);\n  const [loading, setLoading] = useState<boolean>(false);\n  const [error, setError] = useState<Error | undefined>(undefined);\n\n  const fetchTraceData = useCallback(async (traceId: string) => {\n    setLoading(true);\n    try {\n      const response = await MlflowService.getExperimentTraceData(traceId);\n\n      if (Array.isArray(response.spans)) {\n        setTraceData(response);\n      } else {\n        // Not a showstopper, but we should log this error and notify the user.\n        Utils.logErrorAndNotifyUser('Invalid trace data response: ' + JSON.stringify(response?.toString()));\n      }\n    } catch (e: any) {\n      setError(e);\n    }\n    setLoading(false);\n  }, []);\n\n  useEffect(() => {\n    if (traceId && !skip) {\n      fetchTraceData(traceId);\n    }\n  }, [fetchTraceData, traceId, skip]);\n\n  return { traceData, loading, error };\n};\n","import { type ModelTraceInfo } from '@databricks/web-shared/model-trace-explorer';\nimport { useEditKeyValueTagsModal } from '../../../../common/hooks/useEditKeyValueTagsModal';\nimport { MlflowService } from '../../../sdk/MlflowService';\nimport { KeyValueEntity } from '../../../types';\nimport { useCallback } from 'react';\nimport { MLFLOW_INTERNAL_PREFIX } from '../../../../common/utils/TagUtils';\n\ntype EditedModelTrace = {\n  traceRequestId: string;\n  tags: KeyValueEntity[];\n};\n\nexport const useEditExperimentTraceTags = ({\n  onSuccess,\n  existingTagKeys = [],\n}: {\n  onSuccess?: () => void;\n  existingTagKeys?: string[];\n}) => {\n  const { showEditTagsModal, EditTagsModal } = useEditKeyValueTagsModal<EditedModelTrace>({\n    saveTagsHandler: async (editedEntity, existingTags, newTags) => {\n      if (!editedEntity.traceRequestId) {\n        return;\n      }\n      const requestId = editedEntity.traceRequestId;\n      // First, determine new tags to be added\n      const addedOrModifiedTags = newTags.filter(\n        ({ key: newTagKey, value: newTagValue }) =>\n          !existingTags.some(\n            ({ key: existingTagKey, value: existingTagValue }) =>\n              existingTagKey === newTagKey && newTagValue === existingTagValue,\n          ),\n      );\n\n      // Next, determine those to be deleted\n      const deletedTags = existingTags.filter(\n        ({ key: existingTagKey }) => !newTags.some(({ key: newTagKey }) => existingTagKey === newTagKey),\n      );\n\n      // Fire all requests at once\n      const updateRequests = Promise.all([\n        ...addedOrModifiedTags.map(({ key, value }) => MlflowService.setExperimentTraceTag(requestId, key, value)),\n        ...deletedTags.map(({ key }) => MlflowService.deleteExperimentTraceTag(requestId, key)),\n      ]);\n\n      return updateRequests;\n    },\n    valueRequired: true,\n    allAvailableTags: existingTagKeys.filter((tagKey) => tagKey && !tagKey.startsWith(MLFLOW_INTERNAL_PREFIX)),\n    onSuccess: onSuccess,\n  });\n\n  const showEditTagsModalForTrace = useCallback(\n    (trace: ModelTraceInfo) => {\n      if (!trace.request_id) {\n        return;\n      }\n      const visibleTags = trace.tags?.filter(({ key }) => key && !key.startsWith(MLFLOW_INTERNAL_PREFIX)) || [];\n      showEditTagsModal({\n        traceRequestId: trace.request_id,\n        tags: visibleTags || [],\n      });\n    },\n    [showEditTagsModal],\n  );\n\n  return {\n    showEditTagsModalForTrace,\n    EditTagsModal,\n  };\n};\n","import Utils from '@mlflow/mlflow/src/common/utils/Utils';\nimport { keys, pickBy } from 'lodash';\nimport React, { useState } from 'react';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { MlflowService } from '../../sdk/MlflowService';\nimport { Modal, Typography } from '@databricks/design-system';\n\nexport const TracesViewDeleteTraceModal = ({\n  experimentIds,\n  visible,\n  rowSelection,\n  setRowSelection,\n  handleClose,\n  refreshTraces,\n}: {\n  experimentIds: string[];\n  visible: boolean;\n  rowSelection: { [id: string]: boolean };\n  setRowSelection: (rowSelection: { [id: string]: boolean }) => void;\n  handleClose: () => void;\n  refreshTraces: () => void;\n}) => {\n  const intl = useIntl();\n  const [errorMessage, setErrorMessage] = useState<string>('');\n  const [isLoading, setIsLoading] = useState(false);\n  const tracesToDelete = keys(pickBy(rowSelection, (value) => value));\n\n  const submitDeleteTraces = async () => {\n    try {\n      // TODO: Add support for deleting traces from multiple experiments\n      // The trace data contains the experiment ID, so we simply need to\n      // pass the trace data instead of just the trace IDs.\n      await MlflowService.deleteTraces(experimentIds[0] ?? '', tracesToDelete);\n\n      // reset row selection and refresh traces\n      setRowSelection({});\n      refreshTraces();\n      handleClose();\n    } catch (e: any) {\n      setErrorMessage(\n        intl.formatMessage({\n          defaultMessage: 'An error occured while attempting to delete traces. Please refresh the page and try again.',\n          description: 'Experiment page > traces view controls > Delete traces modal > Error message',\n        }),\n      );\n    }\n    setIsLoading(false);\n  };\n\n  const handleOk = () => {\n    submitDeleteTraces();\n    setIsLoading(true);\n  };\n\n  return (\n    <Modal\n      componentId=\"codegen_mlflow_app_src_experiment-tracking_components_traces_tracesviewdeletetracemodal.tsx_62\"\n      title={\n        <FormattedMessage\n          defaultMessage=\"{count, plural, one {Delete Trace} other {Delete Traces}}\"\n          description=\"Experiment page > traces view controls > Delete traces modal > Title\"\n          values={{ count: tracesToDelete.length }}\n        />\n      }\n      visible={visible}\n      onCancel={handleClose}\n      okText={\n        <FormattedMessage\n          defaultMessage=\"Delete {count, plural, one { # trace } other { # traces }}\"\n          description=\"Experiment page > traces view controls > Delete traces modal > Delete button\"\n          values={{ count: tracesToDelete.length }}\n        />\n      }\n      onOk={handleOk}\n      okButtonProps={{ loading: isLoading, danger: true }}\n    >\n      {errorMessage && <Typography.Paragraph color=\"error\">{errorMessage}</Typography.Paragraph>}\n      <Typography.Paragraph>\n        <Typography.Text bold>\n          <FormattedMessage\n            defaultMessage=\"{count, plural, one { # trace } other { # traces }} will be deleted.\"\n            description=\"Experiment page > traces view controls > Delete traces modal > Confirmation message title\"\n            values={{\n              count: tracesToDelete.length,\n            }}\n          />\n        </Typography.Text>\n      </Typography.Paragraph>\n      <Typography.Paragraph>\n        <FormattedMessage\n          defaultMessage=\"Deleted traces cannot be restored. Are you sure you want to proceed?\"\n          description=\"Experiment page > traces view controls > Delete traces modal > Confirmation message\"\n        />\n      </Typography.Paragraph>\n    </Modal>\n  );\n};\n","import { Button, useDesignSystemTheme } from '@databricks/design-system';\nimport React, { useCallback, useState } from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { TracesViewDeleteTraceModal } from './TracesViewDeleteTraceModal';\n\nexport const TracesViewControlsActions = ({\n  experimentIds,\n  rowSelection,\n  setRowSelection,\n  refreshTraces,\n  baseComponentId,\n}: {\n  experimentIds: string[];\n  rowSelection: { [id: string]: boolean };\n  setRowSelection: (rowSelection: { [id: string]: boolean }) => void;\n  refreshTraces: () => void;\n  baseComponentId: string;\n}) => {\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const { theme } = useDesignSystemTheme();\n\n  const openModal = useCallback(() => {\n    setIsModalOpen(true);\n  }, [setIsModalOpen]);\n\n  const closeModal = useCallback(() => {\n    setIsModalOpen(false);\n  }, [setIsModalOpen]);\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        flexDirection: 'row',\n        alignItems: 'center',\n        gap: theme.spacing.sm,\n      }}\n    >\n      <Button componentId={`${baseComponentId}.traces_table.delete_traces`} onClick={openModal} danger>\n        <FormattedMessage\n          defaultMessage=\"Delete\"\n          description=\"Experiment page > traces view controls > Delete button\"\n        />\n      </Button>\n      <TracesViewDeleteTraceModal\n        experimentIds={experimentIds}\n        visible={isModalOpen}\n        rowSelection={rowSelection}\n        handleClose={closeModal}\n        refreshTraces={refreshTraces}\n        setRowSelection={setRowSelection}\n      />\n    </div>\n  );\n};\n","import {\n  Button,\n  ColumnsIcon,\n  DialogCombobox,\n  DialogComboboxContent,\n  DialogComboboxOptionList,\n  DialogComboboxOptionListCheckboxItem,\n  DialogComboboxOptionListSearch,\n  DialogComboboxTrigger,\n  InfoIcon,\n  Input,\n  Popover,\n  SearchIcon,\n  TableFilterLayout,\n  Typography,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport { useMemo, useState } from 'react';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { ExperimentViewTracesTableColumnLabels } from './TracesView.utils';\nimport { entries } from 'lodash';\nimport { TracesViewControlsActions } from './TracesViewControlsActions';\n\nconst InputTooltip = ({ baseComponentId }: { baseComponentId: string }) => {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <Popover.Root\n      componentId=\"codegen_mlflow_app_src_experiment-tracking_components_traces_tracesviewcontrols.tsx_28\"\n      modal={false}\n    >\n      <Popover.Trigger asChild>\n        <Button\n          size=\"small\"\n          type=\"link\"\n          icon={\n            <InfoIcon\n              css={{\n                svg: { width: 16, height: 16, color: theme.colors.textSecondary },\n              }}\n            />\n          }\n          componentId={`${baseComponentId}.traces_table.filter_tooltip`}\n        />\n      </Popover.Trigger>\n      <Popover.Content>\n        <Popover.Arrow />\n        <Typography.Paragraph>\n          <FormattedMessage\n            defaultMessage=\"Search traces using a simplified version of the SQL {whereBold} clause.\"\n            description=\"Tooltip string to explain how to search runs from the experiments table\"\n            values={{ whereBold: <b>WHERE</b> }}\n          />\n        </Typography.Paragraph>\n        <FormattedMessage defaultMessage=\"Examples:\" description=\"Text header for examples of mlflow search syntax\" />\n        <ul>\n          <li>\n            <code>tags.some_tag = \"abc\"</code>\n          </li>\n        </ul>\n      </Popover.Content>\n    </Popover.Root>\n  );\n};\n\nexport const TracesViewControls = ({\n  experimentIds,\n  filter,\n  onChangeFilter,\n  hiddenColumns = [],\n  disabledColumns = [],\n  toggleHiddenColumn,\n  rowSelection,\n  setRowSelection,\n  refreshTraces,\n  baseComponentId,\n}: {\n  experimentIds: string[];\n  filter: string;\n  onChangeFilter: (newFilter: string) => void;\n  hiddenColumns?: string[];\n  disabledColumns?: string[];\n  toggleHiddenColumn: (columnId: string) => void;\n  rowSelection: { [id: string]: boolean };\n  setRowSelection: (newSelection: { [id: string]: boolean }) => void;\n  refreshTraces: () => void;\n  baseComponentId: string;\n}) => {\n  const intl = useIntl();\n\n  // Internal filter value state, used to control the input value\n  const [filterValue, setFilterValue] = useState<string | undefined>(filter || undefined);\n\n  const allColumnsList = useMemo(() => {\n    return entries(ExperimentViewTracesTableColumnLabels)\n      .map(([key, label]) => ({\n        key,\n        label: intl.formatMessage(label),\n      }))\n      .filter(({ key }) => !disabledColumns.includes(key));\n  }, [intl, disabledColumns]);\n\n  const displayedFilterValue = filterValue ?? filter;\n\n  const showActionButtons = Object.values(rowSelection).filter(Boolean).length > 0;\n\n  return showActionButtons ? (\n    <TracesViewControlsActions\n      experimentIds={experimentIds}\n      rowSelection={rowSelection}\n      setRowSelection={setRowSelection}\n      refreshTraces={refreshTraces}\n      baseComponentId={baseComponentId}\n    />\n  ) : (\n    <TableFilterLayout css={{ marginBottom: 0 }}>\n      <Input\n        componentId={`${baseComponentId}.traces_table.search_filter`}\n        placeholder={intl.formatMessage({\n          defaultMessage: 'Search traces',\n          description: 'Experiment page > traces view filters > filter string input placeholder',\n        })}\n        value={displayedFilterValue}\n        // Matches runs filter input width\n        css={{ width: 430 }}\n        onChange={(e) => setFilterValue(e.target.value)}\n        prefix={<SearchIcon />}\n        suffix={<InputTooltip baseComponentId={baseComponentId} />}\n        allowClear\n        onClear={() => {\n          onChangeFilter('');\n          setFilterValue(undefined);\n        }}\n        onKeyDown={(e) => {\n          if (e.key === 'Enter') {\n            onChangeFilter(displayedFilterValue);\n            setFilterValue(undefined);\n          }\n        }}\n      />\n      <DialogCombobox\n        componentId={`${baseComponentId}.traces_table.column_selector`}\n        label={\n          <div css={{ display: 'flex', alignItems: 'center', gap: 4 }}>\n            <ColumnsIcon />\n            <FormattedMessage\n              defaultMessage=\"Columns\"\n              description=\"Experiment page > traces table > column selector > title\"\n            />\n          </div>\n        }\n      >\n        <DialogComboboxTrigger\n          aria-label={intl.formatMessage({\n            defaultMessage: 'Columns',\n            description: 'Experiment page > traces table > column selector > title',\n          })}\n        />\n        <DialogComboboxContent>\n          <DialogComboboxOptionList>\n            <DialogComboboxOptionListSearch>\n              {allColumnsList.map(({ key, label }) => (\n                <DialogComboboxOptionListCheckboxItem\n                  key={key}\n                  value={key}\n                  checked={!hiddenColumns.includes(key)}\n                  onChange={() => toggleHiddenColumn(key)}\n                >\n                  {label}\n                </DialogComboboxOptionListCheckboxItem>\n              ))}\n            </DialogComboboxOptionListSearch>\n          </DialogComboboxOptionList>\n        </DialogComboboxContent>\n      </DialogCombobox>\n    </TableFilterLayout>\n  );\n};\n","import { useCallback, useEffect, useMemo, useState } from 'react';\nimport LocalStorageUtils from '../../../../common/utils/LocalStorageUtils';\nimport { isObject, sortBy } from 'lodash';\nimport { ExperimentViewTracesTableColumns } from '../TracesView.utils';\n\ntype LocalStorageStore = ReturnType<typeof LocalStorageUtils.getStoreForComponent>;\n\nexport interface ExperimentViewTracesUIState {\n  hiddenColumns?: string[];\n}\n\nconst defaultExperimentViewTracesUIState: ExperimentViewTracesUIState = {\n  hiddenColumns: [ExperimentViewTracesTableColumns.traceName, ExperimentViewTracesTableColumns.source],\n};\n\nconst loadExperimentViewTracesUIState = (localStore: LocalStorageStore): ExperimentViewTracesUIState => {\n  try {\n    const uiStateRaw = localStore.getItem('uiState');\n    const uiState = JSON.parse(uiStateRaw);\n    if (!isObject(uiState)) {\n      return defaultExperimentViewTracesUIState;\n    }\n    return uiState;\n  } catch (e) {\n    return defaultExperimentViewTracesUIState;\n  }\n};\n\nexport const useExperimentViewTracesUIState = (experimentIds: string[]) => {\n  const localStore = useMemo(() => {\n    const persistenceIdentifier = JSON.stringify(experimentIds.slice().sort());\n    return LocalStorageUtils.getStoreForComponent('ExperimentViewTraces', persistenceIdentifier);\n  }, [experimentIds]);\n\n  const [uiState, setUIState] = useState<ExperimentViewTracesUIState>(() =>\n    loadExperimentViewTracesUIState(localStore),\n  );\n\n  const toggleHiddenColumn = useCallback((columnId: string) => {\n    setUIState((prevUIState) => {\n      const hiddenColumns = prevUIState.hiddenColumns || [];\n      return {\n        hiddenColumns: hiddenColumns.includes(columnId)\n          ? hiddenColumns.filter((id) => id !== columnId)\n          : [...hiddenColumns, columnId],\n      };\n    });\n  }, []);\n\n  useEffect(() => {\n    localStore.setItem('uiState', JSON.stringify(uiState));\n  }, [localStore, uiState]);\n\n  return { uiState, toggleHiddenColumn };\n};\n","import { useCallback } from 'react';\nimport { useSearchParams } from '../../../../common/utils/RoutingUtils';\n\nconst QUERY_PARAM_KEY = 'selectedTraceId';\n\n/**\n * Query param-powered hook that returns the currently selected trace ID and a function to set the selected trace ID.\n * To be used in traces page components.\n */\nexport const useActiveExperimentTrace = () => {\n  // TODO(ML-40722): Create separate UI route for traces page and use route params instead of search params\n  const [searchParams, setSearchParams] = useSearchParams();\n\n  const selectedTraceId = searchParams.get(QUERY_PARAM_KEY) ?? undefined;\n\n  const setSelectedTraceId = useCallback(\n    (selectedTraceId: string | undefined) => {\n      setSearchParams((params) => {\n        if (selectedTraceId === undefined) {\n          params.delete(QUERY_PARAM_KEY);\n          return params;\n        }\n        params.set(QUERY_PARAM_KEY, selectedTraceId);\n        return params;\n      });\n    },\n    [setSearchParams],\n  );\n\n  return [selectedTraceId, setSelectedTraceId] as const;\n};\n","import { useDesignSystemTheme } from '@databricks/design-system';\n\nimport { useExperimentTraces } from './hooks/useExperimentTraces';\nimport { TracesViewTable } from './TracesViewTable';\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { TraceDataDrawer } from './TraceDataDrawer';\nimport { useEditExperimentTraceTags } from './hooks/useEditExperimentTraceTags';\nimport { TracesViewControls } from './TracesViewControls';\nimport { SortingState } from '@tanstack/react-table';\nimport { compact, isFunction, isNil, uniq } from 'lodash';\nimport { useExperimentViewTracesUIState } from './hooks/useExperimentViewTracesUIState';\nimport { ExperimentViewTracesTableColumns, getTraceInfoTotalTokens } from './TracesView.utils';\nimport { useActiveExperimentTrace } from './hooks/useActiveExperimentTrace';\nimport { ModelTraceInfo } from '@databricks/web-shared/model-trace-explorer';\n\nexport const TRACE_AUTO_REFRESH_INTERVAL = 30000;\n\nconst defaultSorting: SortingState = [{ id: ExperimentViewTracesTableColumns.timestampMs, desc: true }];\n\nexport const TracesView = ({\n  experimentIds,\n  runUuid,\n  loggedModelId,\n  disabledColumns,\n}: {\n  experimentIds: string[];\n  /**\n   * If `runUuid` is provided, the traces will be filtered to only show traces from that run.\n   */\n  runUuid?: string;\n  /**\n   * If `loggedModelId` is provided, the traces will be filtered to only show traces from that logged model.\n   */\n  loggedModelId?: string;\n  /**\n   * Columns that should be disabled in the table.\n   * Disabled columns are hidden and are not available to be toggled at all.\n   */\n  disabledColumns?: ExperimentViewTracesTableColumns[];\n}) => {\n  const timeoutRef = useRef<number | undefined>(undefined);\n  const [filter, setFilter] = useState<string>('');\n  const [sorting, setSorting] = useState<SortingState>(defaultSorting);\n  const [rowSelection, setRowSelection] = useState<{ [id: string]: boolean }>({});\n\n  const [selectedTraceId, setSelectedTraceId] = useActiveExperimentTrace();\n\n  const { traces, loading, error, hasNextPage, hasPreviousPage, fetchNextPage, fetchPrevPage, refreshCurrentPage } =\n    useExperimentTraces({\n      experimentIds,\n      sorting,\n      filter,\n      runUuid,\n      loggedModelId,\n    });\n\n  const onTraceClicked = useCallback(\n    ({ request_id }: ModelTraceInfo) => setSelectedTraceId(request_id),\n    [setSelectedTraceId],\n  );\n\n  // clear row selections when the page changes.\n  // the backend specifies a max of 100 deletions,\n  // plus it's confusing to have selections on a\n  // page that the user can't see\n  const onNextPage = useCallback(() => {\n    fetchNextPage();\n    setRowSelection({});\n  }, [fetchNextPage]);\n\n  const onPreviousPage = useCallback(() => {\n    fetchPrevPage();\n    setRowSelection({});\n  }, [fetchPrevPage]);\n\n  const baseComponentId = runUuid ? `mlflow.run.traces` : `mlflow.experiment_page.traces`;\n\n  // auto-refresh traces\n  useEffect(() => {\n    // if the hook reruns, clear the current timeout, since we'll be scheduling another\n    window.clearTimeout(timeoutRef.current);\n\n    const scheduleRefresh = async () => {\n      // only refresh if the user is on the first page\n      // otherwise it might mess with browsing old traces\n      if (loading || hasPreviousPage) return;\n\n      await refreshCurrentPage(true);\n\n      window.clearTimeout(timeoutRef.current);\n      timeoutRef.current = window.setTimeout(scheduleRefresh, TRACE_AUTO_REFRESH_INTERVAL);\n    };\n\n    timeoutRef.current = window.setTimeout(scheduleRefresh, TRACE_AUTO_REFRESH_INTERVAL);\n    return () => window.clearTimeout(timeoutRef.current);\n  }, [refreshCurrentPage, loading, hasPreviousPage]);\n\n  const { theme } = useDesignSystemTheme();\n\n  // Try to find the trace info for the currently selected trace id\n  const selectedTraceInfo = useMemo(() => {\n    if (!selectedTraceId) return undefined;\n    return traces.find((trace) => trace.request_id === selectedTraceId);\n  }, [selectedTraceId, traces]);\n\n  const {\n    // hiddenColumns is a list of columns that are hidden by the user.\n    uiState,\n    toggleHiddenColumn,\n  } = useExperimentViewTracesUIState(experimentIds);\n\n  const existingTagKeys = useMemo(\n    () => uniq(compact(traces.flatMap((trace) => trace.tags?.map((tag) => tag.key)))),\n    [traces],\n  );\n\n  const { showEditTagsModalForTrace, EditTagsModal } = useEditExperimentTraceTags({\n    onSuccess: () => refreshCurrentPage(true),\n    existingTagKeys,\n  });\n\n  const usingFilters = filter !== '';\n\n  const anyTraceContainsTokenCount = traces.some((trace) => !isNil(getTraceInfoTotalTokens(trace)));\n\n  // Automatically disabled columns: hide the token count column if there's no trace that contains token count information.\n  const autoDisabledColumns = useMemo(\n    () => (!anyTraceContainsTokenCount ? [ExperimentViewTracesTableColumns.totalTokens] : []),\n    [anyTraceContainsTokenCount],\n  );\n\n  // Combine columns that are disabled by parent component and columns that are disabled automatically.\n  const allDisabledColumns = useMemo(\n    () => [...(disabledColumns ?? []), ...autoDisabledColumns],\n    [disabledColumns, autoDisabledColumns],\n  );\n\n  const allHiddenColumns = useMemo(\n    () => [...(uiState.hiddenColumns ?? []), ...allDisabledColumns],\n    [uiState, allDisabledColumns],\n  );\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        flexDirection: 'column',\n        gap: theme.spacing.sm,\n        height: '100%',\n        overflow: 'hidden',\n      }}\n    >\n      <TracesViewControls\n        experimentIds={experimentIds}\n        filter={filter}\n        onChangeFilter={setFilter}\n        hiddenColumns={uiState.hiddenColumns ?? []}\n        disabledColumns={allDisabledColumns}\n        toggleHiddenColumn={toggleHiddenColumn}\n        rowSelection={rowSelection}\n        setRowSelection={setRowSelection}\n        refreshTraces={refreshCurrentPage}\n        baseComponentId={baseComponentId}\n      />\n      <TracesViewTable\n        experimentIds={experimentIds}\n        runUuid={runUuid}\n        traces={traces}\n        loading={loading}\n        error={error}\n        onTraceClicked={onTraceClicked}\n        onTraceTagsEdit={showEditTagsModalForTrace}\n        hasNextPage={hasNextPage}\n        hasPreviousPage={hasPreviousPage}\n        onPreviousPage={onPreviousPage}\n        onNextPage={onNextPage}\n        onTagsUpdated={refreshCurrentPage}\n        usingFilters={usingFilters}\n        onResetFilters={() => setFilter('')}\n        hiddenColumns={allHiddenColumns}\n        disableTokenColumn={!anyTraceContainsTokenCount}\n        setSorting={(sortingSetter) => {\n          // If header is clicked enough times, tanstack table switches to \"no sort\" mode.\n          // In that case, we should just reverse the direction of the current sort instead.\n          if (isFunction(sortingSetter)) {\n            return setSorting((currentState) => {\n              const newState = sortingSetter(currentState);\n              const currentSortBy = currentState[0];\n              if ((!newState || newState.length === 0) && currentSortBy) {\n                return [{ id: currentSortBy.id, desc: !currentSortBy.desc }];\n              }\n              return newState;\n            });\n          }\n        }}\n        sorting={sorting}\n        rowSelection={rowSelection}\n        setRowSelection={setRowSelection}\n        baseComponentId={baseComponentId}\n      />\n      {selectedTraceId && (\n        <TraceDataDrawer\n          traceInfo={selectedTraceInfo}\n          loadingTraceInfo={loading}\n          requestId={selectedTraceId}\n          onClose={() => setSelectedTraceId(undefined)}\n        />\n      )}\n      {EditTagsModal}\n    </div>\n  );\n};\n","import { type ModelTraceInfo } from '@databricks/web-shared/model-trace-explorer';\nimport { type MessageDescriptor, defineMessage } from 'react-intl';\nimport { isNil } from 'lodash';\n\nconst TRACE_METADATA_FIELD_RUN_ID = 'mlflow.sourceRun';\nconst TRACE_METADATA_FIELD_TOTAL_TOKENS = 'total_tokens';\nconst TRACE_METADATA_FIELD_INPUTS = 'mlflow.traceInputs';\nconst TRACE_METADATA_FIELD_OUTPUTS = 'mlflow.traceOutputs';\nexport const TRACE_TAG_NAME_TRACE_NAME = 'mlflow.traceName';\n\n// Truncation limit for tracing metadata, taken from:\n// https://github.com/mlflow/mlflow/blob/2b457f2b46fc135a3fba77aefafe2319a899fc08/mlflow/tracing/constant.py#L23\nconst MAX_CHARS_IN_TRACE_INFO_METADATA_AND_TAGS = 250;\n\nconst getTraceMetadataField = (traceInfo: ModelTraceInfo, field: string) => {\n  return traceInfo.request_metadata?.find(({ key }) => key === field)?.value;\n};\n\nexport const isTraceMetadataPossiblyTruncated = (traceMetadata: string) => {\n  return traceMetadata.length >= MAX_CHARS_IN_TRACE_INFO_METADATA_AND_TAGS;\n};\n\nexport const getTraceInfoRunId = (traceInfo: ModelTraceInfo) =>\n  getTraceMetadataField(traceInfo, TRACE_METADATA_FIELD_RUN_ID);\n\nexport const getTraceInfoTotalTokens = (traceInfo: ModelTraceInfo) =>\n  getTraceMetadataField(traceInfo, TRACE_METADATA_FIELD_TOTAL_TOKENS);\n\nexport const getTraceInfoInputs = (traceInfo: ModelTraceInfo) => {\n  const inputs = getTraceMetadataField(traceInfo, TRACE_METADATA_FIELD_INPUTS);\n  if (isNil(inputs)) {\n    return undefined;\n  }\n  try {\n    return JSON.stringify(JSON.parse(inputs)); // unescape non-ascii characters\n  } catch (e) {\n    return inputs;\n  }\n};\n\nexport const getTraceInfoOutputs = (traceInfo: ModelTraceInfo) => {\n  const outputs = getTraceMetadataField(traceInfo, TRACE_METADATA_FIELD_OUTPUTS);\n  if (isNil(outputs)) {\n    return undefined;\n  }\n  try {\n    return JSON.stringify(JSON.parse(outputs)); // unescape non-ascii characters\n  } catch (e) {\n    return outputs;\n  }\n};\n\nexport const getTraceTagValue = (traceInfo: ModelTraceInfo, tagName: string) => {\n  return traceInfo.tags?.find(({ key }) => key === tagName)?.value;\n};\n\nexport const getTraceDisplayName = (traceInfo: ModelTraceInfo) => {\n  return getTraceTagValue(traceInfo, TRACE_TAG_NAME_TRACE_NAME) || traceInfo.request_id;\n};\n\nexport const EXPERIMENT_TRACES_SORTABLE_COLUMNS = ['timestamp_ms'];\n\n// defining a separate const for this column as\n// we don't users to be able to control its visibility\nexport const TRACE_TABLE_CHECKBOX_COLUMN_ID = 'select';\n\nexport enum ExperimentViewTracesTableColumns {\n  requestId = 'request_id',\n  traceName = 'traceName',\n  timestampMs = 'timestamp_ms',\n  inputs = 'inputs',\n  outputs = 'outputs',\n  runName = 'runName',\n  totalTokens = 'total_tokens',\n  source = 'source',\n  latency = 'latency',\n  tags = 'tags',\n  status = 'status',\n}\n\nexport const ExperimentViewTracesTableColumnLabels: Record<ExperimentViewTracesTableColumns, MessageDescriptor> = {\n  [ExperimentViewTracesTableColumns.requestId]: defineMessage({\n    defaultMessage: 'Request ID',\n    description: 'Experiment page > traces table > request id column header',\n  }),\n  [ExperimentViewTracesTableColumns.traceName]: defineMessage({\n    defaultMessage: 'Trace name',\n    description: 'Experiment page > traces table > trace name column header',\n  }),\n  [ExperimentViewTracesTableColumns.timestampMs]: defineMessage({\n    defaultMessage: 'Time created',\n    description: 'Experiment page > traces table > time created column header',\n  }),\n  [ExperimentViewTracesTableColumns.status]: defineMessage({\n    defaultMessage: 'Status',\n    description: 'Experiment page > traces table > status column header',\n  }),\n  [ExperimentViewTracesTableColumns.inputs]: defineMessage({\n    defaultMessage: 'Request',\n    description: 'Experiment page > traces table > input column header',\n  }),\n  [ExperimentViewTracesTableColumns.outputs]: defineMessage({\n    defaultMessage: 'Response',\n    description: 'Experiment page > traces table > output column header',\n  }),\n  [ExperimentViewTracesTableColumns.runName]: defineMessage({\n    defaultMessage: 'Run name',\n    description: 'Experiment page > traces table > run name column header',\n  }),\n  [ExperimentViewTracesTableColumns.totalTokens]: defineMessage({\n    defaultMessage: 'Tokens',\n    description: 'Experiment page > traces table > tokens column header',\n  }),\n  [ExperimentViewTracesTableColumns.source]: defineMessage({\n    defaultMessage: 'Source',\n    description: 'Experiment page > traces table > source column header',\n  }),\n  [ExperimentViewTracesTableColumns.latency]: defineMessage({\n    defaultMessage: 'Execution time',\n    description: 'Experiment page > traces table > latency column header',\n  }),\n  [ExperimentViewTracesTableColumns.tags]: defineMessage({\n    defaultMessage: 'Tags',\n    description: 'Experiment page > traces table > tags column header',\n  }),\n};\n\nexport const ExperimentViewTracesStatusLabels = {\n  UNSET: null,\n  IN_PROGRESS: defineMessage({\n    defaultMessage: 'In progress',\n    description: 'Experiment page > traces table > status label > in progress',\n  }),\n  OK: defineMessage({\n    defaultMessage: 'OK',\n    description: 'Experiment page > traces table > status label > ok',\n  }),\n  ERROR: defineMessage({\n    defaultMessage: 'Error',\n    description: 'Experiment page > traces table > status label > error',\n  }),\n};\n","import { DatasetSourceTypes, type DatasetSummary, type RunDatasetWithTags } from '../types';\n\nexport const datasetSummariesEqual = (summary1: DatasetSummary, summary2: DatasetSummary) =>\n  summary1.digest === summary2.digest && summary1.name === summary2.name && summary1.context === summary2.context;\n\nexport const getDatasetSourceUrl = (datasetWithTags: RunDatasetWithTags) => {\n  const { dataset } = datasetWithTags;\n  const sourceType = dataset.sourceType;\n  try {\n    if (sourceType === DatasetSourceTypes.HTTP) {\n      const { url } = JSON.parse(dataset.source);\n      return url;\n    }\n    if (sourceType === DatasetSourceTypes.S3) {\n      const { uri } = JSON.parse(dataset.source);\n      return uri;\n    }\n    if (sourceType === DatasetSourceTypes.HUGGING_FACE) {\n      const { path } = JSON.parse(dataset.source);\n      return `https://huggingface.co/datasets/${path}`;\n    }\n  } catch {\n    return null;\n  }\n  return null;\n};\n","import {\n  ArrowLeftIcon,\n  ArrowRightIcon,\n  CloseIcon,\n  DesignSystemContext,\n  RedoIcon,\n  UndoIcon,\n  ZoomInIcon,\n  ZoomOutIcon,\n} from '@databricks/design-system';\nimport { useContext } from 'react';\nimport RcImage from 'rc-image';\nimport './Image.css';\n\nconst icons = {\n  rotateLeft: <UndoIcon />,\n  rotateRight: <RedoIcon />,\n  zoomIn: <ZoomInIcon />,\n  zoomOut: <ZoomOutIcon />,\n  close: <CloseIcon />,\n  left: <ArrowLeftIcon />,\n  right: <ArrowRightIcon />,\n};\n\nexport const ImagePreviewGroup = ({\n  children,\n  visible,\n  onVisibleChange,\n}: {\n  children: React.ReactNode;\n  visible: boolean;\n  onVisibleChange: (v: boolean) => void;\n}) => {\n  const { getPopupContainer } = useContext(DesignSystemContext);\n\n  return (\n    <RcImage.PreviewGroup\n      icons={icons}\n      preview={{\n        visible: visible,\n        getContainer: getPopupContainer,\n        onVisibleChange: (v) => onVisibleChange(v),\n      }}\n    >\n      {children}\n    </RcImage.PreviewGroup>\n  );\n};\n\nexport { RcImage as Image };\n","import React from 'react';\nimport { useSyncExternalStore } from 'use-sync-external-store/shim';\n\nfunction useMatchesMediaQuery(queryList: MediaQueryList) {\n  return useSyncExternalStore(\n    React.useCallback(\n      (callback) => {\n        queryList.addEventListener('change', callback);\n        return () => {\n          queryList.removeEventListener('change', callback);\n        };\n      },\n      [queryList],\n    ),\n    () => queryList.matches,\n  );\n}\n\n/**\n * React hook that listens for changes to a [media query][media-query]. Uses\n * [`window.matchMedia()`][match-media] under-the-hood.\n *\n * [media-query]: https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_media_queries/Using_media_queries\n * [match-media]: https://developer.mozilla.org/en-US/docs/Web/API/Window/matchMedia\n *\n * @usage\n *\n * ```tsx\n * function FancyButton() {\n *   const prefersReducedMotion = useMediaQuery('(prefers-reduced-motion)');\n *   return prefersReducedMotion ? <Button /> : <DancingButton />;\n * }\n * ```\n *\n * > **Note**\n * > The vast majority of use-cases can (and should) use vanilla CSS media\n * > queries instead of this hook  which will cause a re-render when the match\n * > state changes. Usage of this hook should be reserved for use-cases where\n * > CSS cannot be used instead.\n * >\n * > ```tsx\n * > <Button css={{ 'not (prefers-reduced-motion)': { animation:  } }} />\n * > ```\n */\nexport function useMediaQuery(query: string) {\n  // Note: a new MediaQueryList is created with every _usage_ of this hook.\n  // It's probably cheap to create many instances of MediaQueryList, and\n  // garbage collection will still clean up as expected, but consider using a\n  // [weak cache](https://github.com/tc39/proposal-weakrefs#weak-caches) to\n  // reuse MediaQueryLists where possible if performance is impacted.\n  const queryList = React.useMemo(() => window.matchMedia(query), [query]);\n  return useMatchesMediaQuery(queryList);\n}\n","/**\n * Adapted from `duotone-dark`\n * Ref: https://github.com/react-syntax-highlighter/react-syntax-highlighter/blob/b2457268891948f7005ccf539a70c000f0695bde/src/styles/prism/duotone-dark.js\n */\n\nconst databricksDuotoneDarkTheme = {\n  'code[class*=\"language-\"]': {\n    fontFamily:\n      'Consolas, Menlo, Monaco, \"Andale Mono WT\", \"Andale Mono\", \"Lucida Console\", \"Lucida Sans Typewriter\", \"DejaVu Sans Mono\", \"Bitstream Vera Sans Mono\", \"Liberation Mono\", \"Nimbus Mono L\", \"Courier New\", Courier, monospace',\n    fontSize: '14px',\n    lineHeight: '1.375',\n    direction: 'ltr',\n    textAlign: 'left',\n    whiteSpace: 'pre',\n    wordSpacing: 'normal',\n    wordBreak: 'normal',\n    MozTabSize: '4',\n    OTabSize: '4',\n    tabSize: '4',\n    WebkitHyphens: 'none',\n    MozHyphens: 'none',\n    msHyphens: 'none',\n    hyphens: 'none',\n    background: '#2a2734',\n    color: '#5DFAFC', // D\n  },\n  'pre[class*=\"language-\"]': {\n    fontFamily:\n      'Consolas, Menlo, Monaco, \"Andale Mono WT\", \"Andale Mono\", \"Lucida Console\", \"Lucida Sans Typewriter\", \"DejaVu Sans Mono\", \"Bitstream Vera Sans Mono\", \"Liberation Mono\", \"Nimbus Mono L\", \"Courier New\", Courier, monospace',\n    fontSize: '14px',\n    lineHeight: '1.375',\n    direction: 'ltr',\n    textAlign: 'left',\n    whiteSpace: 'pre',\n    wordSpacing: 'normal',\n    wordBreak: 'normal',\n    MozTabSize: '4',\n    OTabSize: '4',\n    tabSize: '4',\n    WebkitHyphens: 'none',\n    MozHyphens: 'none',\n    msHyphens: 'none',\n    hyphens: 'none',\n    background: '#2a2734',\n    color: '#5DFAFC', // D\n    padding: '1em',\n    margin: '.5em 0',\n    overflow: 'auto',\n  },\n  'pre > code[class*=\"language-\"]': {\n    fontSize: '1em',\n  },\n  'pre[class*=\"language-\"]::-moz-selection': {\n    textShadow: 'none',\n    background: '#6a51e6',\n  },\n  'pre[class*=\"language-\"] ::-moz-selection': {\n    textShadow: 'none',\n    background: '#6a51e6',\n  },\n  'code[class*=\"language-\"]::-moz-selection': {\n    textShadow: 'none',\n    background: '#6a51e6',\n  },\n  'code[class*=\"language-\"] ::-moz-selection': {\n    textShadow: 'none',\n    background: '#6a51e6',\n  },\n  'pre[class*=\"language-\"]::selection': {\n    textShadow: 'none',\n    background: '#6a51e6',\n  },\n  'pre[class*=\"language-\"] ::selection': {\n    textShadow: 'none',\n    background: '#6a51e6',\n  },\n  'code[class*=\"language-\"]::selection': {\n    textShadow: 'none',\n    background: '#6a51e6',\n  },\n  'code[class*=\"language-\"] ::selection': {\n    textShadow: 'none',\n    background: '#6a51e6',\n  },\n  ':not(pre) > code[class*=\"language-\"]': {\n    padding: '.1em',\n    borderRadius: '.3em',\n  },\n  comment: {\n    color: '#6c6783',\n  },\n  prolog: {\n    color: '#6c6783',\n  },\n  doctype: {\n    color: '#6c6783',\n  },\n  cdata: {\n    color: '#6c6783',\n  },\n  punctuation: {\n    color: '#6c6783',\n  },\n  namespace: {\n    Opacity: '.7',\n  },\n  tag: {\n    color: '#3AACE2', // D\n  },\n  operator: {\n    color: '#3AACE2', // D\n  },\n  number: {\n    color: '#3AACE2', // D\n  },\n  property: {\n    color: '#5DFAFC', // D\n  },\n  function: {\n    color: '#5DFAFC', // D\n  },\n  'tag-id': {\n    color: '#eeebff',\n  },\n  selector: {\n    color: '#eeebff',\n  },\n  'atrule-id': {\n    color: '#eeebff',\n  },\n  'code.language-javascript': {\n    color: '#c4b9fe',\n  },\n  'attr-name': {\n    color: '#c4b9fe',\n  },\n  'code.language-css': {\n    color: '#ffffff', // D\n  },\n  'code.language-scss': {\n    color: '#ffffff', // D\n  },\n  boolean: {\n    color: '#ffffff', // D\n  },\n  string: {\n    color: '#ffffff', // D\n  },\n  entity: {\n    color: '#ffffff', // D\n    cursor: 'help',\n  },\n  url: {\n    color: '#ffffff', // D\n  },\n  '.language-css .token.string': {\n    color: '#ffffff', // D\n  },\n  '.language-scss .token.string': {\n    color: '#ffffff', // D\n  },\n  '.style .token.string': {\n    color: '#ffffff', // D\n  },\n  'attr-value': {\n    color: '#ffffff', // D\n  },\n  keyword: {\n    color: '#ffffff', // D\n  },\n  control: {\n    color: '#ffffff', // D\n  },\n  directive: {\n    color: '#ffffff', // D\n  },\n  unit: {\n    color: '#ffffff', // D\n  },\n  statement: {\n    color: '#ffffff', // D\n  },\n  regex: {\n    color: '#ffffff', // D\n  },\n  atrule: {\n    color: '#ffffff', // D\n  },\n  placeholder: {\n    color: '#ffffff', // D\n  },\n  variable: {\n    color: '#ffffff', // D\n  },\n  deleted: {\n    textDecoration: 'line-through',\n  },\n  inserted: {\n    borderBottom: '1px dotted #eeebff',\n    textDecoration: 'none',\n  },\n  italic: {\n    fontStyle: 'italic',\n  },\n  important: {\n    fontWeight: 'bold',\n    color: '#c4b9fe',\n  },\n  bold: {\n    fontWeight: 'bold',\n  },\n  'pre > code.highlight': {\n    Outline: '.4em solid #8a75f5',\n    OutlineOffset: '.4em',\n  },\n  '.line-numbers.line-numbers .line-numbers-rows': {\n    borderRightColor: '#2c2937',\n  },\n  '.line-numbers .line-numbers-rows > span:before': {\n    color: '#3c3949',\n  },\n  '.line-highlight.line-highlight': {\n    background: 'linear-gradient(to right, rgba(224, 145, 66, 0.2) 70%, rgba(224, 145, 66, 0))',\n  },\n};\n\nexport default databricksDuotoneDarkTheme;\n","/**\n * Adapted from `material-light`\n * Ref: https://github.com/react-syntax-highlighter/react-syntax-highlighter/blob/b2457268891948f7005ccf539a70c000f0695bde/src/styles/prism/material-light.js#L1\n *\n * This theme overwrites colors to be similiar to the `@databricks/editor` theme.\n */\n\nconst databricksLightTheme = {\n  'code[class*=\"language-\"]': {\n    textAlign: 'left',\n    whiteSpace: 'pre',\n    wordSpacing: 'normal',\n    wordBreak: 'normal',\n    wordWrap: 'normal',\n    color: 'rgb(77, 77, 76)', // D\n    background: '#fafafa',\n    fontFamily: 'Monaco, Menlo, Ubuntu Mono, Consolas, source-code-pro, monospace',\n    fontSize: '12px', // D\n    lineHeight: '1.5em',\n    MozTabSize: '4',\n    OTabSize: '4',\n    tabSize: '4',\n    WebkitHyphens: 'none',\n    MozHyphens: 'none',\n    msHyphens: 'none',\n    hyphens: 'none',\n  },\n  'pre[class*=\"language-\"]': {\n    textAlign: 'left',\n    whiteSpace: 'pre',\n    wordSpacing: 'normal',\n    wordBreak: 'normal',\n    wordWrap: 'normal',\n    color: 'rgb(77, 77, 76)', // D\n    background: '#fafafa',\n    fontFamily: 'Monaco, Menlo, Ubuntu Mono, Consolas, source-code-pro, monospace',\n    fontSize: '12px', // D\n    lineHeight: '1.5em',\n    MozTabSize: '4',\n    OTabSize: '4',\n    tabSize: '4',\n    WebkitHyphens: 'none',\n    MozHyphens: 'none',\n    msHyphens: 'none',\n    hyphens: 'none',\n    overflow: 'auto',\n    position: 'relative',\n    margin: '0.5em 0',\n    padding: '1.25em 1em',\n  },\n  'code[class*=\"language-\"]::-moz-selection': {\n    background: '#cceae7',\n    color: '#263238',\n  },\n  'pre[class*=\"language-\"]::-moz-selection': {\n    background: '#cceae7',\n    color: '#263238',\n  },\n  'code[class*=\"language-\"] ::-moz-selection': {\n    background: '#cceae7',\n    color: '#263238',\n  },\n  'pre[class*=\"language-\"] ::-moz-selection': {\n    background: '#cceae7',\n    color: '#263238',\n  },\n  'code[class*=\"language-\"]::selection': {\n    background: '#cceae7',\n    color: '#263238',\n  },\n  'pre[class*=\"language-\"]::selection': {\n    background: '#cceae7',\n    color: '#263238',\n  },\n  'code[class*=\"language-\"] ::selection': {\n    background: '#cceae7',\n    color: '#263238',\n  },\n  'pre[class*=\"language-\"] ::selection': {\n    background: '#cceae7',\n    color: '#263238',\n  },\n  ':not(pre) > code[class*=\"language-\"]': {\n    whiteSpace: 'normal',\n    borderRadius: '0.2em',\n    padding: '0.1em',\n  },\n  '.language-css > code': {\n    color: '#f5871f', // D\n  },\n  '.language-sass > code': {\n    color: '#f5871f', // D\n  },\n  '.language-scss > code': {\n    color: '#f5871f', // D\n  },\n  '[class*=\"language-\"] .namespace': {\n    Opacity: '0.7',\n  },\n  atrule: {\n    color: '#7c4dff',\n  },\n  'attr-name': {\n    color: '#39adb5',\n  },\n  'attr-value': {\n    color: '#f6a434',\n  },\n  attribute: {\n    color: '#f6a434',\n  },\n  boolean: {\n    color: '#7c4dff', // D\n  },\n  builtin: {\n    color: '#39adb5',\n  },\n  cdata: {\n    color: '#39adb5',\n  },\n  char: {\n    color: '#39adb5',\n  },\n  class: {\n    color: '#39adb5',\n  },\n  'class-name': {\n    color: '#6182b8',\n  },\n  comment: {\n    color: '#8e908c', // D\n  },\n  constant: {\n    color: '#7c4dff', // D\n  },\n  deleted: {\n    color: '#e53935',\n  },\n  doctype: {\n    color: '#aabfc9',\n  },\n  entity: {\n    color: '#e53935',\n  },\n  function: {\n    color: '#4271ae', // D\n  },\n  hexcode: {\n    color: '#f5871f', // D\n  },\n  id: {\n    color: '#7c4dff',\n    fontWeight: 'bold',\n  },\n  important: {\n    color: '#7c4dff',\n    fontWeight: 'bold',\n  },\n  inserted: {\n    color: '#39adb5',\n  },\n  keyword: {\n    color: '#8959a8', // D\n  },\n  number: {\n    color: '#f5871f', // D\n  },\n  operator: {\n    color: '#3e999f', // D\n  },\n  prolog: {\n    color: '#aabfc9',\n  },\n  property: {\n    color: '#39adb5',\n  },\n  'pseudo-class': {\n    color: '#f6a434',\n  },\n  'pseudo-element': {\n    color: '#f6a434',\n  },\n  punctuation: {\n    color: 'rgb(77, 77, 76)', // D\n  },\n  regex: {\n    color: '#6182b8',\n  },\n  selector: {\n    color: '#e53935',\n  },\n  string: {\n    color: '#3ba85f', // D\n  },\n  symbol: {\n    color: '#7c4dff',\n  },\n  tag: {\n    color: '#e53935',\n  },\n  unit: {\n    color: '#f5871f', // D\n  },\n  url: {\n    color: '#e53935',\n  },\n  variable: {\n    color: '#c72d4c', // D\n  },\n};\n\nexport default databricksLightTheme;\n","import { PrismLight as SyntaxHighlighter } from 'react-syntax-highlighter';\nimport python from 'react-syntax-highlighter/dist/cjs/languages/prism/python';\nimport json from 'react-syntax-highlighter/dist/cjs/languages/prism/json';\n\nSyntaxHighlighter.registerLanguage('python', python);\nSyntaxHighlighter.registerLanguage('json', json);\n\nimport duotoneDarkStyle from './theme/databricks-duotone-dark';\nimport lightStyle from './theme/databricks-light';\nimport { CSSProperties, ReactNode } from 'react';\nimport { pick } from 'lodash';\n\nexport type CodeSnippetTheme = 'duotoneDark' | 'light';\n\nexport const buttonBackgroundColorDark = 'rgba(140, 203, 255, 0)';\nexport const buttonColorDark = 'rgba(255, 255, 255, 0.84)';\nexport const buttonHoverColorDark = '#8ccbffcc';\nexport const buttonHoverBackgroundColorDark = 'rgba(140, 203, 255, 0.08)';\nexport const duboisAlertBackgroundColor = '#fff0f0';\nexport const snippetPadding = '24px';\n\nconst themesStyles: Record<CodeSnippetTheme, any> = {\n  light: lightStyle,\n  duotoneDark: duotoneDarkStyle,\n};\n\nexport type CodeSnippetLanguage = 'python' | 'json';\n\nexport interface CodeSnippetProps {\n  /**\n   * The code string\n   */\n  children: string;\n  /**\n   * The actions that are displayed on the right top corner of the component\n   *  see `./actions` for built-in actions\n   */\n  actions?: NonNullable<ReactNode> | NonNullable<ReactNode>[];\n  /**\n   * The theme, default theme is `light`\n   */\n  theme?: CodeSnippetTheme;\n  /**\n   * Language of the code (`children`)\n   */\n  language: CodeSnippetLanguage;\n  /**\n   * Custom styles (passed to the internal `<pre>`)\n   */\n  style?: CSSProperties;\n  /**\n   * Whether to show line numbers on the left or not\n   */\n  showLineNumbers?: boolean;\n  /**\n   * Custom styles for line numbers\n   */\n  lineNumberStyle?: CSSProperties;\n  /**\n   * Whether or not to wrap long lines\n   */\n  wrapLongLines?: boolean;\n}\n\n/**\n * `CodeSnippet` is used for highlighting code, use this instead of\n */\nexport function CodeSnippet({\n  theme = 'light',\n  language,\n  actions,\n  style,\n  children,\n  showLineNumbers,\n  lineNumberStyle,\n  wrapLongLines,\n}: CodeSnippetProps) {\n  const customStyle = {\n    border: 'none',\n    borderRadius: 0,\n    margin: 0,\n    padding: snippetPadding,\n    ...style,\n  };\n\n  return (\n    <SyntaxHighlighter\n      showLineNumbers={showLineNumbers}\n      lineNumberStyle={lineNumberStyle}\n      language={language}\n      style={themesStyles[theme]}\n      customStyle={customStyle}\n      codeTagProps={{\n        style: pick(style, 'backgroundColor'),\n      }}\n      wrapLongLines={wrapLongLines}\n    >\n      {children}\n    </SyntaxHighlighter>\n  );\n}\n"],"names":["_path","_rect","_rect2","_rect3","_rect4","_extends","Object","assign","bind","n","e","arguments","length","t","r","hasOwnProperty","call","apply","SvgChartBar","_ref","svgRef","title","titleId","props","width","height","viewBox","fill","xmlns","ref","id","d","stroke","strokeLinecap","x","y","ForwardRef","_path2","_path3","SvgChartContour","_rect5","_rect6","_rect7","_rect8","_rect9","_rect10","_rect11","_rect12","_rect13","_rect14","_rect15","_rect16","_rect17","_rect18","SvgChartDifference","_line","_line2","_line3","SvgChartImage","x1","y1","x2","y2","SvgChartLine","strokeWidth","strokeLinejoin","_path4","_path5","SvgChartParallel","_circle","_ellipse","_circle2","_circle3","_ellipse2","_ellipse3","SvgChartScatter","cx","cy","rx","ry","fillOpacity","_g","_defs","SvgRegisteredModelGreyOk","clipPath","style","maskType","maskUnits","mask","fillRule","clipRule","JsonPreview","json","wrapperStyle","overlayStyle","codeSnippetStyle","formattedJson","isJsonContent","useFormattedJson","_jsx","position","maxHeight","overflow","children","_jsxs","_Fragment","CodeSnippet","language","padding","overflowX","css","_css","bottom","right","left","background","React","parsed","JSON","parse","isJson","isObject","Date","stringify","_ref3","name","styles","FormattedJsonDisplay","_ref2","wrapLongLines","ToggleIconButton","pressed","onClick","icon","onBlur","onFocus","onMouseEnter","onMouseLeave","componentId","analyticsEvents","type","remainingProps","theme","useDesignSystemTheme","eventContext","useDesignSystemEventComponentCallbacks","componentType","DesignSystemEventProviderComponentTypes","Button","DesignSystemEventProviderAnalyticsEventTypes","OnClick","event","cursor","general","heightSm","borderRadius","legacyBorders","borderRadiusMd","lineHeight","typography","lineHeightBase","border","display","alignItems","justifyContent","colors","actionDefaultBackgroundPress","color","actionDefaultTextPress","textSecondary","actionDefaultBackgroundHover","actionDefaultTextHover","useDragAndDropElement","dragGroupKey","dragKey","onDrop","disabled","dropListener","useRef","current","isOver","draggedItem","dropTargetRef","useDrop","canDrop","accept","drop","monitor","key","sourceKey","didDrop","collect","shallow","getItem","isDragging","dragHandleRef","dragPreviewRef","useDrag","canDrag","item","groupKey","isDraggingOtherGroup","Boolean","_ref4","DragAndDropProvider","rootElementRef","manager","setManager","useState","useLayoutEffect","rootElement","dragDropManager","createDragDropManager","HTML5Backend","undefined","getBackend","teardown","DndProvider","useIsTabActive","isTabActive","setIsTabActive","document","visibilityState","useEffect","addEventListener","DEFAULT_MIN_COLUMNS","DEFAULT_MAX_COLUMNS","DEFAULT_MIN_COLUMN_WIDTH","DEFAULT_GAP","getGridColumnSetup","minColumns","maxColumns","minColumnWidth","gap","additionalBreakpoints","gridTemplateColumns","reduce","acc","breakpointWidth","minColumnWidthForBreakpoint","LocalStorageUtils","getStoreForComponent","componentName","LocalStorageStore","join","getSessionScopedStoreForComponent","version","constructor","scope","storageObj","this","window","localStorage","sessionStorage","loadComponentState","storedVal","reactComponentStateKey","saveComponentState","stateRecord","targetValue","toJSON","setItem","withScopePrefix","value","useElementHeight","resizeCallback","hideableElementsContainer","setHideableElementsContainer","elementHeight","setElementHeight","ResizeObserver","resizeObserver","entry","target","scrollHeight","observe","disconnect","observeHeight","ExperimentSourceTypeIcon","sourceType","className","SourceType","NOTEBOOK","NotebookIcon","LOCAL","HomeIcon","PROJECT","FolderBranchIcon","JOB","WorkflowsIcon","ErrorIcon","XCircleIcon","textValidationDanger","FinishedIcon","CheckCircleIcon","textValidationSuccess","RunStatusIcon","status","ClockIcon","HIGH_RESOLUTION_MEDIA_QUERY","RunColorPill","hidden","onChangeColor","colorValue","setColorValue","onChangeColorDebounced","useMemo","debounce","flexShrink","marginBottom","opacity","backgroundColor","visuallyHidden","onChange","list","COLORS_PALETTE_DATALIST_ID","ExperimentViewDatasetSchemaTable","schema","filter","filteredSchema","row","_","hasFilter","toLowerCase","includes","Table","scrollable","TableRow","isHeader","TableHeader","FormattedMessage","defaultMessage","onWheel","stopPropagation","TableCell","map","idx","_ref5","_ref6","_ref7","_ref8","_ref9","_ref10","ExperimentViewDatasetSchema","datasetWithTags","dataset","setFilter","Header","grey600","marginTop","spacing","sm","form","TableFilterInput","placeholder","onClear","containerProps","mlflow_colspec","TableIcon","fontSize","Typography","Text","marginLeft","lg","md","ExperimentViewDatasetLink","runTags","DatasetSourceTypes","HTTP","HUGGING_FACE","url","getDatasetSourceUrl","NewWindowIcon","href","S3","CopyButton","CopyIcon","copyText","EXTERNAL","ExperimentViewDatasetSourceType","typeLabel","Hint","values","ExperimentViewDatasetSourceURL","whiteSpace","fontSizeSm","columnGap","xs","Link","openInNewTab","uri","source","ExperimentViewDatasetDigest","digest","ExperimentViewDatasetDrawerImpl","_datasetWithTags$tags","isOpen","setIsOpen","selectedDatasetWithRun","setSelectedDatasetWithRun","runData","contextTag","tags","find","tag","MLFLOW_RUN_DATASET_CONTEXT_TAG","fullProfile","profile","getRunColor","useGetExperimentRunColor","experimentId","Drawer","Root","open","onOpenChange","Content","Title","level","marginRight","to","Routes","getRunPageRoute","runUuid","runLink","runName","footer","Spacer","size","borderTop","flexDirection","borderRight","paddingLeft","datasets","backgroundSecondary","paddingBottom","paddingTop","ExperimentViewDatasetWithContext","displayTextAsLink","LegacyTooltip","ellipsis","Tag","textTransform","substring","Divider","ExperimentViewDatasetDrawer","textOverflow","_tags$find","SourceCellRenderer","_tags$Utils$sourceTyp","Utils","sourceTypeTag","sourceLink","renderSource","ExperimentPageUISetStateContext","state","ExperimentPageUIStateContextProvider","setUIState","Provider","useUpdateExperimentViewUIState","useExperimentIds","params","useParams","location","useLocation","normalizedLocationSearch","decodeURIComponent","search","compareExperimentIdsQueryParam","queryParams","qs","experimentIdsRaw","toString","logErrorAndNotifyUser","usePopulateImagesByRunUuid","runUuids","runUuidsIsActive","autoRefreshEnabled","enabled","dispatch","useDispatch","runUuidsSerialized","slice","NUM_RUNS_TO_SUPPORT_FOR_LOG_IMAGE","split","forEach","listImagesApi","refreshTimeoutRef","autoRefreshEnabledRef","runUuidsIsActiveSerialized","hookUnmounted","fetchImagesFn","async","activeRunUuids","autoRefresh","index","scheduleRefresh","clearTimeout","setTimeout","EXPERIMENT_RUNS_IMAGE_AUTO_REFRESH_INTERVAL","then","ConfirmModal","Component","super","isSubmitting","onRequestCloseHandler","handleSubmitWrapper","onClose","setState","handleSubmit","finally","render","Modal","visible","onOk","okText","confirmButtonText","confirmLoading","onCancel","centered","helpText","DeleteRunModalImpl","deletePromises","selectedRunIds","runId","push","deleteRunApi","Promise","all","catch","errorModalContent","intl","formatMessage","openErrorModal","_this$props$onSuccess","_this$props","onSuccess","number","pluralize","mapDispatchToProps","connect","injectIntl","GenericInputModal","formRef","onSubmit","validateFields","resetAndClearModalForm","handleSubmitFailure","reject","resetFields","handleCancel","cancelText","displayForm","child","innerRef","NEW_NAME_FIELD","RenameFormComponent","inputToAutoFocus","autoFocusInputRef","focus","select","autoFocus","prevProps","componentDidUpdate","LegacyForm","layout","Item","initialValue","rules","required","message","validator","label","Input","RenameForm","RenameRunModalImpl","handleRenameRun","newRunName","updateRunRequestId","getUUID","updateRunApi","trim","Error","RenameRunModalWithIntl","RenameRunModal","RunsChartsConfigureField","compact","RunsChartsMetricParamSelect","metricKeyList","paramKeyList","useIntl","isEmpty","LegacySelect","selectFull","dangerouslySetAntdProps","showSearch","OptGroup","metric","Option","makeCanonicalSortKey","param","RunsChartsRunNumberSelect","options","shouldUseNewRunRowsVisibilityModel","countOption","optionValue","runsChartsRunCountDefaultOptions","RunsChartsConfigureBarChart","onStateChange","updateMetric","useCallback","metricKey","updateVisibleRunCount","runsCountToCompare","emptyMetricsList","RunsChartsConfigureParallelChart","updateSelectedParams","selectedParams","updateSelectedMetrics","selectedMetrics","emptyParamsList","mode","renderMetricSelectorV2","selectedMetricKeys","ExpressionInput","chartExpression","updateYAxisExpression","removeYAxisExpression","compileExpression","useChartExpressionParser","isValidExpression","setIsValidExpression","expression","compiledExpression","rpn","variables","validateAndUpdate","validationState","CloseIcon","RunsChartsYAxisMetricAndExpressionSelector","usingChartExpressions","shouldEnableChartExpressions","xAxisKey","RunsChartsLineChartXAxisType","METRIC","temporaryChartExpressions","setTemporaryChartExpressions","yAxisExpressions","updateYAxisExpressionTemporary","newExpressions","removeYAxisExpressionTemporary","splice","handler","updateYAxisKey","yAxisKey","config","range","yMin","yMax","Radio","Group","RunsChartsLineChartYAxisType","EXPRESSION","PlusIcon","addNewYAxisExpressionTemporary","USE_GLOBAL_SETTING_KEY","renderXAxisMetricSelector","selectedXAxisMetricKey","updateSelectedXAxisMetricKey","preventDefault","safeLog","isUndefined","Math","log10","safePow","pow","RunsChartsConfigureLineChart","_state$range","_state$range2","_state$range3","_state$range4","_state$range5","_state$range6","_state$range7","_state$range8","shouldEnableMetricsOnXAxis","shouldEnableDeepLearningUIPhase3","usingManualRangeControls","shouldEnableManualRangeControls","localAxisRange","setLocalAxisRange","xMin","xAxisScaleType","xMax","scaleType","metricKeys","updateXAxisKey","useGlobal","useGlobalXaxisKey","selectedYAxisMetricKey","isInvalidLogValue","updateXAxisScaleType","isLogType","newXMin","newXMax","prev","updateYAxisType","newYMin","newYMax","updateIgnoreOutliers","ignoreOutliers","updateSmoothing","lineSmoothness","updateXAxisWhenConfirmed","inTransitionState","updateYAxisWhenConfirmed","a","b","invalidMessage","FormUI","Message","METRIC_AXIS_PREFIX","SimpleSelect","contentProps","matchTriggerWidth","textOverflowMode","startsWith","STEP","TIME","TIME_RELATIVE","shouldEnableGlobalLineChartConfig","SimpleSelectOption","Tooltip","content","side","QuestionMarkIcon","timeStepQuestionMarkIcon","SimpleSelectOptionGroup","placement","Number","updateXAxisScaleMin","max","updateXAxisScaleMax","min","Switch","checked","activeLabel","inactiveLabel","disabledLabel","updateYAxisScaleMin","updateYAxisScaleMax","bold","delayDuration","SegmentedControlGroup","displayPoints","SegmentedControlButton","InfoIcon","useGlobalLineSmoothing","LineSmoothSlider","defaultValue","svg","RunsChartsConfigureLineChartPreview","entities","metricsByRunUuid","areStatesEqual","nextState","prevState","_cardConfig$ignoreOut","_cardConfig$range","_cardConfig$range2","_cardConfig$range3","_cardConfig$range4","previewData","cardConfig","groupBy","globalLineChartConfig","usingMultipleRunsHoverTooltip","useLineChartGlobalConfig","isGrouped","some","groupParentInfo","aggregateFunction","runUuidsToFetch","flatMap","g","belongsToGroup","_r$runInfo$runUuid","_r$runInfo","runInfo","_g$runUuid","metricKeysToFetch","yAxisKeys","_cardConfig$yAxisExpr","fallback","_cardConfig$selectedM","exp","variable","add","Set","Array","from","getYAxisKeys","xAxisKeys","concat","resultsByRunUuid","isLoading","useSampledMetricHistory","maxResults","sampledData","run","metricsHistory","_resultsByRunUuid$run","_resultsByRunUuid$run2","history","uuid","removeOutliersFromMetricHistory","sampledGroupData","useGroupedChartRunData","ungroupedRunsData","sampledDataResultsByRunUuid","chartData","setTooltip","resetTooltip","useRunsChartsTooltip","RunsChartsTooltipMode","MultipleTracesWithScanline","Simple","LegacySkeleton","checkValidRange","rangeMin","rangeMax","xRange","yRange","RunsMetricsLinePlot","runsData","useDefaultHoverBox","onHover","onUnhover","RunsChartsConfigureContourChart","updateAxis","canonicalKey","axis","isCanonicalSortKeyOfType","extractCanonicalSortKey","_state$xaxis","_state$yaxis","_state$zaxis","firstMetric","firstParam","xaxis","yaxis","zaxis","scatterPlotDefaultOptions","RunsChartsConfigureScatterChart","RunsChartsConfigureDifferenceChart","updateCompareGroups","compareGroup","compareGroups","group","updateChartName","chartName","updateShowChangeFromBaseline","showChangeFromBaseline","updateShowDifferencesOnly","showDifferencesOnly","Checkbox","DifferenceCardConfigCompareGroup","_state$compareGroups","groupedCondition","DISABLED_GROUP_WHEN_GROUPBY","isChecked","LegacyInfoTooltip","RunsChartsConfigureImageChart","imageKeyList","stepMarks","maxMark","minMark","useImageSliderStepMarks","data","selectedImageKeys","imageKeys","updateStep","step","handleUpdate","imageKey","_currentConfig$imageK","currentConfig","_currentConfig$imageK2","DialogCombobox","multiSelect","DialogComboboxTrigger","handleClear","minWidth","DialogComboboxContent","DialogComboboxOptionList","_state$imageKeys","DialogComboboxOptionListCheckboxItem","marks","keys","previewComponentsMap","RunsChartType","BAR","RunsMetricsBarPlot","displayRunNames","displayMetricKey","margin","barChartCardDefaultMargin","CONTOUR","RunsContourPlot","xAxis","yAxis","zAxis","LINE","PARALLEL","isConfigured","isParallelChartConfigured","_cardConfig$selectedP","paramKey","dataTrace","_dataTrace$params$par","isNaN","filteredData","processParallelCoordinateData","LazyParallelCoordinatesPlot","axesRotateThreshold","Empty","description","image","NoIcon","SCATTER","RunsScatterPlot","DIFFERENCE","setCardConfig","shouldEnableNewDifferenceViewCharts","DifferenceViewPlotV2","DifferenceViewPlot","IMAGE","ImageGridPlot","containerWidth","RunsChartsConfigureModal","chartRunData","supportedChartTypes","isChartTypeSupported","borderStyle","actionDefaultBorderDefault","currentFormState","setCurrentFormState","isEditing","updateChartType","emptyChartCard","RunsChartsCardConfig","getEmptyChartCardByType","reverse","images","sort","disableSaveButton","_lineCardConfig$selec","okButtonProps","bodyStyle","overflowY","borderBottom","chartType","chartTypeOption","ChartBarIcon","ChartScatterIcon","ChartLineIcon","ChartParallelIcon","ChartContourIcon","shouldEnableDifferenceViewCharts","ChartDifferenceIcon","shouldEnableImageGridCharts","ChartImageIcon","RunsChartsTooltipWrapper","contextData","runs","component","RunsChartsTooltipBody","hoverOnly","PreviewComponent","renderPreviewChartType","iconSize","field","RunsChartsDraggableGridStateContext","createContext","draggedCardUuid","targetSection","RunsChartsDraggableGridActionsContext","setDraggedCardUuid","setTargetSection","setTargetPosition","onDropChartCard","onSwapCards","useRunsChartsDraggableGridStateContext","useContext","useRunsChartsDraggableGridActionsContext","RunsChartsDraggableCardsGridContextProvider","visibleChartCards","shouldEnableDraggableChartsGridLayout","targetSectionUuid","setTargetSectionUuid","immediateDraggedCardUuid","immediateTargetSectionId","targetLocalPosition","pos","updateChartsUIState","useUpdateRunsChartsUIConfiguration","sourceChartUuid","targetChartUuid","_current$compareRunCh","newChartsOrder","compareRunCharts","indexSource","findIndex","c","indexTarget","sourceChart","draggedChartUuid","targetSectionId","targetPosition","_current$compareRunCh2","_current$compareRunSe","_current$compareRunSe2","_current$compareRunCh3","sourceCard","chart","sourceSection","compareRunSections","section","metricSectionId","sourceSectionCards","chartCard","_current$compareRunCh4","resultChartsList","visibleSectionCards","originalIndex","clampedLocalPosition","targetIndex","indexOf","_current$compareRunCh5","targetSectionCards","deleted","sortBy","_targetSectionCards$i","stateContextValue","actionsContextValue","RunsChartsFilterInput","chartsSearchFilter","inputValue","setInputValue","searching","setSearching","updateChartFilter","updateChartFilterDebounced","useDebouncedCallback","role","prefix","iconFontSize","Spinner","SearchIcon","allowClear","RunsChartsFullScreenModal","isMetricHistoryLoading","fullScreenChart","tooltipContextValue","tooltipComponent","getPrefixedClassName","subtitle","verticalSizing","flex","RunsChartsCard","sectionIndex","fullScreen","onRemoveChart","onReorderCharts","onStartEditChart","setFullScreenChart","canMoveDown","canMoveUp","onMoveDown","onMoveUp","onReorderWith","RunsChartsGlobalChartSettingsDropdown","updateUIState","updateGlobalLineChartSettings","newSettings","isUsingGlobalMetricXaxis","DropdownMenu","modal","Trigger","asChild","GearIcon","align","Label","CheckboxItem","ItemIndicator","Sub","SubTrigger","IconWrapper","CheckIcon","visibility","SubContent","RunsChartsNoDataFoundIndicator","hideEmptyCharts","paddingRight","link","chunks","createLineChartValuesBox","activeRun","hoverData","_hoverData$metricEnti","_hoverData$yValue","metricKeyFromConfig","metricEntity","metricValue","yValue","metrics","isNil","xValue","getTooltipXValue","_hoverData$xValue","_hoverData$xValue2","shouldEnableRelativeTimeDateAxis","ValuesBox","isHovering","createBarChartValuesBox","_customMetricBehavior","_customMetricBehavior2","customMetricBehaviorDef","customMetricBehaviorDefs","displayName","displayValue","valueFormatter","createScatterChartValuesBox","_activeRun$metrics$xK","_activeRun$params$xKe","_activeRun$metrics$yK","_activeRun$params$yKe","xKey","yKey","createContourChartValuesBox","_activeRun$metrics$xK2","_activeRun$params$xKe2","_activeRun$metrics$yK2","_activeRun$params$yKe2","_activeRun$metrics$zK","_activeRun$params$zKe","zKey","zValue","createParallelChartValuesBox","paramsList","metricsList","closeContextMenu","onTogglePin","onHideRun","containsMultipleRunsTooltipData","RunsMultipleTracesTooltipBody","singleTraceHoverData","hoveredDataPoint","metricSuffix","contentWrapper","header","colorPill","actionsWrapper","pinnable","pinned","PinFillIcon","PinIcon","VisibleIcon","primary","PLOT_CONFIG","displaylogo","scrollZoom","modeBarButtonsToRemove","DEFAULT_COLOR_SCALE","markerSize","reverseScale","runsChartDefaultContourMargin","colorScale","onUpdate","selectedRunUuid","onSetDownloadHandler","layoutHeight","layoutWidth","setContainerDiv","containerDiv","isDynamicSizeSupported","useDynamicPlotSize","plotData","xValues","yValues","zValues","tooltipData","_xAxisData$xAxis$key","_yAxisData$yAxis$key","_zAxisData$zAxis$key","xAxisData","yAxisData","zAxisData","z","layers","customdata","text","hovertemplate","zAxisTitle","hoverinfo","hoverlabel","runsChartHoverlabel","textposition","marker","line","unshift","connectgaps","contours","coloring","colorscale","reversescale","colorbar","tickfont","family","plotlyThemedLayout","createThemedPlotlyLayout","setLayout","ticks","standoff","template","newLayout","setHoveredPointIndex","useRenderRunsChartTraceHighlight","highlightScatterTraces","hoverCallback","_scatterPoints$pointI","_customdata","points","scatterPoints","curveNumber","pointIndex","pointCustomDataRunUuid","unhoverCallback","mutableHoverCallback","useMutableChartHoverCallback","legendLabelData","getLegendDataFromRuns","dataToExport","trace","createChartImageDownloadHandler","commonRunsChartStyles","chartWrapper","scatterChartHighlightStyles","LazyPlot","useResizeHandler","RunsMetricsLegendWrapper","labelData","doubleClick","showTips","runsChartDefaultMargin","barWidth","ids","names","_d$metrics$metricKey","normalizeChartValue","textValues","_d$metrics$metricKey3","_d$metrics$metricKey2","val","places","toFixed","getFixedPointValue","textfont","orientation","hovermode","tickformat","chartAxisTickFormat","showticklabels","fixedrange","highlightBarTraces","_points$0$data","_points$0$pointIndex","_points$","_points$2","layoutToExport","automargin","highlightStyles","transition","TraceLabel","dashStyle","maxWidth","TraceLabelColorIndicator","strokeDasharray","dashType","getDashArray","pathYOffset","STROKE_WIDTH","flexWrap","alignContent","labelDatum","heightBuffer","RunsMetricsLegend","PLOTLY_DRAGLAYER_SELECTOR","parseMicroseconds","plotlyAxisBoundary","_plotlyAxisBoundary$m","microsecondsString","isString","match","getCompareValue","element","timestamp","getDataTraceForRun","_yValues","_runEntry$runInfo","_yValues2","_runEntry$runInfo2","_runEntry$runInfo3","runEntry","lineShape","lineDash","displayOriginalLine","originalLine","evaluateExpression","sortedMetricsHistory","xDataPointsPerVariable","_runEntry$metricsHist","elements","compareValue","xDataPoints","intersection","xDataPoint","obj","_runEntry$metricsHist2","_elements$find","expressionValue","getExpressionChartsSortedMetricHistory","_sortedMetricsHistory","_sortedMetricsHistory2","ySteps","xValuesWithSteps","prepareXAxisDataForMetricType","stepOrder","xSteps","yValueHistory","orderBySteps","has","_sortedMetricsHistory3","prepareMetricHistoryByAxisType","firstNonZeroXIndex","optimizedLineShape","containsDuplicateXValues","shouldDisplayMarkers","containsSingleValue","EMA","metricHistory","hovertext","createTooltipTemplate","dash","shape","createFadedTraceColor","dataPoints","stepIndexes","_stepIndexes$a$step","_stepIndexes$b$step","Infinity","axisType","minTimestamp","minBy","_ref16","EPOCH_RELATIVE_TIME","_ref17","_ref18","TIME_RELATIVE_HOURS","_ref19","HOUR_IN_MILLISECONDS","_ref20","_ref21","datapoint","_ref22","lockXAxisZoom","positionInSection","dynamicXAxisKey","maxDiff","maxTimestamp","maxBy","diff","LINE_CHART_RELATIVE_TIME_THRESHOLD","getTraceAndOriginalTrace","shouldEnableChartsOriginalLinesWhenSmoothing","originalLineProps","lineDashStyles","flat","bandsData","_ref23","_runEntry$runInfo4","aggregatedMetricsHistory","xMins","xMaxes","yMins","yMaxes","_ref11","_ref12","_ref13","minReversed","_ref14","_ref15","isNumber","lastNonZeroXIndex","bandValues","fillcolor","getBandTraceForRun","plotDataWithBands","highlightLineTraces","xAxisPlotlyType","getXAxisPlotlyType","xAxisKeyLabel","getChartAxisLabelDescriptor","yAxisParams","autorange","xAxisParams","showlegend","updatedLayout","isEqual","containsMultipleMetricKeys","_ref24","_hoveredPoint$curveNu","_hoveredPointData$met","hoveredPoint","hoveredPointData","themedPlotlyLayout","immediateLayout","getXAxisRange","getLineChartLegendData","scanlineElement","initHandler","updateHandler","updateHandlerMultipleRuns","onPointHover","hoverCallbackMultipleRuns","onPointUnhover","unhoverCallbackMultipleRuns","chartBoundaries","containerLeftPixels","plotWidthPixels","plotOffsetPixels","lowerBoundValue","valueRange","mainContainer","dragLayer","initialized","scanlineElementRef","currentHoveredDataPoint","visibleXValues","uniq","initializedFigure","setInitializedFigure","immediateHoverData","immediateLegendLabelData","immediateRunsData","immediatePlotData","immediateXValuesData","immediateFigure","setupBoundaries","figure","_figure$layout$xaxis","_figure$layout$xaxis$","_figure$layout$xaxis2","_figure$layout$xaxis3","_lowerBoundary","_upperBoundary","lowerAxisValue","upperAxisValue","lowerBoundary","getTime","upperBoundary","updateContainerPosition","containerRect","getBoundingClientRect","dragLayerRect","onUpdatePlotHandler","graphDiv","querySelector","onInitPlotHandler","requestAnimationFrame","pointerLeavePlotCallback","relatedTarget","Element","classList","contains","onPointHoverCallback","singleTraceData","traceUuid","onPointUnhoverCallback","getClosestXValue","pointerClientX","boundaries","resultX","currentStep","abs","tooltipDataUpdateHandler","throttle","closestXValue","clientX","legendEntry","_correspondingDataTra","_correspondingDataTra2","correspondingDataEntry","correspondingDataTrace","xIndex","tooltipLegendItems","orderBy","leading","windowResizeHandler","hoverHandler","_immediateHoverData$c","_immediateHoverData$c2","closestXValueLeftInPixels","clientY","originalEvent","removeEventListener","top","borderLeft","pointerEvents","useRunsMultipleTracesTooltipData","legend","onInitialized","PlotlyLikeFormattedTime","FormattedDate","year","month","day","FormattedTime","hour","hourCycle","minute","second","fractionalSecondDigits","PlotlyLikeFormattedTimestamp","hoveredTraceUuid","displayedXValueLabel","rowGap","textPlaceholder","fontWeight","_points$$customdata","DRAGGABLE_CARD_HANDLE_CLASS","DRAGGABLE_CARD_TRANSITION_NAME","DRAGGABLE_CARD_TRANSITION_VAR","RunsChartsChartsDragGroup","ChartRunsCountIndicator","memo","runsOrGroups","containsGroups","containsRuns","count","RunsChartCardWrapperRaw","onDelete","onEdit","tooltip","noop","previousChartUuid","nextChartUuid","additionalMenuContent","toggleFullScreenChart","toggles","supportedDownloadFormats","onClickDownload","isHidden","isRefreshing","gridTemplateRows","backgroundPrimary","borderRadiusBase","DragIcon","String","toggle","currentToggle","setToggle","toggleLabel","FullscreenIcon","OverflowIcon","Separator","chartEntry","chartComponentWrapper","verticalAlign","RunsChartCardWrapper","l","pad","RunsChartsBarChartCard","_customMetricBehavior3","_customMetricBehavior4","isInViewport","isInViewportProp","reorderProps","usingDraggableChartsGridLayout","slicedRuns","isEmptyDataset","elementRef","isInViewportInternal","useIsInViewport","imageDownloadHandler","setImageDownloadHandler","useChartImageDownloadHandler","chartBody","barChartCardWrapper","GENERAL_AREA","format","runsToExport","downloadChartDataCsv","getV2ChartTitle","expressions","SUPPORTED_DOWNLOAD_FORMATS","RunsChartsLineChartCard","_config$ignoreOutlier","onDownloadFullMetricHistoryCsv","isInViewportDeferred","isInViewportDeferredProp","_config$selectedMetri","metricsInRuns","_r$runInfo2","_config$yAxisExpressi","_config$selectedMetri2","destroyTooltip","isInViewportDeferreed","sampledMetricsByRunUuid","useSelector","pick","shallowEqual","yRangeLocal","setYRangeLocal","yRangeLegacy","setOffsetTimestamp","stepRange","xRangeLocal","setXRangeLocal","offsetTimestamp","findChartStepsByTimestampForRuns","lowerBound","floor","upperBound","ceil","useCompareRunChartSelectedRange","renderChartBody","renderSkeleton","lineChartCardWrapper","yAxisMin","yAxisMax","xAxisMin","xAxisMax","yAxisAutorange","newYRange","xAxisAutorange","newXRange","ungroupedRunUuids","groupedRunUuids","_groupParentInfo$runU","timestampRange","findAbsoluteTimestampRangeForRelativeRange","_groupParentInfo$runU2","_config$selectedMetri3","_config$selectedMetri4","savedChartTitle","downloadChartMetricHistoryCsv","_d$runInfo","_group$groupParentInf","RunsChartsScatterChartCard","scatterChartCardWrapper","paramsToExport","metricsToExport","RunsChartsContourChartCard","contourChartCardWrapper","SvgParallelChartPlaceholder","gradientUnits","stopColor","offset","NotConfiguredParallelCoordsPlaceholder","ParallelChartSvg","UnsupportedDataPlaceholder","textAlign","RunsChartsParallelChartCard","configuredChartRunData","showAllRuns","containsStringValues","_config$selectedParam","updateVisibleOnlySetting","_state$compareRunChar","newCompareRunCharts","existingChartConfig","parallelCoordsData","configured","containsUnsupportedValues","displaySubtitle","parallelChartCardWrapper","fullScreenEnabled","PARALLEL_CHARTS_AREA","NotConfiguredDifferenceChartPlaceholder","RunsChartsDifferenceChartCard","_config$compareGroups","confirmChartCardConfiguration","useConfirmChartCardConfigurationFn","setter","showChangeFromBaselineToggle","showDifferencesOnlyToggle","showTooltip","RunsChartsImageChartCard","containerRef","setContainerWidth","entries","contentRect","tmpConfig","setTmpConfig","DEFAULT_IMAGE_GRID_CHART_NAME","stepMarkLength","shouldDisplayImageLimitIndicator","LOG_IMAGE_TAG_INDICATOR","conf","onAfterChange","RunsChartsCardRaw","usingGridLayout","chartElementKey","editProps","commonChartProps","HEADING_COLUMN_ID","NoDifferenceDataPlaceholder","modelMetrics","systemMetrics","parameters","attributes","getDifferenceViewDataGroups","getData","MODEL_METRICS","SYSTEM_METRICS","PARAMETERS","ATTRIBUTES","TAGS","baselineColumn","nonBaselineColumns","baselineColumnUuid","getColumns","convertRunToColumnInfo","isBaseline","baselineAccessorFn","accessorFn","cell","getDifferenceChartDisplayedValue","getValue","_differenceView","difference","differenceView","Paragraph","ArrowDownIcon","ArrowUpIcon","accessorKey","table","useReactTable","columns","enableColumnResizing","columnResizeMode","getCoreRowModel","updateBaselineColumnUuid","getRowModel","rows","getTotalSize","getHeaderGroups","headerGroup","headers","column","getSize","resizable","getCanResize","resizeHandler","getResizeHandler","flexRender","columnDef","getContext","getAllCells","multiline","customExpandIcon","record","expanded","ChevronDownIcon","ChevronRightIcon","onExpand","float","getJSONRows","getChildren","parsedRowWithoutHeadingCol","result","_parsedRowWithoutHead","DIFFERENCE_CHART_DEFAULT_EMPTY_VALUE","newParsedRow","_parsedRowWithoutHead2","jsonSchema","isAllJson","parsedRow","isArray","validateParseJSON","commonSchema","extractMaximumCommonSchema","schema1","schema2","collectKeys","getTableBodyHeight","tableHeight","antdTableComponents","onResize","restProps","Resizable","handle","draggableOpts","enableUserSelectHack","CellDifference","direction","paragraphColor","DifferenceChartCellDirection","NEGATIVE","POSITIVE","SAME","DashIcon","columnWidths","setColumnWidths","dataSource","handleResize","next","dataIndex","rowDifference","onHeaderCell","filterIcon","filterDropdown","fixed","components","scroll","pagination","expandable","expandIcon","defaultExpandAllRows","indentSize","sticky","IMAGE_GAP_SIZE","getImageSize","numImages","maxImagesPerRow","ImagePlot","imageUrl","compressedImageUrl","imageSize","maxImageSize","previewVisible","setPreviewVisible","GenericSkeleton","ImagePreviewGroup","onVisibleChange","Image","src","preview","ImagePlotWithHistory","metadataByStep","ImageIcon","getArtifactLocationUrl","filepath","compressed_filepath","EmptyImageGridPlot","ImageGridSingleKeyPlot","displayRuns","imageMetadata","imageMetadataByStep","metadata","lineHeightMd","ImageGridMultipleKeyPlot","grid","filteredPreviewData","ParallelCoordinatesPlot","Suspense","originalCardConfig","globalXAxisKey","globalSelectedXAxisMetricKey","activeKey","onActiveKeyChange","disableCollapse","clsPrefix","classItem","classItemActive","classHeader","classContent","classContentBox","classArrow","transform","textPrimary","outlineColor","outlineStyle","Accordion","dangerouslyAppendEmotionCSS","expandIconPosition","RunsChartsAddChartMenu","onAddChart","addChartButton","iconWrapper","RunsChartsSectionHeader","sectionChartsLength","addNewChartCard","onDeleteSection","onAddSection","editSection","onSetEditSection","onSetSectionName","onSectionReorder","isExpanded","hideExtraControls","tmpSectionName","setTmpSectionName","isDraggingHandle","setIsDraggingHandle","sectionNameRef","confirmButtonRef","sectionNameWidth","setSectionNameWidth","isDeleteSectionModalOpen","setIsDeleteSectionModalOpen","isCurrentlyEdited","isCurrentlyHovered","setIsCurrentlyHovered","onMouseMove","inset","isDarkMode","blue800","blue100","blue400","EDITABLE_LABEL_PADDING_WIDTH","onMouseDown","onMouseUp","onDoubleClick","onKeyDown","onPressEnter","minHeight","PencilIcon","rotate","addSectionAbove","addSectionBelow","deleteSection","DangerModal","deleteModalConfirm","deleteModalCancel","alignSelf","RunsCharts","sectionId","cardsConfig","onInsertCharts","parallelChartCards","differenceChartCards","imageChartCards","remainingChartCards","gridSetup","dropTargetGeneralRef","isOverGeneral","dropTargetParallelRef","isOverParallel","isChartsEmpty","chartCards","_chartCards","_chartCards2","_remainingChartCards","_remainingChartCards2","sharedObserver","entryCallbackMap","WeakMap","observeElement","callback","_sharedObserver","IntersectionObserver","entryCallback","get","isIntersecting","set","_sharedObserver2","unobserve","delete","RunsChartsDraggableCard","_translateBy$x","_translateBy$y","setElementRef","setIsInViewport","useIsInViewportV2","translateBy","onResizeStart","onResizeStop","cardProps","shouldDeferLineChartRendering","deferredValue","useDebounce","resizeWidth","setResizeWidth","resizeHeight","setResizeHeight","setIsDragging","origin","setOrigin","draggedCardElementRef","onStartDrag","onDrag","onStopDrag","onResizeStartInternal","_draggedCardElementRe","rect","_rect$width","_rect$height","onResizeInternal","DraggableCore","onStart","onStop","ResizableHandle","zIndex","RUNS_CHARTS_UI_Z_INDEX","CARD_DRAGGED","overflowing","forwardRef","actionDefaultIconDefault","RunsChartsDraggablePreview","borderColor","borderWidth","CARD_PREVIEW","rowHeightSuggestions","PlaceholderSymbol","Symbol","RunsChartsDraggableCardsGridSection","_sectionConfig$column","_sectionConfig$cardHe","sectionConfig","useMediaQuery","responsive","breakpoints","cardHeight","gridBoxRef","setColumns","columnCount","s","setCardHeight","_current$compareRunSe3","_current$compareRunSe4","lastElementCount","setPositionInSection","resizePreview","setResizePreview","findCoords","_gridBoxRef$current","rowCount","col","colGapsCount","passedColGaps","passedRowGaps","cardsToRender","isEmptyChartCard","cardTransforms","newArray","fromIndex","toIndex","newIndex","oldIndex","oldCoords","newCoords","deltaX","deltaY","dragPreview","_gridBoxRef$current2","_rect$width2","mouseMove","columnSuggestions","setColumnSuggestions","immediateColSuggestion","immediateRowSuggestion","_gridBoxRef$current3","gridBoxRefSize","gapSize","cols","getColumnSuggestions","_immediateColSuggesti","_immediateRowSuggesti","columnSuggestion","curr","rowHeightSuggestion","Global","array","_cardConfig$uuid","_cardConfig$uuid2","_array","_array2","RunsChartsSection","sectionCharts","reorderCharts","insertCharts","startEditChart","removeChart","getChartMetricsAndParams","lineConfig","scatterConfig","parallelConfig","contourConfig","RunsChartsSectionAccordion","setEditSection","onActivePanelChange","newCompareRunPanels","shouldDisplaySection","chartConfig","isGenerated","newCompareRunSections","isAccordionReordered","addSection","above","newSection","isReordered","appendSection","setSectionName","sectionReorder","sourceSectionId","sourceSectionIdx","targetSectionIdx","noRunsSelected","sectionsToRender","chartsToRender","compareRunChartsFiltered","chartMatchesFilter","shouldUseRegexpBasedChartFiltering","filterRegex","RegExp","metricOrParam","filterLowerCase","sectionsWithCharts","isSearching","MetricChartsAccordion","Panel","block","MATCH_VARIABLE_REGEX","Operator","Parenthesis","VariableParenthesis","precedence","ADD","SUBTRACT","MULTIPLY","DIVIDE","POWER","NEGATIVE_SIGN","POSITIVE_SIGN","isBinaryOperator","char","isUnaryOperator","variableStringToIndex","popAndValidate","stack","operandCount","lastElement","pop","flushUnaryOperators","output","last","noVariableExpression","replace","test","parsedExpression","matches","dedupMatches","matchesMap","parseVariablesAndReplaceWithIndex","cleanedExpression","incrementOperand","i","isUnarySign","OPEN","CLOSE","num","periodMatches","floatNum","parseFloat","op1","isHigherPrecedence","toRPN","parseInt","tokens","token","fromRPN","experimentChartImageDefaultDownloadLayout","paper_bgcolor","plot_bgcolor","experimentChartImageDefaultDownloadSettings","experimentChartImageDefaultDownloadPlotConfig","downloadImage","filename","downloadHandlerRef","downloadHandler","setDownloadHandler","setDownloadHandlerCached","existingHandler","chartTitle","_downloadHandlerRef$c","meta","VIEWPORT_DEBOUNCE_MS","deferTimeoutMs","activeObserver","startObserver","intersectionObserver","mutableRef","highlightChartTracesFn","traceSelector","parentSelector","parent","hoverIndex","selectIndex","_parent$querySelector","_parent$querySelector3","numberOfBands","deselected","_parent$querySelector2","_parent$querySelector4","_parent$querySelector5","_parent$querySelector6","remove","querySelectorAll","bandTraceIndex","highlightFn","lastRunsData","selectedTraceIndex","hoveredPointIndex","onHighlightChange","useRunsChartTraceHighlight","shouldEnableUnifiedChartDataTraceHighlight","lastSelectedTraceIndex","highlightChangeListener","newExtern","externallyHighlightedRunIndex","ChartsTraceHighlightSource","RunsChartsSetHighlightContext","highlightDataTrace","RunsChartsSetHighlightContextProvider","highlightListenerFns","contextValue","shouldBlock","notifyListeners","fn","listener","createElement","RunsChartsTooltipContext","ContextMenuVisibility","extractHTMLAncestorElement","HTMLElement","currentElement","parentElement","ctxMenuRef","currentPos","usingImprovedClickMechanism","currentSnappedCoordinates","setMode","contextMenuShown","setContextMenuShown","HIDDEN","tooltipDisplayParams","setTooltipDisplayParams","hoveredRunUuid","setHoveredRunUuid","additionalAxisData","setAdditionalAxisData","focusedRunData","mutableContextMenuShownRef","mutableHoveredRunUuid","mutableTooltipDisplayParams","mutableAdditionalAxisData","applyPositioning","isChangingVisibilityMode","targetX","targetY","currentCtxMenu","reposition","menuRect","getCoordinatesForTargetElement","targetElement","_containerRef$current","targetRect","offsetX","offsetY","HOVER","nativeEvent","updateTooltip","additionalRunData","_focusedRunData$curre","VISIBLE","currentRunUuid","mouseDownCapture","button","pageX","pageY","tooltipAreaClicked","clickedInTheSamePlace","_focusedRunData$curre3","_focusedRunData$curre2","domRoot","getRootNode","rootClickListener","_focusedRunData$curre4","capture","_focusedRunData$curre5","CHART","displayTooltip","onMouseDownCapture","onClickCapture","contextMenuContainer","contextMenuWrapper","userSelect","TOOLTIP_CONTAINER","TOOLTIP","boxShadow","shadowLow","overlayElement","RunsChartsUIConfigurationContext","RunsChartsUIConfigurationContextProvider","useReorderRunsChartsFn","newSectionsState","targetChart","isSameMetricSection","newSourceChart","configuredCard","serializedCard","serialize","existingChartCard","useInsertRunsChartsFn","useRemoveRunsChartFn","configToDelete","setup","GET_METRIC_HISTORY_BULK_INTERVAL","gql","shouldUseGraphql","shouldEnableGraphQLSampledMetrics","legacyResult","store","rangeKey","createChartAxisRangeKey","anyRunRefreshing","anyRunLoading","returnValues","metricsByMetricKey","dataByMetricKey","_store$entities$sampl","_store$entities$sampl2","runMetricData","loading","refreshing","keyBy","refreshFn","chunk","runUuidsChunk","action","getSampledMetricHistoryBulkAction","fetchMetricsFn","isAutoRefreshing","EXPERIMENT_RUNS_METRIC_AUTO_REFRESH_INTERVAL","refresh","useSampledMetricHistoryREST","graphQlResult","_range$","_range$2","_data$mlflowGetMetric6","refetch","startPolling","stopPolling","networkStatus","error","useQuery","skip","notifyOnNetworkStatusChange","pollInterval","onCompleted","_data$mlflowGetMetric","_data$mlflowGetMetric2","_data$mlflowGetMetric3","_data$mlflowGetMetric4","mlflowGetMetricHistoryBulkInterval","apiError","code","displayGlobalErrorNotification","runIds","startStep","endStep","_data$mlflowGetMetric5","metricsByRunId","_metricsByRunId$runId","NetworkStatus","setVariables","poll","useSampledMetricHistoryGraphQL","isDifferent","headingColumnId","getMetrics","filterCondition","runDataKeys","runDataAttribute","hasDifference","MLFLOW_SYSTEM_METRIC_PREFIX","getVisibleTagValues","DifferenceCardAttributes","USER","SOURCE","VERSION","MODELS","attribute","attributeData","user","getUser","getSourceName","getSourceVersion","models","getLoggedModelsFromTags","findChartStepsByTimestamp","currentMetricHistory","useDefaultIfNotFound","flatHistory","valueOf","lowerEntry","first","upperEntry","sampledMetrics","stepRangesPerRun","_sampledMetrics$runUu","metricHistoryForRun","bound","currentlyVisibleMetrics","relativeRange","multiplier","_minBy","runMetrics","visibleMetricHistoryForRun","_metric$metricsHistor","timestampOffset","SEARCH_BAR","invariant","aggregatedRunUuidsInGroup","runUuidsForAggregation","aggregatedMetricsHistoryForMetric","metricsHistoryInGroup","_sampledDataResultsBy","_sampledDataResultsBy2","steps","h","createAggregatedMetricHistory","createValueAggregatedMetricHistory","RUN_ID_FILTER_EXPRESSION","LOGGED_MODEL_ID_FILTER_EXPRESSION","createRunIdsFilterExpression","useExperimentTraces","experimentIds","sorting","loggedModelId","traces","setTraces","setLoading","setError","orderByString","firstOrderByColumn","EXPERIMENT_TRACES_SORTABLE_COLUMNS","desc","filterString","isExperimentLoggedModelsUIEnabled","pageTokens","setPageTokens","currentPage","setCurrentPage","currentPageToken","fetchTraces","pageToken","silent","response","MlflowService","getExperimentTraces","runNamesForTraces","traceIdToRunIdMap","traceId","request_id","getTraceInfoRunId","runIdsToRunNames","searchRuns","experiment_ids","run_view_type","ViewType","ALL","info","fetchRunNamesForTraces","tracesWithRunNames","prevPages","next_page_token","hasNextPage","hasPreviousPage","reset","fetchNextPage","prevPage","fetchPrevPage","refreshCurrentPage","TracesViewTableTagCell","onAddEditTags","baseComponentId","visibleTagList","MLFLOW_INTERNAL_PREFIX","containsTags","KeyValueTag","charLimit","enableFullViewModal","SpeechBubblePlusIcon","getIcon","textValidationWarning","TracesViewTableStatusCell","original","labelDescriptor","ExperimentViewTracesStatusLabels","TracesViewTablePreviewCell","previewFieldName","setIsExpanded","fullData","setFullData","fetchFullData","getExperimentTraceData","previewValue","requestData","errorMessage","ErrorWrapper","getUserVisibleError","expand","collapse","showExpander","isTraceMetadataPossiblyTruncated","ExpandedParamCell","structuredJSONValue","objectData","wordBreak","fontFamily","TracesViewTableRequestPreviewCell","getTraceInfoInputs","TracesViewTableResponsePreviewCell","getTraceInfoOutputs","TracesViewTableSourceCell","getHeaderSizeClassName","getColumnSizeClassName","TracesViewTableRow","buttonHeight","_meta","_meta2","TRACE_TABLE_CHECKBOX_COLUMN_ID","selected","TracesViewTableTimestampCell","timestamp_ms","toLocaleString","navigator","timeZoneName","timeSinceStr","TracesViewTableHeaderCheckbox","getIsAllRowsSelected","getIsSomeRowsSelected","toggleAllRowsSelected","TracesViewTableCellCheckbox","getCanSelect","getIsSelected","toggleSelected","TraceTableLangchainQuickstartContent","showLabel","showLineNumbers","TraceTableLlamaIndexQuickstartContent","TraceTableCustomQuickstartContent","TraceTableAutogenQuickstartContent","TraceTableOpenAIQuickstartContent","TracesViewTableNoTracesQuickstart","titleElementLevel","isRun","Tabs","List","TracesViewTable","onTraceClicked","onTraceTagsEdit","onNextPage","onPreviousPage","usingFilters","onResetFilters","setSorting","rowSelection","setRowSelection","hiddenColumns","disableTokenColumn","enableResizing","enableSorting","ExperimentViewTracesTableColumnLabels","ExperimentViewTracesTableColumns","requestId","traceName","getTraceTagValue","TRACE_TAG_NAME_TRACE_NAME","timestampMs","inputs","outputs","experiment_id","totalTokens","getTraceInfoTotalTokens","latency","execution_time_ms","isFinite","formatDuration","getRowId","getSortedRowModel","onSortingChange","onRowSelectionChange","enableRowSelection","columnSizeInfo","getState","columnSizingInfo","columnSizeVars","getFlatHeaders","colSizes","empty","getEmptyState","getMessageField","DangerIcon","CursorPagination","getLeafHeaders","sortable","getCanSort","sortDirection","getIsSorted","onToggleSort","getToggleSortingHandler","isResizing","getIsResizing","TableSkeletonRows","ModelTraceExplorerFrameRenderer","modelTrace","useLatestVersion","iframeRef","setIsLoading","handleMessage","_iframeRef$current","iframeWindow","contentWindow","ModelTraceChildToParentFrameMessage","Ready","_iframeRef$current2","postMessage","ModelTraceParentToChildFrameMessage","UpdateTrace","traceData","TitleSkeleton","TableSkeleton","lines","Version","TraceDataDrawer","traceInfo","loadingTraceInfo","loadingTraceData","setTraceData","fetchTraceData","spans","useExperimentTraceData","shouldFetchTraceInfo","internalTraceInfo","loadingInternalTracingInfo","setTraceInfoData","fetchTraceInfo","getExperimentTraceInfo","trace_info","useExperimentTraceInfo","traceInfoToUse","getTraceDisplayName","combinedModelTrace","trace_data","containsSpans","expandContentToFullHeight","WarningIcon","TracesViewDeleteTraceModal","handleClose","refreshTraces","setErrorMessage","tracesToDelete","pickBy","handleOk","_experimentIds$","deleteTraces","submitDeleteTraces","danger","TracesViewControlsActions","isModalOpen","setIsModalOpen","openModal","closeModal","InputTooltip","Popover","Arrow","whereBold","TracesViewControls","onChangeFilter","disabledColumns","toggleHiddenColumn","filterValue","setFilterValue","allColumnsList","displayedFilterValue","TableFilterLayout","suffix","ColumnsIcon","DialogComboboxOptionListSearch","defaultExperimentViewTracesUIState","useExperimentViewTracesUIState","localStore","persistenceIdentifier","uiState","uiStateRaw","loadExperimentViewTracesUIState","columnId","prevUIState","QUERY_PARAM_KEY","defaultSorting","TracesView","_uiState$hiddenColumn2","timeoutRef","selectedTraceId","setSelectedTraceId","useActiveExperimentTrace","_searchParams$get","searchParams","setSearchParams","useSearchParams","selectedTraceInfo","existingTagKeys","_trace$tags","showEditTagsModalForTrace","EditTagsModal","showEditTagsModal","useEditKeyValueTagsModal","saveTagsHandler","editedEntity","existingTags","newTags","traceRequestId","addedOrModifiedTags","newTagKey","newTagValue","existingTagKey","existingTagValue","deletedTags","updateRequests","setExperimentTraceTag","deleteExperimentTraceTag","valueRequired","allAvailableTags","tagKey","visibleTags","useEditExperimentTraceTags","anyTraceContainsTokenCount","autoDisabledColumns","allDisabledColumns","allHiddenColumns","_uiState$hiddenColumn","onTagsUpdated","sortingSetter","isFunction","currentState","newState","currentSortBy","getTraceMetadataField","_traceInfo$request_me","_traceInfo$request_me2","request_metadata","traceMetadata","tagName","_traceInfo$tags","_traceInfo$tags$find","defineMessage","UNSET","IN_PROGRESS","OK","ERROR","datasetSummariesEqual","summary1","summary2","context","path","icons","rotateLeft","UndoIcon","rotateRight","RedoIcon","zoomIn","ZoomInIcon","zoomOut","ZoomOutIcon","close","ArrowLeftIcon","ArrowRightIcon","getPopupContainer","DesignSystemContext","RcImage","PreviewGroup","getContainer","v","query","queryList","useSyncExternalStore","useMatchesMediaQuery","matchMedia","wordSpacing","MozTabSize","OTabSize","tabSize","WebkitHyphens","MozHyphens","msHyphens","hyphens","textShadow","comment","prolog","doctype","cdata","punctuation","namespace","Opacity","operator","property","function","selector","boolean","string","entity","keyword","control","directive","unit","statement","regex","atrule","textDecoration","inserted","italic","fontStyle","important","Outline","OutlineOffset","borderRightColor","wordWrap","builtin","class","constant","hexcode","symbol","SyntaxHighlighter","registerLanguage","python","snippetPadding","themesStyles","light","lightStyle","duotoneDark","duotoneDarkStyle","actions","lineNumberStyle","customStyle","codeTagProps"],"sourceRoot":""}